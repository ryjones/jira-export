<Issue id="28636" key="IS-596" number="596" project="10401" reporter="ozheregelya" creator="ozheregelya" type="10004" summary="Libindy-based load test hangs after returning 307 error" priority="3" resolution="10000" status="10001" created="2018-03-18 15:06:16.0" updated="2018-05-21 13:52:00.0" resolutiondate="2018-05-21 13:52:00.0" votes="0" watches="2" workflowId="51278"> <description><! CDATA Steps to Reproduce: 1. Run load test: {code:java} for s in `seq 1 2000` ; do python3 Perf_Add_nyms.py -n 500 -s 5 &>load_out.txt ; done{code} Actual Results: {code:java} _indy_loop_callback: Function returned b'{"result":{"reqId":1521336430121822811,"txnTime":1521336430,"signature":"59JDxoGumAgzrBLmqcP5LJ38fQd4kA7nJ65QM4C2nRcAKNLb2pJ9JjR9oNeCe7fyuNJLZK3igvrfjJKt23Kdgc7h","type":"1","auditPath": "9D3b534tAiuWnrkfKagbKdjFXnvyTUhpw7TDjooi9vbX","7XPRYpFhAaRpPMSsiCYXpektfaVgxfXPzpa4FSgjnk12","CNtm6AHLqN8YENHH7ej1uWkYyAAD8vDXs2zXJACQSRuU","Dz5DLFmgasKwezfbWhAh2PtSUjksh7mffMnpew8BBxkw","73htxaNp7Y3Hoq4beXhhxmUqjLx2pd4UqpFN8BLDKr7v","4fkd5QTvzssyi4gtDWPptS3j8ReaKyQ6bt5hHMUXPdDG","EuGtrxBLTCwUVe31t3YU8yi2HZ4WVtZNvKHMjZdjPyAo" ,"dest":"HaX2pHifFw59CH92e65EC3","seqNo":37960,"rootHash":"3vretHAe8VT8D5uioCeF2WL6VmSNL8YnwCikHPY3sQaJ","signatures":null,"identifier":"Th7MpTaRZVRYnPiabds81Y"},"op":"REPLY"}' _indy_loop_callback: Function returned (b'2WuCpFipjxzmzUWdseGkJu', b'puhGdn5UYcr7bYZziPGjf9JF5xdGXEXAdF1yjy6F8zf') _indy_loop_callback: Function returned b'{"reqId":1521336431546944698,"identifier":"Th7MpTaRZVRYnPiabds81Y","operation":{"dest":"2WuCpFipjxzmzUWdseGkJu","type":"1"},"protocolVersion":1}' _indy_loop_callback: Function returned b'{"result":{"identifier":"Th7MpTaRZVRYnPiabds81Y","type":"1","txnTime":1521336431,"rootHash":"DCB4maWDXKwsenWiUo88BvG1UckihMy9rwzxamGPoBht","signatures":null,"reqId":1521336431546944698,"auditPath": "BU4TYhQvbSSQuURiCNXvZQWFy9nRWCMypoLWS9NQcWMQ","Dz5DLFmgasKwezfbWhAh2PtSUjksh7mffMnpew8BBxkw","73htxaNp7Y3Hoq4beXhhxmUqjLx2pd4UqpFN8BLDKr7v","4fkd5QTvzssyi4gtDWPptS3j8ReaKyQ6bt5hHMUXPdDG","EuGtrxBLTCwUVe31t3YU8yi2HZ4WVtZNvKHMjZdjPyAo" ,"dest":"2WuCpFipjxzmzUWdseGkJu","seqNo":37961,"signature":"WLqhzES9g4gCFuU79BrwEbVBkuhSXdYQz8UwBNqarMYPZCrgfUrUsyeKab2TnZXPkVS1S6UScjg6XHJJR7e7V3h"},"op":"REPLY"}' _indy_loop_callback: Function returned (b'XGffeuUAxcJsZcH6Z379m', b'HVu5tcRQD7LZEnKFxhdQaY8F1UozexrzT9CdddV27td') _indy_loop_callback: Function returned b'{"reqId":1521336433005465858,"identifier":"Th7MpTaRZVRYnPiabds81Y","operation":{"dest":"XGffeuUAxcJsZcH6Z379m","type":"1"},"protocolVersion":1}' _indy_loop_callback: Function returned error 307 Exception in callback _indy_loop_callback(274, 307, b'') at /usr/local/lib/python3.5/dist-packages/indy/libindy.py:62 handle: <Handle _indy_loop_callback(274, 307, b'') at /usr/local/lib/python3.5/dist-packages/indy/libindy.py:62> Traceback (most recent call last): File "/usr/lib/python3.5/asyncio/events.py", line 125, in _run self._callback(*self._args) File "/usr/local/lib/python3.5/dist-packages/indy/libindy.py", line 70, in _indy_loop_callback future.set_exception(IndyError(ErrorCode(err))) File "/usr/lib/python3.5/enum.py", line 241, in __call__ return cls.__new__(cls, value) File "/usr/lib/python3.5/enum.py", line 476, in __new__ raise ValueError("%r is not a valid %s" % (value, cls.__name__)) ValueError: 307 is not a valid ErrorCode{code} Expected Results: Load test shouldÂ work.  Debug output of hanged load test with debug logs attached.  ></description> </Issue>
