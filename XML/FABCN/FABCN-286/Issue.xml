<Issue id="33614" key="FABCN-286" number="286" project="11207" reporter="dmk88" creator="dmk88" type="10000" summary="TypeError: Illegal buffer in stub.setEvent()" priority="3" resolution="10203" status="6" created="2018-09-10 11:09:47.0" updated="2019-11-30 21:15:06.0" resolutiondate="2018-10-21 08:11:39.0" votes="0" watches="3" workflowId="57104"> <description><! CDATA I use setEvent()  https://fabric-shim.github.io/fabric-shim.ChaincodeStub.html#setEvent__anchor  in my chaincode on node.js. And I have a problem.  For example:    {code:java} console.info('=========== Node.js Chaincode query with Set Event Start ==========='); try { stub.setEvent('TransferTestEvent', Buffer.from('testPayload')); } catch (e) { console.info('Catch Error: '); console.info(e); } console.info('Event add :'); console.info(stub.chaincodeEvent.getEventName()); console.info('Payload add :'); console.info(stub.chaincodeEvent.getPayload().toString('utf8')); console.info('=========== Node.js Chaincode query with Set Event End ===========');{code}    After that I can see event name and payload in logs:    {code:java} =========== Node.js Chaincode query with Set Event Start ===========  Event add :  TransferTest  Payload add : test  =========== Node.js Chaincode query with Set Event End ===========  (node:19) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 1): TypeError: Illegal buffer  (node:19)  DEP0018  DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.{code}    So I have error: TypeError: Illegal buffer.  setEvent(name, payload) is not async function. It`s only simple setter. So I can`t solve the problem of UnhandledPromiseRejectionWarning.  I think that problem is in encoding payload "TypeError: Illegal buffer" in fabric-shim.     ></description> </Issue>
