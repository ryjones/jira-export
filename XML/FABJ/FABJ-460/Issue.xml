<Issue id="41291" key="FABJ-460" number="460" project="10605" reporter="yeousunn" creator="yeousunn" type="10004" summary="Discovery returning anchor peer twice in peer list." priority="3" resolution="10001" status="6" created="2019-07-18 08:07:45.0" updated="2020-11-19 10:32:31.0" resolutiondate="2020-11-19 10:32:31.0" votes="0" watches="1" workflowId="54295"> <description><! CDATA When using discovery to find out the number of peer nodes, I am getting count of 5 peers instead of 4. On checking the list of peers returned, I can see that the anchor peer is returned twice. I am using fabric version 1.4.2 and first-network sample. Following is the configuration: {code:java} channels: mychannel: orderers: - orderer.example.com  peers: peer0.org1.example.com: endorsingPeer: true chaincodeQuery: true ledgerQuery: true eventSource: true discover: true  .... ....  peers: peer0.org1.example.com: url: grpcs://192.168.14.245:7051 grpcOptions: ssl-target-name-override: peer0.org1.example.com grpc.http2.keepalive_time: 15 hostnameOverride: peer0.org1.example.com tlsCACerts: path: /home/hyperledger/fabric-samples/first-network/crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.crt  {code} Java code: {code:java} Collection<Peer> peers = mychannel.getPeers(); int noOfPeers = peers.size(); {code} Output: {noformat} Number of peers: 5 List:    Peer{ id: 11, name: peer0.org2.example.com:9051, channelName: mychannel, url: grpcs://peer0.org2.example.com:9051},  Peer{ id: 13, name: peer1.org2.example.com:10051, channelName: mychannel, url: grpcs://peer1.org2.example.com:10051},  Peer{ id: 6, name: peer0.org1.example.com, channelName: mychannel, url: grpcs://192.168.14.245:7051},  Peer{ id: 10, name: peer0.org1.example.com:7051, channelName: mychannel, url: grpcs://peer0.org1.example.com:7051},  Peer{ id: 12, name: peer1.org1.example.com:8051, channelName: mychannel, url: grpcs://peer1.org1.example.com:8051}  {noformat} In the above result the Peer id: 6 and id: 10 are the same peer node.  By updating /etc/hosts file and updating the config I am currently able to get correct value. {code:java} 192.186.14.245 peer0.org1.example.com {code} {code:java} peers: peer0.org1.example.com: url: grpcs://peer0.org1.example.com:7051 grpcOptions: ssl-target-name-override: peer0.org1.example.com grpc.http2.keepalive_time: 15 hostnameOverride: peer0.org1.example.com tlsCACerts: path: /home/thgy/work/hyperledger/fabric-samples/first-network/crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/server.crt{code} Â   ></description> </Issue>
