<Issue id="46558" key="FABJ-547" number="547" project="10605" reporter="JIRAUSER21357" creator="JIRAUSER21357" type="10004" summary="Memory leak in OrdererClient" priority="3" status="10300" created="2021-02-12 10:44:49.0" updated="2021-02-24 14:09:10.0" votes="0" watches="2" workflowId="60502" archived="N"> <description><! CDATA When there is an i/o exception thrown, the ManagedChannelImpl associated with the OrdererClient remains in the heap (is not thread-safe).  Attaching the analyzed images from heap dump of the same.  Pasting the exception:  Jan 20 19:20:23 gtd-maersk-perf-plt-actionable-flows-deployment-5b84674bc5zltxs plt-actionable-flows  org.springframework.kafka.KafkaListenerEndpointContainer#4-0-C-1  ERROR i.g.i.ManagedChannelOrphanWrapper - *~*~*~ Channel ManagedChannelImpl\{logId=2164329, target=n1ba1e5-orderer5node1.gtd-preprod.us-south.containers.appdomain.cloud:7050} was not shutdown properly!!! ~*~*~*Jan 20 19:20:23 gtd-maersk-perf-plt-actionable-flows-deployment-5b84674bc5zltxs plt-actionable-flows  org.springframework.kafka.KafkaListenerEndpointContainer#4-0-C-1  ERROR i.g.i.ManagedChannelOrphanWrapper - *~*~*~ Channel ManagedChannelImpl\{logId=2164329, target=n1ba1e5-orderer5node1.gtd-preprod.us-south.containers.appdomain.cloud:7050} was not shutdown properly!!! ~*~*~*    Make sure to call shutdown()/shutdownNow() and wait until awaitTermination() returns true.java.lang.RuntimeException: ManagedChannel allocation site at io.grpc.internal.ManagedChannelOrphanWrapper$ManagedChannelReference.<init>(ManagedChannelOrphanWrapper.java:94) at io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:52) at io.grpc.internal.ManagedChannelOrphanWrapper.<init>(ManagedChannelOrphanWrapper.java:43) at io.grpc.internal.AbstractManagedChannelImplBuilder.build(AbstractManagedChannelImplBuilder.java:512) at org.hyperledger.fabric.sdk.OrdererClient.sendTransaction(OrdererClient.java:157) at org.hyperledger.fabric.sdk.Orderer.sendTransaction(Orderer.java:164) at sun.reflect.GeneratedMethodAccessor772.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at java.lang.reflect.Method.invoke(Unknown Source) at com.ibm.tradelens.blockchain.client.CustomChannel.sendTransaction(CustomChannel.java:509) at com.ibm.tradelens.blockchain.client.BlockchainClient.submitTransaction(BlockchainClient.java:497) at com.ibm.gtd.actionable.flows.service.impl.ActionableFlowChaincodeServiceImpl.submitTransaction(ActionableFlowChaincodeServiceImpl.java:275)     Not able to upload the heap dump due to file size limitation. Let us know where and how can we pass that to you.  ></description> </Issue>
