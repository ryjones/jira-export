<Issue id="19128" key="FABC-198" number="198" project="10607" reporter="smithbk" assignee="smithbk" creator="smithbk" type="10004" summary="Reopen connections closed by LDAP server due to inactivity" priority="3" resolution="10000" status="6" created="2017-07-10 21:16:43.0" updated="2018-07-18 22:03:50.0" resolutiondate="2017-07-25 17:35:54.0" votes="0" watches="2" workflowId="32378"> <description><! CDATA If the LDAP server is configured to close inactive connections, the fabric-ca-server can fail as follows when enrolling a user: {code} 2017/06/28 15:21:39  DEBUG  Failed to get user 'user1': LDAP search failure: LDAP Result Code 200 "": ldap: connection closed; search request: &{BaseDN: Scope:2 DerefAliases:0 SizeLimit:0 TimeLimit:0 TypesOnly:false Filter:(sAMAccountName=XBR_us_po) Attributes:   Controls:  } {code} Note the "ldap: connection closed" part of the error message above.  This happens because the fabric-ca-server caches a connection to the server in order to perform an LDAP search to map a user name to a DN during enrollment; however, if the server has closed the connection on its side, the fabric-ca-server which is acting as the LDAP client will fail.  The fix is to create a new connection when this error occurs.  There are two work-arounds: 1) Restarting the fabric-ca-server 2) Configuring the LDAP server to not close inactivity connections    ></description> </Issue>
