<Issue id="17145" key="FABC-194" number="194" project="10607" reporter="dbshah" assignee="skarim" creator="dbshah" type="10004" summary="getcacert call from fabric-ca-client fails with tls enabled" priority="1" resolution="10000" status="6" created="2017-05-25 15:32:42.0" updated="2018-07-18 22:03:49.0" resolutiondate="2017-05-31 17:29:35.0" votes="0" watches="3" workflowId="32374" security="10001"> <description><! CDATA This is seen in alpha2 as well as alpha3-ee71b0a. When making an enroll call with fabric-ca-client with tls enabled it goes through, but getcacert fails.     Failed getcacert request:  ```  FABRIC_CA_CLIENT_HOME=/client/ca1 fabric-ca-client getcacert -u https://fabric-ca-0a.net_blockchain.com:7054 --caname OrdererCA -d  2017/05/25 15:25:58  DEBUG  Entered runGetCACert  2017/05/25 15:25:58  DEBUG  Initializing BCCSP: &\{ProviderName:SW SwOpts:0xc420149230 Pkcs11Opts:<nil>}  2017/05/25 15:25:58  DEBUG  Initializing BCCSP with software options &\{SecLevel:256 HashFamily:SHA2 Ephemeral:false FileKeystore:0xc4201a1af0 DummyKeystore:<nil>}  2017/05/25 15:25:58  DEBUG  Sending request  POST https://fabric-ca-0a.net_blockchain.com:7054/cainfo  Authorization:   \{"caname":"OrdererCA"}  Error: POST failure  Post https://fabric-ca-0a.net_blockchain.com:7054/cainfo: x509: certificate signed by unknown authority ; not sending  POST https://fabric-ca-0a.net_blockchain.com:7054/cainfo  Authorization:   \{"caname":"OrdererCA"}  ```     enroll request:  ```  fabric-ca-client enroll -u https://orderer0a:orderer0apw@fabric-ca-0a.net_blockchain.com:7054 --caname OrdererCA -d  2017/05/25 15:31:19  DEBUG  Entered runEnroll  2017/05/25 15:31:19  INFO  User provided config file: /mnt/crypto/orderer/orderer-0a/fabric-ca-client-config.yaml  2017/05/25 15:31:19  INFO  Configuration file location: /mnt/crypto/orderer/orderer-0a/fabric-ca-client-config.yaml  2017/05/25 15:31:19  DEBUG  Enrolling &\{Name:orderer0a Secret:orderer0apw Profile: Label: CSR:0xc4200a7080 CAName:OrdererCA}  2017/05/25 15:31:19  DEBUG  Initializing BCCSP: &\{ProviderName:SW SwOpts:0xc4201d3740 Pkcs11Opts:<nil>}  2017/05/25 15:31:19  DEBUG  Initializing BCCSP with software options &\{SecLevel:256 HashFamily:SHA2 Ephemeral:false FileKeystore:0xc4201e8c80 DummyKeystore:<nil>}  2017/05/25 15:31:19  DEBUG  GenCSR &\{CN:adminOrderer Names: \{C:US ST:North Carolina L: O:Hyperledger OU:Fabric SerialNumber:}  Hosts: orderer-0a  KeyRequest:<nil> CA:<nil> SerialNumber:}  2017/05/25 15:31:19  INFO  generating key: &\{A:ecdsa S:256}  2017/05/25 15:31:19  DEBUG  generate key from request: algo=ecdsa, size=256  2017/05/25 15:31:19  INFO  encoded CSR  2017/05/25 15:31:19  DEBUG  Sending request  POST https://fabric-ca-0a.net_blockchain.com:7054/enroll  Authorization: Basic b3JkZXJlcjBhOm9yZGVyZXIwYXB3  \{"hosts": "orderer-0a" ,"certificate_request":"-----BEGIN CERTIFICATE REQUEST-----\nMIIBQzCB6wIBADBhMQswCQYDVQQGEwJVUzEXMBUGA1UECBMOTm9ydGggQ2Fyb2xp\nbmExFDASBgNVBAoTC0h5cGVybGVkZ2VyMQ8wDQYDVQQLEwZGYWJyaWMxEjAQBgNV\nBAMTCW9yZGVyZXIwYTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABP0XN1+Q8Fih\nHxvWdYTWOjYZniXnmXy47ZJMM5kyKYm6vZpvyvl/Jy/XR1VGLOqJD2dzDbfiLQng\nsynl91qR5t6gKDAmBgkqhkiG9w0BCQ4xGTAXMBUGA1UdEQQOMAyCCm9yZGVyZXIt\nMGEwCgYIKoZIzj0EAwIDRwAwRAIgOuao1PpUsFlgn9CEM+KlMqHZkqxFD5nP+jHo\n4qk6i7ACIDIu5N6Sq7ysKoEKDZD6u2eBFPL0pL2/uqkPs8w6P5w9\n-----END CERTIFICATE REQUEST-----\n","profile":"","crl_override":"","label":"","CAName":"OrdererCA"}  2017/05/25 15:31:19  INFO  TLS Enabled  2017/05/25 15:31:19  DEBUG  CA Files:  /certs/cacert.pem   2017/05/25 15:31:19  DEBUG  Client Cert File: /certs/orderer0a-cert.pem  2017/05/25 15:31:19  DEBUG  Client Key File: /certs/orderer0a-key.pem  2017/05/25 15:31:19  DEBUG  Check client TLS certificate for valid dates  2017/05/25 15:31:19  DEBUG  Received response  statusCode=200 (200 OK)  2017/05/25 15:31:19  DEBUG  Response body result: map Cert:LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNPakNDQWVHZ0F3SUJBZ0lVSG00RjJQUW1Pa1BHUkNka3dyOCtxRzdjRFBFd0NnWUlLb1pJemowRUF3SXcKWVRFTE1Ba0dBMVVFQmhNQ1ZWTXhGekFWQmdOVkJBZ1REazV2Y25Sb0lFTmhjbTlzYVc1aE1SUXdFZ1lEVlFRSwpFd3RJZVhCbGNteGxaR2RsY2pFUE1BMEdBMVVFQ3hNR1JtRmljbWxqTVJJd0VBWURWUVFERXdsUGNtUmxjbVZ5ClEwRXdIaGNOTVRjd05USTFNVFV5TmpBd1doY05NVGd3TkRJek1qTXlOakF3V2pCaE1Rc3dDUVlEVlFRR0V3SlYKVXpFWE1CVUdBMVVFQ0JNT1RtOXlkR2dnUTJGeWIyeHBibUV4RkRBU0JnTlZCQW9UQzBoNWNHVnliR1ZrWjJWeQpNUTh3RFFZRFZRUUxFd1pHWVdKeWFXTXhFakFRQmdOVkJBTVRDVzl5WkdWeVpYSXdZVEJaTUJNR0J5cUdTTTQ5CkFnRUdDQ3FHU000OUF3RUhBMElBQlAwWE4xK1E4RmloSHh2V2RZVFdPallabmlYbm1YeTQ3WkpNTTVreUtZbTYKdlpwdnl2bC9KeS9YUjFWR0xPcUpEMmR6RGJmaUxRbmdzeW5sOTFxUjV0NmpkekIxTUE0R0ExVWREd0VCL3dRRQpBd0lDQkRBTUJnTlZIUk1CQWY4RUFqQUFNQjBHQTFVZERnUVdCQlQ0TFlCTXZ3WHBuUkZKVTRDbGF2dVBrb3pPCjZ6QWZCZ05WSFNNRUdEQVdnQlFsb2UwVUhQbnFKV05jT1Q1cjEwalFFWmVXR0RBVkJnTlZIUkVFRGpBTWdncHYKY21SbGNtVnlMVEJoTUFvR0NDcUdTTTQ5QkFNQ0EwY0FNRVFDSUhia3ppeHFKNFhTbVpBbElkeHNwT2pDSnRiMwpmOEVlUHVvem9wRGt6N24xQWlCY2hvMmEwYjhkM2xBT3ZnUFR2K0ozQWVDNjlWOS9pa05BbXQxZWNtMXZQUT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K ServerInfo:map CAName:OrdererCA CAChain:LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNCVENDQWF5Z0F3SUJBZ0lVZW9DVTh6UytCcTZtRldvU3BNN3ozRDk0SG1Bd0NnWUlLb1pJemowRUF3SXcKWVRFTE1Ba0dBMVVFQmhNQ1ZWTXhGekFWQmdOVkJBZ1REazV2Y25Sb0lFTmhjbTlzYVc1aE1SUXdFZ1lEVlFRSwpFd3RJZVhCbGNteGxaR2RsY2pFUE1BMEdBMVVFQ3hNR1JtRmljbWxqTVJJd0VBWURWUVFERXdsUGNtUmxjbVZ5ClEwRXdIaGNOTVRjd05USTFNVFV5TmpBd1doY05Nakl3TlRJME1UVXlOakF3V2pCaE1Rc3dDUVlEVlFRR0V3SlYKVXpFWE1CVUdBMVVFQ0JNT1RtOXlkR2dnUTJGeWIyeHBibUV4RkRBU0JnTlZCQW9UQzBoNWNHVnliR1ZrWjJWeQpNUTh3RFFZRFZRUUxFd1pHWVdKeWFXTXhFakFRQmdOVkJBTVRDVTl5WkdWeVpYSkRRVEJaTUJNR0J5cUdTTTQ5CkFnRUdDQ3FHU000OUF3RUhBMElBQkQ3a0QrdytmRTRhQXBYSmJXZTRtTVNlY2xma3h5cmFNbEpSd3oxNmpsaEcKNnM2UEQ1eTA2eGxiQ3d6WFRsb0tKTmRYMmp2SERrZTB6bm9KZnhZVWVEQ2pRakJBTUE0R0ExVWREd0VCL3dRRQpBd0lCQmpBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUIwR0ExVWREZ1FXQkJRbG9lMFVIUG5xSldOY09UNXIxMGpRCkVaZVdHREFLQmdncWhrak9QUVFEQWdOSEFEQkVBaUFDU3d1UjhiUEpGejVybkZpN0ZFVXQ1c2kyYWt1bU9MWW0KQm55QWtzekNud0lnTGZhaXBEblQrTHF6NEdzazdKZDM1N0hOUHlyS0VCNmN3L1dpamMycXJHQT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=    2017/05/25 15:31:19  DEBUG  newEnrollmentResponse orderer0a  2017/05/25 15:31:19  INFO  Stored client certificate at /mnt/crypto/orderer/orderer-0a/msp/signcerts/cert.pem  2017/05/25 15:31:19  INFO  Stored CA certificate chain at /mnt/crypto/orderer/orderer-0a/msp/cacerts/fabric-ca-0a-net_blockchain-com-7054-OrdererCA.pem  ```           ></description> </Issue>
