<Issue id="34790" key="FABC-742" number="742" project="10607" reporter="christopherferris" assignee="ashutosh_kumar" creator="christopherferris" type="10004" summary="when SDK uses TLS and CA does not, no error, downgrades silently" priority="2" status="10701" created="2018-10-19 11:33:22.0" updated="2019-08-25 22:50:59.0" votes="0" watches="5" workflowId="46202" security="10000"> <description><! CDATA From email to security list:  Hello,   On fabric-ca 1.2.0 and fabric-sdk-go d489eba94c868f736015935e88da20faf9aa80d4 (July 2018) we observed that if the SDK client is configured with TLS CA certificates (see example configuration  1 ) and the fabric-ca does not have TLS enabled (FABRIC_CA_SERVER_TLS_ENABLED=false), then the client will downgrade to http and proceed without errors. We expected the client to immediately abort, and not downgrade. We believe downgrading could allow a MITM attack where the attacker forces a client to downgrade to http and the client subsequently sends sensitive data over http (e.g., enrollId, enrollSecret).     1  Example portion of go-sdk client configuration:     ca.org2.example.com|https://urldefense.proofpoint.com/v2/url?u=http-3A__ca.org2.example.com&d=DwMFaQ&c=jf_iaSHvJObTbx-siA1ZOg&r=33Ksn4bRkfEi53BOWQorz0ej6pr527Q2SbGcvZWUBSE&m=R63ZQ87zt6VyuYxGt-K_rrP0qH17-zJtqTIRaqrEqxw&s=S8ZBweYBEY_lCdeHV7omnQ8TwfjmA-nqHroHWYCBfkE&e= :    url:  https://ca.org2.example.com:7054|https://urldefense.proofpoint.com/v2/url?u=https-3A__ca.org2.example.com-3A7054&d=DwMFaQ&c=jf_iaSHvJObTbx-siA1ZOg&r=33Ksn4bRkfEi53BOWQorz0ej6pr527Q2SbGcvZWUBSE&m=R63ZQ87zt6VyuYxGt-K_rrP0qH17-zJtqTIRaqrEqxw&s=TJR4xaRtKpDGJVAM5k2HGE6SFtSXg-pwkXVkSEdeOIA&e=     tlsCACerts:     path: "/tmp/fabric/crypto-config/peerOrganizations/ org2.example.com/ca/ca.org2.example.com-cert.pem|https://urldefense.proofpoint.com/v2/url?u=http-3A__org2.example.com_ca_ca.org2.example.com-2Dcert.pem&d=DwMFaQ&c=jf_iaSHvJObTbx-siA1ZOg&r=33Ksn4bRkfEi53BOWQorz0ej6pr527Q2SbGcvZWUBSE&m=R63ZQ87zt6VyuYxGt-K_rrP0qH17-zJtqTIRaqrEqxw&s=sUIETCNk-5CDts8hl8mgd_loC6lZTyS8V7sIb_srOZI&e= "     client:       key:         path: "/tmp/fabric/crypto-config/peerOrganizations/ org2.example.com/users/Admin@org2.example.com/tls/client.key|https://urldefense.proofpoint.com/v2/url?u=http-3A__org2.example.com_users_Admin-40org2.example.com_tls_client.key&d=DwMFaQ&c=jf_iaSHvJObTbx-siA1ZOg&r=33Ksn4bRkfEi53BOWQorz0ej6pr527Q2SbGcvZWUBSE&m=R63ZQ87zt6VyuYxGt-K_rrP0qH17-zJtqTIRaqrEqxw&s=aAYFnAvVRcyjAjLB3UMhpRfe5R-GWOgsPpdPTzWfTjU&e= "       cert:         path: "/tmp/fabric/crypto-config/peerOrganizations/ org2.example.com/users/Admin@org2.example.com/tls/client.crt|https://urldefense.proofpoint.com/v2/url?u=http-3A__org2.example.com_users_Admin-40org2.example.com_tls_client.crt&d=DwMFaQ&c=jf_iaSHvJObTbx-siA1ZOg&r=33Ksn4bRkfEi53BOWQorz0ej6pr527Q2SbGcvZWUBSE&m=R63ZQ87zt6VyuYxGt-K_rrP0qH17-zJtqTIRaqrEqxw&s=jV9dWapK4NpVt4G3Vb36KLbqY-94v4agImuf6v0NmEI&e= "    registrar:      enrollId: admin      enrollSecret: adminpw    caName:  ca.org2.example.com|https://urldefense.proofpoint.com/v2/url?u=http-3A__ca.org2.example.com&d=DwMFaQ&c=jf_iaSHvJObTbx-siA1ZOg&r=33Ksn4bRkfEi53BOWQorz0ej6pr527Q2SbGcvZWUBSE&m=R63ZQ87zt6VyuYxGt-K_rrP0qH17-zJtqTIRaqrEqxw&s=S8ZBweYBEY_lCdeHV7omnQ8TwfjmA-nqHroHWYCBfkE&e=     ></description> </Issue>
