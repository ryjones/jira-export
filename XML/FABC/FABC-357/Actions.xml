<Action id="23741" issue="16510" author="dhwang" type="comment" created="2017-05-11 13:37:59.0" updateauthor="dhwang" updated="2017-05-11 13:37:59.0"> <body><! CDATA I think TLS configuration for MariaDB is somehow messed up by the CA configuration for intermediate CA.    My db configuration is the following:    {code:java} db: type: mysql datasource: 'root:password@tcp(mariadb:3306)/fabricca?parseTime=true&tls=skip-verify' tls: enabled: true certfiles: /etc/hyperledger/fabric-ca-server-tls/server-cert.pem certfileslist:  /etc/hyperledger/fabric-ca-server-tls/server-cert.pem  ca_certfiles: /etc/hyperledger/fabric-ca-server-tls/ca-cert.pem client: certfile: /etc/hyperledger/fabric-ca-server-tls/client-cert.pem keyfile: /etc/hyperledger/fabric-ca-server-tls/client-key.pem {code} ---------------------------------------------------------------------------------------------  Test #1:  Without  either "client:"   or "ca:" specified in my yaml file: I start int ca with: fabric-ca-server start -c /etc/hyperledger/fabric-ca/int-ca.yaml -b admin:password --url  https://admin:password@root_ca_ip:7054|https://admin:password@root_ca_ip:7054/   I got the following error:  2017/05/11 13:30:23  INFO  TLS Enabled 2017/05/11 13:30:23  DEBUG  CA Files: 2017/05/11 13:30:23  DEBUG  Client Cert File: 2017/05/11 13:30:23  DEBUG  Client Key File: 2017/05/11 13:30:23  DEBUG  Client Cert or Key not provided, if server requires mutual TLS, the connection will fail: open : no such file or directory Error: Failed to initialize CA: Failed to get client TLS config: No CA certificate files provided  ----------------------------------------------------------------------------------------------------  Test # 2:  Adding just "ca:" and start int ca with the same command as #1 {code:java} ca: certfile: certificate.pem keyfile: key.pem {code} I got the following error:  Notice the database name and the user in the url is incorrect in the DEBUG message.  2017/05/11 13:31:25  DEBUG  Using MySQL database, connecting to database... 2017/05/11 13:31:25  DEBUG  Database Name: etc 2017/05/11 13:31:25  DEBUG  CA Files: /etc/hyperledger/fabric-ca-server-tls/server-cert.pem 2017/05/11 13:31:25  DEBUG  Client Cert File: /etc/hyperledger/fabric-ca-server-tls/client-cert.pem 2017/05/11 13:31:25  DEBUG  Client Key File: /etc/hyperledger/fabric-ca-server-tls/client-key.pem 2017/05/11 13:31:25  DEBUG  Connection String: ///-ca/:mypass@tcp(mariadb:3306)/?parseTime=true&tls=skip-verify 2017/05/11 13:31:25  ERROR  Failed to connect to MySQL database  error: Error 1045: Access denied for user '///-ca/'@'172.18.0.3' (using password: YES)  Error: Failed to query 'INFORMATION_SCHEMA.SCHEMATA table: Error 1045: Access denied for user '///-ca/'@'172.18.0.3' (using password: YES)  ></body> </Action>
<Action id="24545" issue="16510" author="christopherferris" type="comment" body="https://gerrit.hyperledger.org/r/#/c/9859/" created="2017-05-27 06:05:25.0" updateauthor="christopherferris" updated="2017-05-27 06:05:25.0"/>
