<Issue id="16503" key="FABC-525" number="525" project="10607" reporter="smithbk" creator="smithbk" type="10001" summary="Improve admin role usability" priority="3" resolution="10200" status="6" created="2017-05-09 16:04:39.0" updated="2019-07-27 14:59:44.0" resolutiondate="2019-05-08 11:53:06.0" votes="7" watches="20" workflowId="32707"> <description><! CDATA Only users with admin role privileges can install and instantiate chain code.  MSP determines if someone has the admin role by doing a strict byte comparison with certificates found in the admincerts directory.  For chaincode install, this is the local MSP and for chaincode instantiate, it is the channel MSP in the config block.   This makes it difficult to write an application which both enrolls and installs and/or instantiates chaincode.  For chaincode installation, it means that after enrollment and reenrollment, the user's certificate must be exported from the SDK and copied (manually?) to the msp/admincerts directory on the peer's file system.  This is not very usable.  The following is a proposal to make this more usable.  1) Enhance the SatisfiesPrincipal function of msp to do more than a byte comparison.  Logically speaking, change the comparison from "if the caller's cert exactly matches any of these admincerts" to "if the caller's cert exactly matches any of these admincerts OR (if the caller's cert is issued by any of root/intermediate certs AND the cert has the 'hf.admin' attribute with a value of 'true').  2) Enhance fabric-ca to put the 'hf.admin' attribute in any issued ecerts for user's with the 'hf.admin' attribute.  A lot of this code already exists and would be pretty easy.  From a configuration perspective, we could of course provide a configurable list of attributes which are put into ecerts, but the default would for now just be a list of one attribute: "hf.admin". NOTE: This has a dependency on FAB-5556 because we need to make sure that admin role evaluates the same across the channel.  This would not require any changes to SDKs.  The user experience would then be to register user's with the "hf.admin" attribute, enroll as normal, and no manual distribution steps would be required.  ></description> </Issue>
