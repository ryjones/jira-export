<Issue id="17705" key="FABC-280" number="280" project="10607" reporter="smithbk" assignee="smithbk" creator="smithbk" type="10004" summary="SECURITY: fabric-ca does not verify x509 certificates against the issuing CA" priority="1" resolution="10000" status="6" created="2017-06-09 18:11:52.0" updated="2018-07-18 22:04:08.0" duedate="2017-06-14 00:00:00.0" resolutiondate="2017-06-10 20:58:43.0" votes="0" watches="1" workflowId="32460" security="10001"> <description><! CDATA The token-based authentication mechanism in fabric-ca-server does not verify the certificate was issued by the CA.  The token-based authentication attack is subject to a privileges escalation attack. In a nutshell, the attack allows anyone to fake the identity of another user and gain her access rights. In more details, let’s say Alice is an high-privileged user of fabric-ca and Bob gets Alice’s ECert in some way (notice that ECerts are supposed to be public, of course). Then Bob, can generate a self-signed certificate copying Alice’s certificate SN and AKI. (This is already enough to be authenticated by the system). Bob can copy additional information (i.e. the CommonName) as needed. As can be seen in Figure 2.1, the server says that the fake certificate for CommonName ’test.example.com’ has been authenticated. Changing the common name to that of Alice, would give to Bob the ability to perform any operation that Alice is allowed to. The reason why this happens is that fabric-ca does a weak check on the certificate. It only checks that the certificate is not revoked but it does not check that the certificate has been signed by the proper authority.  ></description> </Issue>
