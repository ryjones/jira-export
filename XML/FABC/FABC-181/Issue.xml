<Issue id="26670" key="FABC-181" number="181" project="10607" reporter="rennman" assignee="skarim" creator="rennman" type="10004" summary="fabric-ca ldap attributes that are missing cause error" priority="3" resolution="10000" status="6" created="2018-01-08 21:14:16.0" updated="2018-07-18 22:03:47.0" resolutiondate="2018-01-19 20:46:52.0" votes="0" watches="2" workflowId="32361"> <description><! CDATA Even though the comment to (u *user) GetAttribute() indicates "GetAttribute returns the value of an attribute, or "" if not found" if actually returns an error if not found.  This is causing the attribute LDAP retrieval to fail in cases where a particular user does not have an attribute defined. However, if the function is changed to return and empty string array, and not an error, things start working again:   {code:java} @@ -403,7 +403,8 @@ func (u *user) GetAttribute(name string) (*api.Attribute, error) {                 log.Debugf("Getting attribute '%s' from LDAP user '%s'", name, u.name)                 vals := u.entry.GetAttributeValues(name)                 if len(vals) == 0 { -                       return nil, fmt.Errorf("No value for attribute '%s'", name) +                       //return nil, fmt.Errorf("No value for attribute '%s'", name) +                       vals = make(  string,0)                 }                 return &api.Attribute{Name: name, Value: strings.Join(vals, ",")}, nil         } @@ -553,7 +554,8 @@ func (ue *userExpr) attrFunction(args ...interface{}) (interface{}, error) {         vals := ue.user.entry.GetAttributeValues(attrName)         log.Debugf("Values for LDAP attribute '%s' are '%+v'", attrName, vals)         if len(vals) == 0 { -               return nil, fmt.Errorf("No value for attribute '%s'", attrName) +               //return nil, fmt.Errorf("No value for attribute '%s'", attrName) +               vals = make(  string,0)         }         return strings.Join(vals, sep), nil  }  {code}  ></description> </Issue>
