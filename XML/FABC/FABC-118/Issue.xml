<Issue id="17832" key="FABC-118" number="118" project="10607" reporter="rennman" assignee="rennman" creator="rennman" type="10002" summary=" SECURITY  fabric-ca-server does not correctly instantiate intermediate CA CSR" priority="1" resolution="10000" status="6" created="2017-06-13 15:20:04.0" updated="2018-07-18 22:03:34.0" resolutiondate="2017-06-22 18:30:07.0" votes="0" watches="3" workflowId="32298" security="10001"> <description><! CDATA When acting as an intermediate CA, fabric ca server is allocating an empty CSR and essentially setting it to not nil if it is nil. Then the later check in clientconfig.go which checks for nil; if it is nil, then the assignment to the client config CSR never happens. So an empty CSR gets passed around rather than the correct CSR that comes from client config. Consequently, the root server does not recognize this as an intermediate ca request. This has repercussions for later checks in the code (e.g. is the hf.IntermediateCA flag set) Fix is to delete these three lines in lib/ca.go: {code:java} if clientCfg.Enrollment.CSR == nil { clientCfg.Enrollment.CSR = &api.CSRInfo{} } {code}  ></description> </Issue>
