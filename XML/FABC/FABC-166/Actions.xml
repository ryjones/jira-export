<Action id="28350" issue="19242" author="lehors" type="comment" created="2017-07-13 20:00:06.0" updateauthor="lehors" updated="2017-07-13 20:00:06.0"> <body><! CDATA Digging into that one I found that the problem has to do with the test itself. The call to os.RemoveAll(rootDir) fails with: remove rootDir/fabric-ca-server.db: text file busy  Then because the database isn't cleaned up properly the test picks up a dirty db which leads to a failure.  When run alone the test passes all right.  Then the code assumes enrollment will succeed and proceed to dereferencing id without any precaution. Unfortunately in this case it is nil, which leads to the segmentation violation.  I'm not completely sure why os.RemoveAll fails. It might be a timing issue. This needs to be investigated further.  ></body> </Action>
<Action id="28363" issue="19242" author="lehors" type="comment" body="Actually, upon further investigation I have found that the problem comes from trying to delete the db file without ever closing the db. As a matter of fact I don&apos;t see any code about closing the CA db. A quick test adding some code to close the db makes the test run successfully. I will put a CR together." created="2017-07-13 22:53:25.0" updateauthor="lehors" updated="2017-07-13 22:53:25.0"/>
