<Issue id="26939" key="FABC-459" number="459" project="10607" reporter="smithbk" assignee="skarim" creator="smithbk" type="10002" summary="Add ca.GetCertificate" priority="3" resolution="10000" status="6" created="2018-01-18 17:32:45.0" updated="2018-10-19 12:20:56.0" resolutiondate="2018-10-19 12:20:40.0" votes="0" watches="2" workflowId="32641"> <description><! CDATA The following We should add a ca.GetCertificate(serial, aki) method which does the following except that it only returns a single certificate and if there are multiple, will return an error instead.  This code and elsewhere should be replaced with the call to the new ca.GetCertificate function.  {code} certs, err := ca.CertDBAccessor().GetCertificate(serial, aki) if err != nil { return "", newHTTPErr(500, ErrCertNotFound, "Failed searching certificates: %s", err) } if len(certs) == 0 { return "", newAuthErr(ErrCertNotFound, "Certificate not found with AKI '%s' and serial '%s'", aki, serial) } for _, certificate := range certs { if certificate.Status == "revoked" { return "", newAuthErr(ErrCertRevoked, "The certificate in the authorization header is a revoked certificate") } } {code}  ></description> </Issue>
