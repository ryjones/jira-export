<Issue id="25758" key="FABC-404" number="404" project="10607" reporter="rennman" assignee="skarim" creator="rennman" type="10004" summary="fabric-ca a user with hf.Registrar.Attributes &apos;*&apos; can grant too much authority" priority="3" resolution="10000" status="6" created="2017-12-14 21:08:28.0" updated="2018-07-18 22:04:34.0" resolutiondate="2018-01-20 10:08:21.0" votes="0" watches="4" workflowId="32584"> <description><! CDATA A user with 'hf.Registrar.Attributes' set to '*' (the default) is allowed to raise his own level of access and/or delegate greater access than he himself has.  An example: A user with only the following definition (restricted admin): {code:java} { "type": "user", "affiliation": ".", "attrs":   {"name": "hf.Registrar.Roles", "value": "user"}, {"name": "hf.Registrar.Attributes", "value": "*"}   } {code}  Presumably, this admin can only register type 'user' and nothing more, especially given the fact that in most cases, we specifically check to ensure that such an admin may not delegate anything other than type 'user'  However, with hf.Registrar.Attributes '*', he can register a user with much more authority, e.g.  {code:java} { "type": "user", "affiliation": ".", "max_enrollments": -1, "attrs":   {"name": "hf.Registrar.Roles", "value": "superUser,client,user,peer,validator,auditor,ca,apple,orange"}, {"name": "hf.Registrar.DelegateRoles", "value": "superUser,client,user,peer,validator,auditor,ca,apple,orange"}, {"name": "hf.Revoker", "value": "true"}, {"name": "hf.IntermediateCA", "value": "true"}, {"name": "hf.GenCRL", "value": "true"}, {"name": "hf.Registrar.Attributes", "value": "*"}   } {code}  This is likely not the intention, and since it is the default, also insecure.  ></description> </Issue>
