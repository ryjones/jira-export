<Issue id="14324" key="FABC-248" number="248" project="10607" reporter="rennman" assignee="skarim" creator="rennman" type="10004" summary="Need more robust certificate validation" priority="3" resolution="10000" status="6" created="2017-01-24 16:30:37.0" updated="2018-07-18 22:04:01.0" resolutiondate="2017-05-16 19:23:24.0" votes="0" watches="1" workflowId="32428"> <description><! CDATA At fabric-ca startup, when the server is passed a cert and key, the following tests fail -- certificate checks need to be beefed up.  1) Server should not accept expired CA certificate - past end date - future start date  Currently, this is issued in both of the above cases: 2017/01/18 17:21:44  ERROR  Certificate expired 2017/01/18 17:21:44  WARNING  endpoint 'tcert' is disabled: Failed to initialize TCert handler: Certificate  expired 2017/01/18 17:25:22  INFO  127.0.0.1:32822 - "POST /api/v1/cfssl/enroll" 200  but we still use the cert for enrollment 2017/01/18 17:25:22  INFO  enrollment information was successfully stored in /root/cop/key.pem and  /root/cop/cert.pem  2) Server should not accept CA certificate with incorrect usage (must include at least 'Certificate Sign') 3) Server should not accept CA certificate with basicConstraint CA:false 4) Server should not accept CA RSA cert/key pair of < 2048 bits (this is consistent with the cfssl restriction) 5) Server should not accept CA certificate with non-matching private key 6) Server should gracefully handle the case of an unsupported key type (e.g. DSA)    ></description> </Issue>
