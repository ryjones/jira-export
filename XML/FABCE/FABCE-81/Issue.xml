<Issue id="36167" key="FABCE-81" number="81" project="11210" reporter="swetharepakula" creator="swetharepakula" type="10000" summary="Fix logging in fab3 main" priority="3" resolution="10000" status="6" created="2018-12-14 16:03:57.0" updated="2019-11-30 21:16:49.0" resolutiondate="2019-01-07 18:25:34.0" votes="0" watches="1" workflowId="57206"> <description><! CDATA The change in logging in fab3 main causes fab3 to panic when missing required environment variables and no longer prints the usage or information about what caused the panic.     The error comes because logger is not initialized:  https://github.com/hyperledger/fabric-chaincode-evm/blob/master/fabproxy/cmd/main.go#L91   To fix the panic we need to set the variable declared at the top of the file:  https://github.com/hyperledger/fabric-chaincode-evm/blob/master/fabproxy/cmd/main.go#L34-L38.   Line 38 should read `logger = rawLogger.Name("fab3").Sugar()` instead of `logger := logger.rawLogger.Name("fab3').Sugar()`  However the output of the error comes out as: ``` {"level":"fatal","ts":1544841337.4598348,"logger":"fab3","caller":"cmd/main.go:91","msg":"Fab Proxy requires the environment variable FABPROXY_CONFIG to be set\n\nFabProxy uses environment variables to be able to start communicating with a Fabric network\n\tRequired Environment Variables:\n\t FABPROXY_CONFIG - Path to a compatible Fabric SDK Go config file\n\t FABPROXY_USER - User identity being used for the proxy (Matches the users names in the crypto-config directory specified in the config)\n\t FABPROXY_ORG - Organization of the specified user\n\t FABPROXY_CHANNEL - Channel to be used for the transactions\n\t FABPROXY_CCID - ID of the EVM Chaincode deployed in your fabric network\n\n\tOther Environment Variables:\n\t PORT - Port the FabProxy will be running on. Default is 5000\n\t\n\n","stacktrace":"main.grabEnvVar\n\t/Users/Repakula/go/src/github.com/hyperledger/fabric-chaincode-evm/fabproxy/cmd/main.go:91\nmain.main\n\t/Users/Repakula/go/src/github.com/hyperledger/fabric-chaincode-evm/fabproxy/cmd/main.go:40\nruntime.main\n\t/usr/local/go/src/runtime/proc.go:198"} exit status 1 ```  which is not as easy to parse or understand as the previous output from missing environment variables: ``` Fab Proxy requires the environment variable FABPROXY_CONFIG to be setFab Proxy requires the environment variable FABPROXY_CONFIG to be set FabProxy uses environment variables to be able to start communicating with a Fabric network Required Environment Variables:   FABPROXY_CONFIG - Path to a compatible Fabric SDK Go config file   FABPROXY_USER - User identity being used for the proxy (Matches the users names in the crypto-config directory specified in the config)   FABPROXY_ORG - Organization of the specified user   FABPROXY_CHANNEL - Channel to be used for the transactions   FABPROXY_CCID - ID of the EVM Chaincode deployed in your fabric network Other Environment Variables:   PORT - Port the FabProxy will be running on. Default is 5000  exit status 1 ``` We should not use logger.Fatal in getEnvVar and instead print directly.  ></description> </Issue>
