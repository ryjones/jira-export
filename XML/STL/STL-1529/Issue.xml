<Issue id="39509" key="STL-1529" number="1529" project="10001" reporter="davidaedwards" assignee="jjason" creator="davidaedwards" type="10004" summary="Blocks stop publishing after a day" priority="2" status="10100" created="2019-04-25 12:23:26.0" updated="2019-07-22 14:37:24.0" votes="1" watches="3" workflowId="52389"> <environment><! CDATA Config file attached.  OS: Ubuntu 18.04.2 LTS  CPU: Single core - Intel(R) Xeon(R) Gold 5120 CPU @ 2.20GHz  MemTotal: 469008 kB MemFree: 8788 kB MemAvailable: 103316 kB  Disk: 48% used  ></environment> <description><! CDATA After a little over 24 hours, my network stops processing blocks.  I have a network of two servers. Each runs a docker-compose config containing validator, poet, etc.  I am using these images (two are our own, including a Transaction Processor): {code:none} settings-tp: image: hyperledger/sawtooth-settings-tp:1.1.5 identity-tp: image: hyperledger/sawtooth-identity-tp:1.1.5 influxdb: image: influxdb:1.5 grafana: image: grafana/grafana:6.1.0 projectname-endpoint: image: projectdomain/sawtooth-projectname-endpoint:1.0.0-alpha1 projectname-tp: image: projectdomain/sawtooth-projectname-tp:1.0.0-alpha1 validator: image: hyperledger/sawtooth-validator:1.1.5 rest-api: image: hyperledger/sawtooth-rest-api:1.1.5 shell: image: hyperledger/sawtooth-all:1.1 poet-engine: image: hyperledger/sawtooth-poet-engine:1.1 poet-validator-registry-tp: image: hyperledger/sawtooth-poet-validator-registry-tp:1.1 {code} I am running a script that is generating transactions and batches to update random user entries.  Our set up contains one "main" node, which is allowed to write and one "client" node that is only allowed to read.  The log below is from the main node, each `Command: user -  update -  B=29` is logged at the top of our Transaction Processor handle function. At the very bottom you can see the POST logs. Those are when my script calls to create new batches to update the users. However, as you can see, those updates aren't being sent to the transaction processor (because it would result in a "Command" in the log.   {code:none} sawtooth-poet-engine |  2019-04-24 19:32:27.953 INFO poet_fork_resolver  Choose new fork 66063fd2 over current fork 165298f4: New fork aggregate local mean (8 2524.534386) greater than current fork aggregate local mean (82518.880482) sawtooth-poet-engine |  2019-04-24 19:32:28.022 INFO engine  Committing 66063fd2f50441c5f97c91fa9b69900f5d78ed60fced2b54d8b7575e068b9bfd68a415cf65a8e8c79a31fd fbac26218a7097bf7ac34f24174316ba77c23bcbda sawtooth-projectname-endpoint |  OkHttp http://rest-api:8008/...  INFO projectdomain.projectname.Endpoint - CLIENT Receiving: {"state_changes":  {"value": "CAYYw6zWhqUtIgJJVChNMB04YUArSCxQJ1hEYE4=", "a ddress": "5ee4b4b143613c9ad55147a7144f6067327c3b82ea70e7c5426add9ceea4d07dc29022", "type": "SET"}, {"value": "CAUYw6zWhqUtIgJJVCg5MDg4W0AMSApQXVhWYBk=", "address": "5ee4b4b1436106df05371981a237d0ed11472fa e7c94c9ac0eff1d05413516710d17b1", "type": "SET"}, {"value": "CAIYw6zWhqUtIgJBVChLMCI4XkAhSBtQDFgzYCs=", "address": "5ee4b4b1436140b244112641dd78dd4f93b6c9190dd46e0099194d5a44257b7efad6ef", "type": "SET"}, {"value": "CAEYw6zWhqUtIgJERSgtMCc4F0AKSD1QDFg5YEw=", "address": "5ee4b4b143614dff4ea340f0a823f15d3f4f01ab62eae0e5da579ccb851f8db9dfe84c", "type": "SET"} , "previous_block_id": "165298f40cf983b9ee7b02fcb 1fadedb80e84365c1d2cc9b43509751c8e0f475341e776d1046418bdfe9a6c93c767fd26eec7a37b3a95eda705f9ce828888811", "block_id": "66063fd2f50441c5f97c91fa9b69900f5d78ed60fced2b54d8b7575e068b9bfd68a415cf65a8e8c79a31f dfbac26218a7097bf7ac34f24174316ba77c23bcbda", "block_num": "12682"} sawtooth-poet-engine |  2019-04-24 19:32:28.867 INFO engine  Chain head updated to 66063fd2f50441c5f97c91fa9b69900f5d78ed60fced2b54d8b7575e068b9bfd68a415cf65a8e8c79a31fdfbac26218a7097bf7ac34f24174316ba77c23bcbda, abandoning block in progress sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-rest-api-default |  2019-04-24 19:32:30.483 INFO helpers  POST /batches HTTP/1.1: 202 status, 362 size, in 0.162910 s sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-poet-engine |  2019-04-24 19:32:31.738 INFO engine  Finalized 346808a4ce963623aad3857d20428e0031ed3ceb18180f221bbe0aef6c6c31b872d912763c24bcf774900e50db53f634c3af2a450122b38bfd7b7dc62b7acb17 with {'Signature': '9dbaab4453232007e9a3b6681f83c6c44f60673da333fbce9f44a0b0df5f57b3330bbeecea0eb479ae7c46e2c3fcdb040b047eb22b0cddd6a94fb7868ac57975', 'SerializedCertificate': '{"block_hash": "b\'\\\\x0e\\\\x89\\\\x94\\\\xa0v,\\\\xfd(\\\\x87\\\\xaf?\\\\x99I\\\\x12\\\\xa7h\\\\xbf\\\\x7fO\\\\xca\\\\x1d\\\\xb3T%\\\\xb2j\\\\x94\\\\xe0\\\\xbdf\\\\xa7\\\\xc9\'", "duration": 1.8333071494603645, "local_mean": 5.777688291110046, "nonce": "27084839eaf7ce26906dd211e14e6576611fa2d22c8b70d1318b1ad44f073809", "previous_certificate_id": "MQYDMY3EMNRDENTE", "request_time": 1556134349.0298517, "validator_address": "03ef8564c8ae35f77516f889f3b88180dbb8d4f1e84aa14e33a0abcebc0e7a602e"}'} sawtooth-poet-engine |  2019-04-24 19:32:31.739 INFO engine  Published block 346808a4ce963623aad3857d20428e0031ed3ceb18180f221bbe0aef6c6c31b872d912763c24bcf774900e50db53f634c3af2a450122b38bfd7b7dc62b7acb17 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-projectname-tp | -  Command: user -  update -  B=29 sawtooth-validator-default |  2019-04-24 19:32:32.996 INFO block_validator  Block 346808a4ce963623aad3857d20428e0031ed3ceb18180f221bbe0aef6c6c31b872d912763c24bcf774900e50db53f634c3af2a450122b38bfd7b7dc62b7acb17 (block_num:12683, state:12e891dfe44f9d1e06d1626ec319453078c0ee95f25b8b63a7aaae981412358c, previous_block_id:66063fd2f50441c5f97c91fa9b69900f5d78ed60fced2b54d8b7575e068b9bfd68a415cf65a8e8c79a31fdfbac26218a7097bf7ac34f24174316ba77c23bcbda) passed validation sawtooth-rest-api-default |  2019-04-24 19:32:36.032 INFO helpers  POST /batches HTTP/1.1: 202 status, 362 size, in 0.391339 s sawtooth-rest-api-default |  2019-04-24 19:32:41.586 INFO helpers  POST /batches HTTP/1.1: 202 status, 362 size, in 0.804410 s sawtooth-rest-api-default |  2019-04-24 19:32:45.667 INFO helpers  POST /batches HTTP/1.1: 202 status, 362 size, in 0.134126 s sawtooth-rest-api-default |  2019-04-24 19:32:47.876 INFO helpers  POST /batches HTTP/1.1: 202 status, 362 size, in 0.075376 s sawtooth-rest-api-default |  2019-04-24 19:32:51.963 INFO helpers  POST /batches HTTP/1.1: 202 status, 362 size, in 0.128591 s sawtooth-rest-api-default |  2019-04-24 19:32:54.073 INFO helpers  POST /batches HTTP/1.1: 202 status, 362 size, in 0.060383 s {code}   I have attached images from Grafana to visualize the issue.  Unfortunately, it was running with -v not -vvv. Next time I run it, I will run it with -vvv for long term testing. I will leave it with -v (without restarting it) for a day or two, in case someone has a test they want me to run on it.  ></description> </Issue>
