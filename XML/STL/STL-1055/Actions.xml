<Action id="40840" issue="27642" author="adamludvik" type="comment" created="2018-02-26 16:27:57.0" updateauthor="adamludvik" updated="2018-02-26 16:27:57.0"> <body><! CDATA The following output shows the value returned by _index_of_txn_in_schedule(), the ordering of predecessors, and the list of base contexts for the problem transaction when the off by one error is present. Note that the return counts include counts for other batches, whereas the other logging messages are just for the problem batch.     PYTHONHASHSEED=1   2018-02-12 18:38:37.293 WARNING scheduler_parallel  0   2018-02-12 18:38:37.296 WARNING scheduler_parallel  0   2018-02-12 18:38:37.297 WARNING scheduler_parallel  deque( 'e423ed4e6cbb062f332a1e2b918aa1fc0113d82be356cf00d79cc3edac3e156f0c1347543437180470cd81b55177625636ce80284055412a0162f96a8520cd23', '32fc4cd0db2354965db458b27790a8b760f4efe5132386e75419449157a80e8c7befc391445fc341452d0f4bfe0b2bf642b40e8abed1c559f75d0b9989977a74' )   2018-02-12 18:38:37.302 WARNING context_manager  Base:  'a1256e347124438197ee62c68eca07f7' , CtxID: 40f5110b09da474eabba75440515c5b62018-02-12 18:35:37.247 WARNING context_manager  Base:  'b05bac1cd5a244fabc91f084a3368b4a' , CtxID: c1241da5fa0a49dda094cbf681c5a64d     PYTHONHASHSEED=2   2018-02-12 18:37:48.998 WARNING scheduler_parallel  0   2018-02-12 18:37:48.998 WARNING scheduler_parallel  0   2018-02-12 18:37:49.000 WARNING scheduler_parallel  deque( '32fc4cd0db2354965db458b27790a8b760f4efe5132386e75419449157a80e8c7befc391445fc341452d0f4bfe0b2bf642b40e8abed1c559f75d0b9989977a74', 'e423ed4e6cbb062f332a1e2b918aa1fc0113d82be356cf00d79cc3edac3e156f0c1347543437180470cd81b55177625636ce80284055412a0162f96a8520cd23' )   2018-02-12 18:37:49.001 WARNING context_manager  Base:  '7958c015ed4247ccbb51ab0907578b9d', '47f4e62c235148628aec5d315ea25347' , CtxID: 37aa6e1159f243c99d9bb2004e4f693b     Notice that between runs, the predecessors deque order is different and that the number of base contexts is different. The following shows the same logging with the off by one error fixed:     PYTHONHASHSEED=1   2018-02-12 18:39:56.895 WARNING scheduler_parallel  77   2018-02-12 18:39:56.896 WARNING scheduler_parallel  63   2018-02-12 18:39:56.896 WARNING scheduler_parallel  deque( 'e423ed4e6cbb062f332a1e2b918aa1fc0113d82be356cf00d79cc3edac3e156f0c1347543437180470cd81b55177625636ce80284055412a0162f96a8520cd23', '32fc4cd0db2354965db458b27790a8b760f4efe5132386e75419449157a80e8c7befc391445fc341452d0f4bfe0b2bf642b40e8abed1c559f75d0b9989977a74' )   2018-02-12 18:39:56.898 WARNING context_manager  Base:  'd06bedfeb6d342c189ee9696fb584873' , CtxID: 493d049967994475bd019dd9d5f206b4     PYTHONHASHSEED=2   2018-02-12 18:40:32.211 WARNING scheduler_parallel  63   2018-02-12 18:40:32.211 WARNING scheduler_parallel  77   2018-02-12 18:40:32.212 WARNING scheduler_parallel  deque( 'e423ed4e6cbb062f332a1e2b918aa1fc0113d82be356cf00d79cc3edac3e156f0c1347543437180470cd81b55177625636ce80284055412a0162f96a8520cd23', '32fc4cd0db2354965db458b27790a8b760f4efe5132386e75419449157a80e8c7befc391445fc341452d0f4bfe0b2bf642b40e8abed1c559f75d0b9989977a74' )   2018-02-12 18:40:32.212 WARNING context_manager  Base:  '538aa867abc14901a6ad8dc037f1a110' , CtxID: 753b43f201134d928f8be1ef0435fb38     Notice that now the deque is in the same order and the number of base contexts is the same.  Iterating over the unsorted set resulted in the same ordering as was calculated when the off-by-one error was present:     PYTHONHASHSEED=1   2018-02-12 18:38:37.296 WARNING scheduler_parallel  txn_id = e423ed4e6cbb062f332a1e2b918aa1fc0113d82be356cf00d79cc3edac3e156f0c1347543437180470cd81b55177625636ce80284055412a0162f96a8520cd23   2018-02-12 18:38:37.296 WARNING scheduler_parallel  txn_id = 32fc4cd0db2354965db458b27790a8b760f4efe5132386e75419449157a80e8c7befc391445fc341452d0f4bfe0b2bf642b40e8abed1c559f75d0b9989977a74     PYTHONHASHSEED=2   2018-02-12 18:37:48.998 WARNING scheduler_parallel  txn_id = 32fc4cd0db2354965db458b27790a8b760f4efe5132386e75419449157a80e8c7befc391445fc341452d0f4bfe0b2bf642b40e8abed1c559f75d0b9989977a74   2018-02-12 18:37:48.999 WARNING scheduler_parallel  txn_id = e423ed4e6cbb062f332a1e2b918aa1fc0113d82be356cf00d79cc3edac3e156f0c1347543437180470cd81b55177625636ce80284055412a0162f96a8520cd23  ></body> </Action>
