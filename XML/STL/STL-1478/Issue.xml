<Issue id="36723" key="STL-1478" number="1478" project="10001" reporter="yoni" assignee="arsulegai" creator="yoni" type="10004" summary="validator error after multiple delete and write in one transaction" environment="i reproduced on sawtooth 1.1.x, running one node directly on ubuntu with intkey cxx tp" priority="3" resolution="10000" status="10001" created="2019-01-13 14:11:42.0" updated="2019-04-24 11:58:51.0" resolutiondate="2019-04-24 11:58:51.0" votes="0" watches="2" workflowId="48276"> <description><! CDATA Issue found by TASE.  TP flow: # Delete several addresses # Write to at least one address  result: * validator crashes     to reproduce i did the following: # changed the intkey tp so in case of Verb='dec'  it will delete the two addresses of name+'1' and name+'2' and write to address name void DoDec(const std::string& name, int value) { {color:#ff0000}// Yoni, debug code{color} {color:#ff0000}#if 1{color} {color:#ff0000} this->state->DeleteState(this->MakeAddress(name+"1"));{color} {color:#ff0000} this->state->DeleteState(this->MakeAddress(name+"2"));{color} {color:#ff0000}this->state->SetState(this->MakeAddress(name), "123"){color}; {color:#ff0000} return; {color} {color:#ff0000}#else{color} ... } # changed intkey client so that each transaction input and output will only include inteky prefix and not full address (to allow the 'dec' transaction to delete other addresses) ## inside /sawtooth-core/sdk/examples/intkey_python/sawtooth_intkey/client_cli/intkey_client.py at _send_transacion method: inputs=* *{color:#ff0000}self._get_prefix(){color} , outputs= {color:#ff0000}self._get_prefix(){color} , # start sawtooth and run $ inteky set test1 10 $ intkey set test2 10  $ intkey dec test 10  ></description> </Issue>
