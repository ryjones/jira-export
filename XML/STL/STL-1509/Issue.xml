<Issue id="38815" key="STL-1509" number="1509" project="10001" reporter="danintel" assignee="ltseeley" creator="danintel" type="10004" summary="seth account create causes sawtooth-validator to panic" priority="3" resolution="10000" status="10001" created="2019-03-27 21:19:39.0" updated="2019-04-12 15:01:45.0" resolutiondate="2019-04-12 15:01:45.0" votes="0" watches="1" workflowId="50465"> <environment><! CDATA Inside Docker container:  root@e83123f26575:/project/sawtooth-seth# sawtooth -V sawtooth-cli (Hyperledger Sawtooth) version 1.2.1.dev442 root@e83123f26575:/project/sawtooth-seth# uname -a Linux e83123f26575 4.15.0-46-generic #49~16.04.1-Ubuntu SMP Tue Feb 12 17:45:24 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux root@e83123f26575:/project/sawtooth-seth# lsb_release -a No LSB modules are available. Distributor ID: Ubuntu Description:    Ubuntu 18.04.2 LTS Release:        18.04 Codename:       bionic  ></environment> <description><! CDATA I am following the "Getting Started" directions for Seth: https://sawtooth.hyperledger.org/docs/seth/releases/latest/getting_started.html Running Docker Compose on  Internet-facing server (no proxy needed). The container installs and uses Sawtooth 1.2.1.dev442 on Ubuntu 18 (Bionic).  This step fails and causes sawtooth-validator to panic: *seth account create --nonce=0 --wait myalias*  $ *sudo docker exec -it seth-cli-go bash*  sudo  password for dano:  root@e83123f26575:/project/sawtooth-seth# *openssl ecparam -genkey -name secp256k1 | openssl ec -out key-file.pem*         read EC key writing EC key root@e83123f26575:/project/sawtooth-seth# *seth account import key-file.pem myalias* Key at key-file.pem imported with alias myalias root@e83123f26575:/project/sawtooth-seth# *seth account create --nonce=0 --wait myalias* Error: Problem submitting account creation transaction:  Code    : 18 Title   : Validator Disconnected Message : The validator disconnected before sending a response. Try your request again later.  *Output from log:*  root@e83123f26575:/project/sawtooth-seth# seth account import key-file.pem myaliasKey at key-file.pem imported with alia s myalias root@e83123f26575:/project/sawtooth-seth# seth account create --nonce=0 --wait myalias Error: Problem submitting account creation transaction: Code    : 18 Title   : Validator Disconnected Message : The validator disconnected before sending a response. Try your request again later.  rest-api         |  2019-03-27 20:56:23.557 DEBUG    route_handlers  Sending CLIENT_BATCH_SUBMIT_REQUEST request to validator rest-api         |  2019-03-27 20:56:23.584 DEBUG    route_handlers  Received CLIENT_BATCH_SUBMIT_RESPONSE response from validator with status OK rest-api         |  2019-03-27 20:56:23.587 INFO     helpers  POST /batches HTTP/1.1: 202 status, 347 size, in 0.031246s rest-api         |  2019-03-27 20:56:23.588 DEBUG    route_handlers  Sending CLIENT_BATCH_STATUS_REQUEST request to validator block-info-tp    | INFO  | sawtooth_sdk::proces | Message: 1adfa651b66243ac9f8e5faa97c4f5aa block-info-tp    | INFO  | sawtooth_sdk::proces | TP_PROCESS_REQUEST sending TpProcessResponse: OK seth-tp          | 2019/03/27 20:56:23.601189 transaction_handlers.go:148:  DEBUG  Creating new EOA at sender address: 5 c9de61331a5f4185dc027a221097a2467cf47f8 seth-tp          | 2019/03/27 20:56:23.601529 sawtooth_app_state.go:53:  DEBUG  GetAccount(5c9de61331a5f4185dc027a221097 a2467cf47f8) seth-tp          | 2019/03/27 20:56:23.604880 sawtooth_app_state.go:53:  DEBUG  GetAccount(00000000000000000000000000000 00000000000) seth-tp          | 2019/03/27 20:56:23.606578 transaction_handlers.go:182:  WARN  Global Permissions not set, all actions allowed! seth-tp          | 2019/03/27 20:56:23.606681 sawtooth_app_state.go:75:  DEBUG  UpdateAccount(5c9de61331a5f4185dc027a221 097a2467cf47f8) sawtooth-validator | thread '<unnamed>' *panicked at 'called `Result::unwrap()` on an `Err` value: Other("TypeError")', src/libcore/result.rs:997:5* sawtooth-validator | note: Run with `RUST_BACKTRACE=1` environment variable to display a backtrace. sawtooth-validator | fatal runtime error: failed to initiate panic, error 5 devmode-engine-rust | INFO  | sawtooth_sdk::messag | Received Disconnect seth-tp          | 2019/03/27 20:56:23.801268 processor.go:320:  INFO  Validator 'tcp://validator:4004' disconnected seth-tp          | 2019/03/27 20:56:23.802035 processor.go:380:  INFO  Received command to restart settings-tp      | INFO  | sawtooth_sdk::messag | Received Disconnect settings-tp      | DEBUG | sawtooth_sdk::messag | Exited stream settings-tp      | DEBUG | zmq:547              | socket dropped seth-tp          | 2019/03/27 20:56:23.803139 processor.go:451:  DEBUG  Workers done 0/2 seth-tp          | 2019/03/27 20:56:23.803591 processor.go:451:  DEBUG  Workers done 1/2 settings-tp      | DEBUG | zmq:547              | socket dropped seth-tp          | 2019/03/27 20:56:23.804204 processor.go:454:  DEBUG  Workers done 2/2 block-info-tp    | INFO  | sawtooth_sdk::messag | Received Disconnect block-info-tp    | INFO  | sawtooth_sdk::proces | Trying to Reconnect block-info-tp    | INFO  | sawtooth_sdk::proces | connecting to endpoint: tcp://validator:4004 devmode-engine-rust | thread 'main' panicked at 'Failed to summarize block: ReceiveError("DisconnectedError")', src/libc ore/result.rs:1009:5 devmode-engine-rust | note: Run with `RUST_BACKTRACE=1` for a backtrace. settings-tp      | INFO  | sawtooth_sdk::proces | Trying to Reconnect settings-tp      | INFO  | sawtooth_sdk::messag | Sender has already closed. settings-tp      | INFO  | sawtooth_sdk::proces | connecting to endpoint: tcp://validator:4004 settings-tp      | DEBUG | zmq:454              | context dropped block-info-tp    | INFO  | sawtooth_sdk::proces | sending TpRegisterRequest: block_info 1.0 block-info-tp    | DEBUG | sawtooth_sdk::messag | Exited stream seth-rpc         |  00:06:00.112  (140047763171072) ERROR  Failed to send disconnect: sending on a closed channel seth-tp          | 2019/03/27 20:56:23.809525 connection.go:100:  INFO  Connecting to tcp://validator:4004 seth-tp          | 2019/03/27 20:56:23.810678 connection.go:97:  INFO  Binding to inproc://workers seth-tp          | 2019/03/27 20:56:23.811053 connection.go:97:  INFO  Binding to inproc://shutdown seth-tp          | 2019/03/27 20:56:23.811276 connection.go:100:  INFO  Connecting to inproc://shutdown seth-tp          | 2019/03/27 20:56:23.811358 processor.go:146:  DEBUG  Registering (seth, 1.0,  a68b06 ) seth-tp          | 2019/03/27 20:56:23.811714 connection.go:100:  INFO  Connecting to inproc://workers settings-tp      | INFO  | sawtooth_sdk::proces | sending TpRegisterRequest: sawtooth_settings 1.0 seth-tp          | 2019/03/27 20:56:23.811790 connection.go:100:  INFO  Connecting to inproc://workers rest-api         |  2019-03-27 20:56:23.810 DEBUG    state_delta_subscription_handler  Validator disconnected rest-api         |  2019-03-27 20:56:23.812 WARNING  route_handlers  Validator disconnected while waiting for response block-info-tp    | DEBUG | zmq:547              | socket dropped block-info-tp    | DEBUG | zmq:547              | socket dropped block-info-tp    | DEBUG | zmq:454              | context dropped rest-api         |  2019-03-27 20:56:23.813 INFO     helpers  GET /batch_statuses?id=68c2be7d4d909780ae20dfecbc4f4bbcd01 c6dc2dc21acc029a64e7a667852091c8aa00c37017e5c863ebcc7d287717dde48ea278c54b77f1ed56147880a05c5&wait=60 HTTP/1.1: 503 stat us, 351 size, in 0.225511 s devmode-engine-rust exited with code 101 sawtooth-validator exited with code 139 rest-api         |  2019-03-27 20:56:24.808 DEBUG    state_delta_subscription_handler  Attempting to resubscribe...      ></description> </Issue>
