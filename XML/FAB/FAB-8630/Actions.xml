<Action id="41151" issue="28178" author="rameshthoomu" type="comment" created="2018-03-02 16:10:10.0" updateauthor="rameshthoomu" updated="2018-03-02 16:10:10.0"> <body><! CDATA  ~jyellick   ~denyeart  this test is failing frequently in CI..  https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-end-2-end-daily-x86_64/29/   any workaround or fix planned to prevent this issue?  ></body> </Action>
<Action id="41176" issue="28178" author="denyeart" type="comment" created="2018-03-05 01:07:07.0" updateauthor="denyeart" updated="2018-03-05 01:07:07.0"> <body><! CDATA I tried five times:  {color:#333333}./byfn.{color}{color:#333333}sh{color}{color:#333333} -{color}{color:#333333}m{color} {color:#333333}up{color}{color:#333333} -{color}{color:#333333}c{color}{color:#333333} couchdbtest -s couchdb -t {color}{color:#008080}60{color}  I had 100% success rate.  Can anybody reproduce the problem locally?  ></body> </Action>
<Action id="41270" issue="28178" author="rameshthoomu" type="comment" body=" ~denyeart  finally captured the docker container logs https://jenkins.hyperledger.org/view/fabric-samples/job/fabric-byfn-verify-x86_64/340/" created="2018-03-06 20:56:59.0" updateauthor="rameshthoomu" updated="2018-03-06 20:56:59.0"/>
<Action id="41281" issue="28178" author="denyeart" type="comment" created="2018-03-07 06:54:56.0" updateauthor="denyeart" updated="2018-03-07 12:54:29.0"> <body><! CDATA  ~rameshthoomu  Thanks for the debug logs... I see the problem now...  After spinning up the network, it takes peer0 8 seconds to establish connection to the couchdb container and finish startup.  The attempt to join peer0 to the channel takes place 2 seconds after spinning up the network.  peer0 is not available yet when the join command comes in.  The join channel fails, and then the subsequent channel query will of course fail since the channel is unknown on the peer.  e2e test does not detect the join channel failure:    {code:java} 20:43:13 + peer channel join -b custom-channel-couch.block  20:43:16 + set +x  20:43:16 Error: Error getting endorser client channel: endorser client failed to connect to peer0.org1.example.com:7051: failed to create new connection: context deadline exceeded ... 20:43:16 ===================== peer0.org1 joined on the channel "custom-channel-couch" ===================== {code}    The e2e test should be improved in two ways:  1) detect join channel failure condition (actually, all steps should detect failure)  2) retry join channel several times, to account for the longer peer startup time when depending on couchdb container.     Who could make these updates?  ></body> </Action>
<Action id="41343" issue="28178" author="rameshthoomu" type="comment" body="Marking this as highest bug. This has to fix ASAP, I see 85% of fabric-samples and 100% of e2e-daily builds are failing. Not sure who has bandwidth to fix this.." created="2018-03-08 02:00:55.0" updateauthor="rameshthoomu" updated="2018-03-08 02:00:55.0"/>
<Action id="41350" issue="28178" author="denyeart" type="comment" body="I took a look and actually utils.sh joinChannelWithRetry is already setup to retry 5 times with 3 seconds delay each retry.  It just needs a small improvement to look for &quot;Error&quot; in the *peer channel join* result as part of the retry logic." created="2018-03-08 04:01:59.0" updateauthor="denyeart" updated="2018-03-08 04:01:59.0"/>
<Action id="41378" issue="28178" author="skarim" type="comment" body="https://gerrit.hyperledger.org/r/#/c/18885/" created="2018-03-08 16:54:46.0" updateauthor="skarim" updated="2018-03-08 16:54:46.0"/>
