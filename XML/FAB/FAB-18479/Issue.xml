<Issue id="46881" key="FAB-18479" number="18479" project="10002" reporter="denyeart" assignee="denyeart" creator="denyeart" type="10004" summary="Orderer does not log error if it cannot forward transaction to Raft leader" priority="2" resolution="10000" status="6" created="2021-05-28 21:58:16.0" updated="2021-06-09 19:12:59.0" resolutiondate="2021-06-08 14:52:31.0" votes="1" watches="2" workflowId="60784" archived="N"> <description><! CDATA When a transaction is submitted to a Raft orderer node, as soon as it accepts the transaction a success is returned to the client. If the orderer node is not the Raft leader, it will attempt to forward the transaction to the Raft leader. If this fails, for example due to a network issue, the orderer does not log the error, and does not retry the send. It simply logs a debug message as follows:    {code:java} 2021-05-21T15:34:04.155751059Z  36m2021-05-21 15:34:04.155 UTC  orderer.common.broadcast  ProcessMessage -> DEBU 1f97d 0m  channel: mychannel  Broadcast is processing normal message from 172.30.176.148:49500 with txid '6c05b32a0751453a729105903798b275ae2507165772ac760ee7f4440ea265b8' of type ENDORSER_TRANSACTION 2021-05-21T15:34:04.157226324Z  36m2021-05-21 15:34:04.156 UTC  orderer.consensus.etcdraft  submitSent -> DEBU 1f97e 0m Sending msg of 7425 bytes to 5 on channel mychannel took 24.752µs 2021-05-21T15:34:04.157298684Z  36m2021-05-21 15:34:04.156 UTC  orderer.common.broadcast  ProcessMessage -> DEBU 1f97f 0m  channel: mychannel  Broadcast has successfully enqueued message of type ENDORSER_TRANSACTION from 172.30.176.148:49500 2021-05-21T15:34:04.157832832Z  36m2021-05-21 15:34:04.157 UTC  orderer.common.cluster  1 -> DEBU 1f980 0m Stream 17 to OS1(n46c992-orderingservicenode5:7050) is aborted 2021-05-21T15:34:04.157980725Z  36m2021-05-21 15:34:04.157 UTC  orderer.common.cluster.step  sendMessage -> DEBU 1f981 0m Send of SubmitRequest for channel mychannel with payload of size 7425 to OS1(n46c992-orderingservicenode5:7050) took 195.364µs but failed due to EOF {code}    The orderer should log the send failure as an error rather than debug message.  A few other things could be done to improve the behavior in the future:  The orderer could retry the send before giving up.  The orderer could also attempt the send before replying success back to the client.  However, there has been some debate on these functionality changes given the async nature of Raft communications. Clients need to check for transaction commit events regardless since cutting transactions into blocks is not guaranteed. These suggestions are therefore out of scope for this work item, but may be taken up in follow-on enhancements.  ></description> </Issue>
