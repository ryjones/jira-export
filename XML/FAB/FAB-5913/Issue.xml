<Issue id="20406" key="FAB-5913" number="5913" project="10002" reporter="yuki-kon" assignee="yuki-kon" creator="yuki-kon" type="10001" summary="balance-transfer: queryChaincode fails to select peer" environment="fabric-samples commit 7cca09f0470eceabc233018e7a9ae48a88487218" priority="3" resolution="10000" status="6" created="2017-08-24 21:06:01.0" updated="2018-07-20 18:50:38.0" resolutiondate="2018-01-30 19:13:16.0" votes="0" watches="2" workflowId="39836"> <description><! CDATA In fabric-samples/balance-transfer/app/query.js, "queryChaincode" fails to select peer. "queryChaincode" has “peer“ as an args to select a target peer to get ledger's data. "queryChaincode" calls channel.queryByChaincode like the below. Target peer is not included in request object.  {code:java} return channel.queryByChaincode(request, target); {code}  channel.queryByChaincode accepts target peer as a var in request object. As a result, target peer designated like the above is ignored and transaction proposal is sent to default peers (i.e. peer1 & peer2). Target peer should be put into request object.  In addition, "queryChaincode" doesn’t output responses from all peers in log message. It exits the loop processing after outputting the first response like the below. We should print all responses from all peers. Also, we should return a response (e.g. the response_payloads 0 ) after the loop.  {code:java} for (let i = 0; i < response_payloads.length; i++) { logger.info(args 0 +' now has ' + response_payloads i .toString('utf8') + ' after the move'); return args 0 +' now has ' + response_payloads i .toString('utf8') + ' after the move'; } {code}   ></description> </Issue>
