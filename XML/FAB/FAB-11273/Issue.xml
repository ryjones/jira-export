<Issue id="32147" key="FAB-11273" number="11273" project="10002" reporter="rhegde" creator="rhegde" type="10004" summary="Peer fails sending endorsement response to HFC even after chaincode execution completion" priority="2" resolution="10001" status="6" created="2018-07-23 19:53:07.0" updated="2018-12-04 21:21:50.0" resolutiondate="2018-12-04 21:21:50.0" votes="0" watches="2" workflowId="43376"> <description><! CDATA *Fabric Release* - Fabric 1.0.6  *Description*  We encountered issue where multiple PEER failed to send the Endorsement Response and reported Execution Timeout.  Execution Flow * HFC sent endorsement request to the Peer * Peer received the request and sent the same to the chaincode for Endorsement Processing * Chaincode completed the execution by using the couch database as world state ledger    {code:java} ESC 36m2018-07-23 20:32:52.192 CEST  chaincode  processStream -> DEBU da6ESC 0m  a724cefa Received message COMPLETED from shim  ESC 36m2018-07-23 20:32:52.192 CEST  chaincode  HandleMessage -> DEBU da7ESC 0m  a724cefa Fabric side Handling ChaincodeMessage of type: COMPLETED in state ready  ESC 36m2018-07-23 20:32:52.192 CEST  chaincode  HandleMessage -> DEBU da8ESC 0m  a724cefaf6517cdf1858aef72dc0e486d25abebd00cfff04674b212d26de41aa HandleMessage- COMPLETED. Notify  ESC 36m2018-07-23 20:32:52.192 CEST  chaincode  notify -> DEBU da9ESC 0m notifying Txid:a724cefaf6517cdf1858aef72dc0e486d25abebd00cfff04674b212d26de41aa ESC 36m2018-07-23 20:32:52.192 CEST  chaincode  Execute -> DEBU daaESC 0m Exit ESC 36m2018-07-23 20:32:52.192 CEST  endorser  callChaincode -> DEBU dabESC 0m Exit ESC 36m2018-07-23 20:32:52.192 CEST  lockbasedtxmgr  GetTxSimulationResults -> DEBU dacESC 0m Simulation completed, getting simulation results ESC 36m2018-07-23 20:32:52.192 CEST  lockbasedtxmgr  Done -> DEBU dadESC 0m Done with transaction simulation / query execution  a92a2043-a49e-4a66-9a91-ec04058820d5  {code} Communication between chaincode, peer and couch database is also good at this point of time looking at the logs.  Peer failed to send the response to the HFC and finally there was execute timeout reported in the Peer Logs after default ExecuteTimeout (30sec).  {code:java} ESC 36m2018-07-23 20:32:52.192 CEST  lockbasedtxmgr  Done -> DEBU dadESC 0m Done with transaction simulation / query execution  a92a2043-a49e-4a66-9a91-ec04058820d5  ....  30 seconds wait ... ESC 36m2018-07-23 20:33:22.193 CEST  chaincode  Execute -> DEBU de1ESC 0m Exit ESC 31m2018-07-23 20:33:22.193 CEST  chaincode  ExecuteChaincode -> ERRO de2ESC 0m Error executing chaincode: Failed to execute transaction (Timeout expired while executing transaction) ESC 36m2018-07-23 20:33:22.193 CEST  endorser  callChaincode -> DEBU de3ESC 0m Exit {code}    *Note:* # After restarting 1 of the peer from 3 affected, that peer was able to process Endorsement and send response to the HFC.  *Impact*  Any endorsement sent to the impacted peer always result in Execute Timeout thus result unavailability of Service.  ></description> </Issue>
