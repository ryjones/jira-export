<Action id="57705" issue="38080" author="yacovm" type="comment" created="2019-02-28 09:24:15.0" updateauthor="yacovm" updated="2019-02-28 09:24:15.0"> <body><! CDATA It does not. And the failure of sending is a message is because the node on the other side, closes the stream because it rejects the certificate (as seen in the logs).  The success in sending that is logged in the etcdraft chain is a false positive, because it only thinks it succeeds, due to allocating a new gRPC stream (but not sending the message yet) and then queueing the message in the queue, which returns. The message itself is dropped on the other side and the stream is closed.    ></body> </Action>
<Action id="57718" issue="38080" author="guoger" type="comment" body=" ~yacovm  hmm, thanks for explaining this. why is certificate rejected? I don&apos;t think {{orderer4}} is evicted in that IT, no?" created="2019-02-28 12:54:08.0" updateauthor="guoger" updated="2019-02-28 12:54:08.0"/>
<Action id="57719" issue="38080" author="yacovm" type="comment" body="Because orderer4 was down while orderer5 was added, so it takes time to get the config update. During that time, it still thinks orderer5 is not in the channel. It&apos;s part of the test. " created="2019-02-28 13:02:45.0" updateauthor="yacovm" updated="2019-02-28 13:02:45.0"/>
<Action id="57720" issue="38080" author="guoger" type="comment" body=" ~yacovm  In this case, {{orderer5}} is the leader, and {{orderer4}} is never going to catch up then... I think we have a problem here..." created="2019-02-28 13:08:28.0" updateauthor="guoger" updated="2019-02-28 13:08:28.0"/>
<Action id="57721" issue="38080" author="guoger" type="comment" created="2019-02-28 13:30:28.0" updateauthor="guoger" updated="2019-02-28 13:30:54.0"> <body><! CDATA What we could do, is to actually pull and commit blocks during suspicion, till the latest config block that still contains its certificate. Although this should be done carefully to correctly update the block number in raft go routine to avoid replay. i could take on this if it's considered a viable solution.   ~yacovm  ~kchristidis   ></body> </Action>
<Action id="57722" issue="38080" author="yacovm" type="comment" body="I don&apos;t think this needs to be done in the chain. I think this is a trivial extension of the work I did in https://gerrit.hyperledger.org/r/#/c/29084/ " created="2019-02-28 13:36:10.0" updateauthor="yacovm" updated="2019-02-28 13:36:10.0"/>
<Action id="57726" issue="38080" author="kchristidis" type="comment" body="Based on the discussion in RC just now, a solution to this is to have the eviction suspicion thread push an artificial snapshot (based on the latest config block) to {{snapC}}." created="2019-02-28 14:11:23.0" updateauthor="kchristidis" updated="2019-02-28 14:11:23.0"/>
