<Action id="50948" issue="33813" author="denyeart" type="comment" body="Automated tests have worked around the issue of couchdb container taking a couple extra seconds to startup... would still be good to understand root cause." created="2018-09-21 14:10:58.0" updateauthor="denyeart" updated="2018-09-21 14:10:58.0"/>
<Action id="51439" issue="33813" author="denyeart" type="comment" body="Cause of slowdown in couchdb start has not been found, tests have been updated to reflect the slightly longer startup time." created="2018-10-01 15:39:42.0" updateauthor="denyeart" updated="2018-10-01 15:39:42.0"/>
<Action id="51610" issue="33813" author="denyeart" type="comment" created="2018-10-03 03:29:26.0" updateauthor="denyeart" updated="2018-10-03 03:29:26.0"> <body><! CDATA Additional people and CI tests have been hitting timeouts since moving to baseimage 0.4.12 images of fabric-couchdb.  I will re-open to continue the investigation of root cause.   ~harsha544  mentioned he will inspect 0.4.10 to 0.4.12 changes that may impact the slower couchdb container startup time.  ></body> </Action>
<Action id="51619" issue="33813" author="knagware9" type="comment" body="I used prior couch db images and its working fine. !Screenshot from 2018-10-03 17-25-28.png!" created="2018-10-03 11:55:50.0" updateauthor="knagware9" updated="2018-10-03 11:55:50.0"/>
<Action id="51621" issue="33813" author="harsha544" type="comment" created="2018-10-03 13:06:13.0" updateauthor="harsha544" updated="2018-10-03 13:06:13.0"> <body><! CDATA  ~knagware9  Do these BYFN test leverage couchdb as well, and are these done on x86/s390x as well ? Can you kindly provide docker ps -a Output and attach respective test log ?  ></body> </Action>
<Action id="51701" issue="33813" author="knagware9" type="comment" body="Tested with Prior couch db images 0.4.10 on x86 (Ubuntu 16.04) .please find the test results attached !BYFN_couchdb_E2ETest.png!" created="2018-10-03 15:06:47.0" updateauthor="knagware9" updated="2018-10-03 15:06:47.0"/>
<Action id="51702" issue="33813" author="knagware9" type="comment" body="!Couchdb_BYFN_test.png|thumbnail!" created="2018-10-03 15:08:44.0" updateauthor="knagware9" updated="2018-10-03 15:08:44.0"/>
<Action id="51778" issue="33813" author="chris.elder" type="comment" created="2018-10-04 18:04:41.0" updateauthor="chris.elder" updated="2018-10-04 18:04:41.0"> <body><! CDATA I have reviewed this defect.  It looks like there are three main options for resolving this defect for v1.3.  1)  Revert the change in   https://gerrit.hyperledger.org/r/#/c/24427/    2) Continue troubleshooting in an attempt to find the exact cause of the additional delay in CouchDB startup.  3) Add additional logic in the docker compose scripts to ensure CouchDB has completed startup.     Option 2 is difficult since the error does not occur in local Mac or Linux VMs that have been tested.  In the Jenkins environment, this is an intermittent issue.  Time to resolve is a factor in attempting option 2.  Option 3 may be the best long term solution, but that is not really an option for 1.3 due to time constraints.  Option 1 looks to be the best solution for 1.3.           ></body> </Action>
<Action id="51788" issue="33813" author="knagware9" type="comment" body="Update on FAB-12023: I tried to setup using couch db 0.4.12 images on ubuntu 18.04 LTS and not getting any issue .Tried BYFN end to end test too...seems issue with only Ubuntu 16.04" created="2018-10-05 05:49:32.0" updateauthor="knagware9" updated="2018-10-05 05:49:32.0"/>
<Action id="51818" issue="33813" author="denyeart" type="comment" body=" ~chris.elder  At one point I thought you mentioned the problem may not be with the couchdb changes, but other changes in baseimage.  Are you now confident that reverting  https://gerrit.hyperledger.org/r/#/c/24427/   will resolve it?" created="2018-10-06 16:58:42.0" updateauthor="denyeart" updated="2018-10-06 16:58:42.0"/>
<Action id="51819" issue="33813" author="harsha544" type="comment" body="FWIW  ~denyeart   ~chris.elder  Here&apos;s an instance already reported pertaining to slowness of CouchDB  https://github.com/apache/couchdb-documentation/issues/278" created="2018-10-06 17:56:14.0" updateauthor="harsha544" updated="2018-10-06 17:56:14.0"/>
<Action id="51833" issue="33813" author="denyeart" type="comment" created="2018-10-08 01:50:27.0" updateauthor="denyeart" updated="2018-10-08 01:50:27.0"> <body><! CDATA  ~chris.elder   While I +2ed https://gerrit.hyperledger.org/r/#/c/26801/ to revert the couchdb image, troubleshooting needs to continue.  On my mac using byfn: with couchdb image 0.4.10 on average it takes peer 2 seconds to connect to couchdb. with couchdb image 0.4.12 on average it takes peer 8 seconds to connect to couchdb. The results are very consistent for me and therefore troubleshooting with incremental changes to find the root cause should be possible.  ></body> </Action>
<Action id="51871" issue="33813" author="denyeart" type="comment" created="2018-10-08 23:46:36.0" updateauthor="denyeart" updated="2018-10-09 02:44:49.0"> <body><! CDATA The more minimal https://gerrit.hyperledger.org/r/#/c/26859/ seems to have solved the issue, it at least makes couchdb container startup much faster than 0.4.12 and a little faster than 0.4.10 even, on mac and in CI.  The CR also reverts FAB-12249 which was targeted for v1.4, to take CouchDB back from 2.2.0 to 2.1.1, which is the level that has been system tested throughout the v1.3 release cycle.  ></body> </Action>
