<Issue id="37558" key="FAB-14130" number="14130" project="10002" reporter="skarim" assignee="ronenschafferibm" creator="skarim" type="10004" summary="Flakey gossip tests - out of memory" priority="3" resolution="10000" status="6" created="2019-02-10 17:34:08.0" updated="2019-06-06 06:47:18.0" resolutiondate="2019-06-06 06:47:07.0" votes="0" watches="4" workflowId="49169"> <description><! CDATA  https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/8782/console   Â  {code:java} 19:22:24 ok  	github.com/hyperledger/fabric/gossip/api	0.012s	coverage: 100.0% of statements 19:26:14 fatal error: runtime: out of memory 19:26:14  19:26:14 runtime stack: 19:26:14 runtime.throw(0x98054f, 0x16) 19:26:14 	/usr/local/go/src/runtime/panic.go:608 +0x72 19:26:14 runtime.sysMap(0xc00c000000, 0x8000000, 0xd81fb8) 19:26:14 	/usr/local/go/src/runtime/mem_linux.go:156 +0xc7 19:26:14 runtime.(*mheap).sysAlloc(0xd68c00, 0x8000000, 0x0, 0x0) 19:26:14 	/usr/local/go/src/runtime/malloc.go:619 +0x1c7 19:26:14 runtime.(*mheap).grow(0xd68c00, 0x4000, 0x0) 19:26:14 	/usr/local/go/src/runtime/mheap.go:920 +0x42 19:26:14 runtime.(*mheap).allocSpanLocked(0xd68c00, 0x4000, 0xd81fc8, 0x433b4e) 19:26:14 	/usr/local/go/src/runtime/mheap.go:848 +0x337 19:26:14 runtime.(*mheap).alloc_m(0xd68c00, 0x4000, 0xffffffffffff0101, 0x7f0e0d699e18) 19:26:14 	/usr/local/go/src/runtime/mheap.go:692 +0x119 19:26:14 runtime.(*mheap).alloc.func1() 19:26:14 	/usr/local/go/src/runtime/mheap.go:759 +0x4c 19:26:14 runtime.(*mheap).alloc(0xd68c00, 0x4000, 0x10101, 0x7f0e0d699ec0) 19:26:14 	/usr/local/go/src/runtime/mheap.go:758 +0x8a 19:26:14 runtime.largeAlloc(0x7fffe00, 0x7f0e18a20101, 0x434f01) 19:26:14 	/usr/local/go/src/runtime/malloc.go:1019 +0x97 19:26:14 runtime.mallocgc.func1() 19:26:14 	/usr/local/go/src/runtime/malloc.go:914 +0x46 19:26:14 runtime.systemstack(0x7f0e148eebe0) 19:26:14 	/usr/local/go/src/runtime/asm_amd64.s:351 +0x66 19:26:14 runtime.mstart() 19:26:14 	/usr/local/go/src/runtime/proc.go:1229 19:26:14  19:26:14 goroutine 405  running : 19:26:14 runtime.systemstack_switch() 19:26:14 	/usr/local/go/src/runtime/asm_amd64.s:311 fp=0xc000058ca0 sp=0xc000058c98 pc=0x457160 19:26:14 runtime.mallocgc(0x7fffe00, 0x8ce1a0, 0xc009165b01, 0xc000058d78) 19:26:14 	/usr/local/go/src/runtime/malloc.go:913 +0x896 fp=0xc000058d40 sp=0xc000058ca0 pc=0x40d906 19:26:14 runtime.makeslice(0x8ce1a0, 0x7fffe00, 0x7fffe00, 0x4993c9, 0xc0009e2028, 0xc009165bc9) 19:26:14 	/usr/local/go/src/runtime/slice.go:70 +0x77 fp=0xc000058d70 sp=0xc000058d40 pc=0x442627 19:26:14 bytes.makeSlice(0x7fffe00, 0x0, 0x0, 0x0) 19:26:14 	/usr/local/go/src/bytes/buffer.go:231 +0x6d fp=0xc000058db0 sp=0xc000058d70 pc=0x4eb57d 19:26:14 bytes.(*Buffer).grow(0xc0001ae000, 0x200, 0x237) 19:26:14 	/usr/local/go/src/bytes/buffer.go:144 +0x15a fp=0xc000058e00 sp=0xc000058db0 pc=0x4eaeea 19:26:14 bytes.(*Buffer).ReadFrom(0xc0001ae000, 0xa29b60, 0xc0009e2028, 0x7f0e189d9570, 0xc0001ae000, 0x1) 19:26:14 	/usr/local/go/src/bytes/buffer.go:204 +0x4b fp=0xc000058e70 sp=0xc000058e00 pc=0x4eb37b 19:26:14 io.copyBuffer(0xa29260, 0xc0001ae000, 0xa29b60, 0xc0009e2028, 0x0, 0x0, 0x0, 0xc0003e77a0, 0x0, 0x0) 19:26:14 	/usr/local/go/src/io/io.go:388 +0x303 fp=0xc000058ee0 sp=0xc000058e70 pc=0x46fe03 19:26:14 io.Copy(0xa29260, 0xc0001ae000, 0xa29b60, 0xc0009e2028, 0x406825, 0xc0003e7860, 0xc00119b7b0) 19:26:14 	/usr/local/go/src/io/io.go:364 +0x5a fp=0xc000058f40 sp=0xc000058ee0 pc=0x46faba 19:26:14 os/exec.(*Cmd).writerDescriptor.func1(0xc0003e7860, 0xc00119b7b0) 19:26:14 	/usr/local/go/src/os/exec/exec.go:279 +0x4d fp=0xc000058fa0 sp=0xc000058f40 pc=0x4fbe4d 19:26:14 os/exec.(*Cmd).Start.func1(0xc000369760, 0xc000874160) 19:26:14 	/usr/local/go/src/os/exec/exec.go:400 +0x27 fp=0xc000058fd0 sp=0xc000058fa0 pc=0x4fbec7 19:26:14 runtime.goexit() 19:26:14 	/usr/local/go/src/runtime/asm_amd64.s:1333 +0x1 fp=0xc000058fd8 sp=0xc000058fd0 pc=0x459241 19:26:14 created by os/exec.(*Cmd).Start 19:26:14 	/usr/local/go/src/os/exec/exec.go:399 +0x5a6 19:26:14  19:26:14 goroutine 1  semacquire, 4 minutes : 19:26:14 sync.runtime_Semacquire(0xc000898b38) 19:26:14 	/usr/local/go/src/runtime/sema.go:56 +0x39 19:26:14 sync.(*WaitGroup).Wait(0xc000898b30) 19:26:14 	/usr/local/go/src/sync/waitgroup.go:130 +0x64 19:26:14 cmd/go/internal/work.(*Builder).Do(0xc00062f180, 0xc000636780) 19:26:14 	/usr/local/go/src/cmd/go/internal/work/exec.go:174 +0x38e 19:26:14 cmd/go/internal/test.runTest(0xd58480, 0xc0000ae020, 0x1d, 0x1e) 19:26:14 	/usr/local/go/src/cmd/go/internal/test/test.go:759 +0xea9 19:26:14 main.main() 19:26:14 	/usr/local/go/src/cmd/go/main.go:219 +0x7d4 19:26:14  19:26:14 goroutine 19  syscall, 4 minutes : 19:26:14 os/signal.signal_recv(0x0) 19:26:14 	/usr/local/go/src/runtime/sigqueue.go:139 +0x9c 19:26:14 os/signal.loop() 19:26:14 	/usr/local/go/src/os/signal/signal_unix.go:23 +0x22 19:26:14 created by os/signal.init.0 19:26:14 	/usr/local/go/src/os/signal/signal_unix.go:29 +0x41 19:26:14  19:26:14 goroutine 8  select, 3 minutes : 19:26:14 cmd/go/internal/test.(*runCache).builderRunTest(0xc000283f90, 0xc00062f180, 0xc0007fca00, 0x0, 0x0) 19:26:14 	/usr/local/go/src/cmd/go/internal/test/test.go:1167 +0xe0c 19:26:14 cmd/go/internal/test.(*runCache).builderRunTest-fm(0xc00062f180, 0xc0007fca00, 0x797973, 0xc00062f1f0) 19:26:14 	/usr/local/go/src/cmd/go/internal/test/test.go:907 +0x3e 19:26:14 cmd/go/internal/work.(*Builder).Do.func1(0xc0007fca00) 19:26:14 	/usr/local/go/src/cmd/go/internal/work/exec.go:107 +0x72 19:26:14 cmd/go/internal/work.(*Builder).Do.func2(0xc000898b30, 0xc00062f180, 0xc00077eaa0) 19:26:14 	/usr/local/go/src/cmd/go/internal/work/exec.go:165 +0xbb 19:26:14 created by cmd/go/internal/work.(*Builder).Do 19:26:14 	/usr/local/go/src/cmd/go/internal/work/exec.go:152 +0x36a 19:26:14  19:26:14 goroutine 308  chan receive, 3 minutes : 19:26:14 cmd/go/internal/base.processSignals.func1(0xc000364300) 19:26:14 	/usr/local/go/src/cmd/go/internal/base/signal.go:21 +0x34 19:26:14 created by cmd/go/internal/base.processSignals 19:26:14 	/usr/local/go/src/cmd/go/internal/base/signal.go:20 +0x93 19:26:14  19:26:14 goroutine 407  syscall, 3 minutes : 19:26:14 syscall.Syscall6(0xf7, 0x1, 0x4532, 0xc0011b45d8, 0x1000004, 0x0, 0x0, 0x2065687420666920, 0x79207463656a626f, 0x672065726120756f) 19:26:14 	/usr/local/go/src/syscall/asm_linux_amd64.s:44 +0x5 19:26:14 os.(*Process).blockUntilWaitable(0xc00117a840, 0x0, 0x0, 0x0) 19:26:14 	/usr/local/go/src/os/wait_waitid.go:31 +0x98 19:26:14 os.(*Process).wait(0xc00117a840, 0x0, 0x0, 0x0) 19:26:14 	/usr/local/go/src/os/exec_unix.go:22 +0x39 19:26:14 os.(*Process).Wait(0xc00117a840, 0x0, 0x0, 0x0) 19:26:14 	/usr/local/go/src/os/exec.go:125 +0x2b 19:26:14 os/exec.(*Cmd).Wait(0xc000369760, 0x0, 0x0) 19:26:14 	/usr/local/go/src/os/exec/exec.go:465 +0x5b 19:26:14 cmd/go/internal/test.(*runCache).builderRunTest.func1(0xc000628120, 0xc000369760) 19:26:14 	/usr/local/go/src/cmd/go/internal/test/test.go:1164 +0x2b 19:26:14 created by cmd/go/internal/test.(*runCache).builderRunTest 19:26:14 	/usr/local/go/src/cmd/go/internal/test/test.go:1163 +0xd68 19:26:14 Makefile:193: recipe for target 'unit-test' failed 19:26:14 make: ***  unit-test  Error 2 19:26:14 {code}  ></description> </Issue>
