<Action id="39966" issue="27512" author="ratnakar" type="comment" created="2018-02-09 22:44:48.0" updateauthor="ratnakar" updated="2018-02-09 22:44:48.0"> <body><! CDATA  ~jyellick  Thanks for providing the use case.  Here is my observation:  Tested using a channel deliver service client, details  here|https://github.com/hyperledger/fabric/tree/master/examples/events/eventsclient   *Testcase*:  _Network Topology_: 3 orgs (org1 , org2, org3) and each org has 2 peers in it.  Step 1 : Create a channel with all 3 org peers joined the channel using e2e_cli scripts Step 2: Channel deliver service client is connected to one of the peer (*peer0.org3.example.com*) of org3 Step 3 : Remove one of the org (*org3*) from the channel by config update.  Step 4:  Send few transactions on *org1* and *org2* and observe the client is still connected to the peer and listening for the blocks, however no new blocks are retrieved. Step 5: Disconnect the client on peer0 of org3 and connect it again. No error is observed,  however client could still retrieve old blocks but not the new blocks any more.  NOTE:   peer0 of org3 indicates that it receives a FORBIDDEN as a response from the orderer. {code} 2018-02-09 19:15:25.804 UTC  deliveryClient  StartDeliverForChannel -> DEBU 1619 This peer will pass blocks from orderer service to other peers for channel mychannel 2018-02-09 19:15:25.808 UTC  deliveryClient  connect -> DEBU 161a Connected to orderer.example.com:7050 2018-02-09 19:15:25.808 UTC  deliveryClient  connect -> DEBU 161b Establishing gRPC stream with orderer.example.com:7050 ... 2018-02-09 19:15:25.809 UTC  deliveryClient  afterConnect -> DEBU 161c Entering 2018-02-09 19:15:25.809 UTC  deliveryClient  RequestBlocks -> DEBU 161d Starting deliver with block  8  for channel mychannel 2018-02-09 19:15:25.809 UTC  deliveryClient  afterConnect -> DEBU 161e Exiting 2018-02-09 19:15:25.811 UTC  blocksProvider  DeliverBlocks -> ERRO 161f  mychannel  Got error &{FORBIDDEN} 2018-02-09 19:15:25.911 UTC  deliveryClient  Disconnect -> DEBU 1620 Entering 2018-02-09 19:15:25.911 UTC  ConnProducer  DisableEndpoint -> WARN 1621 Only 1 endpoint remained, will not black-list it {code}       ></body> </Action>
<Action id="39969" issue="27512" author="jyellick" type="comment" body="Can you confirm that when a client of org3 is connected to the deliver service on a peer of org2 or org1, that this deliver stream is broken?" created="2018-02-09 22:51:11.0" updateauthor="jyellick" updated="2018-02-09 22:51:11.0"/>
<Action id="39972" issue="27512" author="ratnakar" type="comment" created="2018-02-09 23:38:32.0" updateauthor="ratnakar" updated="2018-02-09 23:39:33.0"> <body><! CDATA There is no provision for me to connect to deliver service on a peer of org2 or org1, using org3 certs.   There is a cert validation happens and it throws the following error when client tries to connect other orgs peer  for example client of org1 tries to connect to org2, it throws the following error {code:java} 2018-02-09 18:35:19.885 EST  eventsclient  main -> INFO 001 Error connecting: failed to create new connection: x509: certificate is valid for peer1.org1.example.com, peer1, not peer0.org2.example.com {code}  ></body> </Action>
<Action id="40011" issue="27512" author="jyellick" type="comment" body="Ah, unfortunately, then the hack of simply removing the org may not be sufficient here.  I think you will need to revoke only the client certificate, so that the peer may continue to receive updated blocks, including the updated CRL." created="2018-02-12 05:34:58.0" updateauthor="jyellick" updated="2018-02-12 05:34:58.0"/>
<Action id="67231" issue="27512" author="sykesm" type="comment" body="Stale" created="2020-01-22 22:26:15.0" updateauthor="sykesm" updated="2020-01-22 22:26:15.0"/>
