<Issue id="36449" key="FAB-13471" number="13471" project="10002" reporter="raft 3" assignee="yacovm" creator="raft 3" type="10004" summary="Chaincode installation fails with timeout error" priority="2" resolution="10000" status="6" created="2019-01-02 15:56:09.0" updated="2019-12-23 16:33:40.0" resolutiondate="2019-01-22 15:37:34.0" votes="1" watches="12" workflowId="47982"> <description><! CDATA We run multiple chaincode upgrade processes in parallel for different chaincodes through a single CLI container in our CI/CD pipelines . Steps are as below:  {code:java} 1. Iterate through peers and install new version of chaincode 2. Upgrade chaincode on first peer 3. Iterate through peers and invoke chaincode 4. Iterate through peers and list installed and instantiated chaincode{code} Some peer(s) accept the *install* command without any error, but actually new version is neither installed nor instantiated.  After that point, any *install* command on that peer fails with timeout error. Also restarting the peer doesnt fix the issue.  Looks like this is not an actual timeout but something has stuck on *lscc* system chaincode on that peer. Installing chaincode on other peers completes almost instantly.  CLI command output: {code:java} root@2bc2a8ee383c:/# peer chaincode install -n pivt -v 1.1 -l node -p /opt/gopath/src/github.com/chaincode/pivt 2019-01-02 15:42:58.441 UTC  chaincodeCmd  checkChaincodeCmdParams -> INFO 001 Using default escc 2019-01-02 15:42:58.441 UTC  chaincodeCmd  checkChaincodeCmdParams -> INFO 002 Using default vscc 2019-01-02 15:43:28.445 UTC  chaincodeCmd  install -> INFO 003 Installed remotely response:<status:500 message:"failed to execute transaction dd8b66c50d4c33b528b5ca36f2f47a90da3e630ff5089bd7e902ffffd0167b73: error sending: timeout expired while executing transaction" >{code} Peer logs: {code:java} 2019-01-02 15:42:58.444 UTC  endorser  callChaincode -> INFO 080    dd8b66c5  Entry chaincode: name:"lscc" 2019-01-02 15:43:28.444 UTC  endorser  callChaincode -> INFO 081    dd8b66c5  Exit chaincode: name:"lscc"  (30000ms) 2019-01-02 15:43:28.445 UTC  endorser  SimulateProposal -> ERRO 082    dd8b66c5  failed to invoke chaincode name:"lscc" , error: timeout expired while executing transaction github.com/hyperledger/fabric/core/chaincode.(*Handler).Execute /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/handler.go:1129 github.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).execute /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:304 github.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).Invoke /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:293 github.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).Execute /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:230 github.com/hyperledger/fabric/core/endorser.(*SupportImpl).Execute /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/support.go:147 github.com/hyperledger/fabric/core/endorser.(*Endorser).callChaincode /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:142 github.com/hyperledger/fabric/core/endorser.(*Endorser).SimulateProposal /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:237 github.com/hyperledger/fabric/core/endorser.(*Endorser).ProcessProposal /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:456 github.com/hyperledger/fabric/core/handlers/auth/filter.(*expirationCheckFilter).ProcessProposal /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/expiration.go:61 github.com/hyperledger/fabric/core/handlers/auth/filter.(*filter).ProcessProposal /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/filter.go:32 github.com/hyperledger/fabric/protos/peer._Endorser_ProcessProposal_Handler /opt/gopath/src/github.com/hyperledger/fabric/protos/peer/peer.pb.go:162 github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).processUnaryRPC /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1011 github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).handleStream /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1249 github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1 /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:680 runtime.goexit /opt/go/src/runtime/asm_amd64.s:2361 error sending failed to execute transaction dd8b66c50d4c33b528b5ca36f2f47a90da3e630ff5089bd7e902ffffd0167b73 github.com/hyperledger/fabric/core/chaincode.processChaincodeExecutionResult /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:236 github.com/hyperledger/fabric/core/chaincode.(*ChaincodeSupport).Execute /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/chaincode_support.go:231 github.com/hyperledger/fabric/core/endorser.(*SupportImpl).Execute /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/support.go:147 github.com/hyperledger/fabric/core/endorser.(*Endorser).callChaincode /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:142 github.com/hyperledger/fabric/core/endorser.(*Endorser).SimulateProposal /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:237 github.com/hyperledger/fabric/core/endorser.(*Endorser).ProcessProposal /opt/gopath/src/github.com/hyperledger/fabric/core/endorser/endorser.go:456 github.com/hyperledger/fabric/core/handlers/auth/filter.(*expirationCheckFilter).ProcessProposal /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/expiration.go:61 github.com/hyperledger/fabric/core/handlers/auth/filter.(*filter).ProcessProposal /opt/gopath/src/github.com/hyperledger/fabric/core/handlers/auth/filter/filter.go:32 github.com/hyperledger/fabric/protos/peer._Endorser_ProcessProposal_Handler /opt/gopath/src/github.com/hyperledger/fabric/protos/peer/peer.pb.go:162 github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).processUnaryRPC /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1011 github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).handleStream /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1249 github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1 /opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:680 runtime.goexit /opt/go/src/runtime/asm_amd64.s:2361 {code}  ></description> </Issue>
