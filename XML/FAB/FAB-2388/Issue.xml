<Issue id="14951" key="FAB-2388" number="2388" project="10002" reporter="adnanchoudhury" assignee="adnanchoudhury" creator="adnanchoudhury" type="10001" summary="CouchDB unit-tests fail intermittently" priority="3" resolution="10000" status="6" created="2017-02-20 19:25:43.0" updated="2018-07-20 18:55:15.0" resolutiondate="2017-02-28 19:41:58.0" votes="0" watches="1" workflowId="37548"> <description><! CDATA If the couchDB unit tests are enabled, it has been observed that the test intermittently fails with the following errors: {code} 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Entering handleRequest()  method=PUT  url=http://couchdb:5984/couch_util_testdb 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 HTTP Request: PUT /couch_util_testdb HTTP/1.1 10:17:25  32munit-tests_1  | 0m Host: couchdb:5984 10:17:25  32munit-tests_1  | 0m User-Agent: Go-http-client/1.1 10:17:25  32munit-tests_1  | 0m Content-Length: 0 10:17:25  32munit-tests_1  | 0m Accept: application/json 10:17:25  32munit-tests_1  | 0m Content-Type: application/json 10:17:25  32munit-tests_1  | 0m Accept-Encoding: gzip 10:17:25  32munit-tests_1  | 0m  10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Exiting handleRequest() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Created database couch_util_testdb  10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Exiting CreateDatabaseIfNotExist() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Entering DropDatabase() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Entering handleRequest()  method=DELETE  url=http://couchdb:5984/couch_util_testdb 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 HTTP Request: DELETE /couch_util_testdb HTTP/1.1 10:17:25  32munit-tests_1  | 0m Host: couchdb:5984 10:17:25  32munit-tests_1  | 0m User-Agent: Go-http-client/1.1 10:17:25  32munit-tests_1  | 0m Content-Type: application/json 10:17:25  32munit-tests_1  | 0m Accept-Encoding: gzip 10:17:25  32munit-tests_1  | 0m  10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Exiting handleRequest() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Dropped database couch_util_testdb  10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Exiting DropDatabase() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Entering CreateConnectionDefinition() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Created database configuration  URL= http://couchdb:5984  10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Exiting CreateConnectionDefinition() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Entering CreateDatabaseIfNotExist() 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Entering handleRequest()  method=GET  url=http://couchdb:5984/couch_util_testdb 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 HTTP Request: GET /couch_util_testdb HTTP/1.1 10:17:25  32munit-tests_1  | 0m Host: couchdb:5984 10:17:25  32munit-tests_1  | 0m User-Agent: Go-http-client/1.1 10:17:25  32munit-tests_1  | 0m Accept: multipart/related 10:17:25  32munit-tests_1  | 0m Accept-Encoding: gzip 10:17:25  32munit-tests_1  | 0m  10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Couch DB error  status code=500  error={"error":"internal_server_error","reason":"No DB shards could be opened.","ref":2413987899} 10:17:25  32munit-tests_1  | 0m 2017/02/20 10:17:25 Error during CouchDB CreateDatabaseIfNotExist() for dbName: couch_util_testdb  error: Couch DB Error: No DB shards could be opened. {code}  To reproduce: 1. Run "couchdb start" from inside fabric to spin up CouchDB container. 2. from fabric/core/util/couchdb, run "go test ./..."  Observation:  1) Reporter was able to reproduce it at least once in approximately 10 runs in local X86 machine. 2) The error occurs in different places in different runs. 3) Z machine report to be updated.   ></description> </Issue>
