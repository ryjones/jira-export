<Action id="53446" issue="35347" author="scottz" type="comment" created="2018-11-14 17:37:58.0" updateauthor="scottz" updated="2018-11-14 17:37:58.0"> <body><! CDATA It is interesting that 8200 had failures, but 8201 all passed, even though they are very similar, simply using different API calls for the same data sets. Even though 8201 passed, the queries were very slow (2 tps avg). This is probably because we do not use indexing on all these queries. Other things in the host CI VM probably caused the slowness; we have seen intermittent unexplained slowdowns before. For the purposes of this test, to avoid timeouts, we should consider changing this testcase to use indexes which would make the rich queries faster. To do this, we could essentially change 8192 to FAB-6813.  More details about this set of 4 testcases, seen in the PTE_Test_Logs and the console logs: {{Description: Launch standard network with couchdb using 1 channel and marbles02 cc. FAB-8192-4i: 4 threads x 1000 invokes (initMarble) followed by three sets of queries: FAB-8199-4q: 4 threads queries: readMarble FAB-8200-4q: 4 threads rich queries: queryMarblesByOwner FAB-8201-4q: 4 threads rich queries: queryMarbles}}  * 8192 send 4000 invoke TXs - PASSED * 8199 simple queries of all transactions - PASSED * 8200 rich queries of all transactions - 114 FAILED (all TIMEOUTs 45 secs, shown in PTE logs), only 1.52 TPS * 8201 rich queries of all transactions - PASSED, 4.96 TPS  I see many errors in the logs like this: {{ 32minfo 39m:  PTE 0 main : stderr: 2018-11-14T03:58:29.512Z -  31merror 39m:  Peer.js : sendProposal - timed out after:45000   32minfo 39m:  PTE 0 main : stdout:  32minfo 39m:  PTE 0 exec :  Nid:chan:org:id=0:testorgschannel1:org1:0 queryValidation  query return: Error: REQUEST_TIMEOUT   32minfo 39m:  PTE 0 main : stdout:  32minfo 39m:  PTE 0 exec :  Nid:chan:org:id=0:testorgschannel1:org2:0 queryValidation  query return: Error: failed to execute transaction 25e044a2501a48e80d876b6684b7b71daf3f371a65e31714daca95455e46017b: error sending: timeout expired while executing transaction }}  Test summaries for 8200 and 8201:  {{PTE testcase: FAB-8200-4q (FAILURES) ======= PTE 0 main Test Summary: executed at Wed Nov 14 2018 03:25:15 GMT+0000 (UTC) ======= (testorgschannel1:marbles02_go_ch1): CONSTANT QUERY transaction stats (testorgschannel1:marbles02_go_ch1):	Total processes 2 (testorgschannel1:marbles02_go_ch1):	Total transactions sent 2000  received 2000 (testorgschannel1:marbles02_go_ch1):	failures: query transactions 61 (testorgschannel1:marbles02_go_ch1):	start 1542165930882  end 1542168475292  duration 2544410 ms  (testorgschannel1:marbles02_go_ch1):	TPS 0.76  ======= PTE 1 main Test Summary: executed at Wed Nov 14 2018 03:25:15 GMT+0000 (UTC) ======= (testorgschannel2:marbles02_go_ch2): CONSTANT QUERY transaction stats (testorgschannel2:marbles02_go_ch2):	Total processes 2 (testorgschannel2:marbles02_go_ch2):	Total transactions sent 2000  received 2000 (testorgschannel2:marbles02_go_ch2):	failures: query transactions 53 (testorgschannel2:marbles02_go_ch2):	start 1542165930896  end 1542168483584  duration 2552688 ms  (testorgschannel2:marbles02_go_ch2):	TPS 0.76  =======  CONSTANT QUERY Overall Performance Summary  ======= CONSTANT QUERY Overall number of PTE: 2 CONSTANT QUERY Overall processes: 4 CONSTANT QUERY Overall transactions: sent 4000 received 4000 failures 114 CONSTANT QUERY Overall time: start 1542165930882 end 1542168483584 duration 2552702 CONSTANT QUERY Overall CONSTANT QUERY TPS 1.52 CONSTANT QUERY Overall TEST RESULTS FAILED}} Â  {{PTE testcase: FAB-8201-4q (PASSED) ======= PTE 0 main Test Summary: executed at Wed Nov 14 2018 04:12:06 GMT+0000 (UTC) ======= (testorgschannel1:marbles02_go_ch1): CONSTANT QUERY transaction stats (testorgschannel1:marbles02_go_ch1):	Total processes 2 (testorgschannel1:marbles02_go_ch1):	Total transactions sent 2000  received 2000 (testorgschannel1:marbles02_go_ch1):	failures: query transactions 0 (testorgschannel1:marbles02_go_ch1):	start 1542168741836  end 1542169548108  duration 806272 ms  (testorgschannel1:marbles02_go_ch1):	TPS 2.48  ======= PTE 1 main Test Summary: executed at Wed Nov 14 2018 04:12:06 GMT+0000 (UTC) ======= (testorgschannel2:marbles02_go_ch2): CONSTANT QUERY transaction stats (testorgschannel2:marbles02_go_ch2):	Total processes 2 (testorgschannel2:marbles02_go_ch2):	Total transactions sent 2000  received 2000 (testorgschannel2:marbles02_go_ch2):	failures: query transactions 0 (testorgschannel2:marbles02_go_ch2):	start 1542168741836  end 1542169548653  duration 806817 ms  (testorgschannel2:marbles02_go_ch2):	TPS 2.48  =======  CONSTANT QUERY Overall Performance Summary  ======= CONSTANT QUERY Overall number of PTE: 2 CONSTANT QUERY Overall processes: 4 CONSTANT QUERY Overall transactions: sent 4000 received 4000 failures 0 CONSTANT QUERY Overall time: start 1542168741836 end 1542169548653 duration 806817 CONSTANT QUERY Overall CONSTANT QUERY TPS 4.96 CONSTANT QUERY Overall TEST RESULTS PASSED}}  ></body> </Action>
