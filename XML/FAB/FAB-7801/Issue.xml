<Issue id="26927" key="FAB-7801" number="7801" project="10002" reporter="mffrench" creator="mffrench" type="10004" summary="Peer chain can&apos;t restart due to some configuration block issue" priority="4" resolution="10203" status="6" created="2018-01-18 06:02:14.0" updated="2018-12-01 11:33:29.0" resolutiondate="2018-12-01 11:33:29.0" votes="0" watches="6" workflowId="43051"> <description><! CDATA    Hi,  after the patch campaign on our Hyperledger Fabric cluster, all the VMs of the cluster has been restarted.   After restart, all the containers were stopped an so we restarted the all stack :  * \{Hyperledger Fabric CA and Orderer Solo} on a dedicated consortium VM, * \{HF Peers, CouchDB and application} on 3 other network participant VMs.   At this first restart everything was looking OK but there was a lot of logs history and so to troubleshoot easily another application issue on a a dedicated participan VMs, we decided to restart again the docker stack but this time by removing and recreating the docker containers to remove the past log (*).   Unfortunately when restarting the Hyperledger stack on this particular node we hit an issue on one of our peers which prevent us to restart our chain on this peer and particularly read the MSP from the configuration block (see logs bellow).   I'm currently looking some way to restart the peer and I see one by removing the peer data and resync the empty peer with the two other still running on our network. Do you see other cheaper way ? Do you have some advice to help us ? And finally do you have some idea on what could be the root cause of this issue ?   Thank you {code:java} 2017-06-19 23:26:01.361 UTC  ledgermgmt  OpenLedger -> INFO 1c9 Opened ledger with id = elixir-channel 2017-06-19 23:26:01.361 UTC  peer  getCurrConfigBlockFromLedger -> DEBU 1ca Getting config block 2017-06-19 23:26:01.361 UTC  fsblkstorage  retrieveBlockByNumber -> DEBU 1cb retrieveBlockByNumber() - blockNum =  26858  2017-06-19 23:26:01.361 UTC  fsblkstorage  newBlockfileStream -> DEBU 1cc newBlockfileStream(): filePath= /var/hyperledger/production/ledgersData/chains/chains/elixir-channel/blockfile_001449 , startOffset= 10192565  2017-06-19 23:26:01.361 UTC  fsblkstorage  nextBlockBytesAndPlacementInfo -> DEBU 1cd Remaining bytes= 5377 , Going to peek  8  bytes 2017-06-19 23:26:01.361 UTC  fsblkstorage  nextBlockBytesAndPlacementInfo -> DEBU 1ce Returning blockbytes - length= 5375 , placementInfo={fileNum= 1449 , startOffset= 10192565 , bytesOffset= 10192567 } 2017-06-19 23:26:01.361 UTC  fsblkstorage  retrieveBlockByNumber -> DEBU 1cf retrieveBlockByNumber() - blockNum =  26847  2017-06-19 23:26:01.361 UTC  fsblkstorage  newBlockfileStream -> DEBU 1d0 newBlockfileStream(): filePath= /var/hyperledger/production/ledgersData/chains/chains/elixir-channel/blockfile_001449 , startOffset= 10025675  2017-06-19 23:26:01.362 UTC  fsblkstorage  nextBlockBytesAndPlacementInfo -> DEBU 1d1 Remaining bytes= 172267 , Going to peek  8  bytes 2017-06-19 23:26:01.362 UTC  fsblkstorage  nextBlockBytesAndPlacementInfo -> DEBU 1d2 Returning blockbytes - length= 5546 , placementInfo={fileNum= 1449 , startOffset= 10025675 , bytesOffset= 10025677 } 2017-06-19 23:26:01.362 UTC  peer  getCurrConfigBlockFromLedger -> DEBU 1d3 Got config block 26847  2017-06-19 23:26:01.362 UTC  common/config  NewStandardValues -> DEBU 1d4 Initializing protos for *config.ChannelProtos 2017-06-19 23:26:01.362 UTC  common/config  initializeProtosStruct -> DEBU 1d5 Processing field: HashingAlgorithm 2017-06-19 23:26:01.363 UTC  common/config  initializeProtosStruct -> DEBU 1d6 Processing field: BlockDataHashingStructure 2017-06-19 23:26:01.363 UTC  common/config  initializeProtosStruct -> DEBU 1d7 Processing field: OrdererAddresses 2017-06-19 23:26:01.363 UTC  common/config  initializeProtosStruct -> DEBU 1d8 Processing field: Consortium 2017-06-19 23:26:01.363 UTC  peer  Initialize -> WARN 1d9 Failed to load chain elixir-channel(Bad envelope: Not a tx of type CONFIG) {code} (*) : peers data and conf are configured to be on the host  through dedicated volume ; this procedure has been used a lot of time last years (at least 48 time as we did 48 chaincode upgrade).     ></description> </Issue>
