<Issue id="34926" key="FAB-12628" number="12628" project="10002" reporter="nileshdeotale" assignee="dongming" creator="nileshdeotale" type="10004" summary="./runPTE.sh failed -  E1026 14:32:27.058292607   28985 ssl_transport_security.cc:989  Handshake failed with fatal error SSL_ERROR_SSL: error:14094418:SSL routines:ssl3_read_bytes:tlsv1 alert unknown ca." priority="2" resolution="10201" status="6" created="2018-10-26 19:32:52.0" updated="2018-10-29 21:08:55.0" resolutiondate="2018-10-29 21:08:55.0" votes="0" watches="1" workflowId="46354"> <description><! CDATA ```clc@clc-ThinkPad-T470p:~/Workplace/Lab/fabric-test/tools/networktest$  ./runPTE.sh --dir connectionprofile -t FAB-3808-2i```clc@clc-ThinkPad-T470p:~/Workplace/Lab/fabric-test/tools/networktest$  ./runPTE.sh --dir connectionprofile -t FAB-3808-2i - Specify ConnProfDir: connectionprofile - Specify TestCases: FAB-3808-2i ./runPTE.sh  starts at Fri Oct 26 14:31:49 EDT 2018 test setupCWD: /home/clc/Workplace/Lab/fabric-test/tools/networktestPTEDir: /home/clc/Workplace/Lab/fabric-test/tools/networktest/../PTELOGSDir: /home/clc/Workplace/Lab/fabric-test/tools/networktest/Logsnpm installation: yesTestCases: FAB-3808-2ichaincode installation/instantiation: yesconnection profile dir: connectionprofileuse default channel: defaultchanneluse default org list: org1 org2Channel: defaultchannelOrganizations: org1 org2           *****************************************************************************          *                              NPM installation                             *          *****************************************************************************  > dtrace-provider@0.8.7 install /home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/dtrace-provider> node-gyp rebuild || node suppress-error.js make: Entering directory '/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/dtrace-provider/build'  TOUCH Release/obj.target/DTraceProviderStub.stampmake: Leaving directory '/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/dtrace-provider/build' > pkcs11js@1.0.16 install /home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/pkcs11js> node-gyp rebuild make: Entering directory '/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/pkcs11js/build'  CXX(target) Release/obj.target/pkcs11/src/main.o  CXX(target) Release/obj.target/pkcs11/src/dl.o  CXX(target) Release/obj.target/pkcs11/src/const.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/error.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/v8_convert.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/template.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/mech.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/param.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/param_aes.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/param_rsa.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/param_ecdh.o  CXX(target) Release/obj.target/pkcs11/src/pkcs11/pkcs11.o  CXX(target) Release/obj.target/pkcs11/src/async.o  CXX(target) Release/obj.target/pkcs11/src/node.o  SOLINK_MODULE(target) Release/obj.target/pkcs11.node  COPY Release/pkcs11.nodemake: Leaving directory '/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/pkcs11js/build' > grpc@1.10.1 install /home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/grpc> node-pre-gyp install --fallback-to-build --library=static_library  grpc  Success: "/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/grpc/src/node/extension_binary/node-v57-linux-x64-glibc/grpc_node.node" is installed via remotenpm notice created a lockfile as package-lock.json. You should commit this file.npm WARN PTE@1.0.0 No repository field. added 310 packages from 319 contributors and audited 786 packages in 34.98sfound 2 vulnerabilities (1 low, 1 moderate)  run `npm audit fix` to fix them, or `npm audit` for detailsPTE@1.0.0 /home/clc/Workplace/Lab/fabric-test/tools/PTE├─┬ fabric-ca-client@1.2.0└─┬ fabric-client@1.2.0           *****************************************************************************          *                       connection profile conversion                       *          ***************************************************************************** Successfully wrote PTE configuration file to /home/clc/Workplace/Lab/fabric-test/tools/PTE/cprof-convert/pte-config.json testPreProc  executes test pre-process: testcase FAB-3808-2i, chaincode samplecc testPreProc  replace testorgschannel1 with defaultchannel testPreProc  replace org1 with org1 testPreProc  replace org2 with org2 ccProc  executes test chaincode process: FAB-3808-2i samplecc ccProc  ./pte_driver.sh CITest/FAB-3808-2i/preconfig/samplecc/runCases-samplecc-install-TLS.txt./pte_driver.sh inFile= CITest/FAB-3808-2i/preconfig/samplecc/runCases-samplecc-install-TLS.txt, tStart=0 iPTE=0 sdk type supported: sdk=nodesdk type supported: sdk=nodeNode Array: CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-install1-TLS.json CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-install2-TLS.jsonexecuting 2 node requestsiPTE: 0, nInstances: 2, tStart: 1540578763480execution: CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-install1-TLS.jsonexecution: CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-install2-TLS.jsonno python requestsno java requestsinfo:  PTE 0 main : input parameters: Nid=1, uiFile=CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-install2-TLS.json, tStart=1540578763480 PTEid=0info:  PTE 0 util :  setTLS  TLSin: ENABLED, TLS: 1info:  PTE 0 main :  Nid=1 pte-main  TLS= 1info:  PTE 0 main : channelName: defaultchannelinfo:  PTE 0 main : channelOrgName.length: 1, channelOrgName: org2info:  PTE 0 main : svcFile;  CITest/CISCFiles/config-chan1-TLS.jsoninfo:  PTE 0 main : GOPATH: info:  PTE 0 main : main - cfgTimeout: 200000info:  PTE 0 main :  performance_main  org= org2, org Name= org2info:  PTE 0 main : chaincode language: golang, path: github.com/hyperledger/fabric-test/chaincodes/samplecc/goinfo:  PTE 0 main :  performance_main  Deploy: user= admin, secret= f6b6c99a9binfo:  PTE 0 util :  >>>> getting the org admininfo:  PTE 0 main : input parameters: Nid=0, uiFile=CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-install1-TLS.json, tStart=1540578763480 PTEid=0info:  PTE 0 util :  org2 admin_cert definedinfo:  PTE 0 util :  setTLS  TLSin: ENABLED, TLS: 1info:  PTE 0 main :  Nid=0 pte-main  TLS= 1info:  PTE 0 main : channelName: defaultchannelinfo:  PTE 0 main : channelOrgName.length: 1, channelOrgName: org1info:  PTE 0 main : svcFile;  CITest/CISCFiles/config-chan1-TLS.jsoninfo:  PTE 0 main : GOPATH: info:  PTE 0 main : main - cfgTimeout: 200000info:  PTE 0 main :  performance_main  org= org1, org Name= org1info:  PTE 0 main : chaincode language: golang, path: github.com/hyperledger/fabric-test/chaincodes/samplecc/goinfo:  PTE 0 main :  performance_main  Deploy: user= admin, secret= 918d039508info:  PTE 0 util :  >>>> getting the org admininfo:  PTE 0 util :  org1 admin_cert definedinfo:  PTE 0 main :  performance_main:Nid=1  Successfully enrolled user 'admin'info:  PTE 0 main :  chaincodeInstall  org: org2, org Name: org2, channel name: defaultchannelinfo:  PTE 0 main :  chainAddOrderer  channel name:  defaultchannelinfo:  PTE 0 util :  getTLSCert  key: orderer, subkey: ordererinfo:  PTE 0 main :  performance_main:Nid=0  Successfully enrolled user 'admin'info:  PTE 0 main :  chaincodeInstall  org: org1, org Name: org1, channel name: defaultchannelinfo:  PTE 0 main :  chainAddOrderer  channel name:  defaultchannelinfo:  PTE 0 util :  getTLSCert  key: orderer, subkey: ordererinfo:  PTE 0 main :  channelAddPeer  channel name:  defaultchannelinfo:  PTE 0 util :  getTLSCert  key: org1, subkey: org1-peer1info:  PTE 0 main :  getCCID  Nid: 0, chaincode_id: sample_cc_ch1, chaincode_ver: v0info:  PTE 0 main :  channelAddPeer  channel name:  defaultchannelinfo:  PTE 0 util :  getTLSCert  key: org2, subkey: org2-peer1info:  PTE 0 main :  getCCID  Nid: 1, chaincode_id: sample_cc_ch1, chaincode_ver: v0error:  PTE 0 main :  chaincodeInstall  Failed to install chaincode in (defaultchannel:org1) due to error:  message=Path must be a string. Received undefined, stack=TypeError: Path must be a string. Received undefined    at assertPath (path.js:28:11)    at Object.join (path.js:1236:7)    at GolangPackager.package (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/packager/Golang.js:34:22)    at /home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Packager.js:59:33    at new Promise (<anonymous>)    at Object.module.exports.package (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Packager.js:32:9)    at _getChaincodePackageData (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Client.js:1851:42)    at Client.installChaincode (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Client.js:1080:10)    at chaincodeInstall (/home/clc/Workplace/Lab/fabric-test/tools/PTE/pte-main.js:531:12)    at /home/clc/Workplace/Lab/fabric-test/tools/PTE/pte-main.js:1220:25error:  PTE 0 main :  chaincodeInstall  Failed to install chaincode in (defaultchannel:org2) due to error:  message=Path must be a string. Received undefined, stack=TypeError: Path must be a string. Received undefined    at assertPath (path.js:28:11)    at Object.join (path.js:1236:7)    at GolangPackager.package (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/packager/Golang.js:34:22)    at /home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Packager.js:59:33    at new Promise (<anonymous>)    at Object.module.exports.package (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Packager.js:32:9)    at _getChaincodePackageData (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Client.js:1851:42)    at Client.installChaincode (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Client.js:1080:10)    at chaincodeInstall (/home/clc/Workplace/Lab/fabric-test/tools/PTE/pte-main.js:531:12)    at /home/clc/Workplace/Lab/fabric-test/tools/PTE/pte-main.js:1220:25 ccProc  instantiate chaincode: samplecc ccProc  ./pte_driver.sh CITest/FAB-3808-2i/preconfig/samplecc/runCases-samplecc-instantiate-TLS.txt./pte_driver.sh inFile= CITest/FAB-3808-2i/preconfig/samplecc/runCases-samplecc-instantiate-TLS.txt, tStart=0 iPTE=0 sdk type supported: sdk=nodeNode Array: CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-instantiate-TLS.jsonexecuting 1 node requestsiPTE: 0, nInstances: 1, tStart: 1540578760167execution: CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-instantiate-TLS.jsonno python requestsno java requestsinfo:  PTE 0 main : input parameters: Nid=0, uiFile=CITest/FAB-3808-2i/preconfig/samplecc/samplecc-chan1-instantiate-TLS.json, tStart=1540578760167 PTEid=0info:  PTE 0 util :  setTLS  TLSin: ENABLED, TLS: 1info:  PTE 0 main :  Nid=0 pte-main  TLS= 1info:  PTE 0 main : channelName: defaultchannelinfo:  PTE 0 main : channelOrgName.length: 1, channelOrgName: org1info:  PTE 0 main : svcFile;  CITest/CISCFiles/config-chan1-TLS.jsoninfo:  PTE 0 main : GOPATH: info:  PTE 0 main : main - cfgTimeout: 200000info:  PTE 0 main :  performance_main  org= org1, org Name= org1info:  PTE 0 main : chaincode language: golang, path: github.com/hyperledger/fabric-test/chaincodes/samplecc/goinfo:  PTE 0 main :  performance_main  instantiate: user= admin, secret= 918d039508info:  PTE 0 util :  >>>> getting the org admininfo:  PTE 0 util :  org1 admin_cert definedinfo:  PTE 0 main :  performance_main:Nid=0  Successfully enrolled user 'admin'info:  PTE 0 main :  chaincodeInstantiate  org= org1, org name=undefined, channel name=defaultchannelinfo:  PTE 0 main :  chainAddOrderer  channel name:  defaultchannelinfo:  PTE 0 util :  getTLSCert  key: orderer, subkey: ordererinfo:  PTE 0 main :  channelAddPeer1  channel name: defaultchannel, org: org1info:  PTE 0 util :  getTLSCert  key: org1, subkey: org1-peer1info:  PTE 0 main :  chaincodeInstantiate:Nid=0  ready to initialize channel defaultchannel E1026 14:32:27.058221748   28985 ssl_transport_security.cc:188  ssl_info_callback: error occured. E1026 14:32:27.058292607   28985 ssl_transport_security.cc:989  Handshake failed with fatal error SSL_ERROR_SSL: error:14094418:SSL routines:ssl3_read_bytes:tlsv1 alert unknown ca.E1026 14:32:28.050291527   28985 ssl_transport_security.cc:188  ssl_info_callback: error occured. E1026 14:32:28.050349492   28985 ssl_transport_security.cc:989  Handshake failed with fatal error SSL_ERROR_SSL: error:14094418:SSL routines:ssl3_read_bytes:tlsv1 alert unknown ca.E1026 14:32:29.361334446   28985 ssl_transport_security.cc:188  ssl_info_callback: error occured. E1026 14:32:29.361400914   28985 ssl_transport_security.cc:989  Handshake failed with fatal error SSL_ERROR_SSL: error:14094418:SSL routines:ssl3_read_bytes:tlsv1 alert unknown ca.error:  Remote.js : Error: Failed to connect before the deadlineerror:  client-utils.js : sendPeersProposal - Promise is rejected: Error: Failed to connect before the deadline    at checkState (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/grpc/src/client.js:838:16)error:  Channel.js : getChannelConfig - Failed getting channel config. Error: Error: Failed to connect before the deadline    at checkState (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/grpc/src/client.js:838:16)error:  Channel.js : Error: Failed to connect before the deadline    at checkState (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/grpc/src/client.js:838:16)error:  PTE 0 main :  chaincodeInstantiate:Nid=0  Failed to initialize channel defaultchannel  due to error:  Error: Error: Failed to connect before the deadline    at getChannelConfig.then.catch (/home/clc/Workplace/Lab/fabric-test/tools/PTE/node_modules/fabric-client/lib/Channel.js:356:27)    at <anonymous>    at process._tickCallback (internal/process/next_tick.js:189:7)           *****************************************************************************          *                  executing priming: FAB-query-TLS/samplecc                            *          *****************************************************************************  testPreProc  executes test pre-process: testcase FAB-query-TLS, chaincode samplecc testPreProc  replace testorgschannel1 with defaultchannel testPreProc  replace org1 with org1 testPreProc  replace org2 with org2 restoreCITestcase  restore testcase FAB-query-TLS           *****************************************************************************          *                  executing testcase: FAB-3808-2i                            *          *****************************************************************************         ```     Collapse JumpMark as read (esc)Message Input Message @Dongming Hwang Mr About this conversation Dongming Hwang Mr dmingTime zone 3:30 PM local time  ></description> </Issue>
