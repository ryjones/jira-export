<Issue id="39695" key="FAB-15380" number="15380" project="10002" reporter="bharadwajambati1" creator="bharadwajambati1" type="10004" summary="Failing daily test cases in chaincode.feature from fabric-test repo" priority="3" resolution="10001" status="6" created="2019-05-07 15:25:15.0" updated="2019-07-30 00:55:22.0" resolutiondate="2019-07-30 00:55:22.0" votes="0" watches="2" workflowId="52580"> <description><! CDATA There are three test scenarios in chaincode.feature from fabric-test repo that are failing a query while running the svt-daily-behave-tests, with the error: `Failed to get state for marble1`. These tests should be first disabled from the daily test suite ( https://gerrit.hyperledger.org/r/#/c/31263/ ) and then reenabled later after they are fixed.  *Scenario: FAB-3888: State Transfer Test, bouncing a non-leader peer, using marbles02, for solo orderer* {code:java} 01:51:26     Then a user receives a success response of {"docType":"marble","name":"marble1","color":"red","size":35,"owner":"tom"}                                               # steps/endorser_impl.py:1183 01:51:26       Assertion Failed: Expected response was {"docType":"marble","name":"marble1","color":"red","size":35,"owner":"tom"}; received Error occurred  'docker exec peer0.org1.example.com sh -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/fcd37b18708b11e9a81afa163eec12f5/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp CORE_PEER_LOCALMSPID=org1.example.com CORE_PEER_ID=peer0.org1.example.com CORE_PEER_ADDRESS=peer0.org1.example.com:7051 peer chaincode query --name mycc --ctor \'{\\"Args\\":  \\"readMarble\\",\\"marble1\\" }\' --channelID behavesystest "' : Error: endorsement failure during query. response: status:500 message:"{\"Error\":\"Failed to get state for marble1\"}" {code} *Scenario: FAB-6256: Test support of rich queries in SHIM API: queryMarbles and queryMarblesByOwner using marbles chaincode on couchdb* {code:java} 02:57:41     When a user invokes on the chaincode with args  "initMarble","marble2","red","50","tom"                                                               # steps/endorser_impl.py:678 02:57:42     And I wait "3" seconds                                                                                                                                # steps/basic_impl.py:24 02:57:45     When a user queries on the chaincode with args  "readMarble","marble1"                                                                                # steps/endorser_impl.py:550 02:57:49     Then a user receives a response containing "name":"marble1"                                                                                           # steps/endorser_impl.py:1228 02:57:49       Assertion Failed: Expected response was "name":"marble1"; received Error occurred  'docker exec peer0.org1.example.com sh -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/3ab4ce88709511e9833cfa163e6920e2/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp CORE_PEER_LOCALMSPID=org1.example.com CORE_PEER_ID=peer0.org1.example.com CORE_PEER_ADDRESS=peer0.org1.example.com:7051 peer chaincode query --name mycc --ctor \'{\\"Args\\":  \\"readMarble\\",\\"marble1\\" }\' --channelID behavesystest "' : Error: endorsement failure during query. response: status:500 message:"{\"Error\":\"Failed to get state for marble1\"}"  02:57:49       {code} *Scenario: FAB-5791: Test API in SHIM interface using marbles02 and shimApiDriver chaincodes for solo orderer leveldb db GOLANG lang* {code:java} 03:19:57     When a user invokes on the chaincode named "mycc" with args  "initMarble","marble111","pink","55","jane"                                                             # steps/endorser_impl.py:702 03:19:59     And I wait "5" seconds                                                                                                                                               # steps/basic_impl.py:24 03:20:04     When a user queries on the chaincode named "mycc" with args  "readMarble","marble1"                                                                                  # steps/endorser_impl.py:510 03:20:07     Then a user receives a response containing "docType":"marble"                                                                                                        # steps/endorser_impl.py:1228 03:20:07       Assertion Failed: Expected response was "docType":"marble"; received Error occurred  'docker exec peer0.org1.example.com sh -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/44a630c8709811e9bc26fa163ee587e3/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp CORE_PEER_LOCALMSPID=org1.example.com CORE_PEER_ID=peer0.org1.example.com CORE_PEER_ADDRESS=peer0.org1.example.com:7051 peer chaincode query --name mycc --ctor \'{\\"Args\\":  \\"readMarble\\",\\"marble1\\" }\' --channelID behavesystest "' : Error: endorsement failure during query. response: status:500 message:"{\"Error\":\"Failed to get state for marble1\"}"  03:20:07        03:20:07       Captured stdout: 03:20:07       test 44a630c8709811e9bc26fa163ee587e3 already exists!!! {code} At the end of each test scenarios, found IOError:  Errno 11  Resource temporarily unavailable {code:java} Skipping.  stat /var/hyperledger/configs/44a630c8709811e9bc26fa163ee587e3/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp/tlsintException IOError:  Errno 11  Resource temporarily unavailable 03:20:07 Traceback (most recent call last): 03:20:07   File "/usr/local/bin/behave", line 11, in <module> 03:20:07     sys.exit(main()) 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/__main__.py", line 183, in main 03:20:07     return run_behave(config) 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/__main__.py", line 127, in run_behave 03:20:07     failed = runner.run() 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/runner.py", line 804, in run 03:20:07     return self.run_with_paths() 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/runner.py", line 824, in run_with_paths 03:20:07     return self.run_model() 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/runner.py", line 626, in run_model 03:20:07     failed = feature.run(self) 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/model.py", line 321, in run 03:20:07     failed = scenario.run(runner) 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/model.py", line 1114, in run 03:20:07     failed = scenario.run(runner) 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/model.py", line 711, in run 03:20:07     if not step.run(runner): 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/model.py", line 1379, in run 03:20:07     formatter.result(self) 03:20:07   File "/usr/local/lib/python2.7/dist-packages/behave/formatter/pretty.py", line 151, in result 03:20:07     self.stream.write(indent(step.error_message.strip(), u"      ")) 03:20:07   File "/usr/lib/python2.7/codecs.py", line 370, in write 03:20:07     self.stream.write(data) 03:20:07 IOError:  Errno 11  Resource temporarily unavailable {code}  *Scenario:* FAB-4703: FAB-5663, Test chaincode calling chaincode - fabric-test/chaincodes/example04/go/cmd {code:java} /00:09:20.890     When an admin sets up a channel                                                                                                                                                             # steps/endorser_impl.py:63 00:09:20.932 2019-05-07 19:48:03.958 UTC  common.tools.configtxgen  main -> INFO 001 Loading configuration 00:09:21.170 2019-05-07 19:48:04.196 UTC  common.tools.configtxgen.localconfig  Load -> INFO 002 Loaded configuration: /w/workspace/fabric-test-daily-behave-master-x86_64_1/gopath/src/github.com/hyperledger/fabric-test/feature/configs/f91b76a4710011e9af2dfa163ecb59a2/configtx.yaml 00:09:21.400 2019-05-07 19:48:04.425 UTC  common.tools.configtxgen.localconfig  completeInitialization -> INFO 003 orderer type: solo 00:09:21.400 2019-05-07 19:48:04.426 UTC  common.tools.configtxgen.localconfig  LoadTopLevel -> INFO 004 Loaded configuration: /w/workspace/fabric-test-daily-behave-master-x86_64_1/gopath/src/github.com/hyperledger/fabric-test/feature/configs/f91b76a4710011e9af2dfa163ecb59a2/configtx.yaml 00:09:21.400 2019-05-07 19:48:04.426 UTC  common.tools.configtxgen  doOutputChannelCreateTx -> INFO 005 Generating new channel configtx 00:09:21.406 2019-05-07 19:48:04.433 UTC  common.tools.configtxgen  doOutputChannelCreateTx -> INFO 006 Writing new channel tx 00:09:55.057     And an admin deploys chaincode at path "github.com/hyperledger/fabric-test/chaincodes/example04/go/cmd" with args  "init","Event","1"  with name "myex04"                                   # steps/endorser_impl.py:155 00:11:10.140       Assertion Failed: The expected chaincode container f91b76a4710011e9af2dfa163ecb59a2-peer0.org1.example.com-myex04-0 is not running 00:1/ code placeholder {code} *Scenario:* FAB-4717: FAB-5663, chaincode-to-chaincode testing passing in channel name as a third argument to chaincode_ex05 when cc_05 and cc_02 are on different channels  {code:java} /(kafka.coordinator.transaction.TransactionCoordinator) 00:09:56.478     When an admin sets up a channel                                                                                                                                                             # steps/endorser_impl.py:63 00:09:56.534 2019-05-07 22:20:58.944 UTC  common.tools.configtxgen  main -> INFO 001 Loading configuration 00:09:56.779 2019-05-07 22:20:59.190 UTC  common.tools.configtxgen.localconfig  Load -> INFO 002 Loaded configuration: /w/workspace/fabric-test-daily-behave-master-x86_64_1/gopath/src/github.com/hyperledger/fabric-test/feature/configs/5453e096711611e987f9fa163e2a866c/configtx.yaml 00:09:57.029 2019-05-07 22:20:59.439 UTC  common.tools.configtxgen.localconfig  completeInitialization -> INFO 003 orderer type: solo 00:09:57.029 2019-05-07 22:20:59.440 UTC  common.tools.configtxgen.localconfig  LoadTopLevel -> INFO 004 Loaded configuration: /w/workspace/fabric-test-daily-behave-master-x86_64_1/gopath/src/github.com/hyperledger/fabric-test/feature/configs/5453e096711611e987f9fa163e2a866c/configtx.yaml 00:09:57.029 2019-05-07 22:20:59.440 UTC  common.tools.configtxgen  doOutputChannelCreateTx -> INFO 005 Generating new channel configtx 00:09:57.036 2019-05-07 22:20:59.447 UTC  common.tools.configtxgen  doOutputChannelCreateTx -> INFO 006 Writing new channel tx 00:10:33.157     And an admin deploys chaincode at path "github.com/hyperledger/fabric-test/chaincodes/example05/go/cmd" with args  "init","sum","0"  with name "myex05"                                     # steps/endorser_impl.py:155 00:11:49.991       Assertion Failed: The expected chaincode container 5453e096711611e987f9fa163e2a866c-peer0.org1.example.com-myex05-0 is not running/ code placeholder {code}    ></description> </Issue>
