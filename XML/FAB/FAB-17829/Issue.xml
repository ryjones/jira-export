<Issue id="44986" key="FAB-17829" number="17829" project="10002" reporter="mariya" creator="mariya" type="10004" summary="chaincode upgrade " priority="3" resolution="10203" status="6" created="2020-05-03 04:10:11.0" updated="2020-05-04 07:42:12.0" resolutiondate="2020-05-04 07:42:12.0" votes="0" watches="1" workflowId="58889" archived="N"> <description><! CDATA I have two orgs OrgA and OrgB, installed chaincode on both org's and executed transactions successfully (peer lifecycle)  Chaincode version v01 Sequence number : 1 {code:java} peer: Version: 2.1.0 Commit SHA: 1bdf975 Go version: go1.14.1 OS/Arch: linux/amd64 Chaincode: Base Docker Label: org.hyperledger.fabric Docker Namespace: hyperledger {code} I want to upgrade my chain code  on both org's.  Document does not clear exact steps to be followed to upgrade chain code.  *Upgrade step:*  Chaincode version v01 Sequence number : 2  I followed below steps and getting error {code:java} Installing chaincode on peer0.... + peer lifecycle chaincode install kevlar-v10.tar.gz --cafile crypto-config/ordererOrganizations/example.io/orderers/orderer.example.io/msp/tlscacerts/tlsca.example.io-cert.pem + res=0 + set +x2020-05-03 02:45:30.477 UTC  grpc  Infof -> DEBU 032 Channel Connectivity change to READY 2020-05-03 02:45:30.537 UTC  msp.identity  Sign -> DEBU 033 Sign: plaintext: 0ABF070A6208031A0C08CAE0B8F50510...FFE57F010000FFFFFCBB1BF100AC3A00 2020-05-03 02:45:30.537 UTC  msp.identity  Sign -> DEBU 034 Sign: digest: 9688D9CD2DFB57FEDF9C8C2DA9A4FAB82177CD9E22390A0B9FC029B173B2B9F9 2020-05-03 02:45:30.943 UTC  cli.lifecycle.chaincode  submitInstallProposal -> INFO 035 Installed remotely: response:<status:200 payload:"\nGkevlar:54c812a0eebc9ed13ed4c7fd5e3d4dee48cc711d093042c9f9715c4e0e9dd6df\022\006kevlar" > 2020-05-03 02:45:30.944 UTC  cli.lifecycle.chaincode  submitInstallProposal -> INFO 036 Chaincode code package identifier: kevlar:54c812a0eebc9ed13ed4c7fd5e3d4dee48cc711d093042c9f9715c4e0e9dd6df ===================== Chaincode is installed on peer0.mk-h2 ===================== Installing chaincode on peer1.... + peer lifecycle chaincode install kevlar-v10.tar.gz --cafile /hl-material/mk-h2/crypto-config/ordererOrganizations/example.io/orderers/orderer.example.io/msp/tlscacerts/tlsca.example.io-cert.pem + res=0 + set +x 2020-05-03 02:45:31.593 UTC  msp.identity  Sign -> DEBU 033 Sign: plaintext: 0ABF070A6208031A0C08CBE0B8F50510...FFE57F010000FFFFFCBB1BF100AC3A00 2020-05-03 02:45:31.593 UTC  msp.identity  Sign -> DEBU 034 Sign: digest: DC46677EBE3B961E6F6842BECF80C17BD2A96D3F6616C32792BEEF4A7F709C81 2020-05-03 02:45:32.021 UTC  cli.lifecycle.chaincode  submitInstallProposal -> INFO 035 Installed remotely: response:<status:200 payload:"\nGkevlar:54c812a0eebc9ed13ed4c7fd5e3d4dee48cc711d093042c9f9715c4e0e9dd6df\022\006kevlar" > 2020-05-03 02:45:32.021 UTC  cli.lifecycle.chaincode  submitInstallProposal -> INFO 036 Chaincode code package identifier: kevlar:54c812a0eebc9ed13ed4c7fd5e3d4dee48cc711d093042c9f9715c4e0e9dd6df ===================== Chaincode is installed on peer1.mk-h2 =====================......... PACKAGE_ID is kevlar:54c812a0eebc9ed13ed4c7fd5e3d4dee48cc711d093042c9f9715c4e0e9dd6df + peer lifecycle chaincode approveformyorg -o orderer.fabric:7050 --tls --cafile /hl-material/mk-h2/crypto-config/ordererOrganizations/example.io/orderers/orderer.example.io/msp/tlscacerts/tlsca.example.io-cert.pem --channelID base-chan-01 --name kevlar --version v10 --init-required --package-id kevlar:54c812a0eebc9ed13ed4c7fd5e3d4dee48cc711d093042c9f9715c4e0e9dd6df --sequence 2 --waitForEvent + res=0 ... 2020-05-03 02:45:32.731 UTC  grpc  Infof -> DEBU 03d Subchannel Connectivity change to READY 2020-05-03 02:45:32.731 UTC  grpc  UpdateSubConnState -> DEBU 03e pickfirstBalancer: HandleSubConnStateChange: 0xc0003f6e10, {READY <nil>} 2020-05-03 02:45:32.731 UTC  grpc  Infof -> DEBU 03f Channel Connectivity change to READY 2020-05-03 02:45:32.731 UTC  msp.identity  Sign -> DEBU 040 Sign: plaintext: 0ACD070A7008031A0C08CCE0B8F50510...66393731356334653065396464366466 2020-05-03 02:45:32.731 UTC  msp.identity  Sign -> DEBU 041 Sign: digest: 56B6DDC7250D5B594AC2B582865973EC6E9AE68E7BAD12082D3518EA790EED09 2020-05-03 02:45:32.735 UTC  msp.identity  Sign -> DEBU 042 Sign: plaintext: 0ACD070A7008031A0C08CCE0B8F50510...1C66381A8D067407619688AC76F1BB84 2020-05-03 02:45:32.735 UTC  msp.identity  Sign -> DEBU 043 Sign: digest: C5E2F915F73DD621824B600E62FABC7B3698C2B4E275736C2EBE85F3C93E1D32 2020-05-03 02:45:32.735 UTC  msp.identity  Sign -> DEBU 044 Sign: plaintext: 0A97070A3A08051A0608CCE0B8F50522...00120D1A0B08FFFFFFFFFFFFFFFFFF01 2020-05-03 02:45:32.735 UTC  msp.identity  Sign -> DEBU 045 Sign: digest: D4A1CB2DE195F0BD8E06E41308A969A842011D3C92BB4EA08B4310356E41A26A 2020-05-03 02:45:33.828 UTC  chaincodeCmd  ClientWait -> INFO 046 txid  3c505cda088f09c91d83d785a516dc32192e5adcdb23d6e553b4911ad34672bf  committed with status (VALID) at ===================== Chaincode definition approved on peer0.mk-h2 on channel 'base-chan-01' ===================== ===================== Checking the commit readiness of the chaincode definition on peer0.mk-h2 on channel 'base-chan-01'... ===================== Attempting to check the commit readiness of the chaincode definition on peer0.mk-h2 ...10 secs + peer lifecycle chaincode checkcommitreadiness --channelID base-chan-01 --name kevlar --version v10 --sequence 2 --output json --init-required + res=1 + set +x2020-05-03 02:45:54.438 UTC  grpc  UpdateSubConnState -> DEBU 031 pickfirstBalancer: HandleSubConnStateChange: 0xc000181050, {READY <nil>} 2020-05-03 02:45:54.438 UTC  grpc  Infof -> DEBU 032 Channel Connectivity change to READY 2020-05-03 02:45:54.472 UTC  msp.identity  Sign -> DEBU 033 Sign: plaintext: 0ACD070A7008031A0C08E2E0B8F50510...0212066B65766C61721A037631304001 2020-05-03 02:45:54.472 UTC  msp.identity  Sign -> DEBU 034 Sign: digest: 321D943DDFCE6610B0D6DD3673F1CC8C3511E7BA4265D43E44885C2E5F92CFB3Error: query failed with status: 500 - failed to invoke backing implementation of 'CheckCommitReadiness': requested sequence is 2, but new definition must be sequence 3!!!!!!!!!!!!!!! Check commit readiness result on peer0.mk-h2 is INVALID !!!!!!!!!!!!!!!! {code} what is correct steps should be followed to upgrade ?  ></description> </Issue>
