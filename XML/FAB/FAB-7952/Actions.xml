<Action id="39795" issue="27208" author="wlahti" type="comment" body="I think we should keep this error message vague to avoid malicious users scanning for channels. I propose we wrap the error message with &quot;channel unavailable&quot; and then add a troubleshooting doc to cover the possible reasons a user would see this error message. " created="2018-02-07 17:07:30.0" updateauthor="wlahti" updated="2018-02-07 17:07:30.0"/>
<Action id="39812" issue="27208" author="wlahti" type="comment" body="https://gerrit.hyperledger.org/r/c/17633/" created="2018-02-07 19:38:40.0" updateauthor="wlahti" updated="2018-02-07 19:38:40.0"/>
<Action id="39867" issue="27208" author="bmos299" type="comment" body="Fair enough.  Keeping what we send back to the client as vague as a good thing.   However, what we cut in the peer logs should have the details about the failure. " created="2018-02-08 17:27:39.0" updateauthor="bmos299" updated="2018-02-08 17:27:39.0"/>
<Action id="40027" issue="27208" author="wlahti" type="comment" created="2018-02-12 18:19:42.0" updateauthor="wlahti" updated="2018-02-12 18:19:42.0"> <body><! CDATA As my fix is currently coded, the CLI user will receive the following purposefully vague error message while attempting to query for non-existent channel "mychannel2": {code:java} Error: Error endorsing query: rpc error: code = Unknown desc = channel  mychannel2  unknown on peer, or creator org  Org1MSP  unknown on channel - <nil>{code}  The peer will log the following error message which contains the exact root cause:  {code:java} 2018-02-12 18:17:17.991 UTC  protoutils  ValidateProposalMessage -> WARN 837 channel  mychannel2 : MSP error: channel doesn't exist{code}  ></body> </Action>
<Action id="40028" issue="27208" author="bmos299" type="comment" created="2018-02-12 19:24:29.0" updateauthor="bmos299" updated="2018-02-12 19:25:18.0"> <body><! CDATA  ~wlahti  do we really want to say    *desc = channel  mychannel2  unknown on peer*   Wouldn't this clue an attacker in that this channel does not exist?  I really like the peer log details.  ></body> </Action>
<Action id="40029" issue="27208" author="wlahti" type="comment" created="2018-02-12 19:30:50.0" updateauthor="wlahti" updated="2018-02-12 19:30:50.0"> <body><! CDATA Note that the entire message is: {code:java} desc = channel  mychannel2  unknown on peer, or creator org  Org1MSP  unknown on channel{code} It doesn't clarify one or the other. Perhaps the comma should be removed from the error message though.  ></body> </Action>
<Action id="40031" issue="27208" author="latitiah" type="comment" created="2018-02-12 19:37:41.0" updateauthor="latitiah" updated="2018-02-12 19:37:41.0"> <body><! CDATA Not necessarily - it is also possible that the channel does exist but the peer has not joined the channel or the MSP is wrong for that channel. This could be an issue that ranges from the peer not having access to simply not joining the channel yet.   That said, it does give the user a hint as to what they should investigate to be sure that the info they have is correct. I thought it was a good middle ground of being vague while giving valid users enough information such that they can troubleshoot effectively.  ></body> </Action>
<Action id="40036" issue="27208" author="wlahti" type="comment" created="2018-02-12 20:13:38.0" updateauthor="wlahti" updated="2018-02-12 20:14:34.0"> <body><! CDATA I have updated my CR to make it more obvious that the error message encapsulates an "OR" statement: {code:java} channel  mychannel2  unknown on peer OR creator org  Org1MSP  unknown on channel{code}  ></body> </Action>
<Action id="40250" issue="27208" author="wlahti" type="comment" created="2018-02-15 15:21:07.0" updateauthor="wlahti" updated="2018-02-15 15:53:21.0"> <body><! CDATA There have been a few code reviews now, which I plan to address today.  The new plan is to return a completely generic "access denied" message to the end user to ensure that no undesired information is leaked. The peer logs will contain the exact root cause, including additional details that were not available prior to this CR. If there is a trusted relationship between the peer and client (which is obviously true for developers/testers), the timestamp can be used to search the peer log for the exact root cause.   I will also post a question and answer on Stack Overflow highlighting the new error message, likely causes, and troubleshooting steps.   ></body> </Action>
<Action id="40269" issue="27208" author="wlahti" type="comment" created="2018-02-15 18:02:46.0" updateauthor="wlahti" updated="2018-02-15 18:02:46.0"> <body><! CDATA With my newest update to the CR ( https://gerrit.hyperledger.org/r/c/17633/ ),  the CLI user will now receive the following purposefully vague error message while attempting to query for non-existent channel "mychannel2": {code:java} Error: Error endorsing query: rpc error: code = Unknown desc = access denied: channel  mychannel2  creator org  Org1MSP  - <nil>{code} The peer will log the following error message which contains the exact root cause:  {code:java} 2018-02-12 18:17:17.991 UTC  protoutils  ValidateProposalMessage -> WARN 837 channel  mychannel2 : MSP error: channel doesn't exist{code}  ></body> </Action>
