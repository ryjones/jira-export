<Issue id="46540" key="FAB-18417" number="18417" project="10002" reporter="JIRAUSER21392" assignee="denyeart" creator="JIRAUSER21392" type="10100" summary="Document CORE_LEDGER_SNAPSHOTS_ROOTDIR for peer start" priority="3" resolution="10000" status="6" created="2021-02-05 15:59:18.0" updated="2021-04-01 15:09:21.0" resolutiondate="2021-04-01 15:07:50.0" votes="0" watches="2" workflowId="60487" archived="N"> <description><! CDATA Following  https://hyperledger-fabric.readthedocs.io/en/latest/peer-chaincode-devmode.html  there is a step to start the peer:    {code:java} CORE_OPERATIONS_LISTENADDRESS=0.0.0.0:10443 CORE_PEER_FILESYSTEMPATH=$(pwd)/data/ FABRIC_LOGGING_SPEC=chaincode=debug CORE_PEER_CHAINCODELISTENADDRESS=0.0.0.0:7052 peer node start --peer-chaincodedev=true {code}    But this command fails with:    {code:java} 2021-02-04 20:32:52.078 -05  nodeCmd  serve -> INFO 001 Starting peer:  Version: 2.4.0  Commit SHA: 0146307ee  Go version: go1.15.7 OS/Arch: linux/amd64 Chaincode: Base Docker Label: org.hyperledger.fabric Docker Namespace: hyperledger 2021-02-04 20:32:52.079 -05  peer  getLocalAddress -> INFO 002 Auto-detected peer address: 192.168.1.74:7051  357/1987  2021-02-04 20:32:52.079 -05  peer  getLocalAddress -> INFO 003 Host is 0.0.0.0 , falling back to auto-detected address: 192.168.1.74:7051 2021-02-04 20:32:52.079 -05  nodeCmd  initGrpcSemaphores -> INFO 004 concurrency limit for endorser service is 2500 2021-02-04 20:32:52.079 -05  nodeCmd  initGrpcSemaphores -> INFO 005 concurrency limit for deliver service is 2500 2021-02-04 20:32:52.100 -05  certmonitor  trackCertExpiration -> INFO 006 The enrollment certificate will expire on 2027-11-10 13:41:11 +0000 UTC 2021-02-04 20:32:52.100 -05  ledgermgmt  NewLedgerMgr -> INFO 007 Initializing LedgerMgr panic: Error in instantiating ledger provider: mkdir /var/hyperledger: permission denied error while creating the dir: /var/hyperledger/production/snapshots/temp github.com/hyperledger/fabric/core/ledger/kvledger.(*Provider).initSnapshotDir /home/ertech/workspace/fabricDev/fabric/core/ledger/kvledger/kv_ledger_provider.go:254 github.com/hyperledger/fabric/core/ledger/kvledger.NewProvider /home/ertech/workspace/fabricDev/fabric/core/ledger/kvledger/kv_ledger_provider.go:125 github.com/hyperledger/fabric/core/ledger/ledgermgmt.NewLedgerMgr /home/ertech/workspace/fabricDev/fabric/core/ledger/ledgermgmt/ledger_mgmt.go:71 github.com/hyperledger/fabric/internal/peer/node.serve /home/ertech/workspace/fabricDev/fabric/internal/peer/node/start.go:431 github.com/hyperledger/fabric/internal/peer/node.glob..func6 /home/ertech/workspace/fabricDev/fabric/internal/peer/node/start.go:127 github.com/spf13/cobra.(*Command).execute /home/ertech/workspace/fabricDev/fabric/vendor/github.com/spf13/cobra/command.go:762 github.com/spf13/cobra.(*Command).ExecuteC /home/ertech/workspace/fabricDev/fabric/vendor/github.com/spf13/cobra/command.go:852 github.com/spf13/cobra.(*Command).Execute  /home/ertech/workspace/fabricDev/fabric/vendor/github.com/spf13/cobra/command.go:800 main.main /home/ertech/workspace/fabricDev/fabric/cmd/peer/main.go:56 runtime.main /home/ertech/programs/go/src/runtime/proc.go:204 runtime.goexit /home/ertech/programs/go/src/runtime/asm_amd64.s:1374 goroutine 1  running : github.com/hyperledger/fabric/core/ledger/ledgermgmt.NewLedgerMgr(0xc0002a9960, 0x1bd5760) /home/ertech/workspace/fabricDev/fabric/core/ledger/ledgermgmt/ledger_mgmt.go:85 +0x7b0 github.com/hyperledger/fabric/internal/peer/node.serve(0xc0005ac880, 0x0, 0x1, 0x0, 0x0) /home/ertech/workspace/fabricDev/fabric/internal/peer/node/start.go:431 +0x213b github.com/hyperledger/fabric/internal/peer/node.glob..func6(0x2301da0, 0xc0005ac880, 0x0, 0x1, 0x0, 0x0) /home/ertech/workspace/fabricDev/fabric/internal/peer/node/start.go:127 +0x9c github.com/spf13/cobra.(*Command).execute(0x2301da0, 0xc0005ac860, 0x1, 0x1, 0x2301da0, 0xc0005ac860)  /home/ertech/workspace/fabricDev/fabric/vendor/github.com/spf13/cobra/command.go:762 +0x47c github.com/spf13/cobra.(*Command).ExecuteC(0x2302720, 0xc0002b5f48, 0x1, 0x1) /home/ertech/workspace/fabricDev/fabric/vendor/github.com/spf13/cobra/command.go:852 +0x2fe github.com/spf13/cobra.(*Command).Execute(...) /home/ertech/workspace/fabricDev/fabric/vendor/github.com/spf13/cobra/command.go:800 main.main() /home/ertech/workspace/fabricDev/fabric/cmd/peer/main.go:56 +0x4c5 {code} Command is trying to create the directory /var/hyperledger and ignoring CORE_PEER_FILESYSTEMPATH, the only way to continue is to modify the fabric/sampleconfig/core.yaml, attibutes fileSystemPath and snapshots.rootDir     Tested in 2.3.0 and 2.4.0     ></description> </Issue>
