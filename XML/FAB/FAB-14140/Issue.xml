<Issue id="37594" key="FAB-14140" number="14140" project="10002" reporter="guoger" creator="guoger" type="10004" summary="Flaky test `TestAccept` in gossip/api" priority="3" resolution="10002" status="6" created="2019-02-11 17:07:24.0" updated="2019-03-27 10:01:23.0" resolutiondate="2019-03-27 10:01:23.0" votes="0" watches="1" workflowId="49208"> <description><! CDATA https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/8812/console  {code} 00:13:30 ok  	github.com/hyperledger/fabric/gossip/api	0.006s	coverage: 100.0% of statements 00:14:00 2019-02-11 16:13:40.814 UTC  gossip.comm#1548  createConnection -> WARN 001 Remote endpoint claims to be a different peer, expected 6c6f63616c686f73743a31353531 but got 6c6f63616c686f73743a31353530 00:14:00 2019-02-11 16:13:40.814 UTC  gossip.comm#1548  sendToEndpoint -> WARN 002 Failed obtaining connection for localhost:1550, PKIid:6c6f63616c686f73743a31353531 reason: authentication failure 00:14:00 2019-02-11 16:13:41.935 UTC  gossip.comm#6870  func1 -> WARN 003 localhost:6871, PKIid:6c6f63616c686f73743a36383731 isn't responsive: EOF 00:14:00 2019-02-11 16:13:41.947 UTC  gossip.comm#4611  func1 -> WARN 004 localhost:4612, PKIid:6c6f63616c686f73743a34363132 isn't responsive: EOF 00:14:00 2019-02-11 16:13:42.447 UTC  gossip.comm#4611  sendToEndpoint -> WARN 005 Failed obtaining connection for localhost:4612, PKIid:6c6f63616c686f73743a34363132 reason: context deadline exceeded 00:14:00 2019-02-11 16:13:42.748 UTC  gossip.comm#4611  sendToEndpoint -> WARN 006 Failed obtaining connection for localhost:4612, PKIid:6c6f63616c686f73743a34363132 reason: context deadline exceeded 00:14:00 2019-02-11 16:13:42.848 UTC  gossip.comm#4611  sendToEndpoint -> WARN 007 Failed obtaining connection for localhost:4612, PKIid:6c6f63616c686f73743a34363132 reason: context deadline exceeded 00:14:00 2019-02-11 16:13:43.048 UTC  gossip.comm#4611  sendToEndpoint -> WARN 008 Failed obtaining connection for localhost:4612, PKIid:6c6f63616c686f73743a34363132 reason: context deadline exceeded 00:14:00 2019-02-11 16:13:46.292 UTC  gossip.comm#2000  SetDialOpts -> WARN 009 Given an empty set of grpc.DialOption, aborting 00:14:00 2019-02-11 16:13:46.292 UTC  gossip.comm#3000  SetDialOpts -> WARN 00a Given an empty set of grpc.DialOption, aborting 00:14:00 2019-02-11 16:13:48.308 UTC  gossip.comm#9611  authenticateRemotePeer -> WARN 00b 127.0.0.1:46828 didn't send TLS certificate 00:14:00 2019-02-11 16:13:48.308 UTC  gossip.comm#9611  GossipStream -> ERRO 00c Authentication failed: No TLS certificate 00:14:00 2019-02-11 16:13:49.312 UTC  gossip.comm#9611  authenticateRemotePeer -> ERRO 00d Failed verifying signature from 127.0.0.1:46830 : Wrong certificate: 203 38 80 186 44 41 213 70 38 207 210 34 213 0 130 215 103 14 206 130 237 34 163 197 164 243 189 76 185 196 110 151 0 ,  24 1 114 66 10 14 108 111 99 97 108 104 111 115 116 58 57 54 49 50 18 14 108 111 99 97 108 104 111 115 116 58 57 54 49 50 26 32 235 124 177 128 252 221 28 124 114 180 138 128 33 236 66 124 142 192 208 78 103 244 34 136 184 71 63 30 61 86 176 96  00:14:00 2019-02-11 16:13:49.312 UTC  gossip.comm#9611  GossipStream -> ERRO 00e Authentication failed: Wrong certificate: 203 38 80 186 44 41 213 70 38 207 210 34 213 0 130 215 103 14 206 130 237 34 163 197 164 243 189 76 185 196 110 151 0 ,  24 1 114 66 10 14 108 111 99 97 108 104 111 115 116 58 57 54 49 50 18 14 108 111 99 97 108 104 111 115 116 58 57 54 49 50 26 32 235 124 177 128 252 221 28 124 114 180 138 128 33 236 66 124 142 192 208 78 103 244 34 136 184 71 63 30 61 86 176 96  00:14:00 2019-02-11 16:13:50.316 UTC  gossip.comm#9611  authenticateRemotePeer -> WARN 00f Identity store rejected 127.0.0.1:46836 : identity doesn't match the computed pkiID 00:14:00 2019-02-11 16:13:50.316 UTC  gossip.comm#9611  GossipStream -> ERRO 010 Authentication failed: identity doesn't match the computed pkiID 00:14:00 2019-02-11 16:13:51.320 UTC  gossip.comm#9611  GossipStream -> ERRO 011 Authentication failed: Expected  82 25 149 84 65 255 15 68 130 166 222 90 46 179 240 16 45 144 188 71 61 49 162 5 238 39 55 175 152 115 226 148  in remote hash of TLS cert, but got  82 25 149 84 65 255 15 68 130 166 222 90 46 179 240 16 45 144 188 71 61 49 162 5 238 39 55 175 152 115 226 148 0  00:14:00 2019-02-11 16:13:52.323 UTC  gossip.comm#9611  authenticateRemotePeer -> WARN 012 127.0.0.1:46842 didn't send a pkiID 00:14:00 2019-02-11 16:13:52.323 UTC  gossip.comm#9611  GossipStream -> ERRO 013 Authentication failed: No PKI-ID 00:14:00 2019-02-11 16:13:53.326 UTC  gossip.comm#9611  authenticateRemotePeer -> WARN 014 Expected connection message from 127.0.0.1:46846 but got <nil> 00:14:00 2019-02-11 16:13:53.326 UTC  gossip.comm#9611  GossipStream -> ERRO 015 Authentication failed: Wrong type 00:14:00 --- FAIL: TestAccept (10.01s) 00:14:00     comm_test.go:922:  00:14:00         	Error Trace:	comm_test.go:922 00:14:00         	            				comm_test.go:750 00:14:00         	Error:      	Not equal:  00:14:00         	            	expected: 20 00:14:00         	            	actual  : 1 00:14:00         	Test:       	TestAccept 00:14:00         	Messages:   	Didn't receive all messages sent 00:14:00     comm_test.go:758:  00:14:00         	Error Trace:	comm_test.go:758 00:14:00         	Error:      	Should NOT be empty, but was    00:14:00         	Test:       	TestAccept 00:14:00 2019-02-11 16:13:56.329 UTC  gossip.comm#9611  authenticateRemotePeer -> WARN 016 Failed reading messge from 127.0.0.1:46848, reason: timed out waiting for connection message from 127.0.0.1:46848 00:14:00 2019-02-11 16:13:56.329 UTC  gossip.comm#9611  GossipStream -> ERRO 017 Authentication failed: timed out waiting for connection message from 127.0.0.1:46848 00:14:00 FAIL 00:14:00 coverage: 90.9% of statements 00:14:00 FAIL	github.com/hyperledger/fabric/gossip/comm	21.577s {code}  ></description> </Issue>
