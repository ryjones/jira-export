<Issue id="43462" key="FAB-17148" number="17148" project="10002" reporter="sykesm" assignee="baidang201" creator="sykesm" type="10004" summary="bccsp/sw/impl_test does not cleanup temporary directories" priority="3" resolution="10000" status="6" created="2019-11-26 15:48:53.0" updated="2019-12-02 01:50:41.0" resolutiondate="2019-12-02 01:50:41.0" votes="0" watches="2" workflowId="56576"> <description><! CDATA My tmpfs filled up today. When I looked in the directory, I found hundreds of directory entries like this: {code} bccsp-sw012112472                                                                                                                                                                     bccsp-sw013888357                                                                                                                                                                     bccsp-sw018301977                                                                                                                                                                     bccsp-sw018547488                                                                                                                                                                     bccsp-sw025594217                                                                                                                                                                     bccsp-sw027997722                                                                                                                                                                     bccsp-sw028166357                                                                                                                                                                     bccsp-sw028412737                                                                                                                                                                     bccsp-sw032099235                                                                                                                                                                     bccsp-sw037743897                                                                                                                                                                     bccsp-sw074214301                                                                                                                                                                     bccsp-sw077179605                                                                                                                                                                     bccsp-sw115707765                                                                                                                                                                     bccsp-sw136555114                                                                                                                                                                     bccsp-sw158334336                                                                                                                                                                     bccsp-sw163894744                                                                                                                                                                     bccsp-sw180537190                                                                                                                                                                     bccsp-sw196812380                                                                                                                                                                     bccsp-sw230348096                                                                                                                                                                     bccsp-sw257630673                                                                                                                                                                     bccsp-sw270912640                                                                                                                                                                     bccsp-sw274183369                                                                                                                                                                     bccsp-sw274615136                                                                                                                                                                     bccsp-sw274685647                                                                                                                                                                     bccsp-sw280747669                                                                                                                                                                     bccsp-sw286267436                                                                                                                                                                     bccsp-sw288349854                                                                                                                                                                     bccsp-sw312212046                                                                                                                                                                     bccsp-sw370193145                                                                                                                                                                     bccsp-sw377809871                                                                                                                                                                     bccsp-sw383122108                                                                                                                                                                     bccsp-sw384270519                                                                                                                                                                     {code}  The bccsp tests create a temporary directory out of TestMain and rely on a defer to clean them up. Since TestMain will exit without returning, the defer will never run.  {code} func TestMain(m *testing.M) { 	tests :=   testConfig{ 		{256, "SHA2"}, 		{256, "SHA3"}, 		{384, "SHA2"}, 		{384, "SHA3"}, 	}  	var err error 	tempDir, err = ioutil.TempDir("", "bccsp-sw") 	if err != nil { 		fmt.Printf("Failed to create temporary directory: %s\n\n", err) 		os.Exit(-1) 	} 	defer os.RemoveAll(tempDir) {code}  ></description> </Issue>
