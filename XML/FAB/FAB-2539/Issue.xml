<Issue id="15106" key="FAB-2539" number="2539" project="10002" reporter="nishi" creator="nishi" type="10004" summary="During installation of chaincode on a peer in E2E test failed with panic" priority="3" resolution="10000" status="6" created="2017-02-28 16:27:21.0" updated="2018-07-20 14:11:50.0" resolutiondate="2017-04-12 02:09:01.0" votes="0" watches="2" workflowId="37632"> <description><! CDATA Scenario:  Network: 1 orderer 4 peers (peer0, peer1, peer2, peer3)  Bring network with orderer, peer0, peer2, peer3 cli  Test Execution:  1. Create 100 channels. 2. Join all peer0, peer2, peer3 on all channels 3. Install Chaincode on peer0 and peer2 4. Instantiate chaincode from peer2 on all channels 5. Query initial values from peer0 on all channels 6. Invoke on chaincode from peer0 on all channels  7. Install on peer3  8. Query from peer3 on all channels  Test step 7 failed with following messages from docker logs -f cli   {noformat} ===================== Invoke transaction on PEER0 on ORG0 is successful =====================  2017-02-28 15:14:33.918 UTC  logging  InitFromViper -> DEBU 001 Setting default logging level to DEBUG for command 'chaincode' 2017-02-28 15:14:33.922 UTC  msp  GetLocalMSP -> DEBU 002 Returning existing local MSP 2017-02-28 15:14:33.922 UTC  msp  GetDefaultSigningIdentity -> DEBU 003 Obtaining default signing identity 2017-02-28 15:14:33.925 UTC  golang/hash  collectChaincodeFiles -> DEBU 004 not using input for hash computation for path:"github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02" name:"mycc" version:"1.0"   2017-02-28 15:14:33.925 UTC  golang/hash  getCodeFromFS -> DEBU 005 getCodeFromFS github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 2017-02-28 15:14:33.926 UTC  util  HashFilesInDir -> DEBU 006 hashFiles /opt/gopath/src/github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 2017-02-28 15:14:33.928 UTC  container  WriteGopathSrc -> INFO 007 rootDirectory = /opt/gopath/src 2017-02-28 15:14:33.928 UTC  container  WriteFolderToTarPackage -> INFO 008 rootDirectory = /opt/gopath/src panic: runtime error: invalid memory address or nil pointer dereference  signal SIGSEGV: segmentation violation code=0x1 addr=0x30 pc=0x82810d   goroutine 1  running : panic(0xc09ac0, 0xc420014080) 	/opt/go/src/runtime/panic.go:500 +0x1a1 github.com/hyperledger/fabric/core/container/util.WriteFolderToTarPackage.func1(0xc4202d58b0, 0x43, 0x0, 0x0, 0x12c2180, 0xc4205f0930, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/core/container/util/writer.go:65 +0xad path/filepath.walk(0xc4202259c0, 0x32, 0x12ce9a0, 0xc42041f520, 0xc4202254c0, 0x0, 0x0) 	/opt/go/src/path/filepath/path.go:372 +0x22e path/filepath.walk(0xc4205f0000, 0x2d, 0x12ce9a0, 0xc42032a340, 0xc4202254c0, 0x0, 0x0) 	/opt/go/src/path/filepath/path.go:376 +0x344 path/filepath.walk(0xc4202c9ef0, 0x26, 0x12ce9a0, 0xc42032a270, 0xc4202254c0, 0x0, 0x0) 	/opt/go/src/path/filepath/path.go:376 +0x344 path/filepath.walk(0xc4203104c0, 0x1a, 0x12ce9a0, 0xc42032a1a0, 0xc4202254c0, 0x0, 0x0) 	/opt/go/src/path/filepath/path.go:376 +0x344 path/filepath.walk(0xc4202fccd0, 0xf, 0x12ce9a0, 0xc42032a0d0, 0xc4202254c0, 0x0, 0xc4202d4501) 	/opt/go/src/path/filepath/path.go:376 +0x344 path/filepath.Walk(0xc4202fccd0, 0xf, 0xc4202254c0, 0xcdfb28, 0x1) 	/opt/go/src/path/filepath/path.go:398 +0xd5 github.com/hyperledger/fabric/core/container/util.WriteFolderToTarPackage(0xc4202ca900, 0xc4202fccd0, 0xf, 0xc4202d4550, 0x48, 0xc420153740, 0x0, 0xc4202fc860, 0xc420151908) 	/opt/gopath/src/github.com/hyperledger/fabric/core/container/util/writer.go:104 +0x1d1 github.com/hyperledger/fabric/core/container/util.WriteGopathSrc(0xc4202ca900, 0x7ffc10150cee, 0x47, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/core/container/util/writer.go:120 +0x1e1 github.com/hyperledger/fabric/core/chaincode/platforms/golang.writeChaincodePackage(0xc420310060, 0xc4202ca900, 0xc420225480, 0x40) 	/opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/package.go:36 +0xee github.com/hyperledger/fabric/core/chaincode/platforms/golang.(*Platform).GetDeploymentPayload(0x130c198, 0xc420310060, 0x130c198, 0x0, 0x0, 0x4a5831, 0x130c198) 	/opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/platform.go:173 +0x12c github.com/hyperledger/fabric/core/chaincode/platforms.GetDeploymentPayload(0xc420310060, 0x0, 0xc4201d18f8, 0x3, 0xcdffc0, 0x3) 	/opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/platforms.go:74 +0x5d github.com/hyperledger/fabric/core/container.GetChaincodePackageBytes(0xc420310060, 0x0, 0x0, 0x0, 0x0, 0x110150cdf) 	/opt/gopath/src/github.com/hyperledger/fabric/core/container/vm.go:100 +0xaa github.com/hyperledger/fabric/peer/chaincode.getChaincodeBytes(0xc420310060, 0xc420310001, 0x0, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/peer/chaincode/common.go:63 +0x168 github.com/hyperledger/fabric/peer/chaincode.chaincodeInstall(0xc4201fa6c0, 0xc4202c6060, 0x0, 0x6, 0xc4202c9a40, 0x9, 0x9) 	/opt/gopath/src/github.com/hyperledger/fabric/peer/chaincode/install.go:105 +0x2b1 github.com/hyperledger/fabric/peer/chaincode.installCmd.func1(0xc4201fa6c0, 0xc4202c6060, 0x0, 0x6, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/peer/chaincode/install.go:44 +0x52 github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).execute(0xc4201fa6c0, 0xc4201ffe60, 0x6, 0x6, 0xc4201fa6c0, 0xc4201ffe60) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:599 +0x234 github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).ExecuteC(0x12b6ce0, 0xf, 0xc420010035, 0x7) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:689 +0x367 github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).Execute(0x12b6ce0, 0x5b, 0xc420010035) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:648 +0x2b main.main() 	/opt/gopath/src/github.com/hyperledger/fabric/peer/main.go:111 +0x52d !!!!!!!!!!!!!!! Chaincode installation on remote peer PEER3 is Failed !!!!!!!!!!!!!!!! ========== ERROR !!! Please check peer logs to verify the issue =========== ===================== FAILED to execute E2E Scenario =================== {noformat} ==    ></description> </Issue>
