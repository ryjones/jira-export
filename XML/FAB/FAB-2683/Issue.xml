<Issue id="15250" key="FAB-2683" number="2683" project="10002" reporter="nishi" assignee="yacovm" creator="nishi" type="10004" summary="chaincode not found intermittent error when all peers in e2e test were NOT leaders " priority="3" resolution="10000" status="6" created="2017-03-07 23:09:24.0" updated="2018-07-20 14:11:56.0" resolutiondate="2017-03-10 16:33:06.0" votes="0" watches="6" workflowId="37723"> <description><! CDATA It appears that Gossip is sometimes failing to share chaincode with the other non-leader peer in the organization.   Commit Level: *30a0e216c50cb8cf6c1423566d1e4c899e24205f* Test Env: 1 orderer, 2 kafka brokers, 4 peers, 2 Orgs (org1:peer0/peer1, org2: peer2/peer3), 1 channel, 1 chaincode  Test Case: {code} Create one channel 'myc1' Join peer0, peer1, peer2, peer3 on 'myc1' Install chaincode on peer0, peer1, peer2, peer3 Instantiate chaincode on peer0 sleep 20sec(after instantiate) for each channel for each chaincode on each peer Query initial values Invoke  Query after invoke {code}  *Scenario1 - FAILURE case*: In docker-compose.yaml following value was set  {code} CORE_PEER0_GOSSIP_ORGLEADER=true CORE_PEER1_GOSSIP_ORGLEADER=false CORE_PEER2_GOSSIP_ORGLEADER=true CORE_PEER3_GOSSIP_ORGLEADER=false {code}   Observations after 10 RUNS:  It passed once on all peers It failed on peer1 8 times. - 7 when could not find chaincode, once when query results did not match expected results after invoke. It failed on peer3 - once when query results did not match expected results after invoke.  When it could not find chaincode, following error message was seen  {code} docker logs -f cli  Error: Error endorsing invoke: rpc error: code = 2 desc = failed to obtain cds for mycc0 - transaction not found mycc0/myc0 {code}  {code} docker logs -f peer1  vagrant@hyperledger-devenv:v0.3.0-927ff1c:/opt/gopath/src/github.com/hyperledger/fabric/examples/e2e$ docker logs -f peer1 2017-03-07 21:38:52.835 UTC  lccc  Invoke -> ERRO 001 ChaincodeId: mycc0 does not exist on channel: myc0(err:chaincode not found mycc0) 2017-03-07 21:38:52.937 UTC  lccc  Invoke -> ERRO 002 ChaincodeId: mycc0 does not exist on channel: myc0(err:chaincode not found mycc0) vagrant@hyperledger-devenv:v0.3.0-927ff1c:/opt/gopath/src/github.com/hyperledger/fabric/examples/e2e$ {code}  *Comparison Scenario2 - SUCCESS case*: When all peers are set as ORG_LEADERS, all the 10 runs passed successfully on all peers.  ></description> </Issue>
