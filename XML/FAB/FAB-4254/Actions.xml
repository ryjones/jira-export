<Action id="25033" issue="17286" author="clayton sims" type="comment" created="2017-06-01 22:50:07.0" updateauthor="clayton sims" updated="2017-06-01 22:50:07.0"> <body><! CDATA Murali - I think this might be peer.....so moving it to fabric-peer.    If not peer can you triage to appropriate component.     ></body> </Action>
<Action id="25424" issue="17286" author="muralisr" type="comment" created="2017-06-05 19:49:18.0" updateauthor="muralisr" updated="2017-06-05 19:49:18.0"> <body><! CDATA  ~Clayton Sims  given the following  {code:java} error:  Chain.js : getChannelConfig - Failed Proposal. Error: Error: SERVICE_UNAVAILABLE at ClientDuplexStream.<anonymous> (/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/fabric-client/lib/Orderer.js:234:23) {code}  my guess would be somethingin the orderer SDK interaction. I'll keep it in peer for now and see if I can confirm.  ></body> </Action>
<Action id="25586" issue="17286" author="muralisr" type="comment" created="2017-06-06 23:09:37.0" updateauthor="muralisr" updated="2017-06-06 23:09:37.0"> <body><! CDATA  ~JasonShen  tried the exact steps a few times at commit level a959653ab74fd2354318cd4e8e8bd5d423df4bb1 and worked just fine.  Now there is at least one  issue with +sporadic+ SERVICE_UNAVAILABLE error from orderer reported in FAB-4415. You might be running into that as well. As stated there, it should be fixed in FAB-4136. Perhaps check when that's fixed.  Meanwhile can you upload all logs so we can try and confirm the issues are same.  ></body> </Action>
<Action id="25596" issue="17286" author="jasonshen" type="comment" created="2017-06-07 02:20:54.0" updateauthor="jasonshen" updated="2017-06-07 02:20:54.0"> <body><! CDATA  ~muralisr  ok, I'm gonna upload my docker-compose.yml file and logs.   ^docker-compose.yaml this is my compose file.     here is sdk's log: {code:java} ***** End-to-end flow: invoke transaction to move money ***** # getMember, name: admin, client.getUserContext(admin, true) info:  crypto_ecdsa_aes : This class requires a CryptoKeyStore to save keys, using the store: {"opts":{"path":"/tmp/hfc-test-kvs_peerOrg2"}} info:  Client.js : Successfully loaded user "admin" from local key value store ok 1 Successfully loaded member from persistence ok 2 Successfully enrolled user 'admin' error:  Orderer.js : sendDeliver - on error code 14: "Error: Connect Failed\n at ClientDuplexStream._emitStatusIfDone (/Users/david/Desktop/work/code/gopath/src/github.com/hyperl edger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:201:19)\n at ClientDuplexStream._readsDone (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric -sdk-node/node_modules/grpc/src/node/src/client.js:169:8)\n at readCallback (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/sr c/node/src/client.js:229:12)" error:  Chain.js : getChannelConfig - Failed Proposal. Error: Error: SERVICE_UNAVAILABLE at ClientDuplexStream.<anonymous> (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/fabric-client/lib/Orderer.js:234:23) at emitOne (events.js:96:13) at ClientDuplexStream.emit (events.js:188:7) at ClientDuplexStream._emitStatusIfDone (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:204:12) at ClientDuplexStream._readsDone (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:169:8) at readCallback (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:229:12) error:  Chain.js : Error: SERVICE_UNAVAILABLE at ClientDuplexStream.<anonymous> (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/fabric-client/lib/Orderer.js:234:23) at emitOne (events.js:96:13) at ClientDuplexStream.emit (events.js:188:7) at ClientDuplexStream._emitStatusIfDone (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:204:12) at ClientDuplexStream._readsDone (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:169:8) at readCallback (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:229:12) not ok 3 Failed to enroll user 'admin'. Error: Error: SERVICE_UNAVAILABLE --- operator: fail at: hfc.newDefaultKeyValueStore.then.then.then (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:548:5) ... not ok 4 Error: Failed to enroll user 'admin'. Error: Error: SERVICE_UNAVAILABLE at hfc.newDefaultKeyValueStore.then.then.then (/Users/david/Desktop/work/code/gopath/src/github.com/ hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:549:9) at process._tickCallback (internal/process/next_tick.js:109:7) --- operator: fail at: hfc.newDefaultKeyValueStore.then.then.then.then (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:640:5) ... not ok 5 Error: Error: Failed to enroll user 'admin'. Error: Error: SERVICE_UNAVAILABLE at hfc.newDefaultKeyValueStore.then.then.then (/Users/david/Desktop/work/code/gopath/src/gith ub.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:549:9) at process._tickCallback (internal/process/next_tick.js:109:7) at hfc.newDefaultKeyValueStore.then.then.th en.then (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:641:9) at process._tickCallback (internal/process/next_tic k.js:109:7) --- operator: fail at: hfc.newDefaultKeyValueStore.then.then.then.then.then (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:658:5 ) ... not ok 6 Error: Error: Error: Failed to enroll user 'admin'. Error: Error: SERVICE_UNAVAILABLE at hfc.newDefaultKeyValueStore.then.then.then (/Users/david/Desktop/work/code/gopath/s rc/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:549:9) at process._tickCallback (internal/process/next_tick.js:109:7) at hfc.newDefaultKeyValueStore.then. then.then.then (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:641:9) at process._tickCallback (internal/process/n ext_tick.js:109:7) at hfc.newDefaultKeyValueStore.then.then.then.then.then (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2e Utils.js:659:9) at process._tickCallback (internal/process/next_tick.js:109:7) --- operator: fail at: e2eUtils.invokeChaincode.then (/Users/david/Desktop/work/code/gopath/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/invoke-transaction.js:38:5) ... info:  E2E testing : Disconnecting the event hub # Successfully slept for 5s to wait for the transaction to be committed in all peers  1..6 # tests 6 # pass 2 # fail 4 {code} well, I don't know where to find all docker container's logs, so here's someone of dockers' log, I will try to upload all log files if that's not enough: {code:java} peer0.org1.example.com | 2017-06-07 02:17:48.473 UTC  flogging  setModuleLevel -> DEBU 1c0 Module 'grpc' logger enabled for log level 'ERROR' peer0.org2.example.com | 2017-06-07 02:17:48.491 UTC  kvledger  NewProvider -> INFO 006 ledger provider Initialized peer0.org2.example.com | 2017-06-07 02:17:48.493 UTC  ledgermgmt  initialize -> INFO 007 ledger mgmt initialized peer0.org2.example.com | 2017-06-07 02:17:48.506 UTC  nodeCmd  serve -> INFO 008 Starting peer with TLS enabled peer0.org2.example.com | 2017-06-07 02:17:48.508 UTC  eventhub_producer  start -> INFO 009 Event processor started peer0.org2.example.com | 2017-06-07 02:17:48.514 UTC  chaincode  NewChaincodeSupport -> INFO 00a Chaincode support using peerAddress: peer0.org2.example.com:7051 peer0.org2.example.com | 2017-06-07 02:17:48.515 UTC  sccapi  RegisterSysCC -> INFO 00b system chaincode cscc(github.com/hyperledger/fabric/core/scc/cscc) registered peer0.org2.example.com | 2017-06-07 02:17:48.516 UTC  sccapi  RegisterSysCC -> INFO 00c system chaincode lscc(github.com/hyperledger/fabric/core/scc/lscc) registered peer0.org2.example.com | 2017-06-07 02:17:48.517 UTC  sccapi  RegisterSysCC -> INFO 00d system chaincode escc(github.com/hyperledger/fabric/core/scc/escc) registered peer0.org2.example.com | 2017-06-07 02:17:48.517 UTC  sccapi  RegisterSysCC -> INFO 00e system chaincode vscc(github.com/hyperledger/fabric/core/scc/vscc) registered peer0.org2.example.com | 2017-06-07 02:17:48.518 UTC  sccapi  RegisterSysCC -> INFO 00f system chaincode qscc(github.com/hyperledger/fabric/core/chaincode/qscc) registered peer0.org2.example.com | 2017-06-07 02:17:48.519 UTC  gossip/service  func1 -> INFO 010 Initialize gossip with endpoint peer0.org2.example.com:7051 and bootstrap set  127.0.0.1:7051  peer0.org2.example.com | 2017-06-07 02:17:48.519 UTC  msp  DeserializeIdentity -> INFO 011 Obtaining identity peer0.org2.example.com | 2017-06-07 02:17:48.527 UTC  msp  DeserializeIdentity -> INFO 012 Obtaining identity peer0.org2.example.com | 2017-06-07 02:17:48.528 UTC  msp  DeserializeIdentity -> INFO 013 Obtaining identity peer0.org2.example.com | 2017-06-07 02:17:48.529 UTC  gossip/discovery  NewDiscoveryService -> INFO 014 Started {     223 212 143 221 75 84 72 130 103 192 209 174 235 158 158 88150 49 135 12 178 109 117 228 206 165 137 119 111 29 198 2  peer0.org2.example.com:7051} incTime is 1496801868528861027 peer0.org2.example.com | 2017-06-07 02:17:48.529 UTC  gossip/gossip  NewGossipService -> INFO 015 Creating gossip service with self membership of {     223 212 143 221 75 84 72 130 103 192 209 174 235 158 158 88 150 49 135 12 178 109 117 228 206 165 137 119 111 29 198 2  peer0.org2.example.com:7051} peer0.org2.example.com | 2017-06-07 02:17:48.529 UTC  msp  DeserializeIdentity -> INFO 016 Obtaining identity peer0.org2.example.com | 2017-06-07 02:17:48.529 UTC  msp  DeserializeIdentity -> INFO 017 Obtaining identity peer0.org2.example.com | 2017-06-07 02:17:48.530 UTC  gossip/gossip  NewGossipService -> WARN 018 External endpoint is empty, peer will not be accessible outside of its organization peer0.org2.example.com | 2017-06-07 02:17:48.530 UTC  gossip/discovery  connect2BootstrapPeers -> INFO 019 Entering:  127.0.0.1:7051  peer0.org2.example.com | 2017-06-07 02:17:48.530 UTC  gossip/discovery  connect2BootstrapPeers -> INFO 01a Exiting peer0.org2.example.com | 2017-06-07 02:17:48.530 UTC  gossip/gossip  start -> INFO 01b Gossip instance peer0.org2.example.com:7051 started peer0.org2.example.com | 2017-06-07 02:17:48.531 UTC  cscc  Init -> INFO 01c Init CSCC peer0.org2.example.com | 2017-06-07 02:17:48.531 UTC  sccapi  deploySysCC -> INFO 01d system chaincode cscc/(github.com/hyperledger/fabric/core/scc/cscc) deployed peer0.org2.example.com | 2017-06-07 02:17:48.531 UTC  sccapi  deploySysCC -> INFO 01e system chaincode lscc/(github.com/hyperledger/fabric/core/scc/lscc) deployed peer0.org2.example.com | 2017-06-07 02:17:48.532 UTC  escc  Init -> INFO 01f Successfully initialized ESCC peer0.org2.example.com | 2017-06-07 02:17:48.532 UTC  sccapi  deploySysCC -> INFO 020 system chaincode escc/(github.com/hyperledger/fabric/core/scc/escc) deployed peer0.org2.example.com | 2017-06-07 02:17:48.533 UTC  sccapi  deploySysCC -> INFO 021 system chaincode vscc/(github.com/hyperledger/fabric/core/scc/vscc) deployed peer0.org2.example.com | 2017-06-07 02:17:48.533 UTC  qscc  Init -> INFO 022 Init QSCC peer0.org2.example.com | 2017-06-07 02:17:48.533 UTC  sccapi  deploySysCC -> INFO 023 system chaincode qscc/(github.com/hyperledger/fabric/core/chaincode/qscc) deployed peer0.org2.example.com | 2017-06-07 02:17:48.533 UTC  nodeCmd  initSysCCs -> INFO 024 Deployed system chaincodess peer0.org2.example.com | 2017-06-07 02:17:48.533 UTC  peer  Initialize -> INFO 025 Loading chain mychannel peer0.org2.example.com | 2017-06-07 02:17:48.533 UTC  ledgermgmt  OpenLedger -> INFO 026 Opening ledger with id = mychannel peer0.org2.example.com | 2017-06-07 02:17:48.552 UTC  ledgermgmt  OpenLedger -> INFO 027 Opened ledger with id = mychannel peer0.org2.example.com | 2017-06-07 02:17:48.561 UTC  peer  Initialize -> WARN 028 Failed to load chain mychannel(Bad envelope: Not a tx of type CONFIG) peer0.org2.example.com | 2017-06-07 02:17:48.562 UTC  nodeCmd  serve -> INFO 029 Starting peer with ID= name:"peer0.org2.example.com"  , network ID= dev , address= peer0.org2.example.com:7051  peer0.org2.example.com | 2017-06-07 02:17:48.567 UTC  nodeCmd  serve -> INFO 02a Started peer with ID= name:"peer0.org2.example.com"  , network ID= dev , address= peer0.org2.example.com:7051  {code} Note that there are some lines seem unnormal. {code:java} peer0.org2.example.com | 2017-06-07 02:17:48.561 UTC  peer  Initialize -> WARN 028 Failed to load chain mychannel(Bad envelope: Not a tx of type CONFIG){code}  ></body> </Action>
<Action id="25628" issue="17286" author="muralisr" type="comment" body=" ~JasonShen  Also, did you try running on the latest master ?" created="2017-06-07 11:30:08.0" updateauthor="muralisr" updated="2017-06-07 11:30:08.0"/>
<Action id="25715" issue="17286" author="jasonshen" type="comment" body=" ~muralisr  yes, but I really couldn&apos;t test it because when I started the hyperledger containers, I got this error: Failed connecting to orderer:7050 , error: grpc: timed out when dialing. I believe that&apos;s one of node sdk&apos;s bug. So I had to give up. " created="2017-06-08 01:43:48.0" updateauthor="jasonshen" updated="2017-06-08 01:43:48.0"/>
<Action id="25716" issue="17286" author="muralisr" type="comment" created="2017-06-08 02:22:40.0" updateauthor="muralisr" updated="2017-06-08 02:22:40.0"> <body><! CDATA  ~JasonShen    I didn't run into connectivity issues connecting to orderer:7050.   _I believe that's one of node sdk's bug._  Are you referring to a known SDK bug (if so which one ) ?  ></body> </Action>
<Action id="25818" issue="17286" author="jasonshen" type="comment" body=" ~muralisr  really thanks. I tried beta version, and this error got fixed!!!" created="2017-06-09 01:53:48.0" updateauthor="jasonshen" updated="2017-06-09 01:53:48.0"/>
<Action id="25833" issue="17286" author="clayton sims" type="comment" body="Are we confident this is fixed?  If so can we close this one" created="2017-06-09 11:56:12.0" updateauthor="clayton sims" updated="2017-06-09 11:56:12.0"/>
<Action id="25834" issue="17286" author="muralisr" type="comment" body="Thanks for testing and following through  ~JasonShen .  Will close the JIRA then." created="2017-06-09 11:56:19.0" updateauthor="muralisr" updated="2017-06-09 11:56:38.0"/>
