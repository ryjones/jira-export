<Issue id="38225" key="FAB-14501" number="14501" project="10002" reporter="denyeart" assignee="denyeart" creator="denyeart" type="10001" summary="Peer crashes with nil pointer if cannot verify connection to CouchDB" priority="3" resolution="10000" status="6" created="2019-03-05 17:55:06.0" updated="2019-03-23 19:47:53.0" resolutiondate="2019-03-23 19:47:53.0" votes="0" watches="1" workflowId="49847"> <description><! CDATA In v1.4.0 there is a regression caused by  https://gerrit.hyperledger.org/r/27558  where the error caused by connection failure to CouchDB does not get handled. This leads to a nil pointer panic when the nil vdbProvider tries to get a handle to a database:    {code:java} panic: runtime error: invalid memory address or nil pointer dereference  signal SIGSEGV: segmentation violation code=0x1 addr=0x20 pc=0x482af8f  goroutine 1  running : github.com/hyperledger/fabric/core/ledger/kvledger.(*Provider).openInternal(0xc00015a680, 0xc000218ac0, 0x3, 0xc0002ed001, 0x0, 0x0, 0x402ca32) /Users/denyeart/work/src/github.com/hyperledger/fabric/core/ledger/kvledger/kv_ledger_provider.go:158 +0x1ef github.com/hyperledger/fabric/core/ledger/kvledger.(*Provider).Open(0xc00015a680, 0xc000218ac0, 0x3, 0x3, 0x5948c40, 0x0, 0x1) /Users/denyeart/work/src/github.com/hyperledger/fabric/core/ledger/kvledger/kv_ledger_provider.go:145 +0x116 github.com/hyperledger/fabric/core/ledger/ledgermgmt.OpenLedger(0xc000218ac0, 0x3, 0x0, 0x0, 0x0, 0x0) /Users/denyeart/work/src/github.com/hyperledger/fabric/core/ledger/ledgermgmt/ledger_mgmt.go:122 +0x19b {code}    This change will handle the CouchDB connection error gracefully and panic the peer with a good error message (e.g. connection problem, username/password problem) as was done in prior releases.        ></description> </Issue>
