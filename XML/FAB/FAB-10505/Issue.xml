<Issue id="30799" key="FAB-10505" number="10505" project="10002" reporter="yacovm" assignee="yacovm" creator="yacovm" type="10004" summary="Discovery ChannelConfigGetter isn&apos;t memory coherent to config updates" priority="3" resolution="10000" status="6" created="2018-05-31 20:52:21.0" updated="2018-07-20 14:16:53.0" resolutiondate="2018-06-01 10:04:05.0" votes="0" watches="1" workflowId="42386"> <description><! CDATA The discovery calls *peer.GetChannelConfig* to fetch the latest *channelconfig.Resources* object and extract from it the the *Sequence()* of the channel (the config block sequence).  However, it might read a stale reference of the *channelconfig.Resources* because that reference is updated via an atomic pointer, while the *peer.GetChannelConfig*  doesn't call an atomic load, but relies on the channels  map's RLock  which the callback that updates the map - doesn't lock.  This can be easily solved via just calling *GetStableChannelConfig* instead of *GetChannelConfig*  ></description> </Issue>
