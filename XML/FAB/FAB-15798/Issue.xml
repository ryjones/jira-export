<Issue id="40768" key="FAB-15798" number="15798" project="10002" reporter="dongming" assignee="dongming" creator="dongming" type="10101" summary="rollback: System crash test: during reset and rollback" priority="3" resolution="10000" status="6" created="2019-06-24 14:25:22.0" updated="2019-08-01 03:28:41.0" resolutiondate="2019-08-01 03:26:40.0" votes="0" watches="1" workflowId="53723"> <description><! CDATA Purpose: System crash test: during reset and rollback  Network configuration: Orgs: O1, O2 Peers: <O1, P1>, <O2, P2> Channels: <P1, C1> <P2, C1>  Transactions: Send all endorsement requests to P1 only  Steps: 1. Setting 1.1 Setup a network with above configuration with 1.4 binary 1.2 Enable capability 1.4.2 1.3 Submit transactions with private data to create a decently large (2,000 blocks) blockchain 1.4 Shutdown P2  2. crash during rollback 2.1 loop 3 times on P2 - Execute rollback command to 1,000 block - Crash the process while rolling back (before restart P2, query P2 block height to ensure that it has not reached original height) - Re-execute the rollback command - Restart P2  2.2 Observation - See below common observation  3. crash during rollback again 3.1 loop 3 times on P2 - Execute rollback command - Crash the process while rolling back  4. Restart P2 4.1 Observation - send endorsement requests to P2 and it shall fail till peer reaches original height - query block height from P2 to ensure that it eventually reaches the original height - block  in <P2, C1> matches the commit hash for last block in <P1, C1> (verify via logs) - query private data from P2 to ensure that all data (including private data) exists on P2 - Take a note of the time taken in rollback/reset - Take a note of the time taken in reprocessing  5. Repeat above with Reset command  ></description> </Issue>
