<Action id="39104" issue="26195" author="ales" type="comment" created="2018-01-25 14:07:00.0" updateauthor="ales" updated="2018-01-25 14:07:00.0"> <body><! CDATA I analysed the issue and here are the results:  +CC install+ * input from user is either a ChaincodeDeploymentSpec or a SignedChaincodeDeploymentSpec (which is basically a ChaincodeDeploymentSpec + instantiation policy and endorsers) * neither struct contains a hash * it is my conclusion that the install path does not introduce any inconsistencies wrt. hashing and preimages  +CC instantiation/upgrade+ * upon instantiate/upgrade, we write in the ledger a ChaincodeData struct * ChaincodeData contains an identifier (Id) which is computed as follows: * in case the chaincode was installed using a ChaincodeDeploymentSpec:   {{h1 = H(cds.CodePackage)}}  {{h2 = H(ccname || ccversion)}}  {{Id = H(h1 || h2)}} * in case the chaincode was installed using a SignedChaincodeDeploymentSpec  {{h1 = H(cds.CodePackage)}}  {{h2 = H(ccname || ccversion)}}  {{h3 = H(InstantiationPolicy || endorser_1 || ... || endorser_n)}}  {{Id = H(h1 || h2 || h3)}} *  unfortunately the preimages are not all there. In particular, the preimage of h1 is never there (given that the CodePackage is not a field of the ChaincodeData struct), nor is the preimage of h3 (given that the endorser are not a field of the ChaincodeData struct) * as a consequence, there's only a limited amount of validation that can be performed on the VSCC side when validating a CC instantiation/upgrade tx   +Possible action items+ # do not perform any additional checks # only check the proper computation of Id (check that either `Id = H(h1 || h2)` or `Id = H(h1 || h2 || h3)`), without being able to validate the correctness of h1 and h3 (since preimages are missing)  I'm currently leaning towards option 1, but I'd like to hear other opinions.  ~elli-androulaki ,  ~angelo.decaro , wdyt?  ></body> </Action>
<Action id="40369" issue="26195" author="scottz" type="comment" body="What is our exposure? What is a use-case that could cause problems, and what kind of problems?" created="2018-02-19 02:54:50.0" updateauthor="scottz" updated="2018-02-19 02:54:50.0"/>
<Action id="40388" issue="26195" author="elli-androulaki" type="comment" created="2018-02-19 14:52:48.0" updateauthor="elli-androulaki" updated="2018-02-19 14:52:48.0"> <body><! CDATA So, based on  ~ales  assessment currently there is no exposure. That is,  since the hashes provided & computed during instantiation / upgrade phase are not used anywhere.  Ideally, we would like the chaincode identifier to be computed during instantiation time (using h1, h2, and instantiation policy) / verified during validation of lscc deploy and that hash to be used as means of looking for the chaincode in subsequent chaincode invocations.   But since chaincode lifecycle is to change soon, and we have currently no breach, it may make sense to merge this work with the new cc lifecycle work for 1.2.  ></body> </Action>
<Action id="41587" issue="26195" author="elli-androulaki" type="comment" body="So this one is a code (small) improvement that could be done only after the new lifecycle is in place. It may be that the check is no longer relevant so i keep the 1.2 flag to remind ourselves to check. " created="2018-03-14 11:26:34.0" updateauthor="elli-androulaki" updated="2018-03-14 11:26:34.0"/>
<Action id="44769" issue="26195" author="kchristidis" type="comment" body=" ~elli-androulaki : Are you referring to the lifecycle changes that Jason is working on and won&apos;t be merged till 1.3? If so, this needs to be set to Backlog. At any rate, let&apos;s update the target version for this JIRA accordingly." created="2018-05-21 18:25:03.0" updateauthor="kchristidis" updated="2018-05-22 12:11:17.0"/>
<Action id="44812" issue="26195" author="elli-androulaki" type="comment" body=" ~kchristidis , you are right; updated the fix version to 1.3. It may be that we dont need to worry about this at all given the lifecycle changes, but it is good to track it to make sure that (if applicable) it is addressed." created="2018-05-22 07:25:23.0" updateauthor="elli-androulaki" updated="2018-05-22 07:25:23.0"/>
<Action id="50215" issue="26195" author="denyeart" type="comment" body=" ~jyellick  Let&apos;s revisit with new lifecycle in v2.0 timeframe. Thoughts?" created="2018-09-11 04:19:34.0" updateauthor="denyeart" updated="2018-11-27 15:35:45.0"/>
<Action id="55607" issue="26195" author="angelo.decaro" type="comment" body="Will be addressed by FAB-11237" created="2019-01-14 13:54:11.0" updateauthor="angelo.decaro" updated="2019-01-14 13:54:11.0"/>
