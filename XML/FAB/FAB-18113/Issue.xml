<Issue id="45747" key="FAB-18113" number="18113" project="10002" reporter="denyeart" creator="denyeart" type="10001" summary="Rebuild ledger state databases in parallel" priority="3" status="10100" created="2020-08-04 21:56:48.0" updated="2020-08-04 22:47:32.0" votes="0" watches="2" workflowId="59649" archived="N"> <description><! CDATA When state database is dropped, peer rebuilds state database upon the next start.  If there are multiple channels, the channel ledgers are opened and their respective state databases are rebuilt one after another.  From a performance perspective, it would be faster to open all the channel ledgers in parallel so that their state databases could be rebuilt in parallel.  Here are the log statements for state db rebuild showing the serial execution...    {code:java} 2020-08-04 17:46:55.162 EDT  ledgermgmt  OpenLedger -> INFO 016 Opening ledger with id = mychannel 2020-08-04 17:46:55.193 EDT  kvledger  recommitLostBlocks -> INFO 017 Recommitting lost blocks - firstBlockNum=0, lastBlockNum=21 2020-08-04 17:46:55.194 EDT  lockbasedtxmgr  CommitLostBlock -> INFO 018 Recommitting block  0  to state database 2020-08-04 17:46:55.641 EDT  kvledger  recommitLostBlocks -> INFO 01d Recommitted lost blocks - firstBlockNum=0, lastBlockNum=21 2020-08-04 17:46:55.651 EDT  ledgermgmt  OpenLedger -> INFO 01e Opened ledger with id = mychannel   2020-08-04 17:46:55.654 EDT  ledgermgmt  OpenLedger -> INFO 025 Opening ledger with id = mychannel2 2020-08-04 17:46:55.665 EDT  kvledger  recommitLostBlocks -> INFO 026 Recommitting lost blocks - firstBlockNum=0, lastBlockNum=0 2020-08-04 17:46:55.665 EDT  lockbasedtxmgr  CommitLostBlock -> INFO 027 Recommitting block  0  to state database 2020-08-04 17:46:55.678 EDT  kvledger  recommitLostBlocks -> INFO 028 Recommitted lost blocks - firstBlockNum=0, lastBlockNum=0 2020-08-04 17:46:55.689 EDT  ledgermgmt  OpenLedger -> INFO 029 Opened ledger with id = mychannel2 {code}    ></description> </Issue>
