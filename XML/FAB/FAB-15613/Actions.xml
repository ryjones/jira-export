<Action id="60917" issue="40360" author="yacovm" type="comment" created="2019-06-12 16:02:48.0" updateauthor="yacovm" updated="2019-06-12 16:48:54.0"> <body><! CDATA I think what we can do is: * When you initiate a connection to a remote peer- record the time it happens.  * If you get a connection from the same remote peer within a short time window (say, a second) : ** W.L.O.G if your ID is lower than the remote peer, close the incoming new connection and ignore it. ** Else, your ID is the higher than the remote peer, so close your own old connection and use the new connection. This way, when 2 peers open connections in parallel then the one with the lower ID gets to be the client, and the one with the higher ID gets to be the server.  * If you get a connection from (the same) remote peer not within a short time window, meaning - your connection to it was created too far in the past, then always close your connection and replace it with the new client side connection from the remote peer.   ~C0rWin   ~naaman  wdyt?   ></body> </Action>
<Action id="60918" issue="40360" author="naaman" type="comment" body=" ~yacovm  Ronen prepared a proposal for a solution that is similar to what you described but a bit more elaborate (e.g., one of the peers may run the original version of the code).  ~ronenschafferibm  I assume you&apos;ll add your proposed solution here shortly." created="2019-06-12 17:13:09.0" updateauthor="naaman" updated="2019-06-12 17:13:09.0"/>
<Action id="60948" issue="40360" author="ronenschafferibm" type="comment" created="2019-06-13 11:14:43.0" updateauthor="ronenschafferibm" updated="2019-06-13 11:14:43.0"> <body><! CDATA I wrote a short document that describes the current implementation and its problems. Additionally, I wrote 2 proposals to address them.   ~yacovm  the 2nd proposal is similar to yours.   https://docs.google.com/document/d/13MMvR_UNigHLqc1rgEj9KYa-AY4RP6kP91gYagKbblA/edit?usp=sharing   ></body> </Action>
<Action id="60976" issue="40360" author="mhbauer" type="comment" body="I still don&apos;t understand why we&apos;re tracking connections at all." created="2019-06-13 17:05:29.0" updateauthor="mhbauer" updated="2019-06-13 17:05:29.0"/>
<Action id="60999" issue="40360" author="naaman" type="comment" body="We are tracking connections because we want to maintain a single bi-directional connection between a pair of peers. Having just a single connection makes failure detection and maintaining membership view more reliable. Both are fundamental to gossip (and group communication is general). You have to track connection to at least be able to say if the remote node is communicating with you or not. If there are multiple connections then some may not be active which complicates things. " created="2019-06-14 02:39:20.0" updateauthor="naaman" updated="2019-06-14 02:39:20.0"/>
<Action id="65037" issue="40360" author="sykesm" type="comment" created="2019-10-28 14:47:16.0" updateauthor="sykesm" updated="2019-10-28 14:47:16.0"> <body><! CDATA  ~yacovm  This has been "assigned" to you. Are you working it or should we unassign it?  Thanks.  ></body> </Action>
<Action id="65038" issue="40360" author="yacovm" type="comment" created="2019-10-28 14:56:15.0" updateauthor="yacovm" updated="2019-10-28 14:56:15.0"> <body><! CDATA I did it, I picked his CR, but no one reviewed it :(   https://gerrit.hyperledger.org/r/#/c/fabric/+/32003/  ></body> </Action>
<Action id="65039" issue="40360" author="yacovm" type="comment" body="well, you did... and I addressed your comments but no one reviewed it after that " created="2019-10-28 14:57:25.0" updateauthor="yacovm" updated="2019-10-28 14:57:25.0"/>
<Action id="65057" issue="40360" author="sykesm" type="comment" body="I&apos;ll try to fix the merge conflict and put it back out there for review." created="2019-10-28 21:19:45.0" updateauthor="sykesm" updated="2019-10-28 21:19:45.0"/>
<Action id="65059" issue="40360" author="yacovm" type="comment" created="2019-10-28 21:54:25.0" updateauthor="yacovm" updated="2019-10-28 21:54:57.0"> <body><! CDATA I would really prefer we just bump the fix version to 2.1 and I'll start from scratch.  Always better to start from scratch.   This is really not something that effects production  ></body> </Action>
<Action id="65060" issue="40360" author="sykesm" type="comment" body="I had assumed that an open CR meant that this was desired. Marking for future and removing from the board." created="2019-10-28 22:02:51.0" updateauthor="sykesm" updated="2019-10-28 22:02:51.0"/>
<Action id="68774" issue="40360" author="denyeart" type="comment" created="2020-04-08 15:05:42.0" updateauthor="denyeart" updated="2020-04-08 15:05:42.0"> <body><! CDATA Hit again:  --- FAIL: TestLeaderYield (30.05s) gossip_service_test.go:629: Failed to establish full channel membership. Only 0 out of 2 peers have full membership  https://dev.azure.com/Hyperledger/Fabric/_build/results?buildId=11638&view=logs&jobId=a11cdf60-0d11-5130-c801-1b4953009464&j=a11cdf60-0d11-5130-c801-1b4953009464&t=849b73ad-cbaa-5065-7214-c0ac3d42920d  ></body> </Action>
