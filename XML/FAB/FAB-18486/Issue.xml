<Issue id="46922" key="FAB-18486" number="18486" project="10002" reporter="JIRAUSER21321" creator="JIRAUSER21321" type="10001" summary="createChannel on latest fabric-samples doesn&apos;t work" priority="3" status="10100" created="2021-06-10 11:39:10.0" updated="2021-06-10 11:40:16.0" votes="0" watches="1" workflowId="60825" archived="N"> <description><! CDATA I downloaded the latest version of fabric and its samples using   curl -sSL  https://bit.ly/2ysbOFE  | bash -s  when I cd into fabric-samples/test-network and run  ./network.sh up createChannel -c mychannel  I get  Error: got unexpected status: BAD_REQUEST – channel creation request not allowed because the orderer system channel is not defined Anchor peer update failed Channel 'mychannel' joined  I'm running mac os 10.15.7 and docker desktop 3.3.3   Here is the full script output:     jonas@Jonas-MBP fabric-samples/test-network (main) » ./network.sh up createChannel -c mychanneljonas@Jonas-MBP fabric-samples/test-network (main) » ./network.sh up createChannel -c mychannelCreating channel 'mychannel'.If network is not up, starting nodes with CLI timeout of '5' tries and CLI delay of '3' seconds and using database 'leveldb with crypto from 'cryptogen'Bringing up networkLOCAL_VERSION=2.3.2DOCKER_IMAGE_VERSION=2.3.2/Users/jonas/IdeaProjects/de4l-client/fabric-samples/test-network/../bin/cryptogenGenerating certificates using cryptogen toolCreating Org1 Identities+ cryptogen generate --config=./organizations/cryptogen/crypto-config-org1.yaml --output=organizationsorg1.example.com+ res=0Creating Org2 Identities+ cryptogen generate --config=./organizations/cryptogen/crypto-config-org2.yaml --output=organizationsorg2.example.com+ res=0Creating Orderer Org Identities+ cryptogen generate --config=./organizations/cryptogen/crypto-config-orderer.yaml --output=organizations+ res=0Generating CCP files for Org1 and Org2Docker Compose is now in the Docker CLI, try `docker compose up` Creating network "fabric_test" with the default driverCreating peer0.org1.example.com ... doneCreating orderer.example.com    ... doneCreating peer0.org2.example.com ... doneCreating cli                    ... doneCONTAINER ID   IMAGE                               COMMAND             CREATED         STATUS                  PORTS                                                                                  NAMESb12494361d97   hyperledger/fabric-tools:latest     "/bin/bash"         2 seconds ago   Up Less than a second                                                                                          clifcdd7f7ba687   hyperledger/fabric-orderer:latest   "orderer"           9 seconds ago   Up 1 second             0.0.0.0:7050->7050/tcp, :::7050->7050/tcp, 0.0.0.0:7053->7053/tcp, :::7053->7053/tcp   orderer.example.come76d15d7c5fd   hyperledger/fabric-peer:latest      "peer node start"   9 seconds ago   Up 2 seconds            7051/tcp, 0.0.0.0:9051->9051/tcp, :::9051->9051/tcp                                    peer0.org2.example.com76869927afad   hyperledger/fabric-peer:latest      "peer node start"   9 seconds ago   Up 5 seconds            0.0.0.0:7051->7051/tcp, :::7051->7051/tcp                                              peer0.org1.example.comGenerating channel genesis block 'mychannel.block'/Users/jonas/IdeaProjects/de4l-client/fabric-samples/test-network/../bin/configtxgen+ configtxgen -profile TwoOrgsApplicationGenesis -outputBlock ./channel-artifacts/mychannel.block -channelID mychannel2021-06-10 13:09:34.985 CEST  common.tools.configtxgen  main -> INFO 001 Loading configuration2021-06-10 13:09:34.989 CEST  common.tools.configtxgen.localconfig  completeInitialization -> INFO 002 orderer type: etcdraft2021-06-10 13:09:34.989 CEST  common.tools.configtxgen.localconfig  completeInitialization -> INFO 003 Orderer.EtcdRaft.Options unset, setting to tick_interval:"500ms" election_tick:10 heartbeat_tick:1 max_inflight_blocks:5 snapshot_interval_size:167772162021-06-10 13:09:34.989 CEST  common.tools.configtxgen.localconfig  Load -> INFO 004 Loaded configuration: /Users/jonas/IdeaProjects/de4l-client/fabric-samples/test-network/configtx/configtx.yaml2021-06-10 13:09:34.991 CEST  common.tools.configtxgen  doOutputBlock -> INFO 005 Generating genesis block2021-06-10 13:09:34.991 CEST  common.tools.configtxgen  doOutputBlock -> INFO 006 Creating application channel genesis block2021-06-10 13:09:34.991 CEST  common.tools.configtxgen  doOutputBlock -> INFO 007 Writing genesis block+ res=0Creating channel mychannelUsing organization 1+ osnadmin channel join --channelID mychannel --config-block ./channel-artifacts/mychannel.block -o localhost:7053 --ca-file /Users/jonas/IdeaProjects/de4l-client/fabric-samples/test-network/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem --client-cert /Users/jonas/IdeaProjects/de4l-client/fabric-samples/test-network/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.crt --client-key /Users/jonas/IdeaProjects/de4l-client/fabric-samples/test-network/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/tls/server.key+ res=0Status: 405\{ "error": "cannot join: channel already exists"} Channel 'mychannel' createdJoining org1 peer to the channel...Using organization 1+ peer channel join -b ./channel-artifacts/mychannel.block+ res=02021-06-10 13:09:41.297 CEST  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initialized2021-06-10 13:09:41.319 CEST  channelCmd  executeJoin -> INFO 002 Successfully submitted proposal to join channelJoining org2 peer to the channel...Using organization 2+ peer channel join -b ./channel-artifacts/mychannel.block+ res=02021-06-10 13:09:44.388 CEST  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initialized2021-06-10 13:09:44.409 CEST  channelCmd  executeJoin -> INFO 002 Successfully submitted proposal to join channelSetting anchor peer for org1...Using organization 1Fetching channel config for channel mychannelUsing organization 1+ peer channel fetch config config_block.pb -o orderer.example.com:7050 --ordererTLSHostnameOverride orderer.example.com -c mychannel --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pemFetching the most recent configuration block for the channel2021-06-10 11:09:44.713 UTC  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initialized2021-06-10 11:09:44.714 UTC  cli.common  readBlock -> INFO 002 Expect block, but got status: &\{NOT_FOUND}Error: can't read the block: &\{NOT_FOUND}Decoding config block to JSON and isolating config to Org1MSPconfig.json+ configtxlator proto_decode --input config_block.pb --type common.Block+ jq '.data.data 0 .payload.data.config'configtxlator: error: open config_block.pb: no such file or directory, try --helpGenerating anchor peer update transaction for Org1 on channel mychannel+ jq '.channel_group.groups.Application.groups.Org1MSP.values += {"AnchorPeers":{"mod_policy": "Admins","value":{"anchor_peers":    {"host": "peer0.org1.example.com","port": 7051}   },"version": "0"}}' Org1MSPconfig.json+ configtxlator proto_encode --input Org1MSPconfig.json --type common.Configconfigtxlator: error: Error decoding: error decoding input: error unmarshaling intermediate JSON: EOF+ configtxlator proto_encode --input Org1MSPmodified_config.json --type common.Configconfigtxlator: error: Error decoding: error decoding input: error unmarshaling intermediate JSON: EOF+ configtxlator compute_update --channel_id mychannel --original original_config.pb --updated modified_config.pbconfigtxlator: error: Error computing update: error computing config update: no channel group included for original config+ configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate+ jq .++ cat config_update.json+ echo '\{"payload":{"header":{"channel_header":{"channel_id":"mychannel", "type":2}},"data":\{"config_update":{' '"channel_id":' '"",' '"isolated_data":' '{},' '"read_set":' null, '"write_set":' null '}}}}'+ configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope2021-06-10 11:09:44.893 UTC  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initializedError: got unexpected status: BAD_REQUEST – channel creation request not allowed because the orderer system channel is not definedAnchor peer update failedSetting anchor peer for org2...Using organization 2Fetching channel config for channel mychannelUsing organization 2Fetching the most recent configuration block for the channel+ peer channel fetch config config_block.pb -o orderer.example.com:7050 --ordererTLSHostnameOverride orderer.example.com -c mychannel --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/organizations/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem2021-06-10 11:09:45.201 UTC  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initialized2021-06-10 11:09:45.202 UTC  cli.common  readBlock -> INFO 002 Expect block, but got status: &\{NOT_FOUND}Error: can't read the block: &\{NOT_FOUND}Decoding config block to JSON and isolating config to Org2MSPconfig.json+ configtxlator proto_decode --input config_block.pb --type common.Block+ jq '.data.data 0 .payload.data.config'configtxlator: error: open config_block.pb: no such file or directory, try --help+ jq '.channel_group.groups.Application.groups.Org2MSP.values += {"AnchorPeers":{"mod_policy": "Admins","value":{"anchor_peers":    {"host": "peer0.org2.example.com","port": 9051}   },"version": "0"}}' Org2MSPconfig.jsonGenerating anchor peer update transaction for Org2 on channel mychannel+ configtxlator proto_encode --input Org2MSPconfig.json --type common.Configconfigtxlator: error: Error decoding: error decoding input: error unmarshaling intermediate JSON: EOF+ configtxlator proto_encode --input Org2MSPmodified_config.json --type common.Configconfigtxlator: error: Error decoding: error decoding input: error unmarshaling intermediate JSON: EOF+ configtxlator compute_update --channel_id mychannel --original original_config.pb --updated modified_config.pbconfigtxlator: error: Error computing update: error computing config update: no channel group included for original config+ configtxlator proto_decode --input config_update.pb --type common.ConfigUpdate+ jq .++ cat config_update.json+ echo '\{"payload":{"header":{"channel_header":{"channel_id":"mychannel", "type":2}},"data":\{"config_update":{' '"channel_id":' '"",' '"isolated_data":' '{},' '"read_set":' null, '"write_set":' null '}}}}'+ configtxlator proto_encode --input config_update_in_envelope.json --type common.Envelope2021-06-10 11:09:45.381 UTC  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initializedError: got unexpected status: BAD_REQUEST – channel creation request not allowed because the orderer system channel is not definedAnchor peer update failedChannel 'mychannel' joined  ></description> </Issue>
