<Action id="62020" issue="41246" author="mania06" type="comment" created="2019-07-22 15:35:26.0" updateauthor="mania06" updated="2019-07-22 15:37:19.0"> <body><! CDATA Hello,  I am having the same issues.  My guess is the lack of persistance to kafka and zookeeper containers. A complete Kafka restart will clear your topics.  Sadly, I haven't any solution so far to recover from this state. I've personally reset the whole setup and started from scratch.  ></body> </Action>
<Action id="62063" issue="41246" author="denyeart" type="comment" body=" ~jyellick   ~guoger  Any ideas?" created="2019-07-24 03:42:20.0" updateauthor="denyeart" updated="2019-07-24 03:42:20.0"/>
<Action id="62069" issue="41246" author="guoger" type="comment" created="2019-07-24 06:24:49.0" updateauthor="guoger" updated="2019-07-24 06:24:49.0"> <body><! CDATA  ~mania06  you guess is correct, kafka/zk data has to be *persisted*  Start from scratch seems to be most straightforward, if it's a throw-away environment. Otherwise, you'll need to write a tool to migrate existing data to a new orderer/kafka/zk setup - extract transactions from blocks (read from peer/orderer), and submit to new cluster again.  (i guess we are not emphasizing this enough in docs... cc  ~denyeart )  ></body> </Action>
<Action id="62074" issue="41246" author="mania06" type="comment" created="2019-07-24 10:11:28.0" updateauthor="mania06" updated="2019-07-24 10:12:23.0"> <body><! CDATA > i guess we are not emphasizing this enough in docs...  Yes, a persistance guide would be very nice to setup a production network :)  ></body> </Action>
<Action id="62075" issue="41246" author="mffrench" type="comment" created="2019-07-24 10:32:29.0" updateauthor="mffrench" updated="2019-07-24 10:32:29.0"> <body><! CDATA Hello  ~guoger ,  ~jyellick ,  ~denyeart ,  in did, seems to me a volume definition is missing in the Kafka HLF docker file :   https://github.com/hyperledger/fabric-baseimage/blob/v0.4.15/images/kafka/Dockerfile.in   While waiting this file to be updated to let the community know HLF Kafka persistance configuration, can you tell us which volume directory target is needed ?  Thank you a lot !  ></body> </Action>
<Action id="62137" issue="41246" author="guoger" type="comment" body=" ~mffrench  sorry for late response, pls consult kafka &amp; zk docs for details. For example, you should be able to specify {{log.dir}} for kafka data location, which should be persisted" created="2019-07-26 02:59:25.0" updateauthor="guoger" updated="2019-07-26 02:59:25.0"/>
<Action id="62214" issue="41246" author="mffrench" type="comment" created="2019-07-29 10:20:30.0" updateauthor="mffrench" updated="2019-07-29 10:20:30.0"> <body><! CDATA Thank you  ~guoger . I think current HLF Kafka Dockerfile and configurations are confusing on this part and we can improve that directly in HLF Kafka dockerfile.   The default log.dir in kafka configuration target a directory path in /tmp/kafka-logs. That can leads to misunderstanding on the persistance or not of this folder. Then as there is no Volume defined in the Dockerfile it consolidate end user to think no persisted volume is needed in Kafka + HLF context.   Looking to HLF Kafka `docker-entrypoint.sh` it seems we may override `log.dirs` with env var like KAFKA_log.dirs. Probably may we define this env variable inside the HLF Kafka dockerfile such as `KAFKA_log.dirs=/opt/kafka/data` and then add Volume definition in the Dockerfile such as `VOLUME= '/opt/kafka/data', '/opt/kafka/logs' ` ?  Let me know what you think...  ></body> </Action>
