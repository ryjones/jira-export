<Issue id="38847" key="FAB-14872" number="14872" project="10002" reporter="jyellick" assignee="guoger" creator="jyellick" type="10002" summary="Deprecate the old consenter metadata storage location and prefer the metadata stored in the block signature." priority="3" resolution="10000" status="6" created="2019-03-29 04:18:47.0" updated="2019-07-09 14:11:44.0" resolutiondate="2019-07-09 14:11:44.0" votes="0" watches="2" workflowId="50499"> <description><! CDATA Today, the consensus plugins use the 4th field of the block metadata to store their consensus metadata info.  This made sense for Kafka, as each node was producing the blocks locally and the metadata was never shared.  However, for Raft, a single node is producing the metadata, and the block is then shared across orderers.  Because the block is shared but there is no integrity over the block metadata, for v1.4.1, the metadata was added into the bytes over which there was a block signature via FAB-14697 however, now the block metadata is duplicated in two places.  For v2.0.0, we should stop writing the metadata into the old spot, and we should prefer the metadata encoded into the first metadata field if it exists when bootstrapping a chain.  This will be especially important as we move towards BFT and the assurances provided by TLS and Deliver become much weaker, and metadata correctness will need to be checked by signature.  This will likely require modifications to the consenter interface for block writing, as metadata is currently passed as a part of the block to WriteBlock and it should be passed explicitly.  ></description> </Issue>
