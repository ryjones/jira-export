<Issue id="42362" key="FAB-16609" number="16609" project="10002" reporter="magpie73" assignee="magpie73" creator="magpie73" type="10001" summary="Fail to start with empty KeyStorePath when PKCS11 BCCSP is default" priority="3" resolution="10000" status="6" created="2019-09-16 01:29:32.0" updated="2019-09-19 15:11:46.0" resolutiondate="2019-09-19 15:11:46.0" votes="0" watches="3" workflowId="55418"> <description><! CDATA *1. Symptoms*  When SW BCCSP is set as default BCCSP provider and 'fileKeystore.KeyStorePath' config for SW BCCSP is empty, the path ' MSP directory /keystore' is used as keystore path without error.  But when Fabric is built with pkcs11 tag and PKCS11 BCCSP is default BCCSP provider, it causes error and Fabric node(peer/orderer) fails to start under same condition. The 'fileKeystore.KeyStorePath' config of both SW and PKCS11 should be set for removing the error.  Even though PKCS11 BCCSP does not need keystore, It fails to start because the logic in the PKCS11Factory only checks 'FileKeystore' config - it should also check 'KeyStorePath' under 'FileKeystore'.  *2. Enhancement suggestions*  I suggest 2 changes like below : - Set default keystore path(  MSP directory /keystore ) for SW BCCSP not only default BCCSP provider is SW, but also BCCSP just when config for SW is set(not nil). - Check BCCSP 'FileKeystore.KeyStorePath' config of PKCS11 BCCSP, set DummyKeystore if the config is empty( zero length ).    !image-2019-09-16-10-33-58-805.png!      ></description> </Issue>
