<Issue id="20259" key="FAB-5830" number="5830" project="10002" reporter="palani.kodeswaran" assignee="manish-sethi" creator="palani.kodeswaran" type="10004" summary="Peer crashes on getState" priority="3" resolution="10000" status="6" created="2017-08-17 19:06:23.0" updated="2018-07-20 14:14:09.0" resolutiondate="2017-10-18 13:22:55.0" votes="0" watches="5" workflowId="39781"> <description><! CDATA We are running a four peer alpha2-network, and 2/4 of the peers crash with the following message on getState()      36m2017-08-15 19:03:58.432 UTC  chaincode  func1 -> DEBU 124e 0m  e0e01909  getting state for chaincode wfmgr, key 11ffc294a8a744edad6c224061fa7dc0, channel beta panic: This instance should not be used after calling Done() panic: runtime error: invalid memory address or nil pointer dereference  signal SIGSEGV: segmentation violation code=0x1 addr=0x30 pc=0x67f194   goroutine 3373340  running : panic(0xc73460, 0xc420016040) /opt/go/src/runtime/panic.go:500 +0x1a1 github.com/hyperledger/fabric/core/chaincode.(*Handler).handleGetState.func1.1(0xc4213d6ab0, 0xc421a6c1e0, 0xc422561e68) /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/handler.go:621 +0x74 panic(0xc25580, 0xc422430980) /opt/go/src/runtime/panic.go:458 +0x243 github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr.(*queryHelper).checkDone(0xc420176500) /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr/helper.go:119 +0x84 github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr.(*queryHelper).getState(0xc420176500, 0xc421cf2563, 0x5, 0xc4223a1c00, 0x20, 0xc4224308d0, 0xc422b99180, 0x4, 0x4, 0xc4224308d0) /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr/helper.go:38 +0x2f github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr.(*lockBasedTxSimulator).GetState(0xc42266b940, 0xc421cf2563, 0x5, 0xc4223a1c00, 0x20, 0x4, 0x2, 0x2, 0xc422b4e050, 0x0) /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr/lockbased_tx_simulator.go:42 +0x5d github.com/hyperledger/fabric/core/chaincode.(*Handler).handleGetState.func1(0xc4213d6ab0, 0xc421a6c1e0) /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/handler.go:639 +0x502 created by github.com/hyperledger/fabric/core/chaincode.(*Handler).handleGetState /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/handler.go:660 +0x49  Â   ></description> </Issue>
