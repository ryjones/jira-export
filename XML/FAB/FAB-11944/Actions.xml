<Action id="50259" issue="33649" author="manish-sethi" type="comment" created="2018-09-11 13:46:44.0" updateauthor="manish-sethi" updated="2018-09-11 13:46:44.0"> <body><! CDATA No  ~tonyyang132  - you are not missing anything. Your understanding is correct. However, can this be the case that the state you are observing is set by some other valid transaction (before or after this invalid transaction). Can you pull out the history of this key and verify that the state was indeed set by this transaction? - if yes, then can you see if this is a repeatable so we can also try it out. Also, attach the debug logs if you have.  Finally, if you are planning to move to a newer version, can you try this on the latest version and verify whether you see the same issue?  ></body> </Action>
<Action id="50346" issue="33649" author="tonyyang132" type="comment" created="2018-09-12 10:17:57.0" updateauthor="tonyyang132" updated="2018-09-12 10:17:57.0"> <body><! CDATA  ~manish-sethi  thank you for your response. Unfortunately the customer environment has been refreshed after the pressure test, so I cannot check history of the key at this moment. But as I heard they were planning another test of similar scale. I'll have them raise the log level to debug and report back if such invalid transactions surface again.     ></body> </Action>
<Action id="50516" issue="33649" author="meinvzou" type="comment" created="2018-09-17 04:33:46.0" updateauthor="meinvzou" updated="2018-09-17 04:33:46.0"> <body><! CDATA Hi, ~manish-sethi , we've reproduced the problem, and see the log as below: 【It seemed that the readSet version is nil? Why?】 2018-09-17 02:49:19.690 UTC  statevalidator  validateKVRead -> WARN 14938 ***zouyudi*333**Version mismatch for key  syccPubwelfare:PweDcodeBind:3016927 . Committed version =  &\{%!s(uint64=42071) %!s(uint64=246)} , Version in readSet  <nil>  2018-09-17 02:49:19.720 UTC  statevalidator  ValidateAndPrepareBatch -> WARN 14939 Block  42072  Transaction index  23  TxId  eb1b447fed984aad00d0644515f123988c5ee1785eb8dd4aa089d119ab1afd66  marked as invalid by state validator. Reason code  11  2018-09-17 02:49:19.721 UTC  statevalidator  validateKVRead -> WARN 1493a ***zouyudi*333**Version mismatch for key  syccPubwelfare:PweDcodeBind:3016885 . Committed version =  &\{%!s(uint64=42071) %!s(uint64=244)} , Version in readSet  <nil>  2018-09-17 02:49:19.721 UTC  statevalidator  ValidateAndPrepareBatch -> WARN 1493b Block  42072  Transaction index  34  TxId  53274639503774f9175ef917018349c7fcd400e13cdcc83fddf302b7f0d89b94  marked as invalid by state validator. Reason code  11  2018-09-17 02:49:19.751 UTC  kvledger  Commit -> INFO 1493c Channel  pubchain : Created block  42072  with 250 transaction(s)  ></body> </Action>
<Action id="50567" issue="33649" author="manish-sethi" type="comment" created="2018-09-17 18:56:53.0" updateauthor="manish-sethi" updated="2018-09-17 18:56:53.0"> <body><! CDATA These logs does not assert the problem mentioned in the Jira (Rather, they depict that things are working as normal) unless you can provide more data points.  A version of a key in the ReadSet 'nil' is a legitimate case which happens when you read a non-existent key at the time of chaincode invoke (simulation).  Further, the log shows that the transaction (that performed a read for a non-existent key) was included in block number  42072 , tran number  23  and was marked invalid because some other transaction (in block number  42071 , tran number  246 ) was already committed and had inserted this key.  ></body> </Action>
<Action id="50579" issue="33649" author="meinvzou" type="comment" created="2018-09-18 04:18:04.0" updateauthor="meinvzou" updated="2018-09-18 04:18:04.0"> <body><! CDATA  ~manish-sethi {color:#172b4d}, {color}Thank you so much. It's indeed what you mentioned. We'll find the reason on the upper layer about our application level. Fabric works as EXPECTED.  !image-2018-09-18-12-15-28-893.png!  ></body> </Action>
<Action id="50601" issue="33649" author="manish-sethi" type="comment" body="Thanks  ~meinvzou  for confirming back. I&apos;ll close this Jira." created="2018-09-18 13:51:33.0" updateauthor="manish-sethi" updated="2018-09-18 13:51:33.0"/>
