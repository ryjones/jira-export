<Issue id="37442" key="FAB-14063" number="14063" project="10002" reporter="wlahti" assignee="wlahti" creator="wlahti" type="10004" summary="Deliver can send multiple blocks when seeking newest" priority="3" resolution="10000" status="6" created="2019-02-05 15:44:08.0" updated="2019-12-15 18:56:24.0" resolutiondate="2019-02-06 14:01:15.0" votes="0" watches="1" workflowId="49047"> <description><! CDATA When seeking just the newest block (i.e. starting and stopping at newest), there is a timing bug that can lead to more than one block being sent. This happens if a block is committed just after Deliver acquires a ledger iterator. The logic for newest would then set the stop number to the ledger height minus one: {code:java} case *ab.SeekPosition_Newest:		 stopNum = chain.Reader().Height() - 1{code} which has changed since the iterator logic evaluated it.  The fix is to check whether the seek start and stop positions are both set to "newest" and set the stopNum to the value returned by the iterator for this case.Â   ></description> </Issue>
