<Action id="70446" issue="46184" author="dongming" type="comment" created="2020-10-06 14:55:58.0" updateauthor="dongming" updated="2020-10-06 14:55:58.0"> <body><! CDATA steps to test: # generate a snapshot at block=10,000 # issue bootbysnapshot on a new peer from the snapshot above # kill the new peer once the bootbysnapshot process begins on the new peer # wait for 3 min, restart the new peer # check the new peer log to ensure that it does not boot from snapshot # then issue bootbysnapshot again on the new new and the peer is booted successfully from the snapshot  The peer log below shows that the bootbysnapshot begins and the peer is kiiled, then restart and the bootbysnapshot does not occur automatically     ^  34m2020-10-05 16:48:54.932 UTC  blkstorage  preResetHtFiles -> INFO 01f^  0m No active channels passed ^  34m2020-10-05 18:14:22.068 UTC  ledgermgmt  createFromSnapshot -> INFO 020^  0m Creating ledger from snapshot at /var/hyperledger/production/ledgersData/snapshots/completed/testorgschannel0/10000 ^  34m2020-10-05 18:17:50.795 UTC  nodeCmd  serve -> INFO 001^  0m Starting peer: Version: 2.3.0 Commit SHA: 20eb852 Go version: go1.14.4 OS/Arch: linux/amd64 Chaincode: Base Docker Label: org.hyperledger.fabric Docker Namespace: hyperledger ... ^  34m2020-10-05 18:17:50.825 UTC  ledgermgmt  NewLedgerMgr -> INFO 009^  0m Initializing LedgerMgr ^  34m2020-10-05 18:17:51.145 UTC  kvledger  deleteUnderConstructionLedgers -> INFO 00a^  0m An under-construction ledger found at start. This indicates a peer stop/crash during creation of a ledger. Going to delete the partially created ledger ledgerID=testorgschannel0 ^  34m2020-10-05 18:17:51.145 UTC  kvledger  Drop -> INFO 00b^  0m Dropping ledger data channel=testorgschannel0 ^  34m2020-10-05 18:17:51.178 UTC  leveldbhelper  deleteAll -> INFO 00c^  0m Have removed 11114 entries for channel testorgschannel0 in leveldb /var/hyperledger/production/ledgersData/chains/index ^  34m2020-10-05 18:17:51.194 UTC  leveldbhelper  deleteAll -> INFO 00d^  0m Have removed 22226 entries for channel testorgschannel0 in leveldb /var/hyperledger/production/ledgersData/chains/index ^  34m2020-10-05 18:17:51.210 UTC  leveldbhelper  deleteAll -> INFO 00e^  0m Have removed 33338 entries for channel testorgschannel0 in leveldb /var/hyperledger/production/ledgersData/chains/index ... ^  34m2020-10-05 18:17:52.320 UTC  leveldbhelper  deleteAll -> INFO 030^  0m Have removed 407351 entries for channel testorgschannel0 in leveldb /var/hyperledger/production/ledgersData/chains/index ^  34m2020-10-05 18:17:52.339 UTC  leveldbhelper  deleteAll -> INFO 031^  0m Have removed 418341 entries for channel testorgschannel0 in leveldb /var/hyperledger/production/ledgersData/chains/index ^  34m2020-10-05 18:17:52.380 UTC  ledgermgmt  NewLedgerMgr -> INFO 032^  0m Initialized LedgerMgr ^  34m2020-10-05 18:17:52.384 UTC  gossip.service  New -> INFO 033^  0m Initialize gossip with endpoint peer1-org1:31001 ^  34m2020-10-05 18:17:52.387 UTC  gossip.gossip  New -> INFO 034^  0m Creating gossip service with self membership of Endpoint: peer1-org1:31001, InternalEndpoint: peer1-org1:31001, PKI-ID: 5116d8d63da490edd2666181c8458c9652952ee3aa9af352190275aef278ef20, Metadata: ^  34m2020-10-05 18:17:52.388 UTC  lifecycle  InitializeLocalChaincodes -> INFO 035^  0m Initialized lifecycle cache with 0 already installed chaincodes ^  34m2020-10-05 18:17:52.388 UTC  gossip.gossip  start -> INFO 036^  0m Gossip instance peer1-org1:31001 started ^  34m2020-10-05 18:17:52.389 UTC  nodeCmd  computeChaincodeEndpoint -> INFO 037^  0m Entering computeChaincodeEndpoint with peerHostname: peer1-org1 ^  34m2020-10-05 18:17:52.389 UTC  nodeCmd  computeChaincodeEndpoint -> INFO 038^  0m Exit with ccEndpoint: peer1-org1:7052 ^  34m2020-10-05 18:17:52.392 UTC  sccapi  DeploySysCC -> INFO 039^  0m deploying system chaincode 'lscc' ^  34m2020-10-05 18:17:52.393 UTC  sccapi  DeploySysCC -> INFO 03a^  0m deploying system chaincode 'cscc' ^  34m2020-10-05 18:17:52.393 UTC  sccapi  DeploySysCC -> INFO 03b^  0m deploying system chaincode 'qscc' ^  34m2020-10-05 18:17:52.394 UTC  sccapi  DeploySysCC -> INFO 03c^  0m deploying system chaincode '_lifecycle' ^  34m2020-10-05 18:17:52.394 UTC  nodeCmd  serve -> INFO 03d^  0m Deployed system chaincodes ^  34m2020-10-05 18:17:52.394 UTC  discovery  NewService -> INFO 03e^  0m Created with config TLS: true, authCacheMaxSize: 1000, authCachePurgeRatio: 0.750000 ^  34m2020-10-05 18:17:52.394 UTC  nodeCmd  registerDiscoveryService -> INFO 03f^  0m Discovery service activated ^  34m2020-10-05 18:17:52.395 UTC  nodeCmd  serve -> INFO 040^  0m Starting peer with ID= peer1-org1 , network ID= dev , address= peer1-org1:31001  ^  34m2020-10-05 18:17:52.395 UTC  nodeCmd  serve -> INFO 041^  0m Started peer with ID= peer1-org1 , network ID= dev , address= peer1-org1:31001  ^  34m2020-10-05 18:17:52.395 UTC  kvledger  LoadPreResetHeight -> INFO 042^  0m Loading prereset height from path  /var/hyperledger/production/ledgersData/chains  ^  34m2020-10-05 18:17:52.395 UTC  blkstorage  preResetHtFiles -> INFO 043^  0m No active channels passed     ></body> </Action>
