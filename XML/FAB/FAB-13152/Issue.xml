<Issue id="35861" key="FAB-13152" number="13152" project="10002" reporter="tock" assignee="tock" creator="tock" type="10004" summary="make protos is broken" priority="2" resolution="10000" status="6" created="2018-12-04 14:08:49.0" updated="2018-12-05 16:25:07.0" resolutiondate="2018-12-05 16:25:02.0" votes="0" watches="3" workflowId="47360"> <description><! CDATA make protos is broken on master.  It seems that  https://gerrit.hyperledger.org/r/#/c/27180/  introduced   common/grpclogging/testpb/echo.proto  common/grpcmetrics/testpb/echo.proto  with wrong go_package path.  ====================================  ++ find . -name .protoroot -exec readlink -f '{}' ';' + PROTO_ROOT_FILES=/opt/gopath/src/github.com/hyperledger/fabric/protos/.protoroot ++ dirname /opt/gopath/src/github.com/hyperledger/fabric/protos/.protoroot + PROTO_ROOT_DIRS=/opt/gopath/src/github.com/hyperledger/fabric/protos +++ for dir in '$PROTO_ROOT_DIRS' +++ echo '-path /opt/gopath/src/github.com/hyperledger/fabric/protos -prune -o ' ++ find /opt/gopath/src/github.com/hyperledger/fabric -path /opt/gopath/src/github.com/hyperledger/fabric/protos -prune -o -path /opt/gopath/src/github.com/hyperledger/fabric/vendor -prune -o -path /opt/gopath/src/github.com/hyperledger/fabric/.build -prune -o -path /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/shim/java -prune -o -name '*.proto' -exec readlink -f '{}' ';' + ROOTLESS_PROTO_FILES='/opt/gopath/src/github.com/hyperledger/fabric/common/tools/protolator/testprotos/sample.proto /opt/gopath/src/github.com/hyperledger/fabric/common/grpcmetrics/testpb/echo.proto /opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb/echo.proto /opt/gopath/src/github.com/hyperledger/fabric/core/comm/testdata/grpc/test.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/pvtdatastorage/persistent_msgs.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/stateleveldb/msgs/storage.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/statecouchdb/msgs/msgs.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/pvtstatepurgemgmt/pvtdata_key.proto' ++ uniq ++ sort ++ dirname /opt/gopath/src/github.com/hyperledger/fabric/common/tools/protolator/testprotos/sample.proto /opt/gopath/src/github.com/hyperledger/fabric/common/grpcmetrics/testpb/echo.proto /opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb/echo.proto /opt/gopath/src/github.com/hyperledger/fabric/core/comm/testdata/grpc/test.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/pvtdatastorage/persistent_msgs.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/stateleveldb/msgs/storage.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/statecouchdb/msgs/msgs.proto /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/pvtstatepurgemgmt/pvtdata_key.proto + ROOTLESS_PROTO_DIRS='/opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb /opt/gopath/src/github.com/hyperledger/fabric/common/grpcmetrics/testpb /opt/gopath/src/github.com/hyperledger/fabric/common/tools/protolator/testprotos /opt/gopath/src/github.com/hyperledger/fabric/core/comm/testdata/grpc /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/pvtstatepurgemgmt /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/statecouchdb/msgs /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/stateleveldb/msgs /opt/gopath/src/github.com/hyperledger/fabric/core/ledger/pvtdatastorage' + for dir in '$ROOTLESS_PROTO_DIRS' '$PROTO_ROOT_DIRS' + echo Working on dir /opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb Working on dir /opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb ++ uniq ++ sort ++ find /opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb -name '*.proto' -exec dirname '{}' ';' + for protos in '$(find "$dir" -name '\''*.proto'\'' -exec dirname {} \; | sort | uniq)' + protoc --proto_path=/opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb --go_out=plugins=grpc:/opt/gopath/src /opt/gopath/src/github.com/hyperledger/fabric/common/grpclogging/testpb/echo.proto /opt/gopath/src/echo.pb.go: Permission deniedMakefile:409: recipe for target 'protos' failed make: ***  protos  Error 1     ></description> </Issue>
