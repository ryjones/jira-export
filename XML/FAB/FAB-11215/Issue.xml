<Issue id="32000" key="FAB-11215" number="11215" project="10002" reporter="sykesm" assignee="jyellick" creator="sykesm" type="10004" summary="Enable additional print functions in vet to catch bad logging formats" priority="4" resolution="10000" status="6" created="2018-07-17 21:17:19.0" updated="2018-07-20 14:17:11.0" resolutiondate="2018-07-18 20:32:40.0" votes="0" watches="2" workflowId="42683"> <description><! CDATA {code} scripts/golinter.sh: ``` $ git diff scripts/ diff --git a/scripts/golinter.sh b/scripts/golinter.sh index 0c8fc3650..3be79a98b 100755 --- a/scripts/golinter.sh +++ b/scripts/golinter.sh @@ -33,7 +33,7 @@ if   -n "$OUTPUT"  ; then fi  echo "Checking with go vet" -OUTPUT="$(go vet ./...)" +OUTPUT="$(go vet -printfuncs Critical,Criticalf,Debug,Debugf,Info,Infof,Notice,Noticef,Warning,Warningf ./...)" if   -n "$OUTPUT"  ; then echo "The following files contain go vet errors" echo $OUTPUT {code}  Results in the following problems: {code}  sykesm@trapped  (master *)$ ./scripts/golinter.sh  Checking with gofmt Checking with goimports Checking with go vet # github.com/hyperledger/fabric/bccsp/pkcs11 bccsp/pkcs11/pkcs11.go:602: Warningf call has arguments but no formatting directives # github.com/hyperledger/fabric/common/tools/configtxgen/localconfig common/tools/configtxgen/localconfig/config.go:375: Infof format %s has arg genesisDefaults.Orderer.BatchSize.MaxMessageCount of wrong type uint32 common/tools/configtxgen/localconfig/config.go:378: Infof format %s has arg genesisDefaults.Orderer.BatchSize.AbsoluteMaxBytes of wrong type uint32 common/tools/configtxgen/localconfig/config.go:381: Infof format %s has arg genesisDefaults.Orderer.BatchSize.PreferredMaxBytes of wrong type uint32 # github.com/hyperledger/fabric/core/deliverservice/blocksprovider core/deliverservice/blocksprovider/blocksprovider.go:198: Warningf call needs 1 arg but has 2 args core/deliverservice/blocksprovider/blocksprovider.go:217: Debug call has possible formatting directive %s # github.com/hyperledger/fabric/core/ledger/kvledger/history/historydb/historyleveldb core/ledger/kvledger/history/historydb/historyleveldb/historyleveldb_query_executer.go:95: Debugf call has arguments but no formatting directives # github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/validator/statebasedval core/ledger/kvledger/txmgmt/validator/statebasedval/combined_iterator.go:137: Debugf format %s has arg vv of wrong type *github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb.VersionedValue core/ledger/kvledger/txmgmt/validator/statebasedval/combined_iterator.go:142: Debugf format %s has arg vv of wrong type *github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb.VersionedValue core/ledger/kvledger/txmgmt/validator/statebasedval/state_based_validator.go:279: Debugf format %s has arg committedVersion of wrong type *github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/version.Height # github.com/hyperledger/fabric/core/scc core/scc/sysccapi.go:133: Infof format %s arg syscc.Name is a func value, not called # github.com/hyperledger/fabric/gossip/comm gossip/comm/comm_impl.go:460: Warning call has possible formatting directive %s gossip/comm/conn.go:353: Debugf format %v reads arg #2, but call has only 1 arg gossip/comm/conn.go:359: Warning call has possible formatting directive %v # github.com/hyperledger/fabric/gossip/service gossip/service/gossip_service.go:330: Debugf call has arguments but no formatting directives # github.com/hyperledger/fabric/gossip/gossip gossip/gossip/gossip_impl.go:414: Warningf call needs 1 arg but has 2 args # github.com/hyperledger/fabric/orderer/common/localconfig orderer/common/localconfig/config.go:265: Infof format %s has arg Defaults.General.ListenPort of wrong type uint16 # github.com/hyperledger/fabric/gossip/privdata gossip/privdata/coordinator.go:310: Warningf format %s has arg missingPvtRWKey of wrong type privdata.rwSetKey gossip/privdata/pull.go:505: Debug call has possible formatting directive %v {code}  /cc  ~jyellick   ></description> </Issue>
