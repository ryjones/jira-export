<Issue id="18727" key="FAB-5038" number="5038" project="10002" reporter="jyellick" assignee="mastersingh24" creator="jyellick" type="10004" summary="first-network crypto-config dir is owned by root" priority="3" resolution="10000" status="6" created="2017-06-27 18:13:55.0" updated="2018-07-20 14:13:37.0" resolutiondate="2017-06-30 17:53:33.0" votes="0" watches="3" workflowId="39296" security="10001"> <description><! CDATA Update:  I now have a procedure which reliably reproduces the original bug.  1. {{./byfn.sh -m generate}} 2. {{./byfn.sh -m up}}  Wait until completed successfully with the large "END" message.  Then escape via ^c.  3. {{./byfn.sh -m down}} 4. {{./byfn.sh -m up}}  Note, the crypto material was not regenerated here.  And the 'up' fails with the following error: "ERRO 001 Cannot run peer because cannot init crypto, missing /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp folder"  5. {{./byfn.sh -m down}}  The error as documented below is observed.  ===================================================  After running the byfn.sh example, attempting to invoke {{./byfn.sh -m down}} may result in error, because the user does not have permissions to remove the {{crypto-config-dir}}.  {noformat}  yellickj@jmobile first-network $ ./byfn.sh -m down Stopping with channel 'mychannel' and CLI timeout of '10000' Continue (y/n)? y proceeding ... WARNING: The CHANNEL_NAME variable is not set. Defaulting to a blank string. WARNING: The TIMEOUT variable is not set. Defaulting to a blank string. Removing peer0.org2.example.com ... done Removing peer1.org1.example.com ... done Removing orderer.example.com ... done Removing peer1.org2.example.com ... done Removing peer0.org1.example.com ... done Removing network net_byfn eb1d080e7655 82f6ddbda167 91790bc3cf5f 585b2505dd26 ---- No images available for deletion ---- rm: cannot remove 'crypto-config/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/msp/keystore': Permission denied rm: cannot remove 'crypto-config/peerOrganizations/org2.example.com/peers/peer1.org2.example.com/tls': Permission denied rm: cannot remove 'crypto-config/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/msp/keystore': Permission denied rm: cannot remove 'crypto-config/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls': Permission denied rm: cannot remove 'crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp/keystore': Permission denied rm: cannot remove 'crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls': Permission denied rm: cannot remove 'crypto-config/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/msp/keystore': Permission denied rm: cannot remove 'crypto-config/peerOrganizations/org1.example.com/peers/peer1.org1.example.com/tls': Permission denied rm: cannot remove 'crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/msp': Permission denied rm: cannot remove 'crypto-config/ordererOrganizations/example.com/orderers/orderer.example.com/tls': Permission denied  yellickj@jmobile first-network $ sudo ^C  yellickj@jmobile first-network $ ls -l total 68 drwxr-xr-x 2 yellickj users  4096 Jun 27 10:40 base drwxr-xr-x 2 yellickj users  4096 Jun 23 18:08 bin -rwxr-xr-x 1 yellickj users 13409 Jun 27 10:40 byfn.sh drwxr-xr-x 4 yellickj users  4096 Jun 27 10:40 chaincode drwxr-xr-x 2 yellickj users  4096 Jun 27 14:10 channel-artifacts -rw-r--r-- 1 yellickj users  5013 Jun 27 10:40 configtx.yaml drwxr-xr-x 4 root     root   4096 Jun 27 14:09 crypto-config -rw-r--r-- 1 yellickj users  3858 Jun 27 10:40 crypto-config.yaml -rw-r--r-- 1 yellickj users  2855 Jun 27 10:40 docker-compose-cli.yaml -rw-r--r-- 1 yellickj users  2132 Jun 27 10:40 docker-compose-couch.yaml -rw-r--r-- 1 yellickj users  2724 Jun 27 10:40 docker-compose-e2e-template.yaml -rw-r--r-- 1 yellickj users   217 Jun 27 10:40 README.md drwxr-xr-x 2 yellickj users  4096 Jun 27 14:09 scripts {noformat}    ></description> </Issue>
