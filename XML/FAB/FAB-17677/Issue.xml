<Issue id="44681" key="FAB-17677" number="17677" project="10002" reporter="senthil1" assignee="senthil1" creator="senthil1" type="10003" summary="move txvalidation flag util to internal/pkg from ledger" priority="3" resolution="10000" status="6" created="2020-03-27 04:00:39.0" updated="2020-04-03 04:12:23.0" resolutiondate="2020-04-03 04:12:23.0" votes="0" watches="1" workflowId="58599" archived="N"> <description><! CDATA The  txvalidation util package|https://github.com/hyperledger/fabric/blob/master/core/ledger/util/txvalidationflags.go  helps in creating transaction validation flags that would be assigned to the block metadata. This function is used by the  v14|https://github.com/hyperledger/fabric/tree/master/core/committer/txvalidator/v14  and  v20|https://github.com/hyperledger/fabric/tree/master/core/committer/txvalidator/v20  validation as it is needed by these packages to record invalid tx as per policy evaluation. This validation flags is also reused in the  mvcc validator|https://github.com/hyperledger/fabric/tree/master/core/ledger/kvledger/txmgmt/validator  to mark valid/invalid transactions. As the txvalidation util package is used only in these two packages, there is no need to keep it in _core/ledger/util/_  Hence, we move the txvalidation util package to the  core/committer/txvalidator|https://github.com/hyperledger/fabric/tree/master/core/committer/txvalidator  where it is used first and it is imported in the  core/ledger/kvledger/txmgmt/validator|https://github.com/hyperledger/fabric/tree/master/core/ledger/kvledger/txmgmt/validator . I really could not find a better way than this. This is because our existing folder structure is flawed:  (1) core/committer/txvalidator – this is called committer (2) core/ledger/kvledger/ – here only the actual commit to database and disk happen (3) core/committer/txvalidator/v14 – first validator (4) core/ledger/kvledger/txmgmt/validator – second validator  I am sure this structure would make any beginner crazy. We should have one package called validation which should do both vscc and mvcc validation. Then we should have another package called committer which should do all commit to databases and disk – refer to figure 9 on page 6 –  https://arxiv.org/pdf/2003.05113.pdf |https://arxiv.org/pdf/2003.05113.pdf for such an architecture.   Given that we have a bad package structure, I could not find a better place for txvalidation util package other than moving it to _core/committer/txvalidator_ package.  ></description> </Issue>
