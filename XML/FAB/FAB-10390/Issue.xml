<Issue id="30645" key="FAB-10390" number="10390" project="10002" reporter="rhegde" assignee="ashutosh_kumar" creator="rhegde" type="10004" summary=" Pen Test Finding - HSM Signing Key  Required to set CKA_MODIFIABLE as CK_FALSE" priority="3" resolution="10000" status="6" created="2018-05-25 15:48:56.0" updated="2018-08-27 13:02:14.0" resolutiondate="2018-08-27 12:49:43.0" votes="0" watches="3" workflowId="43289"> <description><! CDATA Fabric Release  - v1.0.6  Here is the Pen Test finding on the Key Generated using Fabric CA Client  {code:java} The signature key is created with CKA_ MODIFIABLE=TRUE, and the fuzzing results confirm that many of the attributes of private keys can indeed be changed by the C_SetAttribute command. The reason for this is clear from the other traces: once the key has been generated, the C_SetAttribute command is used to change the CKA_ID and CKA_LABEL attributes using data about the value of the public key, so that the key can be easily identified in future. While this seems reasonable, it should be noted that the CKA_ID and CKA_LABEL attributes could be changed again in the future by an attacker. In particular, if the partition contains more than one key (as was the case with the HSM under test), an attacker could swap the identifiers. Since the C_FindObjects command that is used to identify the key for signature only uses the attributes CKA_ID and CKA_CLASS, just changing the CKA_ID would be enough to switch the key used to produce signatures added to the chain. This could potentially cause serious issues. {code} +*Recommendation*+  Fabric CA Client should set the CKA_MODIFIABLE attribute to CK_FALSE after the modifications necessary to CKA_ID and CKA_LABEL have been made.  ></description> </Issue>
