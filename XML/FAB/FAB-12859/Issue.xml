<Issue id="35349" key="FAB-12859" number="12859" project="10002" reporter="mbwhite" creator="mbwhite" type="10001" summary="Empheral Chaincode Build Container on wrong network" priority="3" resolution="10001" status="6" created="2018-11-14 16:17:13.0" updated="2020-01-22 22:32:19.0" resolutiondate="2020-01-22 22:32:19.0" votes="0" watches="2" workflowId="46814"> <description><! CDATA Summary is that docker container used for building the chaincode docker container is not the same network that the chaincode container will be, nor does there seem a way to control this.     - Using a 2 organization fabric network - Created a docker network for the containers - Added a verdaccio server to it - to allow for local deployment of code; replicating what might be an internal npm server - the npm install that takes place in the empheral 'build' docker  {{Networks}} {{  ~  docker network ls }} {{NETWORK ID NAME DRIVER SCOPE}} {{b76928574200 bridge bridge local}} {{3cb876821d0b host host local}} {{7f9ffdfc2174 none null local}} {{2d45c7fce037 trade_network bridge local}}  After a full run, you get the following information on the network.  You can see the chaincode containers that are setup, as well as all hte  {{ ~  docker network inspect trade_network }} {{ }} {{{}} {{"Name": "trade_network",}} {{"Id": "2d45c7fce037385bb468c06dc0b4178bb058a78ebbe03d64cdd80e1f1ef1dd87",}} {{"Created": "2018-11-14T13:15:07.457922816Z",}} {{"Scope": "local",}} {{"Driver": "bridge",}} {{"EnableIPv6": false,}} {{"IPAM": {}} {{"Driver": "default",}} {{"Options": {},}} {{"Config":  }} {{{}} {{"Subnet": "172.28.0.0/16",}} {{"Gateway": "172.28.0.1"}} {{}}} {{ }} {{},}} {{"Internal": false,}} {{"Attachable": true,}} {{"Ingress": false,}} {{"ConfigFrom": {}} {{"Network": ""}} {{},}} {{"ConfigOnly": false,}} {{"Containers": {}} {{"3d9b934fec45eef0060f119058b7ceac0985bfde7031acecaf39cc9bbc46b4f4": {}} {{"Name": "dev-peer0.org2.example.com-bank-network-0.0.10",}} {{"EndpointID": "609bd74ceb5437d01491f9342b3869125b7288897ced286bbe4660e51f6b26ab",}} {{"MacAddress": "02:42:ac:1c:00:0a",}} {{"IPv4Address": "172.28.0.10/16",}} {{"IPv6Address": ""}} {{},}} {{"6ddddc4ed371c226f50688d576189e72a43c22a62c81d4873aa5359be7803966": {}} {{"Name": "couchdb.org1.example.com",}} {{"EndpointID": "172fedf029c19ea3bf64f61a324d2d92af895702cdd405f4e2bfc73894dc0abf",}} {{"MacAddress": "02:42:ac:1c:00:07",}} {{"IPv4Address": "172.28.0.7/16",}} {{"IPv6Address": ""}} {{},}} {{"745eee52d1b7593a84a31014f8f1b75bd1a67a37d10b2c8de469f8cec693ac61": {}} {{"Name": "logspout",}} {{"EndpointID": "fcd60f1e889f316afdefc48e4ef57a32ba16360d87e9c06b00ceeb1cd93e673a",}} {{"MacAddress": "02:42:ac:1c:00:03",}} {{"IPv4Address": "172.28.0.3/16",}} {{"IPv6Address": ""}} {{},}} {{"8c21381a087387d9dae71c8b9ba5583a6ed2a6da73b743f74da83d559832c076": {}} {{"Name": "dev-peer0.org1.example.com-bank-network-0.0.10",}} {{"EndpointID": "6d56ad77a9b79f34744330bd90c260556728da853fad96fb4d2472865851cd6b",}} {{"MacAddress": "02:42:ac:1c:00:0b",}} {{"IPv4Address": "172.28.0.11/16",}} {{"IPv6Address": ""}} {{},}} {{"ae0d461b0bda1de27d4c951fc100d7e33fdd503b981750e42b54bae15f645d7c": {}} {{"Name": "ca.org1.example.com",}} {{"EndpointID": "5c4c89c2cc2f3f704bee2d00b01f700c1bc7e62805f9f080835f82e57c5ab237",}} {{"MacAddress": "02:42:ac:1c:00:05",}} {{"IPv4Address": "172.28.0.5/16",}} {{"IPv6Address": ""}} {{},}} {{"b4e855d8af38034303227fff15c688cd3aba38a43746b43938515da730d3cc4e": {}} {{"Name": "couchdb.org2.example.com",}} {{"EndpointID": "91fc9a6a05593d6ca830da1d8c69eb779dc59b47eebe3e70ea39f12c7f5744b0",}} {{"MacAddress": "02:42:ac:1c:00:06",}} {{"IPv4Address": "172.28.0.6/16",}} {{"IPv6Address": ""}} {{},}} {{"c184e211128008443b69f8bdf8ee577a9f95e308af8687d755e70775019e1025": {}} {{"Name": "peer0.org1.example.com",}} {{"EndpointID": "6a99bfa753813c985869b77acacf021db13bbf28ec8a1119d564acedb1c27c18",}} {{"MacAddress": "02:42:ac:1c:00:09",}} {{"IPv4Address": "172.28.0.9/16",}} {{"IPv6Address": ""}} {{},}} {{"e09364f034d5bd1711792f43c2161195fc7f6512044a426c92b66abb4c85b0d8": {}} {{"Name": "orderer.example.com",}} {{"EndpointID": "abfc4e0019d2b3ccf742269d356ecc1afb43c9f673973ba114d83a710e3e7683",}} {{"MacAddress": "02:42:ac:1c:00:04",}} {{"IPv4Address": "172.28.0.4/16",}} {{"IPv6Address": ""}} {{},}} {{"f129584c45239fbfa09d278b12ccd1d5ceabf3ee4b411ff0124e57a39aafedef": {}} {{"Name": "verdaccio",}} {{"EndpointID": "4514d84d34fbd903845972767b45b99ddb6eff2ea5b11d44f2d20785aee254b5",}} {{"MacAddress": "02:42:ac:1c:00:02",}} {{"IPv4Address": "172.28.0.2/16",}} {{"IPv6Address": ""}} {{},}} {{"f89b740fa526607351ef41eff70338e91cf3142e66c13f93ac66eda95071f8a0": {}} {{"Name": "peer0.org2.example.com",}} {{"EndpointID": "5009a680b68497b8f2630fa31387792db3a9737f93a4ccb3a887047b09a2d0b7",}} {{"MacAddress": "02:42:ac:1c:00:08",}} {{"IPv4Address": "172.28.0.8/16",}} {{"IPv6Address": ""}} {{}}} {{},}} {{"Options": {},}} {{"Labels": {}}} {{}}} {{ }}  When you look at the docker container for the build - you can see that this attached to a different network.  {{```}} {{docker container inspect ecstatic_cray }} {{ }} {{{}} {{"Id": "54a3d4773765eb383fa189628ff8208f56f7284ef17c4c4fa996423a94a85795",}} {{"Created": "2018-11-14T14:40:58.169067375Z",}} {{"Path": "/bin/sh",}} {{"Args":  }} {{"-c",}} {{"cp -R /chaincode/input/src/. /chaincode/output && cd /chaincode/output && npm install --production"}} {{ ,}} {{....}} {{"NetworkSettings": {}} {{"Bridge": "",}} {{"SandboxID": "d8d7add8cecfe4f11f6bc5a005dc0d71d7a925229706fce9fcd96cc6258f5616",}} {{"HairpinMode": false,}} {{"LinkLocalIPv6Address": "",}} {{"LinkLocalIPv6PrefixLen": 0,}} {{"Ports": {},}} {{"SandboxKey": "/var/run/docker/netns/d8d7add8cecf",}} {{"SecondaryIPAddresses": null,}} {{"SecondaryIPv6Addresses": null,}} {{"EndpointID": "3c75a0f6d8b6b8e5150499dd59467ac1c8e42626e73fe293bb6067ae19cf7657",}} {{"Gateway": "172.17.0.1",}} {{"GlobalIPv6Address": "",}} {{"GlobalIPv6PrefixLen": 0,}} {{"IPAddress": "172.17.0.2",}} {{"IPPrefixLen": 16,}} {{"IPv6Gateway": "",}} {{"MacAddress": "02:42:ac:11:00:02",}} {{"Networks": {}} {{"bridge": {}} {{"IPAMConfig": null,}} {{"Links": null,}} {{"Aliases": null,}} {{"NetworkID": "b76928574200eaa54d1a8bea6966ae2abe94a7f5266d30c5eec53897fafef6e3",}} {{"EndpointID": "3c75a0f6d8b6b8e5150499dd59467ac1c8e42626e73fe293bb6067ae19cf7657",}} {{"Gateway": "172.17.0.1",}} {{"IPAddress": "172.17.0.2",}} {{"IPPrefixLen": 16,}} {{"IPv6Gateway": "",}} {{"GlobalIPv6Address": "",}} {{"GlobalIPv6PrefixLen": 0,}} {{"MacAddress": "02:42:ac:11:00:02",}} {{"DriverOpts": null}} {{}}} {{}}} {{}}} {{}}} {{ }}{{```}}  ></description> </Issue>
