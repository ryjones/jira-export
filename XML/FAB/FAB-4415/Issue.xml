<Issue id="17562" key="FAB-4415" number="4415" project="10002" reporter="ratnakar" assignee="ratnakar" creator="ratnakar" type="10004" summary="Channel creation fails intermittently with kafka ordering service" priority="3" resolution="10000" status="6" created="2017-06-06 14:07:37.0" updated="2018-07-20 14:13:10.0" resolutiondate="2017-06-11 16:08:58.0" votes="0" watches="3" workflowId="38857" security="10001"> <description><! CDATA Commit Level : *c50e0dd1ca1ea96cb69503fc83a302c53eff96a6*  Channel creation fails intermittently , with the following network configuration {panel} 3 Kafka brokers with 3 zookeepers 3 Ordererers 2 Peer Organizations (each org contains two peers) 4 CLI containers to run the ccchecker tool, which sends concurrrent transactions on to each peer {panel} +Gist of each component logs:+  _*CLI container logs :*_    {code:java} Error: Got unexpected status: SERVICE_UNAVAILABLE Usage: peer channel create  flags  {code} _*orderer0.example.com*_ {code:java} 2017-06-06 13:44:25.309 UTC  orderer/common/broadcast  Handle -> INFO 486 Consenter instructed us to shut down 2017-06-06 13:44:25.311 UTC  orderer/common/deliver  Handle -> WARN 487 Error reading from stream: rpc error: code = Canceled desc = context canceled{code} *NOTE* : Attached complete logs  ^success-case.tar.gz   ^failure-case.tar.gz  (both success and failure cases)  +*How to reproduce the issue:*+  Clone the repo  https://github.com/asararatnakar/chaincodechecker  {panel} git clone  https://github.com/asararatnakar/chaincodechecker  cd chaincodechecker ./network_setup restart {panel} Similar to e2e_cli sample, the docker-compose here will launch 4 cli containers and one of the cli container (org1.cli) will create the channel by connecting to the orderer (orderer0.example.com)  Fails with below error message while creating the channel    {code:java} 2017-06-06 13:44:25.250 UTC  msp  GetLocalMSP -> DEBU 004 Returning existing local MSP 2017-06-06 13:44:25.250 UTC  msp  GetDefaultSigningIdentity -> DEBU 005 Obtaining default signing identity 2017-06-06 13:44:25.252 UTC  channelCmd  InitCmdFactory -> INFO 006 Endorser and orderer connections initialized 2017-06-06 13:44:25.252 UTC  msp  GetLocalMSP -> DEBU 007 Returning existing local MSP 2017-06-06 13:44:25.252 UTC  msp  GetDefaultSigningIdentity -> DEBU 008 Obtaining default signing identity 2017-06-06 13:44:25.252 UTC  msp  GetLocalMSP -> DEBU 009 Returning existing local MSP 2017-06-06 13:44:25.252 UTC  msp  GetDefaultSigningIdentity -> DEBU 00a Obtaining default signing identity 2017-06-06 13:44:25.253 UTC  msp/identity  Sign -> DEBU 00b Sign: plaintext: 0AA8060A074F7267314D5350129C062D...53616D706C65436F6E736F727469756D  2017-06-06 13:44:25.253 UTC  msp/identity  Sign -> DEBU 00c Sign: digest: 3FE77045136C16BF38B0443A01D08C9432DAFBCC6F97DBCD2BF9C6E1BA90E589  2017-06-06 13:44:25.253 UTC  msp  GetLocalMSP -> DEBU 00d Returning existing local MSP 2017-06-06 13:44:25.253 UTC  msp  GetDefaultSigningIdentity -> DEBU 00e Obtaining default signing identity 2017-06-06 13:44:25.253 UTC  msp  GetLocalMSP -> DEBU 00f Returning existing local MSP 2017-06-06 13:44:25.253 UTC  msp  GetDefaultSigningIdentity -> DEBU 010 Obtaining default signing identity 2017-06-06 13:44:25.253 UTC  msp/identity  Sign -> DEBU 011 Sign: plaintext: 0AE0060A1608021A0608B9E3DAC90522...D5DB4D93EA23A4448C205B64A7A62DFF  2017-06-06 13:44:25.253 UTC  msp/identity  Sign -> DEBU 012 Sign: digest: CEF13BC4FE1A10EAE549BDFE0FC0FCA5C315A3ADAC6D41E2A5C7C6E5DDEF2B5A  Error: Got unexpected status: SERVICE_UNAVAILABLE Usage: peer channel create  flags  Global Flags: -b, --blockpath string Path to file containing genesis block --cafile string Path to file containing PEM-encoded trusted certificate(s) for the ordering endpoint -c, --chain string In case of a newChain command, the chain ID to create. -f, --file string Configuration transaction file generated by a tool such as configtxgen for submitting to orderer --logging-level string Default logging level and overrides, see core.yaml for full syntax -o, --orderer string Ordering service endpoint --test.coverprofile string Done (default "coverage.cov") -t, --timeout int Channel creation timeout (default 5) --tls Use TLS when communicating with the orderer endpoint -v, --version Display current version of fabric peer server !!!!!!!!!!!!!!! Channel================== ERROR !!! FAILED to execute End-2-End Scenario ==================  {code}  ></description> </Issue>
