<Issue id="43934" key="FAB-17357" number="17357" project="10002" reporter="sykesm" assignee="tsharris" creator="sykesm" type="10004" summary="Endorser proposal metrics seem broken" priority="3" resolution="10000" status="6" created="2020-01-09 21:53:58.0" updated="2020-02-24 05:42:40.0" resolutiondate="2020-02-07 19:18:18.0" votes="0" watches="3" workflowId="57795"> <description><! CDATA Working with  ~pandrejko  we noticed:  1. {{proposal_duration}} is mis-spelled as {{propsal_duration}} 2. The sum of "successful" and "received" proposals are not the same yet there are no "failed" proposals.  {code} $ curl --insecure --cert ./auth.crt --key ./auth.key -s https://nc71930-peer2org1.pa1113multizone.us-south.containers.appdomain.cloud:9443/metrics | grep endorser | grep -v _bucket | grep -v '#' | sort -u endorser_chaincode_instantiation_failures{chaincode="demoContract:0.0..1",channel="channel1"} 1 endorser_proposals_received 282 endorser_propsal_duration_count{chaincode="cscc:",channel="",success="true"} 181 endorser_propsal_duration_count{chaincode="lscc:",channel="channel1",success="false"} 1 endorser_propsal_duration_count{chaincode="lscc:",channel="",success="true"} 40 endorser_propsal_duration_count{chaincode="lscc:v1.4.3",channel="channel1",success="true"} 10 endorser_propsal_duration_count{chaincode="lscc:v1.4.3",channel="channel2",success="true"} 3 endorser_propsal_duration_count{chaincode="qscc:",channel="",success="true"} 45 endorser_propsal_duration_count{chaincode="VSCod0108JS:0.0.1",channel="channel1",success="true"} 1 endorser_propsal_duration_count{chaincode="VSCod0108JS:",channel="channel1",success="false"} 1 endorser_propsal_duration_sum{chaincode="cscc:",channel="",success="true"} 0.40356276699999993 endorser_propsal_duration_sum{chaincode="lscc:",channel="channel1",success="false"} 0.167240214 endorser_propsal_duration_sum{chaincode="lscc:",channel="",success="true"} 1.432504239 endorser_propsal_duration_sum{chaincode="lscc:v1.4.3",channel="channel1",success="true"} 76.092053921 endorser_propsal_duration_sum{chaincode="lscc:v1.4.3",channel="channel2",success="true"} 0.670814996 endorser_propsal_duration_sum{chaincode="qscc:",channel="",success="true"} 0.504759506 endorser_propsal_duration_sum{chaincode="VSCod0108JS:0.0.1",channel="channel1",success="true"} 74.32668823 endorser_propsal_duration_sum{chaincode="VSCod0108JS:",channel="channel1",success="false"} 0.076259388 endorser_successful_proposals 280 {code}  If we received 282 proposals and only 280 are successful, where are the other 2?  Well, if we look carefully (?) we see a hint:  {code} endorser_propsal_duration_count{chaincode="lscc:",channel="channel1",success="false"} 1 endorser_propsal_duration_count{chaincode="VSCod0108JS:",channel="channel1",success="false"} 1 {code}  Something is broken....  And, of course, we don't seem to have any tests for failed endorsement metrics so (in retrospect) this is unsurprising.  ></description> </Issue>
