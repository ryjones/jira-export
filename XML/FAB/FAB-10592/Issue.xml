<Issue id="30977" key="FAB-10592" number="10592" project="10002" reporter="manish-sethi" creator="manish-sethi" type="10001" summary="Remove empty results from couchdb metadata" priority="3" resolution="10001" status="6" created="2018-06-09 20:53:03.0" updated="2020-01-22 22:32:44.0" resolutiondate="2020-01-22 22:32:44.0" votes="0" watches="1" workflowId="35849"> <description><! CDATA The function `{color:#000000}BatchRetrieveDocumentMetadata{color}` returns a results-set that contains one entry for each key. ( https://github.com/hyperledger/fabric/blob/master/core/ledger/util/couchdb/couchdb.go#L1434).   However, for the keys that are not present in the db, the result-set contains empty entries (empty in the sense that they don't even include even the key). The entry should either contain key or the entire entry should be removed. Otherwise, this is unnecessary cause confusion in the statecouchdb layer (e.g., the revision map gets filled with an empty entry "":"").  This is how this empty entry looks like  ``` \{  ID: (string) "",  Rev: (string) "",  Version: (string) "",  AttachmentsInfo: (json.RawMessage) <nil> } ```  ></description> </Issue>
