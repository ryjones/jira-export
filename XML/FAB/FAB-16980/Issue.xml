<Issue id="43056" key="FAB-16980" number="16980" project="10002" reporter="tock" assignee="tock" creator="tock" type="10004" summary="deliverServiceImpl#UpdateEndpoints does not take a lock" priority="3" resolution="10000" status="6" created="2019-10-31 12:45:52.0" updated="2019-11-04 19:36:55.0" resolutiondate="2019-11-04 19:36:55.0" votes="0" watches="3" workflowId="56162"> <description><! CDATA The deliverServiceImpl#UpdateEndpoints method neglects to take a lock when accessing the d.deliverClients map.  Other methods take d.lock when accessing d.deliverClients.      From fabric/core/deliveryservice/deliveryclient.go |https://github.com/hyperledger/fabric/blob/3b7b8f0f1fe246d70a9f5350363353566399a10c/core/deliverservice/deliveryclient.go#L175      func (d *deliverServiceImpl) UpdateEndpoints(chainID string, connCriteria ConnectionCriteria) error {     // Use chainID to obtain blocks provider and pass endpoints     // for update     if dc, ok := d.deliverClients chainID ; ok  {         // We have found specified channel so we can safely update it         dc.bclient.UpdateEndpoints(connCriteria.toEndpointCriteria())         return nil     }      return errors.New(fmt.Sprintf("Channel with %s id was not found", chainID)) }  ></description> </Issue>
