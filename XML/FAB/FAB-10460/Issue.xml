<Issue id="30734" key="FAB-10460" number="10460" project="10002" reporter="pd93" creator="pd93" type="10001" summary="Support building from Windows 10 via the Windows Subsystem for Linux (WSL)" priority="3" resolution="10001" status="6" created="2018-05-30 09:05:17.0" updated="2020-01-22 22:32:35.0" resolutiondate="2020-01-22 22:32:35.0" votes="1" watches="4" workflowId="35828"> <description><! CDATA *Scenario*  Currently, running Hyperledger Fabric is supported on Windows via Docker. However, Windows developers who wish to contribute or try out the latest version of Fabric have to build on a Linux box and transfer the images or use Vagrant. Now that the Windows Subsystem for Linux is out of beta and fairly usable, we should make it possible to use this environment for building on Windows.  *Testing*  My system specs: * Windows 10 (1803)  * WSL (Ubuntu 16.04) * Go 1.10.2 * Docker 18.05  Note that the above are Windows programs, but the WSL is a Linux environment. Windows binaries are callable from the WSL by using the full executable name... eg `go.exe`.  Currently when running `make dist-clean all` on the latest commit on master from within the WSL gives me the following output: {code:java} .build/bin/peer CGO_CFLAGS=" " GOBIN=/c/Users/pete/dev/src/github.com/hyperledger/fabric/.build/bin go install -tags "experimental" -ldflags "-X github.com/hyperledger/fabric/common/metadata.Version=1.2.0-snapshot-08e5958 -X github.com/hyperledger/fabric/common/metadata.BaseVersion=0.4.8 -X github.com/hyperledger/fabric/common/metadata.BaseDockerLabel=org.hyperledger.fabric -X github.com/hyperledger/fabric/common/metadata.DockerNamespace=hyperledger -X github.com/hyperledger/fabric/common/metadata.BaseDockerNamespace=hyperledger -X github.com/hyperledger/fabric/common/metadata.Experimental=true" github.com/hyperledger/fabric/peer Binary available as .build/bin/peer .build/bin/orderer CGO_CFLAGS=" " GOBIN=/c/Users/pete/dev/src/github.com/hyperledger/fabric/.build/bin go install -tags "experimental" -ldflags "-X github.com/hyperledger/fabric/common/metadata.Version=1.2.0-snapshot-08e5958 -X github.com/hyperledger/fabric/common/metadata.BaseVersion=0.4.8 -X github.com/hyperledger/fabric/common/metadata.BaseDockerLabel=org.hyperledger.fabric -X github.com/hyperledger/fabric/common/metadata.DockerNamespace=hyperledger -X github.com/hyperledger/fabric/common/metadata.BaseDockerNamespace=hyperledger -X github.com/hyperledger/fabric/common/metadata.Experimental=true" github.com/hyperledger/fabric/orderer Binary available as .build/bin/orderer .build/bin/configtxgen CGO_CFLAGS=" " GOBIN=/c/Users/pete/dev/src/github.com/hyperledger/fabric/.build/bin go install -tags "experimental" -ldflags "-X github.com/hyperledger/fabric/common/tools/configtxgen/metadata.Version=1.2.0-snapshot-08e5958" github.com/hyperledger/fabric/common/tools/configtxgen Binary available as .build/bin/configtxgen .build/bin/cryptogen CGO_CFLAGS=" " GOBIN=/c/Users/pete/dev/src/github.com/hyperledger/fabric/.build/bin go install -tags "experimental" -ldflags "-X github.com/hyperledger/fabric/common/tools/cryptogen/metadata.Version=1.2.0-snapshot-08e5958" github.com/hyperledger/fabric/common/tools/cryptogen Binary available as .build/bin/cryptogen .build/bin/idemixgen CGO_CFLAGS=" " GOBIN=/c/Users/pete/dev/src/github.com/hyperledger/fabric/.build/bin go install -tags "experimental" -ldflags "-X github.com/hyperledger/fabric/common/tools/idemixgen/metadata.Version=1.2.0-snapshot-08e5958" github.com/hyperledger/fabric/common/tools/idemixgen Binary available as .build/bin/idemixgen .build/bin/configtxlator CGO_CFLAGS=" " GOBIN=/c/Users/pete/dev/src/github.com/hyperledger/fabric/.build/bin go install -tags "experimental" -ldflags "-X github.com/hyperledger/fabric/common/tools/configtxlator/metadata.Version=1.2.0-snapshot-08e5958" github.com/hyperledger/fabric/common/tools/configtxlator Binary available as .build/bin/configtxlator Building .build/docker/bin/peer go: disabling cache (/.cache/go-build) due to initialization failure: mkdir /.cache: permission denied # github.com/hyperledger/fabric/peer /tmp/go-link-012409467/000006.o: In function `pluginOpen': /tmp/workdir/go/src/plugin/plugin_dlopen.go:19: warning: Using 'dlopen' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-012409467/000021.o: In function `mygetgrouplist': /tmp/workdir/go/src/os/user/getgrouplist_unix.go:15: warning: Using 'getgrouplist' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-012409467/000020.o: In function `mygetgrgid_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:38: warning: Using 'getgrgid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-012409467/000020.o: In function `mygetgrnam_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:43: warning: Using 'getgrnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-012409467/000020.o: In function `mygetpwnam_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:33: warning: Using 'getpwnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-012409467/000020.o: In function `mygetpwuid_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:28: warning: Using 'getpwuid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-012409467/000004.o: In function `_cgo_f7895c2c5a3a_C2func_getaddrinfo': /tmp/go-build/cgo-gcc-prolog:46: warning: Using 'getaddrinfo' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking (cd sampleconfig && tar -jc *) > .build/sampleconfig.tar.bz2 mkdir -p .build/image/peer/payload cp .build/docker/bin/peer .build/sampleconfig.tar.bz2 .build/image/peer/payload mkdir -p .build/image/peer Building docker peer-image docker build  -t hyperledger/fabric-peer .build/image/peer Sending build context to Docker daemon  25.99MB Step 1/7 : FROM hyperledger/fabric-baseos:amd64-0.4.8  ---> 83b7b016c8e5 Step 2/7 : ENV FABRIC_CFG_PATH /etc/hyperledger/fabric  ---> Running in df0d6409b823 Removing intermediate container df0d6409b823  ---> 5ce4999dfa7f Step 3/7 : RUN mkdir -p /var/hyperledger/production $FABRIC_CFG_PATH  ---> Running in 707470f41593 Removing intermediate container 707470f41593  ---> bfa67fcb53be Step 4/7 : COPY payload/peer /usr/local/bin  ---> 21a58ca1846b Step 5/7 : ADD  payload/sampleconfig.tar.bz2 $FABRIC_CFG_PATH  ---> c50f0da92236 Step 6/7 : CMD  "peer","node","start"   ---> Running in ba2086ca1d6e Removing intermediate container ba2086ca1d6e  ---> 069649718461 Step 7/7 : LABEL org.hyperledger.fabric.version=1.2.0-snapshot-08e5958       org.hyperledger.fabric.base.version=0.4.8  ---> Running in 3e84726bdbcf Removing intermediate container 3e84726bdbcf  ---> 37a5b32a6730 Successfully built 37a5b32a6730 Successfully tagged hyperledger/fabric-peer:latest docker tag hyperledger/fabric-peer hyperledger/fabric-peer:amd64-1.2.0-snapshot-08e5958 docker tag hyperledger/fabric-peer hyperledger/fabric-peer:amd64-latest Building .build/docker/bin/orderer go: disabling cache (/.cache/go-build) due to initialization failure: mkdir /.cache: permission denied # github.com/hyperledger/fabric/orderer /tmp/go-link-784875968/000018.o: In function `pluginOpen': /tmp/workdir/go/src/plugin/plugin_dlopen.go:19: warning: Using 'dlopen' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-784875968/000021.o: In function `mygetgrouplist': /tmp/workdir/go/src/os/user/getgrouplist_unix.go:15: warning: Using 'getgrouplist' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-784875968/000020.o: In function `mygetgrgid_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:38: warning: Using 'getgrgid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-784875968/000020.o: In function `mygetgrnam_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:43: warning: Using 'getgrnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-784875968/000020.o: In function `mygetpwnam_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:33: warning: Using 'getpwnam_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-784875968/000020.o: In function `mygetpwuid_r': /tmp/workdir/go/src/os/user/cgo_lookup_unix.go:28: warning: Using 'getpwuid_r' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking /tmp/go-link-784875968/000004.o: In function `_cgo_f7895c2c5a3a_C2func_getaddrinfo': /tmp/go-build/cgo-gcc-prolog:46: warning: Using 'getaddrinfo' in statically linked applications requires at runtime the shared libraries from the glibc version used for linking mkdir -p .build/image/orderer/payload cp .build/docker/bin/orderer .build/sampleconfig.tar.bz2 .build/image/orderer/payload mkdir -p .build/image/orderer Building docker orderer-image docker build  -t hyperledger/fabric-orderer .build/image/orderer Sending build context to Docker daemon  19.51MB Step 1/8 : FROM hyperledger/fabric-baseos:amd64-0.4.8  ---> 83b7b016c8e5 Step 2/8 : ENV FABRIC_CFG_PATH /etc/hyperledger/fabric  ---> Using cache  ---> 5ce4999dfa7f Step 3/8 : RUN mkdir -p /var/hyperledger/production $FABRIC_CFG_PATH  ---> Using cache  ---> bfa67fcb53be Step 4/8 : COPY payload/orderer /usr/local/bin  ---> 32ef08dab2b6 Step 5/8 : ADD payload/sampleconfig.tar.bz2 $FABRIC_CFG_PATH/  ---> 9c5f67eff68a Step 6/8 : EXPOSE 7050  ---> Running in 8782056ee5fd Removing intermediate container 8782056ee5fd  ---> 82e6241d7bca Step 7/8 : CMD  "orderer"   ---> Running in bb0d235037e3 Removing intermediate container bb0d235037e3  ---> 0093adf25082 Step 8/8 : LABEL org.hyperledger.fabric.version=1.2.0-snapshot-08e5958       org.hyperledger.fabric.base.version=0.4.8  ---> Running in ed3cedb45bbb Removing intermediate container ed3cedb45bbb  ---> 01f34c437d46 Successfully built 01f34c437d46 Successfully tagged hyperledger/fabric-orderer:latest docker tag hyperledger/fabric-orderer hyperledger/fabric-orderer:amd64-1.2.0-snapshot-08e5958 docker tag hyperledger/fabric-orderer hyperledger/fabric-orderer:amd64-latest Building dockerized gotools make 1 : Entering directory '/opt/gopath/src/github.com/hyperledger/fabric' Building github.com/maxbrunsfeld/counterfeiter -> counterfeiter # cd .; git clone https://github.com/maxbrunsfeld/counterfeiter /opt/gotools/obj/src/github.com/maxbrunsfeld/counterfeiter Cloning into '/opt/gotools/obj/src/github.com/maxbrunsfeld/counterfeiter'... error: invalid config file /opt/gotools/obj/src/github.com/maxbrunsfeld/counterfeiter/.git/config error: invalid config file /opt/gotools/obj/src/github.com/maxbrunsfeld/counterfeiter/.git/config error: invalid config file /opt/gotools/obj/src/github.com/maxbrunsfeld/counterfeiter/.git/config error: invalid config file /opt/gotools/obj/src/github.com/maxbrunsfeld/counterfeiter/.git/config error: invalid config file /opt/gotools/obj/src/github.com/maxbrunsfeld/counterfeiter/.git/config fatal: 'origin' does not appear to be a git repository fatal: Could not read from remote repository. Please make sure you have the correct access rights and the repository exists. package github.com/maxbrunsfeld/counterfeiter: exit status 128 gotools.mk:53: recipe for target 'gotool.counterfeiter' failed make 1 : Leaving directory '/opt/gopath/src/github.com/hyperledger/fabric' make 1 : ***  gotool.counterfeiter  Error 1 make: ***  /opt/gotools/bin/counterfeiter  Error 2 gotools.mk:58: recipe for target '/opt/gotools/bin/counterfeiter' failed Makefile:247: recipe for target '.build/docker/gotools' failed make: ***  .build/docker/gotools  Error 2 {code}       ></description> </Issue>
