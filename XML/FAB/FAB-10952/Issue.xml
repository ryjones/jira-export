<Issue id="31507" key="FAB-10952" number="10952" project="10002" reporter="sykesm" assignee="sykesm" creator="sykesm" type="10003" summary="Data race when running core/comm tests" priority="4" resolution="10000" status="6" created="2018-06-29 19:50:26.0" updated="2018-07-20 14:17:05.0" resolutiondate="2018-07-02 14:48:16.0" votes="0" watches="1" workflowId="42575"> <description><! CDATA The tests use package scoped variables to hold client and server certificates that get generated by tests and referenced by tests that have been explicitly tagged for parallel execution. This results in a data race on the client and server certs. {code:java} ================== WARNING: DATA RACE Write at 0x000004dbabe0 by goroutine 28:   github.com/hyperledger/fabric/core/comm_test.loadCerts()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/core/comm/client_test.go:476 +0x4fa   github.com/hyperledger/fabric/core/comm_test.TestSetServerRootCAs()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/core/comm/client_test.go:300 +0x64   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Previous write at 0x000004dbabe0 by goroutine 27:   github.com/hyperledger/fabric/core/comm_test.loadCerts()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/core/comm/client_test.go:476 +0x4fa   github.com/hyperledger/fabric/core/comm_test.TestNewConnection()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/core/comm/client_test.go:146 +0x64   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Goroutine 28 (running) created at:   testing.(*T).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:824 +0x564   testing.runTests.func1()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1063 +0xa4   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d   testing.runTests()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1061 +0x4e1   testing.(*M).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:978 +0x2cd   main.main()       _testmain.go:116 +0x22a  Goroutine 27 (running) created at:   testing.(*T).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:824 +0x564   testing.runTests.func1()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1063 +0xa4   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d   testing.runTests()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1061 +0x4e1   testing.(*M).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:978 +0x2cd   main.main()       _testmain.go:116 +0x22a =================={code}  ></description> </Issue>
