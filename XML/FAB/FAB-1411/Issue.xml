<Issue id="13820" key="FAB-1411" number="1411" project="10002" reporter="oldsharp" assignee="oldsharp" creator="oldsharp" type="10004" summary="&quot;make peer&quot; failed when using proxy in curl-style (socks*://) protocol prefixes" priority="4" resolution="10000" status="6" created="2016-12-15 12:08:25.0" updated="2018-07-20 14:11:03.0" resolutiondate="2017-04-13 23:30:21.0" votes="0" watches="1" workflowId="36891"> <description><! CDATA When run "make peer" in the VM env with cmd like:  {{http_proxy='socks5h://socks-proxy.example.com:8080' https_proxy=$http_proxy make peer}}  the build process would fail with error info like:  {quote}make 1 : Entering directory '/opt/gopath/src/github.com/hyperledger/fabric/gotools' Building github.com/golang/lint/golint -> golint package golang.org/x/tools/go/gcimporter15: unrecognized import path "golang.org/x/tools/go/gcimporter15" (https fetch: Get https://golang.org/x/tools/go/gcimporter15?go-get=1: http: error connecting to proxy http://socks5h://socks-proxy.example.com:8080: dial tcp: lookup socks5h on 10.0.2.3:53: no such host) Makefile:51: recipe for target 'gotool.golint' failed make 1 : Leaving directory '/opt/gopath/src/github.com/hyperledger/fabric/gotools' make 1 : ***  gotool.golint  Error 1 Makefile:56: recipe for target '/opt/gotools/obj/gopath/bin/golint' failed make: ***  /opt/gotools/obj/gopath/bin/golint  Error 2 Makefile:149: recipe for target 'build/docker/gotools' failed make: ***  build/docker/gotools  Error 2{quote}  and  {quote}Sending build context to Docker daemon 35.84 kB Step 1 : FROM hyperledger/fabric-baseimage:x86_64-0.2.2 ---> 4ac07a26ca7a Step 2 : RUN wget https://services.gradle.org/distributions/gradle-2.12-bin.zip -P /tmp --quiet ---> Running in a65e56a36ff7 The command '/bin/sh -c wget https://services.gradle.org/distributions/gradle-2.12-bin.zip -P /tmp --quiet' returned a non-zero code: 8 Makefile:196: recipe for target 'build/image/javaenv/.dummy-x86_64-0.7.0-snapshot-4cd79b1' failed make: ***  build/image/javaenv/.dummy-x86_64-0.7.0-snapshot-4cd79b1  Error 8{quote}  The reason could be: 1. "go get" doesn't understand the curl-style proxy protocol prefixes. 2. Docker doesn't understand the curl-style proxy protocol prefixes. 3. wget is used to fetch the gradle zip package from remote, which does not understand the curl-style proxy protocol prefixes.  The simplest solution would be switching to a http proxy instead of socks proxy (e.g. http://http-proxy.example.com:8080/). The 'socks5h' prefix supported by curl which force the proxy resolve the host name could be extremely useful in some situation, however, especially when facing network env with a high DNS spoofing possibility.  ></description> </Issue>
