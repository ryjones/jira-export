<Issue id="38786" key="FAB-14835" number="14835" project="10002" reporter="sykesm" assignee="yacovm" creator="sykesm" type="10004" summary="Test failure / data race in common/cluster TestSendBigMessage" priority="3" resolution="10000" status="6" created="2019-03-26 21:08:36.0" updated="2019-03-27 22:46:02.0" resolutiondate="2019-03-27 22:46:02.0" votes="1" watches="3" workflowId="50436"> <description><! CDATA {code} 16:19:20 --- FAIL: TestSendBigMessage (17.88s) 16:19:20     comm_test.go:344: Sending took 48.422µs 16:19:20     comm_test.go:344: Sending took 37.916µs 16:19:20     comm_test.go:344: Sending took 15.885µs 16:19:20     comm_test.go:344: Sending took 8.489µs 16:19:20     comm_test.go:351: Total sending time to all 4 nodes took: 251.258µs 16:19:20     testing.go:771: race detected during execution of test 16:19:20 FAIL 16:19:20 coverage: 96.4% of statements 16:19:20 FAIL	github.com/hyperledger/fabric/orderer/common/cluster	26.797s {code}  {code} 16:19:20 ================== 16:19:20 WARNING: DATA RACE 16:19:20 Write at 0x00c0000daa28 by goroutine 252: 16:19:20   internal/race.Write() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/internal/race/race.go:41 +0x38 16:19:20   sync.(*WaitGroup).Wait() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/sync/waitgroup.go:128 +0xef 16:19:20   github.com/hyperledger/fabric/orderer/common/cluster_test.(*clusterNode).Step() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/orderer/common/cluster/comm_test.go:139 +0x52 16:19:20   github.com/hyperledger/fabric/protos/orderer._Cluster_Step_Handler() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/protos/orderer/cluster.pb.go:525 +0xcd 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).processStreamingRPC() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1175 +0x1602 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).handleStream() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1254 +0x130c 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:690 +0xac 16:19:20  16:19:20 Previous read at 0x00c0000daa28 by goroutine 11: 16:19:20   internal/race.Read() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/internal/race/race.go:37 +0x38 16:19:20   sync.(*WaitGroup).Add() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/sync/waitgroup.go:71 +0x16b 16:19:20   github.com/hyperledger/fabric/orderer/common/cluster_test.(*clusterNode).freeze() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/orderer/common/cluster/comm_test.go:154 +0x43 16:19:20   github.com/hyperledger/fabric/orderer/common/cluster_test.TestSendBigMessage() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/orderer/common/cluster/comm_test.go:339 +0x1281 16:19:20   testing.tRunner() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/testing/testing.go:827 +0x162 16:19:20  16:19:20 Goroutine 252 (running) created at: 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:688 +0xb8 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc/internal/transport.(*http2Server).operateHeaders() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/internal/transport/http2_server.go:419 +0x1486 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc/internal/transport.(*http2Server).HandleStreams() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/internal/transport/http2_server.go:459 +0x37a 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:686 +0x170 16:19:20   github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).handleRawConn.func1() 16:19:20       /w/workspace/fabric-verify-unit-tests-x86_64/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:648 +0x50 16:19:20  16:19:20 Goroutine 11 (running) created at: 16:19:20   testing.(*T).Run() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/testing/testing.go:878 +0x659 16:19:20   testing.runTests.func1() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/testing/testing.go:1119 +0xa8 16:19:20   testing.tRunner() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/testing/testing.go:827 +0x162 16:19:20   testing.runTests() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/testing/testing.go:1117 +0x4ee 16:19:20   testing.(*M).Run() 16:19:20       /opt/go/go1.11.5.linux.amd64/src/testing/testing.go:1034 +0x2ee 16:19:20   main.main() 16:19:20       _testmain.go:248 +0x332 16:19:20 ================== {code}  https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10953/consoleFull  ></description> </Issue>
