<Issue id="16803" key="FAB-3970" number="3970" project="10002" reporter="yacovm" assignee="gennadyl" creator="yacovm" type="10004" summary="Make gossip block pull mechanism to be ledger height aware" priority="3" resolution="10000" status="6" created="2017-05-17 08:06:59.0" updated="2018-07-20 14:12:49.0" resolutiondate="2017-08-21 13:34:24.0" votes="0" watches="1" workflowId="38550"> <description><! CDATA The following scenario is possible: peer0 has ledger height 1000 peer1 has ledger height 500  peer0 has in its in-memory messageStore blocks 900-1000 peer1 has in its in-memory messageStore blocks 500-600  peer0 sends a pull Hello to peer1 peer1 returns digests of blocks 500-600 peer0 requests blocks 500-600 peer1 returns blocks 500-600 peer0 discards them because they are too old  We need a way to make the peer ignore pull digest messages of blocks that their sequence number is lower than the ledger's height.  What I think we can do is add an instance method to *StateInfo* that returns the seqNum of the block from the metadata, and since the *channel.go* file has the last stateInfo reference (that is updated by *UpdateStateInfo* method)  it can be used to ignore digests with a too low seqNum.   ~C0rWin   ~gennadyl   opinions?   ></description> </Issue>
