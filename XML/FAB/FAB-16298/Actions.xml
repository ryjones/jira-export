<Action id="66515" issue="41768" author="manish-sethi" type="comment" created="2020-01-07 19:38:34.0" updateauthor="manish-sethi" updated="2020-01-07 19:38:34.0"> <body><! CDATA Adding concrete condition and code location -   If we guarantee that upgrade to 2.1 is from 2.0 only (i.e., not directly from 1.4.x to 2.1), the code between   https://github.com/hyperledger/fabric/blob/92af234c977e0208d550500bf48de710296813de/core/ledger/pvtdatastorage/store_impl.go#L159  and L177 can be deleted in version 2.0  ></body> </Action>
<Action id="67999" issue="41768" author="senthil1" type="comment" created="2020-02-19 02:23:54.0" updateauthor="senthil1" updated="2020-02-19 02:28:20.0"> <body><! CDATA With the introduction of peer reset/rollback, we make the gossip to fetch pvtData from the local store if available. Further, we make the pvtdata reconciler to not fetch pvtData when the pvtstore is ahead of the blockstore. As we allow the pvtDataStore height to be greater than the blockstore height, we have removed the synchronization between pvtstore and blockstore in release 2.0 but not in release 1.4. As a result, when we do rolling upgrade from 1.4 LTS to 2.x LTS, the pendingBatch marker can still present in the pvtDataStore. Hence, we need the associated cleanup code in 2.x LTS. From 2.x+1, we can safely remove pendingBatch marker related code from the pvtDataStore.  _Assumption: user would move from 1.4 LTS to 2.x LTS_  ></body> </Action>
