<Issue id="20640" key="FAB-6048" number="6048" project="10002" reporter="yacovm" assignee="yacovm" creator="yacovm" type="10004" summary="Fix gossip comm UT failure - premature gRPC servicing" priority="3" resolution="10000" status="6" created="2017-09-06 10:43:58.0" updated="2018-07-20 14:14:18.0" resolutiondate="2017-10-04 16:19:53.0" votes="0" watches="2" workflowId="39932"> <description><! CDATA After we upgraded to go 1.9, the gossip comm module sometimes registers the gRPC service after starting the gRPC server and this results in the following:  {code} 08:54:22 unit-tests_1  | 2017-09-06 08:54:21.898 UTC  gossip/comm#2000  SetDialOpts -> WARN 006 Given an empty set of grpc.DialOption, aborting 08:54:22 unit-tests_1  | 2017-09-06 08:54:21.898 UTC  gossip/comm#3000  SetDialOpts -> WARN 007 Given an empty set of grpc.DialOption, aborting 08:54:22 unit-tests_1  | 2017-09-06 08:54:22.901 UTC  grpc  Fatalf -> CRIT 008 grpc: Server.RegisterService after Server.Serve for "gossip.Gossip" 08:54:22 unit-tests_1  | FAIL	github.com/hyperledger/fabric/gossip/comm	20.194s 08:54:22 unit-tests_1  | error: exit status 1 08:54:22 unit-tests_1  | panic: EOF 08:54:22 unit-tests_1  |  08:54:22 unit-tests_1  | goroutine 1  running : 08:54:22 unit-tests_1  | panic(0x4daca0, 0xc42000a0f0) 08:54:22 unit-tests_1  | 	/opt/go/src/runtime/panic.go:500 +0x1a1 08:54:22 unit-tests_1  | main.main() 08:54:22 unit-tests_1  | 	/opt/gotools/obj/gopath/src/github.com/AlekSi/gocov-xml/gocov-xml.go:60 +0x15fd {code}  ></description> </Issue>
