<Issue id="41681" key="FAB-16245" number="16245" project="10002" reporter="vijaypunugubati" assignee="vijaypunugubati" creator="vijaypunugubati" type="10004" summary="fabric-test-svt-weekly-pte job: After 3 hours, PTE client failed to sendTransaction due to error: Stream removed" priority="3" resolution="10201" status="6" created="2019-08-07 17:05:56.0" updated="2019-10-11 15:39:07.0" resolutiondate="2019-10-11 15:39:07.0" votes="0" watches="3" workflowId="54713"> <description><! CDATA *Error* *observed:*  The leader orderer was unreachable by the orderer to send transactions with error `  invoke_move_dist_evtBlock  failed to sendTransaction status: \{"status":"SERVICE_UNAVAILABLE","info":"cannot enqueue"}  `  And followed the error leads to grpc failure in Orderer failover from (grpcs://localhost:5007) to (grpcs://localhost:5005)  The orderers became unreachable. First error was reported after a little more than 3 hours (see the “cannot enqueue” errors with SERVICE_UNAVAILABLE” response codes) indicates the leader orderer was unreachable by the orderer to which we were sending transactions. Then finally all of the orderers because unreachable (hence the grpc errors) - at which point the client threads started “failover” steps, continually trying different orderers but could not connect to any of them (and thus the “REQUEST_TIMEOUT” failures for the rest of the test logs). Step one: we could try to get better info about the particular grpc failures messages. Step 2: to get to root cause, we may need to see logs in the orderers, which means someone needs to run a long test outside of the CI. Also we may want to try a long run in the k8s cluster too, instead of a single VM. We need to determine if the grpc failures were a result of orderers problems, or if they were due to a “networking issue” (unlikely since using single VM), or if caused by some sort of resource contention/exhaustion issue on the VM. {code:java} /13:19:54.638 =================================== FAILURES =================================== 13:19:54.638 ___________ TimedRun_12Hr.test_FAB_7204_samplejsCC_2chan_x_2_x_10tps ___________ 13:19:54.638  13:19:54.638 self = <12HrTest.TimedRun_12Hr testMethod=test_FAB_7204_samplejsCC_2chan_x_2_x_10tps> 13:19:54.638  13:19:54.638     def test_FAB_7204_samplejsCC_2chan_x_2_x_10tps(self): 13:19:54.638         # Assert and confirm that the sh script finished and exited cleanly, 13:19:54.638         # else suggest where to find the logs 13:19:54.638         returncode = subprocess.call("./FAB-7204-4i.sh", cwd=scenarios_directory, shell=True) 13:19:54.638 >       self.assertEqual(returncode, 0, msg="Test Failed; check for errors in fabric-test/tools/PTE/CITest/Logs/") 13:19:54.638 E       AssertionError: Test Failed; check for errors in fabric-test/tools/PTE/CITest/Logs/ 13:19:54.638  13:19:54.638 12HrTest.py:24: AssertionError/ code placeholder{code} *Error from logs:* {code:java} / 32minfo 39m:  2019-08-06T18:50:50.083Z PTE 1 main : stderr:  31merror 39m:  2019-08-06T18:50:50.075Z PTE 1 exec :  Nid:chan:org:id=0:testorgschannel2:org2:0 invoke_move_dist_evtBlock  Failed to send transaction due to error:  Error: 2 UNKNOWN: Stream removed at Object.exports.createStatusError (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/common.js:91:15) at ClientDuplexStream._emitStatusIfDone (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client.js:233:26) at ClientDuplexStream._receiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client.js:211:8) at Object.onReceiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:1306:15) at InterceptingListener._callNext (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:568:42) at InterceptingListener.onReceiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:618:8) at /w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:1123:18/ code placeholder{code}   {code:java} / 32minfo 39m:  2019-08-06T18:50:50.083Z PTE 1 main : stdout:  32minfo 39m:  2019-08-06T18:50:50.077Z PTE 1 exec :  Nid:chan:org:id=0:testorgschannel2:org2:0 ordererFailover  Orderer failover from (grpcs://localhost:5005) to (grpcs://localhost:5006): 32minfo 39m:  2019-08-06T18:50:50.083Z PTE 0 main : stderr: 2019-08-06T18:50:50.075Z -  31merror 39m:  Orderer.js : sendBroadcast - on error: "Error: 2 UNKNOWN: Stream removed\n    at Object.exports.createStatusError (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/common.js:91:15)\n    at ClientDuplexStream._emitStatusIfDone (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client.js:233:26)\n    at ClientDuplexStream._receiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client.js:211:8)\n    at Object.onReceiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:1306:15)\n    at InterceptingListener._callNext (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:568:42)\n    at InterceptingListener.onReceiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:618:8)\n    at /w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:1123:18"  31merror 39m:  2019-08-06T18:50:50.075Z PTE 0 exec :  Nid:chan:org:id=0:testorgschannel1:org1:0 invoke_move_dist_evtBlock  Failed to send transaction due to error:  Error: 2 UNKNOWN: Stream removed at Object.exports.createStatusError (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/common.js:91:15) at ClientDuplexStream._emitStatusIfDone (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client.js:233:26) at ClientDuplexStream._receiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client.js:211:8) at Object.onReceiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:1306:15) at InterceptingListener._callNext (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:568:42) at InterceptingListener.onReceiveStatus (/w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:618:8) at /w/workspace/fabric-test-svt-weekly-pte-x86_64/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/node_modules/grpc/src/client_interceptors.js:1123:18/ code placeholder {code}  https://jenkins.hyperledger.org/view/fabric-test/job/fabric-test-svt-weekly-pte-x86_64/lastFailedBuild/artifact/gopath/src/github.com/hyperledger/fabric-test/tools/PTE/CITest/Logs/FAB-7204-4i_0805120147.log      ></description> </Issue>
