<Issue id="15762" key="FAB-3175" number="3175" project="10002" reporter="yacovm" assignee="yacovm" creator="yacovm" type="10004" summary="Delivery client test fails sometimes in CI " priority="3" resolution="10000" status="6" created="2017-04-15 21:00:50.0" updated="2019-03-19 11:13:13.0" resolutiondate="2017-04-18 07:13:23.0" votes="0" watches="1" workflowId="37998"> <description><! CDATA This is the 2nd time this weekend I saw it fail.   TestNewDeliverService  is the one that was there before I did the revamp, so maybe we need to adjust some stuff there.  IMO we should take a look at this.  ~C0rWin   ~gennadyl   https://jenkins.hyperledger.org/job/fabric-verify-x86_64/9607/console  20:49:39 unit-tests_1  | 2017-04-15 20:49:07.441 UTC  deliveryClient  connect -> ERRO 02e Failed obtaining connection: Failed connecting 20:49:39 unit-tests_1  | stream error: code = 1 desc = "context canceled" 20:49:39 unit-tests_1  | 2017-04-15 20:49:09.453 UTC  deliveryClient  connect -> ERRO 02f Connection to  localhost:5611 established but was unable to create gRPC stream: Failed creating ABC 20:49:39 unit-tests_1  | 2017-04-15 20:49:10.453 UTC  deliveryClient  connect -> ERRO 030 Connection to  localhost:5611 established but was unable to create gRPC stream: Failed creating ABC 20:49:39 unit-tests_1  | 2017-04-15 20:49:12.456 UTC  deliveryClient  StartDeliverForChannel -> ERRO 031 Delivery service - block provider already exists for TEST_CHAINID found, can't start delivery 20:49:39 unit-tests_1  | 2017-04-15 20:49:12.456 UTC  deliveryClient  StopDeliverForChannel -> ERRO 032 Delivery service - no block provider for TEST_CHAINID2 found, can't stop delivery 20:49:39 unit-tests_1  | 2017-04-15 20:49:12.471 UTC  blocksProvider  DeliverBlocks -> WARN 033 Receive error: Client is closing 20:49:39 unit-tests_1  | 2017-04-15 20:49:17.982 UTC  deliveryClient  StartDeliverForChannel -> ERRO 034 Delivery service is stopping cannot join a new channel TEST_CHAINID 20:49:39 unit-tests_1  | 2017-04-15 20:49:17.982 UTC  deliveryClient  StopDeliverForChannel -> ERRO 035 Delivery service is stopping, cannot stop delivery for channel TEST_CHAINID 20:49:39 unit-tests_1  | --- FAIL: TestNewDeliverService (6.53s) 20:49:39 unit-tests_1  | 	assertions.go:225:   	Error Trace:	deliveryclient_test.go:345 20:49:39 unit-tests_1  | 		 			deliveryclient_test.go:120 20:49:39 unit-tests_1  | 		 	Error:		Didn't gossip a new block within a timely manner 20:49:39 unit-tests_1  | 		 20:49:39 unit-tests_1  | 2017-04-15 20:49:23.369 UTC  blocksProvider  DeliverBlocks -> WARN 036 Receive error: Client is closing 20:49:39 unit-tests_1  | 2017-04-15 20:49:33.419 UTC  ConnProducer  NewConnection -> ERRO 037 Failed connecting to localhost:5612 , error: grpc: timed out when dialing 20:49:39 unit-tests_1  | 2017-04-15 20:49:33.421 UTC  blocksProvider  DeliverBlocks -> WARN 038 Receive error: Client is closing 20:49:39 unit-tests_1  | 2017-04-15 20:49:35.424 UTC  blocksProvider  DeliverBlocks -> WARN 039 Receive error: Client is closing 20:49:39 unit-tests_1  | FAIL 20:49:39 unit-tests_1  | coverage: 93.5% of statements 20:49:39 unit-tests_1  | FAIL	github.com/hyperledger/fabric/core/deliverservice	35.100s 20:49:39 unit-tests_1  | error: exit status 1 20:49:39 unit-tests_1  | panic: EOF 20:49:39 unit-tests_1  |  20:49:39 unit-tests_1  | goroutine 1  running : 20:49:39 unit-tests_1  | panic(0x4daca0, 0xc42000a0f0) 20:49:39 unit-tests_1  | 	/opt/go/src/runtime/panic.go:500 +0x1a1 20:49:39 unit-tests_1  | main.main() 20:49:39 unit-tests_1  | 	/opt/gotools/obj/gopath/src/github.com/AlekSi/gocov-xml/gocov-xml.go:60 +0x15fd 20:49:40 unittest_unit-tests_1 exited with code 2 20:49:40 Stopping couchdb ...  20:49:40 Stopping unittest_vp_1 ...  20:49:42  Stopping unittest_vp_1 ... done  Stopping couchdb ... done  ></description> </Issue>
