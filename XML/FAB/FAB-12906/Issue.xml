<Issue id="35430" key="FAB-12906" number="12906" project="10002" reporter="akshay.sood" creator="akshay.sood" type="10004" summary="Adding new peer in existing organization causing new peer to fail" priority="3" resolution="10203" status="6" created="2018-11-17 04:22:42.0" updated="2019-03-01 17:32:45.0" resolutiondate="2019-03-01 17:32:45.0" votes="3" watches="5" workflowId="46896"> <description><! CDATA I am trying to add a new peer into the existing organization  {code:java} org1.example.com {code}  I installed the chaincode on existing network before adding a new peer  I then changed the count of peers of  {code:java} org1.example.com {code} from 2 to 3. Then I executed the following command:  {code:java} cryptogen extend --input="crypto-config" --config=crypto-config.yaml {code}  The output of this command was nothing.  Then I bootstrap the new peer with the following {code:java} docker-compose {code} configuration file:   {code:java} version: '2'  volumes: peer2.org1.example.com:  networks: byfn:   services:  couchdb4: container_name: couchdb4 image: hyperledger/fabric-couchdb # Populate the COUCHDB_USER and COUCHDB_PASSWORD to set an admin user and password # for CouchDB.  This will prevent CouchDB from operating in an "Admin Party" mode. environment: - COUCHDB_USER= - COUCHDB_PASSWORD= # Comment/Uncomment the port mapping if you want to hide/expose the CouchDB service, # for example map it to utilize Fauxton User Interface in dev environments. ports: - "5988:5984" networks: - byfn   peer2.org1.example.com: container_name: peer2.org1.example.com extends: file: peer-base.yaml service: peer-base environment: - CORE_PEER_ID=peer2.org1.example.com - CORE_PEER_ADDRESS=peer2.org1.example.com:7051 - CORE_PEER_GOSSIP_EXTERNALENDPOINT=peer2.org1.example.com:7051 - CORE_PEER_GOSSIP_BOOTSTRAP=peer0.org1.example.com:7051 - CORE_PEER_LOCALMSPID=Org1MSP - CORE_LEDGER_STATE_STATEDATABASE=CouchDB - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb4:5984 - CORE_LEDGER_STATE_COUCHDBCONFIG_USERNAME= - CORE_LEDGER_STATE_COUCHDBCONFIG_PASSWORD= volumes: - /var/run/:/host/var/run/ - ../crypto-config/peerOrganizations/org1.example.com/peers/peer2.org1.example.com/msp:/etc/hyperledger/fabric/msp - ../crypto-config/peerOrganizations/org1.example.com/peers/peer2.org1.example.com/tls:/etc/hyperledger/fabric/tls - peer2.org1.example.com:/var/hyperledger/production ports: - 11051:7051 - 11053:7053 networks: - byfn {code}  But the logs keep showing:  {code:java} peer2.org1.example.com    | 2018-11-15 17:51:38.952 UTC  gossip/gossip  handleMessage -> WARN 5bf Message GossipMessage: tag:EMPTY alive_msg:<membership:<endpoint:"peer0.org2.example.com:7051" pki_id:"\316\347\246\2250\0171\025\221\"=\266|V\037$ \265\213\037\220z`\303\351\257\001\017\216\370J>" > timestamp:<inc_num:1542303654280601328 seq_num:736 > > , Envelope: 84 bytes, Signature: 71 bytes isn't valid peer2.org1.example.com    | 2018-11-15 17:51:38.952 UTC  gossip/gossip  handleMessage -> WARN 5c0 Message GossipMessage: tag:EMPTY alive_msg:<membership:<endpoint:"peer0.org2.example.com:7051" pki_id:"\316\347\246\2250\0171\025\221\"=\266|V\037$ \265\213\037\220z`\303\351\257\001\017\216\370J>" > timestamp:<inc_num:1542303654280601328 seq_num:736 > > , Envelope: 84 bytes, Signature: 71 bytes isn't valid peer2.org1.example.com    | 2018-11-15 17:51:39.123 UTC  gossip/gossip  handleMessage -> WARN 5c1 Message GossipMessage: tag:EMPTY alive_msg:<membership:<endpoint:"peer1.org2.example.com:7051" pki_id:"\262>\03566\350\330~\374\215(#\323\375\331\317\234%,\215-\024\316O\327v}\005\263\374\\\224" > timestamp:<inc_num:1542303654503183827 seq_num:738 > > , Envelope: 84 bytes, Signature: 71 bytes isn't valid peer2.org1.example.com    | 2018-11-15 17:51:39.124 UTC  gossip/gossip  handleMessage -> WARN 5c2 Message GossipMessage: tag:EMPTY alive_msg:<membership:<endpoint:"peer1.org2.example.com:7051" pki_id:"\262>\03566\350\330~\374\215(#\323\375\331\317\234%,\215-\024\316O\327v}\005\263\374\\\224" > timestamp:<inc_num:1542303654503183827 seq_num:738 > > , Envelope: 84 bytes, Signature: 71 bytes isn't valid peer2.org1.example.com    | 2018-11-15 17:51:40.103 UTC  peer/gossip/mcs  Verify -> ERRO 5c3 Failed getting validated identity from peer identity  Peer Identity  0a 07 4f 72 67 32 4d 53 50 12 a6 06 2d 2d 2d 2d 2d 42 45 47 49 4e 20 43 45 52 54 49 46 49 43 41 54 45 2d 2d 2d 2d 2d 0a 4d 49 49 43 4a 7a 43 43 41 63 36 67 41 77 49 42 41 67 49 51 46 54 76 55 43 2b 6a 78 6a 32 50 4e 63 41 48 33 45 61 45 68 4d 7a 41 4b 42 67 67 71 68 6b 6a 4f 50 51 51 44 41 6a 42 7a 4d 51 73 77 0a 43 51 59 44 56 51 51 47 45 77 4a 56 55 7a 45 54 4d 42 45 47 41 31 55 45 43 42 4d 4b 51 32 46 73 61 57 5a 76 63 6d 35 70 59 54 45 57 4d 42 51 47 41 31 55 45 42 78 4d 4e 55 32 46 75 49 45 5a 79 0a 59 57 35 6a 61 58 4e 6a 62 7a 45 5a 4d 42 63 47 41 31 55 45 43 68 4d 51 62 33 4a 6e 4d 69 35 6c 65 47 46 74 63 47 78 6c 4c 6d 4e 76 62 54 45 63 4d 42 6f 47 41 31 55 45 41 78 4d 54 59 32 45 75 0a 62 33 4a 6e 4d 69 35 6c 65 47 46 74 63 47 78 6c 4c 6d 4e 76 62 54 41 65 46 77 30 78 4f 44 45 78 4d 54 55 78 4e 7a 4d 32 4d 44 42 61 46 77 30 79 4f 44 45 78 4d 54 49 78 4e 7a 4d 32 4d 44 42 61 0a 4d 47 6f 78 43 7a 41 4a 42 67 4e 56 42 41 59 54 41 6c 56 54 4d 52 4d 77 45 51 59 44 56 51 51 49 45 77 70 44 59 57 78 70 5a 6d 39 79 62 6d 6c 68 4d 52 59 77 46 41 59 44 56 51 51 48 45 77 31 54 0a 59 57 34 67 52 6e 4a 68 62 6d 4e 70 63 32 4e 76 4d 51 30 77 43 77 59 44 56 51 51 4c 45 77 52 77 5a 57 56 79 4d 52 38 77 48 51 59 44 56 51 51 44 45 78 5a 77 5a 57 56 79 4d 53 35 76 63 6d 63 79 0a 4c 6d 56 34 59 57 31 77 62 47 55 75 59 32 39 74 4d 46 6b 77 45 77 59 48 4b 6f 5a 49 7a 6a 30 43 41 51 59 49 4b 6f 5a 49 7a 6a 30 44 41 51 63 44 51 67 41 45 47 4d 4f 54 72 4b 35 48 5a 30 66 48 0a 43 6a 71 68 67 67 59 4e 30 6a 7a 39 5a 76 70 56 47 47 56 76 57 65 55 39 6b 33 4a 53 51 54 75 39 6f 6a 53 6d 6e 6e 44 30 4d 4d 55 77 50 4c 2b 4a 69 56 77 37 6d 55 30 51 71 42 44 64 4f 61 67 72 0a 69 78 48 39 54 47 78 37 4e 71 4e 4e 4d 45 73 77 44 67 59 44 56 52 30 50 41 51 48 2f 42 41 51 44 41 67 65 41 4d 41 77 47 41 31 55 64 45 77 45 42 2f 77 51 43 4d 41 41 77 4b 77 59 44 56 52 30 6a 0a 42 43 51 77 49 6f 41 67 50 75 6c 39 4e 37 6a 57 34 39 68 68 32 70 70 50 65 6f 52 54 2f 48 52 6b 4b 32 50 47 62 77 73 4b 35 58 41 6f 4f 57 45 4d 2b 44 6f 77 43 67 59 49 4b 6f 5a 49 7a 6a 30 45 0a 41 77 49 44 52 77 41 77 52 41 49 67 66 69 35 58 4a 58 4a 55 57 47 73 4b 5a 77 62 70 63 63 75 52 50 66 6c 31 4b 48 61 4b 44 42 30 69 2f 49 39 30 47 61 4d 72 55 6d 41 43 49 44 63 45 72 52 55 6e 0a 39 48 4c 66 73 45 55 6f 30 31 70 49 44 70 76 31 37 49 68 6f 43 4f 5a 6b 33 69 57 72 34 68 48 36 4a 78 79 30 0a 2d 2d 2d 2d 2d 45 4e 44 20 43 45 52 54 49 46 49 43 41 54 45 2d 2d 2d 2d 2d 0a  cannot be validated. No MSP found able to do that.  peer2.org1.example.com    | 2018-11-15 17:51:40.104 UTC  gossip/gossip  handleMessage -> WARN 5c4 Failed validating identity message: Peer Identity  0a 07 4f 72 67 32 4d 53 50 12 a6 06 2d 2d 2d 2d 2d 42 45 47 49 4e 20 43 45 52 54 49 46 49 43 41 54 45 2d 2d 2d 2d 2d 0a 4d 49 49 43 4a 7a 43 43 41 63 36 67 41 77 49 42 41 67 49 51 46 54 76 55 43 2b 6a 78 6a 32 50 4e 63 41 48 33 45 61 45 68 4d 7a 41 4b 42 67 67 71 68 6b 6a 4f 50 51 51 44 41 6a 42 7a 4d 51 73 77 0a 43 51 59 44 56 51 51 47 45 77 4a 56 55 7a 45 54 4d 42 45 47 41 31 55 45 43 42 4d 4b 51 32 46 73 61 57 5a 76 63 6d 35 70 59 54 45 57 4d 42 51 47 41 31 55 45 42 78 4d 4e 55 32 46 75 49 45 5a 79 0a 59 57 35 6a 61 58 4e 6a 62 7a 45 5a 4d 42 63 47 41 31 55 45 43 68 4d 51 62 33 4a 6e 4d 69 35 6c 65 47 46 74 63 47 78 6c 4c 6d 4e 76 62 54 45 63 4d 42 6f 47 41 31 55 45 41 78 4d 54 59 32 45 75 0a 62 33 4a 6e 4d 69 35 6c 65 47 46 74 63 47 78 6c 4c 6d 4e 76 62 54 41 65 46 77 30 78 4f 44 45 78 4d 54 55 78 4e 7a 4d 32 4d 44 42 61 46 77 30 79 4f 44 45 78 4d 54 49 78 4e 7a 4d 32 4d 44 42 61 0a 4d 47 6f 78 43 7a 41 4a 42 67 4e 56 42 41 59 54 41 6c 56 54 4d 52 4d 77 45 51 59 44 56 51 51 49 45 77 70 44 59 57 78 70 5a 6d 39 79 62 6d 6c 68 4d 52 59 77 46 41 59 44 56 51 51 48 45 77 31 54 0a 59 57 34 67 52 6e 4a 68 62 6d 4e 70 63 32 4e 76 4d 51 30 77 43 77 59 44 56 51 51 4c 45 77 52 77 5a 57 56 79 4d 52 38 77 48 51 59 44 56 51 51 44 45 78 5a 77 5a 57 56 79 4d 53 35 76 63 6d 63 79 0a 4c 6d 56 34 59 57 31 77 62 47 55 75 59 32 39 74 4d 46 6b 77 45 77 59 48 4b 6f 5a 49 7a 6a 30 43 41 51 59 49 4b 6f 5a 49 7a 6a 30 44 41 51 63 44 51 67 41 45 47 4d 4f 54 72 4b 35 48 5a 30 66 48 0a 43 6a 71 68 67 67 59 4e 30 6a 7a 39 5a 76 70 56 47 47 56 76 57 65 55 39 6b 33 4a 53 51 54 75 39 6f 6a 53 6d 6e 6e 44 30 4d 4d 55 77 50 4c 2b 4a 69 56 77 37 6d 55 30 51 71 42 44 64 4f 61 67 72 0a 69 78 48 39 54 47 78 37 4e 71 4e 4e 4d 45 73 77 44 67 59 44 56 52 30 50 41 51 48 2f 42 41 51 44 41 67 65 41 4d 41 77 47 41 31 55 64 45 77 45 42 2f 77 51 43 4d 41 41 77 4b 77 59 44 56 52 30 6a 0a 42 43 51 77 49 6f 41 67 50 75 6c 39 4e 37 6a 57 34 39 68 68 32 70 70 50 65 6f 52 54 2f 48 52 6b 4b 32 50 47 62 77 73 4b 35 58 41 6f 4f 57 45 4d 2b 44 6f 77 43 67 59 49 4b 6f 5a 49 7a 6a 30 45 0a 41 77 49 44 52 77 41 77 52 41 49 67 66 69 35 58 4a 58 4a 55 57 47 73 4b 5a 77 62 70 63 63 75 52 50 66 6c 31 4b 48 61 4b 44 42 30 69 2f 49 39 30 47 61 4d 72 55 6d 41 43 49 44 63 45 72 52 55 6e 0a 39 48 4c 66 73 45 55 6f 30 31 70 49 44 70 76 31 37 49 68 6f 43 4f 5a 6b 33 69 57 72 34 68 48 36 4a 78 79 30 0a 2d 2d 2d 2d 2d 45 4e 44 20 43 45 52 54 49 46 49 43 41 54 45 2d 2d 2d 2d 2d 0a  cannot be validated. No MSP found able to do that. peer2.org1.example.com    | Failed verifying message peer2.org1.example.com    | github.com/hyperledger/fabric/gossip/gossip.(*certStore).validateIdentityMsg peer2.org1.example.com    |     /opt/gopath/src/github.com/hyperledger/fabric/gossip/gossip/certstore.go:103 peer2.org1.example.com    | github.com/hyperledger/fabric/gossip/gossip.(*certStore).handleMessage peer2.org1.example.com    |     /opt/gopath/src/github.com/hyperledger/fabric/gossip/gossip/certstore.go:75 peer2.org1.example.com    | github.com/hyperledger/fabric/gossip/gossip.(*gossipServiceImpl).handleMessage peer2.org1.example.com    |     /opt/gopath/src/github.com/hyperledger/fabric/gossip/gossip/gossip_impl.go:403 peer2.org1.example.com    | github.com/hyperledger/fabric/gossip/gossip.(*gossipServiceImpl).acceptMessages peer2.org1.example.com    |     /opt/gopath/src/github.com/hyperledger/fabric/gossip/gossip/gossip_impl.go:330 peer2.org1.example.com    | runtime.goexit peer2.org1.example.com    |     /opt/go/src/runtime/asm_amd64.s:2361 peer2.org1.example.com    | github.com/hyperledger/fabric/gossip/gossip.(*certStore).handleMessage peer2.org1.example.com    |     /opt/gopath/src/github.com/hyperledger/fabric/gossip/gossip/certstore.go:76 peer2.org1.example.com    | github.com/hyperledger/fabric/gossip/gossip.(*gossipServiceImpl).handleMessage peer2.org1.example.com    |     /opt/gopath/src/github.com/hyperledger/fabric/gossip/gossip/gossip_impl.go:403 peer2.org1.example.com    | github.com/hyperledger/fabric/gossip/gossip.(*gossipServiceImpl).acceptMessages peer2.org1.example.com    |     /opt/gopath/src/github.com/hyperledger/fabric/gossip/gossip/gossip_impl.go:330 peer2.org1.example.com    | runtime.goexit peer2.org1.example.com    |     /opt/go/src/runtime/asm_amd64.s:2361  {code}     ></description> </Issue>
