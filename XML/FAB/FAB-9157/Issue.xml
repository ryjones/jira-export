<Issue id="28886" key="FAB-9157" number="9157" project="10002" reporter="sykesm" assignee="sykesm" creator="sykesm" type="10003" summary="Data race when running kafka consensus tests" priority="4" resolution="10000" status="6" created="2018-03-26 15:00:45.0" updated="2018-07-20 14:16:08.0" resolutiondate="2018-07-02 12:29:37.0" votes="0" watches="2" workflowId="41650"> <description><! CDATA {code:java} ================== WARNING: DATA RACE Write at 0x00c420384130 by goroutine 94:   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).processRegular()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain.go:802 +0x1457   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).processMessagesToBlocks()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain.go:413 +0x123c   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func4.3.2()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2796 +0x3c  Previous read at 0x00c420384130 by goroutine 89:   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).WaitReady()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain.go:165 +0xc1   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).WaitReady-fm()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2687 +0x41   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func1.1()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2175 +0x34  Goroutine 94 (running) created at:   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func4.3()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2795 +0xc01   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Goroutine 89 (running) created at:   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func1()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2174 +0x8c   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func4.3()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2790 +0xb4d   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d ================== ================== WARNING: DATA RACE Read at 0x00c42044e080 by goroutine 159:   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).WaitReady()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain.go:165 +0xc1   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).WaitReady-fm()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2687 +0x41   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func1.1()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2175 +0x34  Previous write at 0x00c42044e080 by goroutine 29:   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).processRegular()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain.go:802 +0x1457   github.com/hyperledger/fabric/orderer/consensus/kafka.(*chainImpl).processMessagesToBlocks()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain.go:413 +0x123c   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func4.5.2()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2968 +0x3c  Goroutine 159 (running) created at:   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func1()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2174 +0x8c   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func4.5()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2987 +0x1040   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Goroutine 29 (running) created at:   github.com/hyperledger/fabric/orderer/consensus/kafka.TestResubmission.func4.5()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/orderer/consensus/kafka/chain_test.go:2967 +0xc6e   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d =================={code}  ></description> </Issue>
