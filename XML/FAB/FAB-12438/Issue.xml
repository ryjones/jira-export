<Issue id="34641" key="FAB-12438" number="12438" project="10002" reporter="sykesm" assignee="yacovm" creator="sykesm" type="10004" summary="orderer test panics" priority="3" resolution="10000" status="6" created="2018-10-12 15:55:24.0" updated="2018-10-13 17:53:28.0" resolutiondate="2018-10-12 21:14:00.0" votes="0" watches="4" workflowId="46045"> <description><! CDATA {code:java} unit-tests_1  | 2018-10-12 15:51:08.398 UTC  orderer/common/server  func1 -> ERRO 002 Deliver client triggered panic: runtime error: invalid memory address or nil pointer dereference unit-tests_1  | goroutine 51  running : unit-tests_1  | runtime/debug.Stack(0x24b2590, 0x1, 0x1) unit-tests_1  | 	/opt/go/src/runtime/debug/stack.go:24 +0xb5 unit-tests_1  | github.com/hyperledger/fabric/orderer/common/server.(*server).Deliver.func1() unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/server.go:156 +0x104 unit-tests_1  | panic(0x174cf00, 0x2472350) unit-tests_1  | 	/opt/go/src/runtime/panic.go:513 +0x1b9 unit-tests_1  | github.com/hyperledger/fabric/orderer/common/multichannel.(*ChainSupport).Errored(0x0, 0x12) unit-tests_1  | 	<autogenerated>:1 +0x3e unit-tests_1  | github.com/hyperledger/fabric/common/deliver.(*Handler).deliverBlocks(0xc00063f8c0, 0x1a20a20, 0xc00065e330, 0xc000665f48, 0xc00015d270, 0x0, 0x0) unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/common/deliver/deliver.go:196 +0x75a unit-tests_1  | github.com/hyperledger/fabric/common/deliver.(*Handler).Handle(0xc00063f8c0, 0x1a20a20, 0xc00065e330, 0xc000665f48, 0xc00065e150, 0x0) unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/common/deliver/deliver.go:154 +0x331 unit-tests_1  | github.com/hyperledger/fabric/orderer/common/server.(*server).Deliver(0xc00063f8f0, 0x1a26f40, 0xc00065e150, 0x0, 0x0) unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/server.go:182 +0x38b unit-tests_1  | github.com/hyperledger/fabric/orderer/common/performance.(*BenchmarkServer).CreateDeliverClient.func1(0xc00065e150, 0xc000524c20) unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/performance/server.go:174 +0x6b unit-tests_1  | created by github.com/hyperledger/fabric/orderer/common/performance.(*BenchmarkServer).CreateDeliverClient unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/performance/server.go:173 +0x192 {code} Appears to be related to FAB-11863.  Printed out the value of chain:  {code:java} 	fmt.Printf("!!MJS: chain: %#v\n", chain) 	fmt.Printf("!!MJS: chain.Errored(): %#v\n", chain.Errored()) 	erroredChan := chain.Errored() 	select { 	case <-erroredChan: 		logger.Warningf(" channel: %s  Rejecting deliver request for %s because of consenter error", chdr.ChannelId, addr) 		return srv.SendStatusResponse(cb.Status_SERVICE_UNAVAILABLE) 	default: {code} What was printed was: {code:java} unit-tests_1  | !!MJS: chain: &multichannel.ChainSupport{ledgerResources:(*multichannel.ledgerResources)(0xc00038e640), Processor:(*msgprocessor.SystemChannel)(0xc00038e820), BlockWriter:(*multichannel.BlockWriter)(0xc0002284c0), Chain:(*solo.chain)(0xc00038e780), cutter:(*blockcutter.receiver)(0xc00063f650), LocalSigner:(*localmsp.mspSigner)(0x2f0cdc8)} unit-tests_1  | !!MJS: chain.Errored(): (<-chan struct {})(0xc0002d3e00) unit-tests_1  | !!MJS: chain: (*multichannel.ChainSupport)(nil) {code} /cc  ~yacovm   ~kchristidis   ></description> </Issue>
