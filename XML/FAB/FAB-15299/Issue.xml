<Issue id="39550" key="FAB-15299" number="15299" project="10002" reporter="tock" assignee="tock" creator="tock" type="10003" summary="Detect restart after consensus type change, change raft start" priority="3" resolution="10000" status="6" created="2019-04-29 14:13:58.0" updated="2019-06-11 15:50:38.0" resolutiondate="2019-05-08 22:09:15.0" votes="0" watches="1" workflowId="52430"> <description><! CDATA Detect restart after consensus-type migration by:  1. The last block and the block before it carry a config-tx 2. In both config txs we have ConsensusType.State == MAINTENANCE 3. The ConsensusType.Type is different in these two blocks 4. The last block (orderer) metadata is empty  This part is implemented in multichannel/chainsupport.go in order to be reusable.  In the etcdraft chain we have to change the start method. Change the etcdraft chain.start() such that:  isJoin = height >0 && not-migration (instead of isJoin=height>0).  "not-migration" is computed by calling the respective method in chainsupport that detects restart after migration.  We do that in order to change the way chain.node.start(fresh, join) is starting.  ></description> </Issue>
