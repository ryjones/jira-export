<Issue id="28862" key="FAB-9134" number="9134" project="10002" reporter="sykesm" creator="sykesm" type="10003" summary="Multiple data races when running TestGenerateDockerBuild" priority="4" resolution="10000" status="6" created="2018-03-26 13:41:24.0" updated="2018-07-20 14:16:07.0" resolutiondate="2018-07-02 20:35:22.0" votes="0" watches="1" workflowId="41640"> <description><! CDATA {code:java} unit-tests_1  | ==================  unit-tests_1  | WARNING: DATA RACE  unit-tests_1  | Read at 0x00c420098408 by goroutine 100:  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/util.DockerBuild()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:61 +0xeec  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.(*Platform).GenerateDockerBuild()  unit-tests_1  |       github.com/hyperledger/fabric/core/chaincode/platforms/golang/_test/_obj_test/platform.go:507 +0x88a  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.TestGenerateDockerBuild()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/platform_test.go:361 +0xbe1  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |  unit-tests_1  | Previous write at 0x00c420098408 by goroutine 26:  unit-tests_1  |   bytes.(*Buffer).grow()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:138 +0x24c  unit-tests_1  |   bytes.(*Buffer).Write()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:163 +0x16d  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/external/github.com/docker/docker/pkg/stdcopy.StdCopy()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/external/github.com/docker/docker/pkg/stdcopy/stdcopy.go:158 +0x785  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient.(*Client).hijack.func1.1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/client.go:722 +0x169  unit-tests_1  |  unit-tests_1  | Goroutine 100 (running) created at:  unit-tests_1  |   testing.(*T).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:789 +0x568  unit-tests_1  |   testing.runTests.func1()  unit-tests_1  |       /opt/go/src/testing/testing.go:1004 +0xa7  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |   testing.runTests()  unit-tests_1  |       /opt/go/src/testing/testing.go:1002 +0x521  unit-tests_1  |   testing.(*M).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:921 +0x206  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.TestMain()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/platform_test.go:378 +0x2c5  unit-tests_1  |   main.main()  unit-tests_1  |       github.com/hyperledger/fabric/core/chaincode/platforms/golang/_test/_testmain.go:118 +0x2f0  unit-tests_1  |  unit-tests_1  | Goroutine 26 (finished) created at:  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient.(*Client).hijack.func1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/client.go:708 +0x50c  unit-tests_1  | ==================  unit-tests_1  | ==================  unit-tests_1  | WARNING: DATA RACE  unit-tests_1  | Read at 0x00c4200983f0 by goroutine 100:  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/util.DockerBuild()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:61 +0xf0c  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.(*Platform).GenerateDockerBuild()  unit-tests_1  |       github.com/hyperledger/fabric/core/chaincode/platforms/golang/_test/_obj_test/platform.go:507 +0x88a  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.TestGenerateDockerBuild()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/platform_test.go:361 +0xbe1  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |  unit-tests_1  | Previous write at 0x00c4200983f0 by goroutine 26:  unit-tests_1  |   bytes.(*Buffer).grow()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:135 +0x3c3  unit-tests_1  |   bytes.(*Buffer).Write()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:163 +0x16d  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/external/github.com/docker/docker/pkg/stdcopy.StdCopy()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/external/github.com/docker/docker/pkg/stdcopy/stdcopy.go:158 +0x785  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient.(*Client).hijack.func1.1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/client.go:722 +0x169  unit-tests_1  |  unit-tests_1  | Goroutine 100 (running) created at:  unit-tests_1  |   testing.(*T).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:789 +0x568  unit-tests_1  |   testing.runTests.func1()  unit-tests_1  |       /opt/go/src/testing/testing.go:1004 +0xa7  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |   testing.runTests()  unit-tests_1  |       /opt/go/src/testing/testing.go:1002 +0x521  unit-tests_1  |   testing.(*M).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:921 +0x206  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.TestMain()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/platform_test.go:378 +0x2c5  unit-tests_1  |   main.main()  unit-tests_1  |       github.com/hyperledger/fabric/core/chaincode/platforms/golang/_test/_testmain.go:118 +0x2f0  unit-tests_1  |  unit-tests_1  | Goroutine 26 (finished) created at:  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient.(*Client).hijack.func1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/client.go:708 +0x50c  unit-tests_1  | ==================  unit-tests_1  | ==================  unit-tests_1  | WARNING: DATA RACE  unit-tests_1  | Read at 0x00c4200fc2a0 by goroutine 100:  unit-tests_1  |   runtime.slicebytetostring()  unit-tests_1  |       /opt/go/src/runtime/string.go:72 +0x0  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/util.DockerBuild()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:61 +0xf62  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.(*Platform).GenerateDockerBuild()  unit-tests_1  |       github.com/hyperledger/fabric/core/chaincode/platforms/golang/_test/_obj_test/platform.go:507 +0x88a  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.TestGenerateDockerBuild()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/platform_test.go:361 +0xbe1  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |  unit-tests_1  | Previous write at 0x00c4200fc2a0 by goroutine 26:  unit-tests_1  |   runtime.slicecopy()  unit-tests_1  |       /opt/go/src/runtime/slice.go:160 +0x0  unit-tests_1  |   bytes.(*Buffer).Write()  unit-tests_1  |       /opt/go/src/bytes/buffer.go:165 +0x121  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/external/github.com/docker/docker/pkg/stdcopy.StdCopy()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/external/github.com/docker/docker/pkg/stdcopy/stdcopy.go:158 +0x785  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient.(*Client).hijack.func1.1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/client.go:722 +0x169  unit-tests_1  |  unit-tests_1  | Goroutine 100 (running) created at:  unit-tests_1  |   testing.(*T).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:789 +0x568  unit-tests_1  |   testing.runTests.func1()  unit-tests_1  |       /opt/go/src/testing/testing.go:1004 +0xa7  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |   testing.runTests()  unit-tests_1  |       /opt/go/src/testing/testing.go:1002 +0x521  unit-tests_1  |   testing.(*M).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:921 +0x206  unit-tests_1  |   github.com/hyperledger/fabric/core/chaincode/platforms/golang.TestMain()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/platforms/golang/platform_test.go:378 +0x2c5  unit-tests_1  |   main.main()  unit-tests_1  |       github.com/hyperledger/fabric/core/chaincode/platforms/golang/_test/_testmain.go:118 +0x2f0  unit-tests_1  |  unit-tests_1  | Goroutine 26 (finished) created at:  unit-tests_1  |   github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient.(*Client).hijack.func1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/fsouza/go-dockerclient/client.go:708 +0x50c  unit-tests_1  | =================={code}  ></description> </Issue>
