<Issue id="29490" key="FAB-9578" number="9578" project="10002" reporter="bstasyszyn" assignee="yacovm" creator="bstasyszyn" type="10004" summary="Panic when discovering local peers" priority="3" resolution="10000" status="6" created="2018-04-18 19:43:53.0" updated="2018-07-20 14:16:21.0" resolutiondate="2018-04-19 08:42:05.0" votes="0" watches="2" workflowId="41875"> <description><! CDATA Sending a discovery request with a local peers query causes a panic on the peer:  req := discclient.NewRequest().AddLocalPeersQuery() client.Send(ctx, req, target)  ... results in the following panic:  org1peer1_1      | 2018-04-18 19:19:11.690 UTC  discovery/acl  ConfigSequence -> CRIT 0c8 Failed obtaining channel config for channel  org1peer1_1      | panic: Failed obtaining channel config for channel org1peer1_1      |  org1peer1_1      | goroutine 723  running : org1peer1_1      | github.com/hyperledger/fabric/vendor/github.com/op/go-logging.(*Logger).Panic(0xc4202c8090, 0xc4223b72e0, 0x2, 0x2) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/op/go-logging/logger.go:188 +0xbd org1peer1_1      | github.com/hyperledger/fabric/discovery/support/acl.(*DiscoverySupport).ConfigSequence(0xc42198cf60, 0x0, 0x0, 0x46) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/discovery/support/acl/support.go:79 +0x288 org1peer1_1      | github.com/hyperledger/fabric/discovery.(*accessCache).EligibleForService(0xc42003f7c0, 0xc421e56700, 0x34e, 0x34e, 0xc421e56a80, 0x322, 0x322, 0xc421e1c5a0, 0x46, 0x46, ...) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/discovery/authcache.go:104 +0x1e4 org1peer1_1      | github.com/hyperledger/fabric/discovery.(*authCache).EligibleForService(0xc4202f3980, 0x0, 0x0, 0xc421e56700, 0x34e, 0x34e, 0xc421e56a80, 0x322, 0x322, 0xc421e1c5a0, ...) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/discovery/authcache.go:79 +0xe0 org1peer1_1      | github.com/hyperledger/fabric/discovery.(*service).processQuery(0xc4202f39c0, 0xc4223b71a0, 0xc421e19170, 0xc421e56a80, 0x322, 0x322, 0xc421e4a130, 0x10, 0x0) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/discovery/service.go:96 +0x148 org1peer1_1      | github.com/hyperledger/fabric/discovery.(*service).Discover(0xc4202f39c0, 0xfc48a0, 0xc421e190b0, 0xc421e19170, 0xc4202f39c0, 0xc421e19150, 0xc421feca70) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/discovery/service.go:84 +0x193 org1peer1_1      | github.com/hyperledger/fabric/protos/discovery._Discovery_Discover_Handler(0xea63e0, 0xc4202f39c0, 0xfc48a0, 0xc421e190b0, 0xc421e3e1c0, 0x0, 0x0, 0x0, 0x20, 0x0) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/protos/discovery/protocol.pb.go:902 +0x241 org1peer1_1      | github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).processUnaryRPC(0xc4201ea000, 0xfc7ee0, 0xc421971e00, 0xc421e8c000, 0xc42198d380, 0x165ee10, 0xc421e19140, 0x0, 0x0) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:920 +0x848 org1peer1_1      | github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).handleStream(0xc4201ea000, 0xfc7ee0, 0xc421971e00, 0xc421e8c000, 0xc421e19140) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:1142 +0x1318 org1peer1_1      | github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1.1(0xc42199f080, 0xc4201ea000, 0xfc7ee0, 0xc421971e00, 0xc421e8c000) org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:637 +0x9f org1peer1_1      | created by github.com/hyperledger/fabric/vendor/google.golang.org/grpc.(*Server).serveStreams.func1 org1peer1_1      | 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/google.golang.org/grpc/server.go:635 +0xa1   ></description> </Issue>
