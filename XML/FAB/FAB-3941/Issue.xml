<Issue id="16750" key="FAB-3941" number="3941" project="10002" reporter="yacovm" assignee="yacovm" creator="yacovm" type="10004" summary="peer channel create CI failure" priority="3" resolution="10000" status="6" created="2017-05-15 20:55:30.0" updated="2018-07-20 14:12:47.0" resolutiondate="2017-05-22 19:52:24.0" votes="0" watches="1" workflowId="38534"> <description><! CDATA This test was introduced lately (12/5) https://gerrit.hyperledger.org/r/#/c/8059/18/peer/channel/create_test.go The purpose of the change set was to fix a problem with peer cli when kafka orderer is used as kafka doesn't create the channel "fast enough". These 2 tests that were added both spawn an ordering service mock and my guess is that even though they have a `defer shutdown` for the instance, some stuff weren't cleaned up fast enough.  20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | Received error: EOF 20:14:49 unit-tests_1  | 2017/05/15 20:14:49 proto: textWriter unindented too far 20:14:49 unit-tests_1  | Received block:  header:<6:7 0:"\x00" } 0:4 0:/* unexpected EOF */ > 20:14:49 unit-tests_1  | --- FAIL: TestCreateChainWithTimeoutErr (0.00s) 20:14:49 unit-tests_1  | panic: listen tcp 127.0.0.1:7050: bind: address already in use  recovered  20:14:49 unit-tests_1  | 	panic: listen tcp 127.0.0.1:7050: bind: address already in use 20:14:49 unit-tests_1  |  20:14:49 unit-tests_1  | goroutine 167  running : 20:14:49 unit-tests_1  | panic(0x95a0c0, 0xc4203993b0) 20:14:49 unit-tests_1  | 	/opt/go/src/runtime/panic.go:500 +0x1a1 20:14:49 unit-tests_1  | testing.tRunner.func1(0xc420097200) 20:14:49 unit-tests_1  | 	/opt/go/src/testing/testing.go:579 +0x25d 20:14:49 unit-tests_1  | panic(0x95a0c0, 0xc4203993b0) 20:14:49 unit-tests_1  | 	/opt/go/src/runtime/panic.go:458 +0x243 20:14:49 unit-tests_1  | github.com/hyperledger/fabric/peer/channel.newOrderer(0x1b8a, 0xc420097200, 0x0) 20:14:49 unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/peer/channel/create_test.go:53 +0x388 20:14:49 unit-tests_1  | github.com/hyperledger/fabric/peer/channel.TestCreateChainWithTimeoutErr(0xc420097200) 20:14:49 unit-tests_1  | 	/opt/gopath/src/github.com/hyperledger/fabric/peer/channel/create_test.go:258 +0x19f 20:14:49 unit-tests_1  | testing.tRunner(0xc420097200, 0xa3cf48) 20:14:49 unit-tests_1  | 	/opt/go/src/testing/testing.go:610 +0x81 20:14:49 unit-tests_1  | created by testing.(*T).Run 20:14:49 unit-tests_1  | 	/opt/go/src/testing/testing.go:646 +0x2ec 20:14:49 unit-tests_1  | FAIL	github.com/hyperledger/fabric/peer/channel	3.168s 20:14:49 unit-tests_1  | error: exit status 1 20:14:49 unit-tests_1  | panic: EOF 20:14:49 unit-tests_1  |  20:14:49 unit-tests_1  | goroutine 1  running : 20:14:49 unit-tests_1  | panic(0x4daca0, 0xc42006c020) 20:14:49 unit-tests_1  | 	/opt/go/src/runtime/panic.go:500 +0x1a1  ></description> </Issue>
