<Action id="71514" issue="46615" author="denyeart" type="comment" created="2021-03-11 05:49:35.0" updateauthor="denyeart" updated="2021-03-11 05:50:21.0"> <body><! CDATA It sounds like peer2 cannot connect to peer1 to retrieve the private data.  Restart the peer and check the log to see if it is able to establish connection with peer1, look for the gossip "membership view" log info messages.  ></body> </Action>
<Action id="71516" issue="46615" author="JIRAUSER21534" type="comment" created="2021-03-11 12:44:34.0" updateauthor="JIRAUSER21534" updated="2021-03-11 12:44:34.0"> <body><! CDATA Adding to the above issue that these are the latest peer logs. Although it is able to discover and connect to org2 peers but still gossip is getting blocks very very slowly. It is getting one block per minute and hence lags behind org2 peers which then leads to private data failure. Able to fetch the latest block from orderer from Org1 peers manually from cli.  ï¿½ 33m2021-03-11 06:29:09.784 UTC  gossip.privdata  RetrievePvtdata -> WARN b687a4bï¿½ 0m Could not fetch all 1 eligible collection private write sets for block  141821  (0 from local cache, 0 from transient store, 0 from other peers). Will commit block with missing private write sets: txID: 2329c91dc4838d23577f3fda58856b2ea8f7671e3e625501c3c1fced002bee45, seq: 1, namespace: mycc, collection: _implicit_org_org1, hash: 26ea0f626b927c0f82b9c465ff68d5f0451326d8ed14c41fdae050ccf8a0652b   channel=mychannel  updating Alive Message:Membership: Endpoint:peer1.org1.com:7051 PKI-id:23bf13103426598fb718c6b46035054c3da82f0a4d29f213eaa31459ef2815a4Identity:Timestamp:inc_num:1615284843005895950 seq_num:82675  36m2021-03-11 12:03:25.194 UTC  grpc  UpdateSubConnState -> DEBU 2931c 0m pickfirstBalancer: HandleSubConnStateChange: 0xc00333c7b0, \{CONNECTING <nil>}  36m2021-03-11 12:03:25.194 UTC  grpc  Infof -> DEBU 2931d 0m Channel Connectivity change to CONNECTING  36m2021-03-11 12:03:25.195 UTC  grpc  Warningf -> DEBU 2931e 0m grpc: addrConn.createTransport failed to connect to \{10.244.3.41:7051 <nil> 0 <nil>}. Err: connection error: desc = "transport: authentication handshake failed: x509: cannot validate certificate for xxxxxxxxx because it doesn't contain any IP SANs". Reconnecting...  36m2021-03-11 12:03:25.195 UTC  grpc  Infof -> DEBU 2931f 0m Subchannel Connectivity change to TRANSIENT_FAILURE  36m2021-03-11 12:03:25.195 UTC  grpc  UpdateSubConnState -> DEBU 29320 0m pickfirstBalancer: HandleSubConnStateChange: 0xc00333c7b0, \{TRANSIENT_FAILURE connection error: desc = "transport: authentication handshake failed: x509: cannot validate certificate for 10.244.3.41 because it doesn't contain any IP SANs"}  36m2021-03-11 12:03:25.195 UTC  grpc  Infof -> DEBU 29321 0m Channel Connectivity change to TRANSIENT_FAILURE  31m2021-03-11 12:03:25.384 UTC  core.comm  ServerHandshake -> ERRO 29322 0m Server TLS handshake failed in 845.607Âµs with error remote error: tls: bad certificate server=PeerServer remoteaddress=xxxxxxxxxx:36954  36m2021-03-11 12:03:25.384 UTC  grpc  Warningf -> DEBU 29323 0m grpc: Server.Serve failed to complete security handshake from "10.244.3.41:36954": remote error: tls: bad certificate  36m2021-03-11 12:03:25.536 UTC  gossip.gossip  handleMessage -> DEBU 29324 0m Entering, xxxxxxxx:22512 f847a19713aa4f29a83765e509c1acd98d3720c5a46e0fc205f156044aee044d sent us GossipMessage: Channel: , nonce: 0, tag: EMPTY Alive Message:Membership: Endpoint:peer1.org2.com:7051 PKI-id:f847a19713aa4f29a83765e509c1acd98d3720c5a46e0fc205f156044aee044dIdentity:Timestamp:inc_num:1615301666890494280 seq_num:99168 , Envelope: 88 bytes, Signature: 71 bytes  36m2021-03-11 12:03:25.536 UTC  gossip.gossip  handleMessage -> DEBU 29325 0m Exiting  ></body> </Action>
<Action id="71520" issue="46615" author="denyeart" type="comment" created="2021-03-12 01:57:15.0" updateauthor="denyeart" updated="2021-03-12 01:58:05.0"> <body><! CDATA The 60s delay is due to this configuration:   https://github.com/hyperledger/fabric/blob/master/sampleconfig/core.yaml#L185   The peer attempts to retrieve private data from remote peers for 60s (by default) before committing the block without private data. This can be configured to a lower value. The connection issue with other peers is the root cause though.  The log from time of peer start should give some clues of which peers it can and cannot connect to.  ></body> </Action>
