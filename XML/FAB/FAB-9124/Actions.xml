<Action id="42915" issue="28852" author="sykesm" type="comment" created="2018-04-13 14:06:00.0" updateauthor="sykesm" updated="2018-04-13 14:06:00.0"> <body><! CDATA On current master, this is the reported race for the test: {code:java} ================== WARNING: DATA RACE Write at 0x00c4200d6648 by goroutine 15:   github.com/hyperledger/fabric/common/deliver.nextBlock()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver.go:321 +0x1d3   github.com/hyperledger/fabric/common/deliver.(*Handler).deliverBlocks()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver.go:250 +0x1a1f   github.com/hyperledger/fabric/common/deliver.(*Handler).Handle()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver.go:153 +0x380   github.com/hyperledger/fabric/common/deliver_test.glob..func2.3.23.2()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver_test.go:493 +0x101   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes.(*runner).runSync()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes/runner.go:109 +0xbb   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes.(*runner).run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes/runner.go:63 +0x17a   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes.(*ItNode).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes/it_node.go:25 +0xa0   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec.(*Spec).runSample()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec/spec.go:176 +0x741   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec.(*Spec).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec/spec.go:127 +0x112   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner.(*SpecRunner).runSpec()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner/spec_runner.go:198 +0x173   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner.(*SpecRunner).runSpecs()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner/spec_runner.go:168 +0x5f7   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner.(*SpecRunner).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner/spec_runner.go:64 +0x103   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/suite.(*Suite).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/suite/suite.go:62 +0x3b9   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo.RunSpecsWithCustomReporters()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/ginkgo_dsl.go:218 +0x310   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo.RunSpecs()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/ginkgo_dsl.go:199 +0xc1   github.com/hyperledger/fabric/common/deliver_test.TestDeliver()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver_suite_test.go:18 +0x85   testing.tRunner()       /usr/local/Cellar/go/1.10.1/libexec/src/testing/testing.go:777 +0x16d  Previous write at 0x00c4200d6648 by goroutine 34:   github.com/hyperledger/fabric/common/deliver.nextBlock.func1()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver.go:313 +0x8c  Goroutine 15 (running) created at:   testing.(*T).Run()       /usr/local/Cellar/go/1.10.1/libexec/src/testing/testing.go:824 +0x564   testing.runTests.func1()       /usr/local/Cellar/go/1.10.1/libexec/src/testing/testing.go:1063 +0xa4   testing.tRunner()       /usr/local/Cellar/go/1.10.1/libexec/src/testing/testing.go:777 +0x16d   testing.runTests()       /usr/local/Cellar/go/1.10.1/libexec/src/testing/testing.go:1061 +0x4e1   testing.(*M).Run()       /usr/local/Cellar/go/1.10.1/libexec/src/testing/testing.go:978 +0x2cd   main.main()       _testmain.go:44 +0x22a  Goroutine 34 (finished) created at:   github.com/hyperledger/fabric/common/deliver.nextBlock()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver.go:311 +0xdc   github.com/hyperledger/fabric/common/deliver.(*Handler).deliverBlocks()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver.go:250 +0x1a1f   github.com/hyperledger/fabric/common/deliver.(*Handler).Handle()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver.go:153 +0x380   github.com/hyperledger/fabric/common/deliver_test.glob..func2.3.23.2()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver_test.go:493 +0x101   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes.(*runner).runSync()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes/runner.go:109 +0xbb   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes.(*runner).run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes/runner.go:63 +0x17a   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes.(*ItNode).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/leafnodes/it_node.go:25 +0xa0   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec.(*Spec).runSample()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec/spec.go:176 +0x741   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec.(*Spec).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/spec/spec.go:127 +0x112   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner.(*SpecRunner).runSpec()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner/spec_runner.go:198 +0x173   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner.(*SpecRunner).runSpecs()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner/spec_runner.go:168 +0x5f7   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner.(*SpecRunner).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/specrunner/spec_runner.go:64 +0x103   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/suite.(*Suite).Run()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/internal/suite/suite.go:62 +0x3b9   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo.RunSpecsWithCustomReporters()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/ginkgo_dsl.go:218 +0x310   github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo.RunSpecs()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/onsi/ginkgo/ginkgo_dsl.go:199 +0xc1   github.com/hyperledger/fabric/common/deliver_test.TestDeliver()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/deliver/deliver_suite_test.go:18 +0x85   testing.tRunner()       /usr/local/Cellar/go/1.10.1/libexec/src/testing/testing.go:777 +0x16d =================={code}  ></body> </Action>
<Action id="42917" issue="28852" author="sykesm" type="comment" body="https://gerrit.hyperledger.org/r/20537" created="2018-04-13 14:30:34.0" updateauthor="sykesm" updated="2018-04-13 14:30:34.0"/>
