<Issue id="19976" key="FAB-5631" number="5631" project="10002" reporter="c0rwin" assignee="c0rwin" creator="c0rwin" type="10004" summary="Make sure couchdb is running while starting peer for FabCar sample application." priority="3" resolution="10000" status="6" created="2017-08-06 09:53:47.0" updated="2018-07-20 14:13:59.0" resolutiondate="2017-08-06 12:31:13.0" votes="0" watches="1" workflowId="39643"> <description><! CDATA Currently {{docker-compose.yaml}} file of the basic-network setup doesn't defines dependencies between peer and couch db container. Which might lead to the errors in cases where it takes few moments longer to couchdb container to start, for example issue reported at  SO|https://stackoverflow.com/questions/45530104/hyperledger-fabric-fabcar-error/45530696#45530696 .  {code} peer0.org1.example.com: container_name: peer0.org1.example.com image: hyperledger/fabric-peer:x86_64-1.0.0 environment: - CORE_VM_ENDPOINT=unix:///host/var/run/docker.sock - CORE_PEER_ID=peer0.org1.example.com - CORE_LOGGING_PEER=debug - CORE_CHAINCODE_LOGGING_LEVEL=DEBUG - CORE_PEER_LOCALMSPID=Org1MSP - CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/peer/ - CORE_PEER_ADDRESS=peer0.org1.example.com:7051 # # the following setting starts chaincode containers on the same # # bridge network as the peers # # https://docs.docker.com/compose/networking/ - CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE=${COMPOSE_PROJECT_NAME}_basic - CORE_LEDGER_STATE_STATEDATABASE=CouchDB - CORE_LEDGER_STATE_COUCHDBCONFIG_COUCHDBADDRESS=couchdb:5984 working_dir: /opt/gopath/src/github.com/hyperledger/fabric command: peer node start # command: peer node start --peer-chaincodedev=true ports: - 7051:7051 - 7053:7053 volumes: - /var/run/:/host/var/run/ - ./crypto-config/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/msp:/etc/hyperledger/msp/peer - ./crypto-config/peerOrganizations/org1.example.com/users:/etc/hyperledger/msp/users - ./config:/etc/hyperledger/configtx depends_on: - orderer.example.com networks: - basic {code}  Therefore need to add {{couchdb}} into {{depends_on}} section to make sure couchdb started prior to the peer container  {code} depends_on: - orderer.example.com - couchdb {code}    ></description> </Issue>
