<Issue id="45036" key="FAB-17869" number="17869" project="10002" reporter="kopaygorodsky" assignee="yacovm" creator="kopaygorodsky" type="10004" summary="Orderer replaces TLS CA root certs with same subject" priority="3" resolution="10000" status="6" created="2020-05-10 13:07:22.0" updated="2020-07-01 10:16:20.0" resolutiondate="2020-05-11 00:51:46.0" votes="0" watches="3" workflowId="58944" archived="N"> <description><! CDATA I have multiple orgs added to system channel Orderer group in genesis block I'm not able to connect to my ordering nodes (mutual tls enabled because of raft). In ordering logs I see `TLS handshake failed with error tls: failed to verify client's certificate: x509: certificate signed by unknown authority (possibly because of "x509: ECDSA verification failure" while trying to verify candidate authority certificate "fabric-ca-server") `. When I start with 1 org and then add orgs with channel update - it works, but after a few mins it throws same error again.  I figured out the problem by reading orderer source code. The problem was in CRS subjects of all CAs, they have same CN + OU which means subjects are equal.  https://github.com/hyperledger/fabric/blob/2c2274d0519a1ce1eba596ff0a43636dce64d926/internal/pkg/comm/server.go#L271 it happens because of key in this map.  CaRoot certs are getting replaced when updating root CAs for channel.  ></description> </Issue>
