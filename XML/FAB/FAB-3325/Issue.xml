<Issue id="15917" key="FAB-3325" number="3325" project="10002" reporter="rhegde" assignee="muralisr" creator="rhegde" type="10004" summary="Chaincode instantiation fails after a Peer Recovery" priority="3" resolution="10000" status="6" created="2017-04-21 21:22:30.0" updated="2020-09-24 12:07:03.0" resolutiondate="2017-06-02 20:32:48.0" votes="0" watches="3" workflowId="38103" security="10000"> <description><! CDATA Procedure - Install and instantiate a chaincode on  say Peer0 using Peer CLI - Peer0 is bounced thus causing user-chaincode container to stop. - Client now tries to Invoke a new Fabric Proposal request thus causing an instantiation failure of the user-chaincode  Logs of Client using Fabric Java SDK {quote}  2017-04-21 20:31:45.045 ERROR 74358 ---  ingleThreadTask  o.h.f.s.Chain                            : Sending proposal to peer1 failed because of gRPC failure=Status{code=UNKNOWN, description=Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory, cause=null}  java.lang.Exception: io.grpc.StatusRuntimeException: UNKNOWN: Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory at org.hyperledger.fabric.sdk.Chain.sendProposalToPeers(Chain.java:2041)  fabric-sdk-java-1.0-SNAPSHOT.jar!/:?  at org.hyperledger.fabric.sdk.Chain.sendProposal(Chain.java:1980)  fabric-sdk-java-1.0-SNAPSHOT.jar!/:?  at org.hyperledger.fabric.sdk.Chain.sendTransactionProposal(Chain.java:1918)  fabric-sdk-java-1.0-SNAPSHOT.jar!/:?  at com.cls.clsnet.fabric.wrapper.FabricWrapperImpl.ledgerTransaction(FabricWrapperImpl.java:70)  clsnet-cls-fabric-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at com.cls.clsnet.inbound.msg.serviceimpl.FabricWrapperInputServiceImpl.processInboundMessage(FabricWrapperInputServiceImpl.java:78)  clsnet-participant-services-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at com.cls.clsnet.task.FabricWrapperInputTask.executeTask(FabricWrapperInputTask.java:30)  clsnet-participant-services-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at com.cls.clsnet.executor.SingleThreadExecutor.run(SingleThreadExecutor.java:50)  clsnet-common-core-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)  ?:1.8.0_121  at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)  ?:1.8.0_121  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)  ?:1.8.0_121  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)  ?:1.8.0_121  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)  ?:1.8.0_121  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)  ?:1.8.0_121  at java.lang.Thread.run(Thread.java:745)  ?:1.8.0_121  Caused by: io.grpc.StatusRuntimeException: UNKNOWN: Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory at io.grpc.Status.asRuntimeException(Status.java:540) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.stub.ClientCalls$UnaryStreamToFuture.onClose(ClientCalls.java:439) ~ grpc-stub-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:428) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl.access$100(ClientCallImpl.java:76) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.close(ClientCallImpl.java:514) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.access$700(ClientCallImpl.java:431) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:546) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:52) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.SerializingExecutor$TaskRunner.run(SerializingExecutor.java:152) ~ grpc-core-1.2.0.jar!/:1.2.0  ... 3 more  2017-04-21 20:31:45.046 ERROR 74358 ---  ingleThreadTask  o.h.f.s.Chain                            : Sending proposal to peer0 failed because of gRPC failure=Status{code=UNKNOWN, description=Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory, cause=null}  java.lang.Exception: io.grpc.StatusRuntimeException: UNKNOWN: Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory at org.hyperledger.fabric.sdk.Chain.sendProposalToPeers(Chain.java:2041)  fabric-sdk-java-1.0-SNAPSHOT.jar!/:?  at org.hyperledger.fabric.sdk.Chain.sendProposal(Chain.java:1980)  fabric-sdk-java-1.0-SNAPSHOT.jar!/:?  at org.hyperledger.fabric.sdk.Chain.sendTransactionProposal(Chain.java:1918)  fabric-sdk-java-1.0-SNAPSHOT.jar!/:?  at com.cls.clsnet.fabric.wrapper.FabricWrapperImpl.ledgerTransaction(FabricWrapperImpl.java:70)  clsnet-cls-fabric-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at com.cls.clsnet.inbound.msg.serviceimpl.FabricWrapperInputServiceImpl.processInboundMessage(FabricWrapperInputServiceImpl.java:78)  clsnet-participant-services-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at com.cls.clsnet.task.FabricWrapperInputTask.executeTask(FabricWrapperInputTask.java:30)  clsnet-participant-services-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at com.cls.clsnet.executor.SingleThreadExecutor.run(SingleThreadExecutor.java:50)  clsnet-common-core-0.0.1-SNAPSHOT.jar!/:0.0.1-SNAPSHOT  at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)  ?:1.8.0_121  at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)  ?:1.8.0_121  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)  ?:1.8.0_121  at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)  ?:1.8.0_121  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)  ?:1.8.0_121  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)  ?:1.8.0_121  at java.lang.Thread.run(Thread.java:745)  ?:1.8.0_121  Caused by: io.grpc.StatusRuntimeException: UNKNOWN: Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory at io.grpc.Status.asRuntimeException(Status.java:540) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.stub.ClientCalls$UnaryStreamToFuture.onClose(ClientCalls.java:439) ~ grpc-stub-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl.closeObserver(ClientCallImpl.java:428) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl.access$100(ClientCallImpl.java:76) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.close(ClientCallImpl.java:514) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl.access$700(ClientCallImpl.java:431) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ClientCallImpl$ClientStreamListenerImpl$1StreamClosed.runInContext(ClientCallImpl.java:546) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.ContextRunnable.run(ContextRunnable.java:52) ~ grpc-core-1.2.0.jar!/:1.2.0  at io.grpc.internal.SerializingExecutor$TaskRunner.run(SerializingExecutor.java:152) ~ grpc-core-1.2.0.jar!/:1.2.0  ... 3 more  2017-04-21 20:31:45.047  INFO 74358 ---  ingleThreadTask  c.c.c.f.w.FabricWrapperImpl              :  Received Proposal Response - 2017-04-21 20:31:45.047  INFO 74358 ---  ingleThreadTask  c.c.c.f.w.FabricWrapperImpl              :  Proposal Response - FAILURE 2017-04-21 20:31:45.048  INFO 74358 ---  ingleThreadTask  c.c.c.f.w.FabricWrapperImpl              :  Proposal Response - FAILURE 2017-04-21 20:31:45.048  INFO 74358 ---  ingleThreadTask  c.c.c.f.w.FabricWrapperImpl              :  Verifying Proposal Responses java.lang.Exception: Not enough endorsers :0.  Sending proposal to peer1 failed because of gRPC failure=Status{code=UNKNOWN, description=Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory, cause=null}. Was verified: false at com.cls.clsnet.fabric.wrapper.FabricWrapperImpl.ledgerTransaction(FabricWrapperImpl.java:94) at com.cls.clsnet.inbound.msg.serviceimpl.FabricWrapperInputServiceImpl.processInboundMessage(FabricWrapperInputServiceImpl.java:78) at com.cls.clsnet.task.FabricWrapperInputTask.executeTask(FabricWrapperInputTask.java:30) at com.cls.clsnet.executor.SingleThreadExecutor.run(SingleThreadExecutor.java:50) at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180) at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294) at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142) at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617) at java.lang.Thread.run(Thread.java:745) 2017-04-21 20:31:45.049 ERROR 74358 ---  ingleThreadTask  c.c.c.t.FabricWrapperInputTask           : Exception Occured while Processing Object from Fabric Wrapper Input Queue ... java.lang.Exception: Not enough endorsers :0.  Sending proposal to peer1 failed because of gRPC failure=Status{code=UNKNOWN, description=Error executing chaincode: Could not get deployment transaction from LSCC for p2pcls:1.0 - Get ChaincodeDeploymentSpec for p2pcls/bar from LSCC error: invalid deployment spec : open /var/hyperledger/production/chaincodes/p2pcls.1.0: no such file or directory, cause=null}. Was verified: false {quote}  We were not able to capture peer logs due to Gossip Logging. Log capture went into an irrecoverable state.  ></description> </Issue>
