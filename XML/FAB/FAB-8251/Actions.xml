<Action id="46754" issue="27684" author="adnanchoudhury" type="comment" created="2018-06-29 15:00:29.0" updateauthor="adnanchoudhury" updated="2018-06-30 04:48:01.0"> <body><! CDATA *Hardware Setup:* IBM Kubernetes cluster of 6 machines (3 each of 2 CPU-4GB memory, 3 each of 4 CPU-16GB memory)  *Result:* *Short:*  1st set of 0.1 million invoke at 36.86 PS 2nd set of 0.1 million invoke at 28.25 PS  set of 0.2 million query at 53.64 PS   Long:  ======= PTE 0 main Test Summary: executed at Fri Jun 29 2018 05:10:13 GMT+0000 (UTC) =======  (testorgschannel1:marbles02_go_ch1): INVOKE transaction stats  (testorgschannel1:marbles02_go_ch1): Total transactions 50000  timeout transactions 0  (testorgschannel1:marbles02_go_ch1): start 1530249030695  end 1530251742270  duration 2711575 ms  (testorgschannel1:marbles02_go_ch1): TPS 18.44  (testorgschannel1:marbles02_go_ch1): peer latency stats (endorsement)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 2146903 ms  (testorgschannel1:marbles02_go_ch1): min: 12 ms  max: 255 ms  avg: 42.93806 ms  (testorgschannel1:marbles02_go_ch1): orderer latency stats (transaction ack)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 1011223 ms  (testorgschannel1:marbles02_go_ch1): min: 5 ms  max: 267 ms  avg: 20.22446 ms  (testorgschannel1:marbles02_go_ch1): event latency stats (end-to-end)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 19815683 ms  (testorgschannel1:marbles02_go_ch1): min: 88 ms  max: 1075 ms  avg: 396.31366 ms     ======= PTE 1 main Test Summary: executed at Fri Jun 29 2018 05:10:13 GMT+0000 (UTC) =======  (testorgschannel2:marbles02_go_ch2): INVOKE transaction stats  (testorgschannel2:marbles02_go_ch2): Total transactions 50000  timeout transactions 0  (testorgschannel2:marbles02_go_ch2): start 1530249030695  end 1530251745075  duration 2714380 ms  (testorgschannel2:marbles02_go_ch2): TPS 18.42  (testorgschannel2:marbles02_go_ch2): peer latency stats (endorsement)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 2136626 ms  (testorgschannel2:marbles02_go_ch2): min: 12 ms  max: 248 ms  avg: 42.73252 ms  (testorgschannel2:marbles02_go_ch2): orderer latency stats (transaction ack)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 1062880 ms  (testorgschannel2:marbles02_go_ch2): min: 6 ms  max: 260 ms  avg: 21.2576 ms  (testorgschannel2:marbles02_go_ch2): event latency stats (end-to-end)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 20066236 ms  (testorgschannel2:marbles02_go_ch2): min: 90 ms  max: 1181 ms  avg: 401.32472 ms     ======= PTE 0 main Test Summary: executed at Fri Jun 29 2018 06:00:17 GMT+0000 (UTC) =======  (testorgschannel1:marbles02_go_ch1): INVOKE transaction stats  (testorgschannel1:marbles02_go_ch1): Total transactions 50000  timeout transactions 0  (testorgschannel1:marbles02_go_ch1): start 1530252041863  end 1530255578198  duration 3536335 ms  (testorgschannel1:marbles02_go_ch1): TPS 14.14  (testorgschannel1:marbles02_go_ch1): peer latency stats (endorsement)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 3851193 ms  (testorgschannel1:marbles02_go_ch1): min: 13 ms  max: 852 ms  avg: 77.02386 ms  (testorgschannel1:marbles02_go_ch1): orderer latency stats (transaction ack)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 2111295 ms  (testorgschannel1:marbles02_go_ch1): min: 6 ms  max: 891 ms  avg: 42.2259 ms  (testorgschannel1:marbles02_go_ch1): event latency stats (end-to-end)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 26144176 ms  (testorgschannel1:marbles02_go_ch1): min: 111 ms  max: 3145 ms  avg: 522.88352 ms     ======= PTE 1 main Test Summary: executed at Fri Jun 29 2018 06:00:17 GMT+0000 (UTC) =======  (testorgschannel2:marbles02_go_ch2): INVOKE transaction stats  (testorgschannel2:marbles02_go_ch2): Total transactions 50000  timeout transactions 0  (testorgschannel2:marbles02_go_ch2): start 1530252041853  end 1530255584878  duration 3543025 ms  (testorgschannel2:marbles02_go_ch2): TPS 14.11  (testorgschannel2:marbles02_go_ch2): peer latency stats (endorsement)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 3844437 ms  (testorgschannel2:marbles02_go_ch2): min: 13 ms  max: 743 ms  avg: 76.88874 ms  (testorgschannel2:marbles02_go_ch2): orderer latency stats (transaction ack)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 2154443 ms  (testorgschannel2:marbles02_go_ch2): min: 6 ms  max: 758 ms  avg: 43.08886 ms  (testorgschannel2:marbles02_go_ch2): event latency stats (end-to-end)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 26356620 ms  (testorgschannel2:marbles02_go_ch2): min: 113 ms  max: 3026 ms  avg: 527.1324 ms     ======= PTE 3 main Test Summary: executed at Fri Jun 29 2018 06:00:16 GMT+0000 (UTC) =======  (testorgschannel2:marbles02_go_ch2): QUERY transaction stats  (testorgschannel2:marbles02_go_ch2): Total transactions 100000  (testorgschannel2:marbles02_go_ch2): start 1530252041869  end 1530255758520  duration 3716651 ms  (testorgschannel2:marbles02_go_ch2): TPS 26.91     ======= PTE 2 main Test Summary: executed at Fri Jun 29 2018 06:00:16 GMT+0000 (UTC) =======  (testorgschannel1:marbles02_go_ch1): QUERY transaction stats  (testorgschannel1:marbles02_go_ch1): Total transactions 100000  (testorgschannel1:marbles02_go_ch1): start 1530252041865  end 1530255782335  duration 3740470 ms  (testorgschannel1:marbles02_go_ch1): TPS 26.73     ></body> </Action>
<Action id="47100" issue="27684" author="adnanchoudhury" type="comment" created="2018-07-09 13:51:31.0" updateauthor="adnanchoudhury" updated="2018-07-09 13:51:31.0"> <body><! CDATA ======= PTE 0 main Test Summary: executed at Fri Jun 29 2018 05:10:13 GMT+0000 (UTC) =======  (testorgschannel1:marbles02_go_ch1): INVOKE transaction stats  (testorgschannel1:marbles02_go_ch1): Total transactions 50000  timeout transactions 0  (testorgschannel1:marbles02_go_ch1): start 1530249030695  end 1530251742270  duration 2711575 ms   (testorgschannel1:marbles02_go_ch1): TPS 18.44  (testorgschannel1:marbles02_go_ch1): peer latency stats (endorsement)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 2146903 ms   (testorgschannel1:marbles02_go_ch1): min: 12 ms  max: 255 ms  avg: 42.93806 ms   (testorgschannel1:marbles02_go_ch1): orderer latency stats (transaction ack)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 1011223 ms   (testorgschannel1:marbles02_go_ch1): min: 5 ms  max: 267 ms  avg: 20.22446 ms   (testorgschannel1:marbles02_go_ch1): event latency stats (end-to-end)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 19815683 ms   (testorgschannel1:marbles02_go_ch1): min: 88 ms  max: 1075 ms  avg: 396.31366 ms      ======= PTE 1 main Test Summary: executed at Fri Jun 29 2018 05:10:13 GMT+0000 (UTC) =======  (testorgschannel2:marbles02_go_ch2): INVOKE transaction stats  (testorgschannel2:marbles02_go_ch2): Total transactions 50000  timeout transactions 0  (testorgschannel2:marbles02_go_ch2): start 1530249030695  end 1530251745075  duration 2714380 ms   (testorgschannel2:marbles02_go_ch2): TPS 18.42  (testorgschannel2:marbles02_go_ch2): peer latency stats (endorsement)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 2136626 ms   (testorgschannel2:marbles02_go_ch2): min: 12 ms  max: 248 ms  avg: 42.73252 ms   (testorgschannel2:marbles02_go_ch2): orderer latency stats (transaction ack)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 1062880 ms   (testorgschannel2:marbles02_go_ch2): min: 6 ms  max: 260 ms  avg: 21.2576 ms   (testorgschannel2:marbles02_go_ch2): event latency stats (end-to-end)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 20066236 ms   (testorgschannel2:marbles02_go_ch2): min: 90 ms  max: 1181 ms  avg: 401.32472 ms      ======= PTE 0 main Test Summary: executed at Fri Jun 29 2018 06:00:17 GMT+0000 (UTC) =======  (testorgschannel1:marbles02_go_ch1): INVOKE transaction stats  (testorgschannel1:marbles02_go_ch1): Total transactions 50000  timeout transactions 0  (testorgschannel1:marbles02_go_ch1): start 1530252041863  end 1530255578198  duration 3536335 ms   (testorgschannel1:marbles02_go_ch1): TPS 14.14  (testorgschannel1:marbles02_go_ch1): peer latency stats (endorsement)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 3851193 ms   (testorgschannel1:marbles02_go_ch1): min: 13 ms  max: 852 ms  avg: 77.02386 ms   (testorgschannel1:marbles02_go_ch1): orderer latency stats (transaction ack)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 2111295 ms   (testorgschannel1:marbles02_go_ch1): min: 6 ms  max: 891 ms  avg: 42.2259 ms   (testorgschannel1:marbles02_go_ch1): event latency stats (end-to-end)  (testorgschannel1:marbles02_go_ch1): total transactions: 50000  total time: 26144176 ms   (testorgschannel1:marbles02_go_ch1): min: 111 ms  max: 3145 ms  avg: 522.88352 ms      ======= PTE 1 main Test Summary: executed at Fri Jun 29 2018 06:00:17 GMT+0000 (UTC) =======  (testorgschannel2:marbles02_go_ch2): INVOKE transaction stats  (testorgschannel2:marbles02_go_ch2): Total transactions 50000  timeout transactions 0  (testorgschannel2:marbles02_go_ch2): start 1530252041853  end 1530255584878  duration 3543025 ms   (testorgschannel2:marbles02_go_ch2): TPS 14.11  (testorgschannel2:marbles02_go_ch2): peer latency stats (endorsement)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 3844437 ms   (testorgschannel2:marbles02_go_ch2): min: 13 ms  max: 743 ms  avg: 76.88874 ms   (testorgschannel2:marbles02_go_ch2): orderer latency stats (transaction ack)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 2154443 ms   (testorgschannel2:marbles02_go_ch2): min: 6 ms  max: 758 ms  avg: 43.08886 ms   (testorgschannel2:marbles02_go_ch2): event latency stats (end-to-end)  (testorgschannel2:marbles02_go_ch2): total transactions: 50000  total time: 26356620 ms   (testorgschannel2:marbles02_go_ch2): min: 113 ms  max: 3026 ms  avg: 527.1324 ms      ======= PTE 3 main Test Summary: executed at Fri Jun 29 2018 06:00:16 GMT+0000 (UTC) =======  (testorgschannel2:marbles02_go_ch2): QUERY transaction stats  (testorgschannel2:marbles02_go_ch2): Total transactions 100000  (testorgschannel2:marbles02_go_ch2): start 1530252041869  end 1530255758520  duration 3716651 ms   (testorgschannel2:marbles02_go_ch2): TPS 26.91     ======= PTE 2 main Test Summary: executed at Fri Jun 29 2018 06:00:16 GMT+0000 (UTC) =======  (testorgschannel1:marbles02_go_ch1): QUERY transaction stats  (testorgschannel1:marbles02_go_ch1): Total transactions 100000  (testorgschannel1:marbles02_go_ch1): start 1530252041865  end 1530255782335  duration 3740470 ms   (testorgschannel1:marbles02_go_ch1): TPS 26.73  ></body> </Action>
<Action id="51231" issue="27684" author="scottz" type="comment" body="Dongming will run this in v1.3 on RC1 load, in vLaunch." created="2018-09-26 18:52:53.0" updateauthor="scottz" updated="2018-09-26 18:52:53.0"/>
<Action id="52650" issue="27684" author="scottz" type="comment" body="Surya should write script to run this on IKS cluster." created="2018-10-25 16:15:52.0" updateauthor="scottz" updated="2018-10-25 16:15:52.0"/>
<Action id="54981" issue="27684" author="adnanchoudhury" type="comment" created="2018-12-19 16:04:08.0" updateauthor="adnanchoudhury" updated="2018-12-20 21:30:06.0"> <body><! CDATA 1) *in 1.2* it was run on an *IKS cluster* in medium hardware (6 nodes with total 18 cpu) , with 1/10th of traffic volume, and its recorded as passed. 2) *in 1.3*, it was decided to run on *Vlaunch*, Dongming and me observed issues of *peer panic* and created a bug https://jira.hyperledger.org/browse/FAB-12204 3) *in 1.4*, it was run in *IKS cluster* with medium hardware (5 nodes with 20 CPU), seeing peer panic while committing right after CC upgrade. CC upgrades keep CouchDB in busy for 4+ hours, and queries+invokes cause peer panic. See FAB-13286  ></body> </Action>
<Action id="55301" issue="27684" author="adnanchoudhury" type="comment" created="2019-01-04 15:59:37.0" updateauthor="adnanchoudhury" updated="2019-01-04 15:59:37.0"> <body><! CDATA If the test is modified to make the step 3b and 3c to send query and invokes at slower rate (tested with 1 invoke or query per second),  1)the peer does not panic 2) the queries and invokes are successful.  ~denyeart  mentions that as the CPU usage is high during the index rebuild, and slower queries and invokes pass, it looks like a resource issue, and we need to document that index rebuild may take a toll on the CPU. marking this as pass.  ></body> </Action>
