<Issue id="46822" key="FAB-18457" number="18457" project="10002" reporter="JIRAUSER20631" assignee="JIRAUSER20631" creator="JIRAUSER20631" type="10004" summary="Fix Docker fabric-tools image with HSM and orderer parsing of Security property" priority="3" resolution="10000" status="6" created="2021-04-28 01:29:56.0" updated="2021-06-07 09:20:24.0" resolutiondate="2021-06-07 09:20:24.0" votes="0" watches="3" workflowId="60722" archived="N"> <description><! CDATA Hi,   I have trouble generating the BCCSP image of fabric-tools for v1.4 the resulting docker image doesn't have BCCSP=PKCS11. Also I get an error using the orderer property ORDERER_GENERAL_BCCSP_PKCS11_SECURITY when it parses de "256" it thinks its a string instead of a number.  So I made these changes in the code:  fabric\common\viperutil\config_util.go - line 316:  {code:go} err := mapstructure.Decode(data, config) {code}  changes to:  {code:go} err := mapstructure.WeakDecode(data, config) {code}   fabric\images\tools\Dockerfile.in - line 11:   {code} RUN make configtxgen configtxlator cryptogen peer discover idemixgen {code}  changes to:  {code} ARG GO_TAGS RUN make configtxgen configtxlator cryptogen peer discover idemixgen GO_TAGS=${GO_TAGS} {code}   fabric\Makefile - line 301:  {code} $(DBUILD) -t $(DOCKER_NS)/fabric-$(TARGET) -f $(@D)/Dockerfile . {code}  changes to:  {code} $(DBUILD) -t $(DOCKER_NS)/fabric-$(TARGET) -f $(@D)/Dockerfile --build-arg GO_TAGS=$(GO_TAGS) . {code}   And now the images work for me, I would like to add a pull request but I'm not authorized, so I'll leave these snippets of code in here.  Have a good day,  Ana Franco     ></description> </Issue>
