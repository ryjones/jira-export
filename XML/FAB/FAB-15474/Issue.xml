<Issue id="39897" key="FAB-15474" number="15474" project="10002" reporter="yacovm" assignee="yacovm" creator="yacovm" type="10004" summary="Gossip accepts leadership messages from foreign orgs" priority="3" resolution="10000" status="6" created="2019-05-17 13:46:13.0" updated="2019-07-15 11:29:49.0" resolutiondate="2019-05-18 16:25:55.0" votes="0" watches="4" workflowId="52792" security="10000"> <description><! CDATA Looking at the code - there isn't a call to *g.isInMyorg* on leadership messages.   So, it means that a peer with a high PKI-ID can forcefully starve peers from remote organizations by overthrowing their leaders.   ~C0rWin  ;  ~naaman   Possible resolutions:  1) We can either filter them out at the  predicate that listens to messages|https://github.com/hyperledger/fabric/blob/release-1.4/gossip/election/adapter.go#L100-L105    2) In the  validateLeadershipMessage|https://github.com/hyperledger/fabric/blob/release-1.4/gossip/gossip/gossip_impl.go#L1207-L1219  function, we can add a call to  g.IsInMyOrg|https://github.com/hyperledger/fabric/blob/release-1.4/gossip/gossip/gossip_impl.go#L1188-L1196 . 3) Since leadership messages are dispatched by the channel module, we can check the creator/sender in the channel module, and drop the message there.  ></description> </Issue>
