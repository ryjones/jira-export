<Issue id="18706" key="FAB-5028" number="5028" project="10002" reporter="nemoto" assignee="nemoto" creator="nemoto" type="10004" summary="Docker cleanup fails after finishing test scenario" environment="fabric commit efbaee526b1ab08dd7e603f9f8a381af60bab48d" priority="4" resolution="10000" status="6" created="2017-06-27 09:31:29.0" updated="2018-07-20 14:13:36.0" resolutiondate="2017-08-05 12:13:44.0" votes="0" watches="2" workflowId="39287" security="10001"> <description><! CDATA When I executed behave tests in fabric/test/feature, I met an error. I think "docker inspect" was executed for a docker which was listed by "docker ps" but already deleted. If so, error handling should be improved.Â  {noformat} $ behave peer.feature -n FAB-3505 --no-capture (...snip) Query Exec command: /bin/bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/4730032a5a6811e78e6bfa163e2101ee/peerOrganizations/org2.example.com/users/Admin@org2.example.com/m When a user queries on the chaincode named "mycc" with args  "query","a"  on "peer0.org2.example.com" # steps/endorser_impl.py:68 148.622s {\"Args\":  \"query\",\"a\" }' --channelID behavesystest " Then a user receives expected response of 980 from "peer0.org2.example.com" # steps/endorser_impl.py:150 0.000s Error: No such object: Error Exception CalledProcessError: Command ' 'docker', 'inspect', 'Error' ' returned non-zero exit status 1 Traceback (most recent call last): File "/usr/local/bin/behave", line 11, in <module> sys.exit(main()) File "/usr/local/lib/python2.7/dist-packages/behave/__main__.py", line 109, in main failed = runner.run() File "/usr/local/lib/python2.7/dist-packages/behave/runner.py", line 672, in run return self.run_with_paths() File "/usr/local/lib/python2.7/dist-packages/behave/runner.py", line 693, in run_with_paths return self.run_model() File "/usr/local/lib/python2.7/dist-packages/behave/runner.py", line 483, in run_model failed = feature.run(self) File "/usr/local/lib/python2.7/dist-packages/behave/model.py", line 523, in run failed = scenario.run(runner) File "/usr/local/lib/python2.7/dist-packages/behave/model.py", line 1255, in run failed = scenario.run(runner) File "/usr/local/lib/python2.7/dist-packages/behave/model.py", line 919, in run runner.run_hook('after_scenario', runner.context, self) File "/usr/local/lib/python2.7/dist-packages/behave/runner.py", line 405, in run_hook self.hooks name (context, *args) File "environment.py", line 64, in after_scenario context.composition.decompose() File "/home/nemoto/go/src/github.com/hyperledger/fabric/test/feature/steps/compose_util.py", line 201, in decompose self.issueCommand( "down" ) File "/home/nemoto/go/src/github.com/hyperledger/fabric/test/feature/steps/compose_util.py", line 174, in issueCommand self.rebuildContainerData() File "/home/nemoto/go/src/github.com/hyperledger/fabric/test/feature/steps/compose_util.py", line 181, in rebuildContainerData container = json.loads(str(subprocess.check_output( "docker", "inspect", containerID ))) 0  File "/usr/lib/python2.7/subprocess.py", line 573, in check_output raise CalledProcessError(retcode, cmd, output=output) subprocess.CalledProcessError: Command ' 'docker', 'inspect', 'Error' ' returned non-zero exit status 1 {noformat}  ></description> </Issue>
