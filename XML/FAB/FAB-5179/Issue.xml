<Issue id="18961" key="FAB-5179" number="5179" project="10002" reporter="nemoto" assignee="nemoto" creator="nemoto" type="10004" summary="Failed to build javaenv-image in the environment behind an HTTP Proxy" environment="fabric commit 6c3cb99d6d575d975105e05d4b1bbb2a3ea42980" priority="3" resolution="10000" status="6" created="2017-07-05 08:04:37.0" updated="2018-07-20 14:13:42.0" resolutiondate="2017-11-27 03:43:03.0" votes="0" watches="2" workflowId="39381"> <description><! CDATA javaenv-image build fails with the following messages when I run make docker in the clean environment behind an HTTP proxy. (Some private information is replaced in the messages.) {noformat} username@ubuntu:~/go/src/github.com/hyperledger/fabric$  master  make docker (...snip) Building docker javaenv-image docker build --build-arg 'http_proxy=http://username:password@proxy:port/' --build-arg 'https_proxy=http://username:password@proxy:port/' --build-arg 'HTTP_PROXY=http://username:password@proxy:port/' --build-arg 'HTTPS_PROXY=http://username:password@proxy:port/' -t hyperledger/fabric-javaenv build/image/javaenv Sending build context to Docker daemon 45.06kB Step 1/15 : FROM hyperledger/fabric-baseimage:x86_64-0.3.1 ---> 9f2e9ec7c527 Step 2/15 : RUN curl -sSL https://services.gradle.org/distributions/gradle-2.12-bin.zip > /tmp/gradle-2.12-bin.zip ---> Running in 67b7ac7cf9b0 ---> 7217c844888a Removing intermediate container 67b7ac7cf9b0 Step 3/15 : RUN unzip -qo /tmp/gradle-2.12-bin.zip -d /opt && rm /tmp/gradle-2.12-bin.zip ---> Running in a06ed18d9793 ---> a2903111a9b2 Removing intermediate container a06ed18d9793 Step 4/15 : RUN ln -s /opt/gradle-2.12/bin/gradle /usr/bin ---> Running in 01798ccf7f96 ---> 6fdd92624c86 Removing intermediate container 01798ccf7f96 Step 5/15 : ENV MAVEN_VERSION 3.3.9 ---> Running in 953c8549ec55 ---> 629aaabecbf4 Removing intermediate container 953c8549ec55 Step 6/15 : ENV USER_HOME_DIR "/root" ---> Running in b11dd5f890a7 ---> 9328b095788f Removing intermediate container b11dd5f890a7 Step 7/15 : RUN mkdir -p /usr/share/maven /usr/share/maven/ref && curl -fsSL http://apache.osuosl.org/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz | tar -xzC /usr/share/maven --strip-components=1 && ln -s /usr/share/maven/bin/mvn /usr/bin/mvn ---> Running in 74cd6545a383 ---> 96721e9c4397 Removing intermediate container 74cd6545a383 Step 8/15 : ENV MAVEN_HOME /usr/share/maven ---> Running in 376974cc8496 ---> bf69098e8977 Removing intermediate container 376974cc8496 Step 9/15 : ENV MAVEN_CONFIG "$USER_HOME_DIR/.m2" ---> Running in 3a604fc8d83e ---> 8f1fa5ce6d61 Removing intermediate container 3a604fc8d83e Step 10/15 : ADD payload/javashim.tar.bz2 /root ---> 540e95717f7c Removing intermediate container 2f26b777c52a Step 11/15 : ADD payload/protos.tar.bz2 /root ---> fe3ecd4d4a95 Removing intermediate container 979bad45865b Step 12/15 : ADD payload/settings.gradle /root ---> 2a4dd848b661 Removing intermediate container 50c476478285 Step 13/15 : WORKDIR /root ---> 049cd9e822c3 Removing intermediate container 1f96781dd701 Step 14/15 : RUN core/chaincode/shim/java/javabuild.sh ---> Running in 2d2871fb369e  FAILURE: Build failed with an exception.  * Where: Build file '/root/core/chaincode/shim/java/build.gradle' line: 30  * What went wrong: Error resolving plugin  id: 'com.google.protobuf', version: '0.8.0'  > The response from https://plugins.gradle.org/api/gradle/2.12/plugin/use/com.google.protobuf/0.8.0 was not a valid response from a Gradle Plugin Resolution Service: content type is 'text/html', expected 'application/json' (status code: 407)  * Try: Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. The command '/bin/sh -c core/chaincode/shim/java/javabuild.sh' returned a non-zero code: 1 Makefile:278: recipe for target 'build/image/javaenv/.dummy-x86_64-1.0.0-rc2-snapshot-6c3cb99' failed make: ***  build/image/javaenv/.dummy-x86_64-1.0.0-rc2-snapshot-6c3cb99  Error 1 username@ubuntu:~/go/src/github.com/hyperledger/fabric${noformat}    Note that I have the following settings in .bashrc {noformat} export http_proxy=http://username:password@proxy:port/ export https_proxy=http://username:password@proxy:port/ export HTTP_PROXY=http://username:password@proxy:port/ export HTTPS_PROXY=http://username:password@proxy:port/{noformat}    ></description> </Issue>
