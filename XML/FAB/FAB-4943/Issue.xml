<Issue id="18584" key="FAB-4943" number="4943" project="10002" reporter="shimos" assignee="shimos" creator="shimos" type="10004" summary="Host GOPATH is hardcoded in compose yaml for behave test" environment="fabric commit 4e219e9586b241893390f14b6a4d58d500891001" priority="3" resolution="10000" status="6" created="2017-06-23 00:29:24.0" updated="2018-07-20 14:13:34.0" resolutiondate="2017-06-26 18:33:51.0" votes="0" watches="1" workflowId="39236" security="10001"> <description><! CDATA Docker-compose yaml files for the new behave tests (test/feature) hardcode the _host_’s GOPATH. This seems to make behave tests fail in the host where GOPATH is not “/opt/gopath” because /opt/gopath in the container becomes empty.  {noformat} /opt/go/src/github.com/hyperledger/fabric/test/feature$ behave –tag=-skip (snip) When a user deploys chaincode at path "github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02" with  "init","a","1000","b","2000"  with name "mycc" # steps/endorser_impl.py:43 17.822s And I wait "30" seconds                                                                                                                                              # steps/basic_impl.py:33 30.030s Then the chaincode is deployed                                                                                                                                       # steps/endorser_impl.py:120 3.921s Assertion Failed: Expect a = 1000, received from the deploy: Captured stdout: Create command:  '/bin/bash', '-c', '"CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp', 'CORE_PEER_LOCALMSPID=org1.example.com', 'CORE_PEER_ID=peer0.org1.example.c om', 'CORE_PEER_ADDRESS=peer0.org1.example.com:7051', 'peer', 'channel', 'create', '--file', '/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/behavesystest.tx', '--channelID', 'behavesystest', '--timeout', '120', '--orderer', 'orderer2.example.com:7050"'   /bin/bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp CORE_PEER_LOCALMSPID=org1.example.com CORE_PEER_ID=peer0.org1.example.com CORE_PEER_ADDRESS=peer0.or g1.example.com:7051 peer channel create --file /var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/behavesystest.tx --channelID behavesystest --timeout 120 --orderer orderer2.example.com:7050" : {'cli': ''}  /bin/bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp peer channel join --blockpath /var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/behavesystes t.block" :  /bin/bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp CORE_PEER_LOCALMSPID=org2.example.com CORE_PEER_ID=peer1.org2.example.com CORE_PEER_ADDRESS=peer1.or g2.example.com:7051 peer chaincode install --name mycc --version 0 --path github.com/hyperledger/fabric/examples/chaincode/go/chaincode_example02 --orderer orderer2.example.com:7050 " : {'peer1.org2.example.com': '', 'peer0.org1.example.com': '', 'peer1.org1.example.com' : '', 'peer0.org2.example.com': ''}  /bin/bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/peerOrganizati ons/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt CORE_PEER_LOCALMSPID=org1.example.com CORE_PEER_ID=peer0.org1.example.com CORE_PEER_ADDRESS=peer0.org1.example.com:7051 peer chaincode instantiate --name mycc --version 0 --channelID behavesystest --ctor '{\"Ar gs\":  \"init\",\"a\",\"1000\",\"b\",\"2000\" }' --orderer orderer2.example.com:7050 " : {'peer0.org1.example.com': ''}  "init","a","1000","b","2000"   u'init', u'a', u'1000', u'b', u'2000'  Query Exec command: /bin/bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781584e/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp CORE_PEER_TLS_ROOTCERT_FILE=/var/hyperledger/configs/7a97e56c57a111e7bb510a00a781 584e/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt peer chaincode query --name mycc --ctor '{\"Args\":  \"query\",\"a\" }' --channelID behavesystest " {'peer0.org1.example.com': ''} (snip) {noformat}   ></description> </Issue>
