<Issue id="31359" key="FAB-10857" number="10857" project="10002" reporter="bstasyszyn" assignee="yacovm" creator="bstasyszyn" type="10001" summary="Add filtering by chaincodes and collections to peer membership queries" priority="3" resolution="10000" status="6" created="2018-06-25 19:45:00.0" updated="2018-07-20 18:50:54.0" resolutiondate="2018-07-03 09:14:28.0" votes="0" watches="3" workflowId="42545"> <description><! CDATA When the chaincode policy does not contain the same set of MSPs as the collection policy then the following error is returned from the endorsers query on the Discovery service:  'Principal set computation failed: chaincode isn't installed on sufficient organizations required by the endorsement policy'.  Instead of an error, I would suggests that the endorser groups be prioritized according to those in which the greatest number of peers have read-access to the collection, and return the group with the highest priority.  Consider the following example:  MSP1: (peer1,peer2) MSP2: (peer3) MSP3: (peer4)  CC policy: (MSP1 AND MSP2) OR MSP3 Collection policy: MSP1, requiredPeerCount=1  The possible endorser groups based on chaincode policy are:  (peer1,peer3), (peer2,peer3), (peer4)  There is no group in which ALL of the peers have read-access to the collection, but I would expect  either group (peer1,peer3) or group (peer2,peer3) to be returned, since peer1 and peer2 have read-access to the collection.  Further, let's say that peer3 is not available, then I would expect the group (peer4). The endorsement would succeed with (peer4) since the private data would be pushed to peer1 and/or peer2, satisfying the collection's requiredPeerCount of 1.   ></description> </Issue>
