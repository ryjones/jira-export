<Issue id="30929" key="FAB-10570" number="10570" project="10002" reporter="denyeart" assignee="chris.elder" creator="denyeart" type="10004" summary="CouchDB index creation error logging is missing after refactor" priority="3" resolution="10000" status="6" created="2018-06-06 21:45:25.0" updated="2020-06-11 15:30:45.0" resolutiondate="2018-06-18 11:31:13.0" votes="0" watches="2" workflowId="42421"> <description><! CDATA FAB-7779 moved couchdb index creation out of statecouchdb.go HandleChaincodeDeploy().  However two things were missed.   1) This important comment got taken out:  //HandleChaincodeDeploy initializes database artifacts for the database associated with the namespace // This function delibrately suppresses the errors that occur during the creation of the indexes on couchdb. // This is because, in the present code, we do not differentiate between the errors because of couchdb interaction // and the errors because of bad index files - the later being unfixable by the admin. Note that the error suppression // is acceptable since peer can continue in the committing role without the indexes. However, executing chaincode queries // may be affected, until a new chaincode with fixed indexes is installed and instantiated  2) And the error logging described in the comment got taken out.  The new index creation code in ProcessIndexesForChaincodeDeploy() returns an error but the caller doesn't check for errors or log the errors.  Both aspects need to be re-introduced into the index creation flow.     ></description> </Issue>
