<Issue id="38138" key="FAB-14454" number="14454" project="10002" reporter="suryalnvs" assignee="guoger" creator="suryalnvs" type="10004" summary="Orderer panics after a series of restarts with: &quot;failed to restore persisted raft data: failed to read WAL: unexpected EOF&quot;" priority="3" resolution="10000" status="6" created="2019-03-01 22:19:56.0" updated="2019-08-08 15:36:35.0" resolutiondate="2019-03-07 16:44:11.0" votes="0" watches="4" workflowId="49758"> <description><! CDATA h2. Observed:  2 of the 3 orderers panics after a series of restarts with chaos-kube with the following panic: {code:java} panic:  channel: testorgschannel3  Error creating consenter: failed to restore persisted raft data: failed to read WAL: unexpected EOFpanic:  channel: testorgschannel3  Error creating consenter: failed to restore persisted raft data: failed to read WAL: unexpected EOF goroutine 1  running :github.com/hyperledger/fabric/vendor/go.uber.org/zap/zapcore.(*CheckedEntry).Write(0xc0007ae0b0, 0x0, 0x0, 0x0) /go/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/zapcore/entry.go:229 +0x515github.com/hyperledger/fabric/vendor/go.uber.org/zap.(*SugaredLogger).log(0xc0000e4070, 0x4, 0x148d1a4, 0x2a, 0xc01181d738, 0x2, 0x2, 0x0, 0x0, 0x0) /go/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/sugar.go:234 +0xf6github.com/hyperledger/fabric/vendor/go.uber.org/zap.(*SugaredLogger).Panicf(0xc0000e4070, 0x148d1a4, 0x2a, 0xc01181d738, 0x2, 0x2) /go/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/sugar.go:159 +0x79github.com/hyperledger/fabric/common/flogging.(*FabricLogger).Panicf(0xc0000e4078, 0x148d1a4, 0x2a, 0xc01181d738, 0x2, 0x2) /go/src/github.com/hyperledger/fabric/common/flogging/zap.go:74 +0x60github.com/hyperledger/fabric/orderer/common/multichannel.newChainSupport(0xc0002842d0, 0xc000680d60, 0xc000a383c0, 0x158fe00, 0x1fb3af0, 0xc0002c97f0, 0x0) /go/src/github.com/hyperledger/fabric/orderer/common/multichannel/chainsupport.go:89 +0x668github.com/hyperledger/fabric/orderer/common/multichannel.(*Registrar).Initialize(0xc0002842d0, 0xc000a383c0) /go/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar.go:196 +0xbfdgithub.com/hyperledger/fabric/orderer/common/server.initializeMultichannelRegistrar(0xc0000a7400, 0xc0000e6fc0, 0xc0004ec590, 0x0, 0xc000284240, 0x1f555e0, 0xc0002c8cc0, 0x2, 0x2, 0xc0002c8cd0, ...) /go/src/github.com/hyperledger/fabric/orderer/common/server/main.go:583 +0x315github.com/hyperledger/fabric/orderer/common/server.Start(0x1465206, 0x5, 0xc00041ec00) /go/src/github.com/hyperledger/fabric/orderer/common/server/main.go:158 +0x7ddgithub.com/hyperledger/fabric/orderer/common/server.Main() /go/src/github.com/hyperledger/fabric/orderer/common/server/main.go:91 +0x1cemain.main() /go/src/github.com/hyperledger/fabric/orderer/main.go:15 +0x20{code} Output of WAL directory for testorgschannel3: {code:java} /shared/etcdraft/wal # ls orderersystemchannel  testorgschannel1      testorgschannel10     testorgschannel2      testorgschannel3      testorgschannel4      testorgschannel5      testorgschannel6      testorgschannel7      testorgschannel8      testorgschannel9 /shared/etcdraft/wal # cd testorgschannel3/ /shared/etcdraft/wal/testorgschannel3 # ls -lrth total 696M -rw-------    1 nobody   42949672   61.1M Mar  1 19:39 0000000000000000-0000000000000000.wal -rw-------    1 nobody   42949672   61.0M Mar  1 19:43 0000000000000001-000000000000085b.wal -rw-------    1 nobody   42949672   61.0M Mar  1 19:47 0000000000000002-00000000000010af.wal -rw-------    1 nobody   42949672   61.0M Mar  1 19:51 0000000000000003-0000000000001903.wal -rw-------    1 nobody   42949672   61.0M Mar  1 19:55 0000000000000004-0000000000002157.wal -rw-------    1 nobody   42949672   61.0M Mar  1 20:00 0000000000000005-00000000000029aa.wal -rw-------    1 nobody   42949672   61.0M Mar  1 20:04 0000000000000006-00000000000031ff.wal -rw-------    1 nobody   42949672   61.1M Mar  1 20:08 0000000000000007-0000000000003a52.wal -rw-------    1 nobody   42949672   61.1M Mar  1 20:14 0000000000000008-00000000000042a7.wal -rw-------    1 nobody   42949672   61.0M Mar  1 20:19 0000000000000009-0000000000004afc.wal -rw-------    1 nobody   42949672   61.0M Mar  1 20:26 1.tmp -rw-------    1 nobody   42949672   61.1M Mar  1 20:26 000000000000000a-0000000000005351.wal -rw-------    1 nobody   42949672   61.0M Mar  1 20:29 000000000000000b-0000000000005ba6.wal -rw-------    1 nobody   42949672   61.0M Mar  1 21:20 0.tmp {code} Logs URL:  https://app.us-south.logging.cloud.ibm.com/87cd83a6af/logs/view?apps=orderer1st-ordererorg   Instance: LogDNA-community-regression-lab  Timestamp at which first Panic was seen:Â Mar 1 15:30:23 EST  ></description> </Issue>
