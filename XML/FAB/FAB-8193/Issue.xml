<Issue id="27602" key="FAB-8193" number="8193" project="10002" reporter="ratnakar" assignee="jyellick" creator="ratnakar" type="10004" summary="Removed Orderer Still Processing Transactions" priority="3" resolution="10000" status="6" created="2018-02-09 22:07:56.0" updated="2018-07-20 14:15:41.0" resolutiondate="2018-02-16 22:15:41.0" votes="0" watches="6" workflowId="41196"> <description><! CDATA Fabric version 1.1   Objective : As an Orderer Org admin , I wanted to delete one of the rouge Orderer process from my system channel (*testchainid*)  Steps: 1. Launch the network with kafka based ordereing service (3 orderer process) 2. Create a channel , join peers and send some invokes and queries 3. Now we wanted to kick out the *orderer2.example.com* process from the orderer organization. Fetch the config block and remove the orderer2.example.com from the config block , calculate the difference and send a config update on the system channel (*testchainid*)  4. Send a config update, however the config update with an error.  Expected: Config update should happen and ordere2.example.com should be removed from the system channel *testchainid*  Gist of error logs: {code:java} peer channel update -f config_update_in_envelope.pb -c $CHANNEL_NAME -o orderer0.example.com:7050 --tls true --cafile $ORDERER_CA 2018-02-09 21:41:20.414 UTC  msp  GetLocalMSP -> DEBU 001 Returning existing local MSP 2018-02-09 21:41:20.414 UTC  msp  GetDefaultSigningIdentity -> DEBU 002 Obtaining default signing identity 2018-02-09 21:41:20.417 UTC  channelCmd  InitCmdFactory -> INFO 003 Endorser and orderer connections initialized 2018-02-09 21:41:20.418 UTC  msp  GetLocalMSP -> DEBU 004 Returning existing local MSP 2018-02-09 21:41:20.418 UTC  msp  GetDefaultSigningIdentity -> DEBU 005 Obtaining default signing identity 2018-02-09 21:41:20.419 UTC  msp  GetLocalMSP -> DEBU 006 Returning existing local MSP 2018-02-09 21:41:20.419 UTC  msp  GetDefaultSigningIdentity -> DEBU 007 Obtaining default signing identity 2018-02-09 21:41:20.420 UTC  msp/identity  Sign -> DEBU 008 Sign: plaintext: 0A95060A0A4F7264657265724D535012...6C2F4F7264657265722F41646D696E73 2018-02-09 21:41:20.420 UTC  msp/identity  Sign -> DEBU 009 Sign: digest: AD9EECA9E904C4018CE23B99A96AABB8DBCA1CFC77FCD6E6B7D0816AFE8BE748 2018-02-09 21:41:20.420 UTC  msp  GetLocalMSP -> DEBU 00a Returning existing local MSP 2018-02-09 21:41:20.420 UTC  msp  GetDefaultSigningIdentity -> DEBU 00b Obtaining default signing identity 2018-02-09 21:41:20.420 UTC  msp  GetLocalMSP -> DEBU 00c Returning existing local MSP 2018-02-09 21:41:20.420 UTC  msp  GetDefaultSigningIdentity -> DEBU 00d Obtaining default signing identity 2018-02-09 21:41:20.420 UTC  msp/identity  Sign -> DEBU 00e Sign: plaintext: 0ACE060A1708021A060880ABF8D30522...5B93E74AD5B6F7DFD9CE768D8F1F9757 2018-02-09 21:41:20.420 UTC  msp/identity  Sign -> DEBU 00f Sign: digest: F2782257EEBFC7033FDBC24D1123A62D560EBF16E7A230641DF85FB29FD9E31A Error: got unexpected status: BAD_REQUEST -- error authorizing update: error validating DeltaSet: policy for  Value   /Channel/OrdererAddresses not satisfied: Failed to reach implicit threshold of 1 sub-policies, required 1 remaining Usage: peer channel update  flags   Flags: -c, --channelID string   In case of a newChain command, the channel ID to create. -f, --file string        Configuration transaction file generated by a tool such as configtxgen for submitting to orderer  Global Flags: --cafile string                       Path to file containing PEM-encoded trusted certificate(s) for the ordering endpoint --certfile string                     Path to file containing PEM-encoded X509 public key to use for mutual TLS communication with the orderer endpoint --clientauth                          Use mutual TLS when communicating with the orderer endpoint --keyfile string                      Path to file containing PEM-encoded private key to use for mutual TLS communication with the orderer endpoint --logging-level string                Default logging level and overrides, see core.yaml for full syntax -o, --orderer string                      Ordering service endpoint --ordererTLSHostnameOverride string   The hostname override to use when validating the TLS connection to the orderer. --tls                                 Use TLS when communicating with the orderer endpoint -v, --version                             Display current version of fabric peer server {code}    Gist ordere0.example.com logs: (enclosed the full logs for reference) {code:java} ^  36m2018-02-09 21:41:20.424 UTC  cauthdsl  func2 -> DEBU e49^  0m 0xc420c060d0 identity 0 does not satisfy principal: This identity is not an admin ^  36m2018-02-09 21:41:20.424 UTC  cauthdsl  func2 -> DEBU e4a^  0m 0xc420c060d0 principal evaluation fails ^  36m2018-02-09 21:41:20.424 UTC  cauthdsl  func1 -> DEBU e4b^  0m 0xc420c060d0 gate 1518212480424667706 evaluation fails ^  36m2018-02-09 21:41:20.424 UTC  policies  Evaluate -> DEBU e4c^  0m Signature set did not satisfy policy /Channel/Orderer/OrdererOrg/Admins ^  36m2018-02-09 21:41:20.424 UTC  policies  Evaluate -> DEBU e4d^  0m == Done Evaluating *cauthdsl.policy Policy /Channel/Orderer/OrdererOrg/Admins ^  36m2018-02-09 21:41:20.424 UTC  policies  func1 -> DEBU e4e^  0m Evaluation Failed: Only 0 policies were satisfied, but needed 1 of   OrdererOrg.Admins   ^  36m2018-02-09 21:41:20.424 UTC  policies  Evaluate -> DEBU e4f^  0m Signature set did not satisfy policy /Channel/Orderer/Admins ^  36m2018-02-09 21:41:20.424 UTC  policies  Evaluate -> DEBU e50^  0m == Done Evaluating *policies.implicitMetaPolicy Policy /Channel/Orderer/Admins ^  33m2018-02-09 21:41:20.424 UTC  orderer/common/broadcast  Handle -> WARN e51^  0m  channel: testchainid  Rejecting broadcast of config message from 172.18.0.18:38768 because of error: error authorizing update: error validating DeltaSet: policy for  Value   /Channel/OrdererAddresses not satisfied: Failed to reach implicit threshold of 1 sub-policies, required 1 remaining ^  36m2018-02-09 21:41:20.424 UTC  orderer/common/server  func1 -> DEBU e52^  0m Closing Broadcast stream ^  36m2018-02-09 21:41:20.426 UTC  grpc  Printf -> DEBU e53^  0m transport: http2Server.HandleStreams failed to read frame: read tcp 172.18.0.17:7050->172.18.0.18:38768 {code}  ></description> </Issue>
