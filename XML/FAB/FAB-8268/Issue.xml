<Issue id="27705" key="FAB-8268" number="8268" project="10002" reporter="denyeart" assignee="chris.elder" creator="denyeart" type="10001" summary="Re-process failed couchdb index create statements automatically" priority="3" resolution="10001" status="6" created="2018-02-14 11:20:12.0" updated="2020-01-22 22:27:01.0" resolutiondate="2020-01-22 22:27:01.0" votes="0" watches="2" workflowId="35555"> <description><! CDATA As of FAB-7777 , failed index create during chaincode install/instantiate will not panic peer but will still leave peer in a state where chaincode is deployed to a peer, but not able to endorse transactions (at least, not able to endorse transactions that utilize rich queries that require the indexes).  If the index create statements failed due to operational issues, there needs to be ability to re-process the failed index create statements at a later point in time, in an attempt to create the indexes that failed previously.  The re-processing of failed index create statements could be done in two ways:  1) Manually by a peer admin, e.g. via new peer APIs.  2) Automatically upon peer startup when ledger is being initialized and recovered.  Hosted environments have requested automatic recovery be implemented first.  This work item will add capability to re-process failed index create statements upon peer startup during ledger initialization/recovery.   https://gerrit.hyperledger.org/r/#/c/17425/   proposed to drop failed index create statements to /stateDBfailedChaincodeArtifacts directory for re-processing.  Additionally, although most indexes are known at chaincode deploy time and applicable to all peers, and therefore included in the chaincode deployment package, there are scenarios where an index may apply to queries performed on a single peer only (for example consider an auditor peer). There have been requirements to create new indexes on a single peer's channel database.  The mechanism implemented for this work item could also be used as a way to deploy new index definitions to the peer, by dropping index create json files into the correct /stateDBfailedChaincodeArtifacts directory.  ></description> </Issue>
