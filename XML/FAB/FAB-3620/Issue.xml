<Issue id="16239" key="FAB-3620" number="3620" project="10002" reporter="scottz" assignee="dongming" creator="scottz" type="10003" summary="cleanup script for networkLauncher to use" priority="3" resolution="10000" status="6" created="2017-05-03 14:15:47.0" updated="2018-07-20 14:12:33.0" resolutiondate="2017-08-31 12:41:09.0" votes="0" watches="1" workflowId="38305"> <description><! CDATA CI daily test scripts are being written to call PTE tool multiple times to run tests. Each test must first call  networkLauncher, which must create a network using parameters specified on command line. We should provide a nice cleanup script in the networkLauncher directory that can be called to clean up (before starting another test). The following steps are captured from some getting-started script steps; maybe we can put these and anything else needed into a bash script called networkDown.sh :  rm -rf /tmp/hfc-*; rm -rf ~/.hfc-key-store  function networkDown () { #docker-compose  down docker-compose down #Cleanup the chaincode containers clearContainers #Cleanup images removeUnwantedImages # remove orderer block and channel creation transactions and crypto material #### need to use appropriate default directories MSPDIR and CRYPTODIR used by NL. rm -rf $MSPDIR/orderer.block $MSPDIR/channel*.tx $CRYPTODIR/crypto-config }  function clearContainers () { CONTAINER_IDS=$(docker ps -aq) if   -z "$CONTAINER_IDS" -o "$CONTAINER_IDS" = " "  ; then echo "---- No containers available for deletion ----" else docker rm -f $CONTAINER_IDS fi }  function removeUnwantedImages() { DOCKER_IMAGE_IDS=$(docker images | grep "dev\|none\|test-vp\|peer 0-9 -" | awk '{print $3}') if   -z "$DOCKER_IMAGE_IDS" -o "$DOCKER_IMAGE_IDS" = " "  ; then echo "---- No images available for deletion ----" else docker rmi -f $DOCKER_IMAGE_IDS fi }  ></description> </Issue>
