<Issue id="35942" key="FAB-13186" number="13186" project="10002" reporter="dongming" assignee="manish-sethi" creator="dongming" type="10004" summary="peers fail during private DB test - fatal error: concurrent map read and map write" priority="1" resolution="10000" status="6" created="2018-12-06 18:21:02.0" updated="2018-12-07 11:32:02.0" resolutiondate="2018-12-07 11:31:51.0" votes="0" watches="4" workflowId="47448"> <description><! CDATA Level of Fabric: 1.4.0-stable pulled Dec 6th morning from nexus prior to launching the network.  Environment: IKS, Each peer is running in its own pod.  Peers are failing while running privateDB test with couchDB (FAB-12936, private DB with requiredPeerCount 0 and maxPeerCount 0).Â Our network contains 5 orgs, 4 of which are participating in private data collection and which are endorsing transactions. It appears SOME of the 8 peers panic. On different test runs, we have seen 5 panic, or 3 panic, or 1 panic. 12936 is a testcase designed for 100% PULL. We have also seen failures on the 100% PUSH testcase, FAB-12937.  Test procedures:  1. create channel and join channel, and update channel with setting anchor peer on each org.  2. install/instantiate chaincode (map cc) on each org  3. run invokes/queries sending 10000 transactions per thread with 4 and 8 threads  4. install/upgrade chaincode with private collection  5. run invokes/queries sending 10000 transactions per thread with 4 and 8 threads  The test passes for levelDB but fails for couchDB with peers restarts itself. Two test failure were observed: 5 peers restarts during the 4 threads invokes run for privateDB in one case and 2 peers restarts during the 8 threads invokes run for privateDB in the other case.  ></description> </Issue>
