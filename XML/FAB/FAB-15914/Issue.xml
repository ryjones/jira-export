<Issue id="40981" key="FAB-15914" number="15914" project="10002" reporter="sykesm" creator="sykesm" type="10004" summary="Panic in ledger management code during shutdown when running integration tests" priority="3" resolution="10002" status="6" created="2019-07-10 15:58:09.0" updated="2020-01-27 15:22:54.0" resolutiondate="2020-01-27 15:22:54.0" votes="0" watches="3" workflowId="53951"> <description><! CDATA {code}  e  org2.peer2  panic: runtime error: invalid memory address or nil pointer dereference  e  org2.peer2   signal SIGSEGV: segmentation violation code=0x1 addr=0x18 pc=0x48e44b9   e  org2.peer2    e  org2.peer2  goroutine 1  running :  e  org2.peer2  github.com/hyperledger/fabric/core/ledger/ledgermgmt.(*LedgerMgr).closeLedger(0xc000143d60, 0xc00271a120, 0xb)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/core/ledger/ledgermgmt/ledger_mgmt.go:168 +0x99  e  org2.peer2  github.com/hyperledger/fabric/core/ledger/ledgermgmt.(*closableLedger).Close(0xc002714c60)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/core/ledger/ledgermgmt/ledger_mgmt.go:181 +0x40  e  org2.peer2  github.com/hyperledger/fabric/gossip/service.privateHandler.close(0x51398e0, 0xc00289cb40, 0x5177ac0, 0xc000517ca0, 0xae00368, 0xc0028a6f00, 0x51715e0, 0xc00289cb70, 0x513d0c0, 0x4fcbc70, ...)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/gossip/service/gossip_service.go:161 +0x31  e  org2.peer2  github.com/hyperledger/fabric/gossip/service.(*GossipService).Stop(0xc0005679a0)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/gossip/service/gossip_service.go:472 +0x2c8  e  org2.peer2  github.com/hyperledger/fabric/internal/peer/node.serve(0x5c27628, 0x0, 0x0, 0x0, 0x0)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/internal/peer/node/start.go:707 +0x443c  e  org2.peer2  github.com/hyperledger/fabric/internal/peer/node.glob..func1(0x5be1ba0, 0x5c27628, 0x0, 0x0, 0x0, 0x0)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/internal/peer/node/start.go:128 +0xf1  e  org2.peer2  github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).execute(0x5be1ba0, 0x5c27628, 0x0, 0x0, 0x5be1ba0, 0x5c27628)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:826 +0x465  e  org2.peer2  github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).ExecuteC(0x5be20a0, 0xc000585f60, 0x1, 0x1)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:914 +0x2fc  e  org2.peer2  github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).Execute(...)  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:864  e  org2.peer2  main.main()  e  org2.peer2  	/Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/cmd/peer/main.go:51 +0x416 {code}  Can be recreated by running the e2e suite with {{ginkgo -r -p}}.  ></description> </Issue>
