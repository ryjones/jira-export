<Issue id="30507" key="FAB-10302" number="10302" project="10002" reporter="jyellick" assignee="yacovm" creator="jyellick" type="10001" summary="Update gossip maps not to use protobuf messages as keys" priority="3" resolution="10000" status="6" created="2018-05-22 20:01:22.0" updated="2018-07-20 18:49:10.0" resolutiondate="2018-07-09 08:14:38.0" votes="0" watches="3" workflowId="42291"> <description><! CDATA We need to upgrade to protobuf v1.1.0 eventually (ideally soon).  The way the newer version of protobuf generates the backing structs, it adds new fields, one of which is itself a struct.  Since only types which may be directly compared with '==' and '!=' map be used in maps, updating protobuf creates a number of build failures:  {noformat} # github.com/hyperledger/fabric/gossip/privdata gossip/privdata/pull.go:346:28: invalid map key type "github.com/hyperledger/fabric/protos/gossip".PvtDataDigest gossip/privdata/pull.go:371:18: invalid map key type "github.com/hyperledger/fabric/protos/gossip".PvtDataDigest # github.com/hyperledger/fabric/gossip/privdata gossip/privdata/pull.go:346:28: invalid map key type "github.com/hyperledger/fabric/protos/gossip".PvtDataDigest gossip/privdata/pull.go:371:18: invalid map key type "github.com/hyperledger/fabric/protos/gossip".PvtDataDigest gossip/privdata/coordinator_test.go:244:29: invalid map key type "github.com/hyperledger/fabric/protos/gossip".PvtDataDigest gossip/privdata/coordinator_test.go:245:8: invalid map key type "github.com/hyperledger/fabric/protos/gossip".PvtDataDigest gossip/privdata/coordinator_test.go:321:28: invalid map key type "github.com/hyperledger/fabric/protos/common".CollectionCriteria gossip/privdata/coordinator_test.go:329:21: invalid map key type "github.com/hyperledger/fabric/protos/common".CollectionCriteria {noformat}  As a prerequisite to updating proto, we must move these fields to use a different element as their key.  ></description> </Issue>
