<Issue id="31530" key="FAB-10968" number="10968" project="10002" reporter="sykesm" assignee="yacovm" creator="sykesm" type="10001" summary="Address races reported by the race detector in fabric/discovery" priority="3" resolution="10000" status="6" created="2018-07-02 13:25:22.0" updated="2018-07-24 12:19:43.0" resolutiondate="2018-07-24 12:19:43.0" votes="0" watches="2" workflowId="42833"> <description><! CDATA Examples: {code:java} ================== WARNING: DATA RACE Write at 0x0000051a3fd0 by goroutine 23:   github.com/hyperledger/fabric/discovery/test.createSupport()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:394 +0xb9a   github.com/hyperledger/fabric/discovery/test.createClientAndService()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:444 +0x2ba   github.com/hyperledger/fabric/discovery/test.TestRevocation()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:246 +0x8c   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Previous write at 0x0000051a3fd0 by goroutine 21:   github.com/hyperledger/fabric/discovery/test.createSupport()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:394 +0xb9a   github.com/hyperledger/fabric/discovery/test.createClientAndService()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:444 +0x2ba   github.com/hyperledger/fabric/discovery/test.TestEndorsementComputationFailure()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:193 +0x8c   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Goroutine 23 (running) created at:   testing.(*T).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:824 +0x564   testing.runTests.func1()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1063 +0xa4   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d   testing.runTests()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1061 +0x4e1   testing.(*M).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:978 +0x2cd   github.com/hyperledger/fabric/discovery/test.TestMain()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:101 +0x223   main.main()       _testmain.go:46 +0x22a  Goroutine 21 (running) created at:   testing.(*T).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:824 +0x564   testing.runTests.func1()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1063 +0xa4   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d   testing.runTests()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1061 +0x4e1   testing.(*M).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:978 +0x2cd   github.com/hyperledger/fabric/discovery/test.TestMain()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:101 +0x223   main.main()       _testmain.go:46 +0x22a{code} and {code:java} WARNING: DATA RACE Read at 0x00c4202484d0 by goroutine 23:   github.com/hyperledger/fabric/discovery/test.testPeerSet.toMembershipSet()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:662 +0x9d   github.com/hyperledger/fabric/discovery/test.createSupport()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:404 +0x100c   github.com/hyperledger/fabric/discovery/test.createClientAndService()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:444 +0x2ba   github.com/hyperledger/fabric/discovery/test.TestRevocation()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:246 +0x8c   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Previous write at 0x00c4202484d0 by goroutine 22:   github.com/hyperledger/fabric/discovery/test.createSupport()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:394 +0xb31   github.com/hyperledger/fabric/discovery/test.createClientAndService()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:444 +0x2ba   github.com/hyperledger/fabric/discovery/test.TestLedgerFailure()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:220 +0x8c   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d  Goroutine 23 (running) created at:   testing.(*T).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:824 +0x564   testing.runTests.func1()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1063 +0xa4   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d   testing.runTests()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1061 +0x4e1   testing.(*M).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:978 +0x2cd   github.com/hyperledger/fabric/discovery/test.TestMain()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:101 +0x223   main.main()       _testmain.go:46 +0x22a  Goroutine 22 (running) created at:   testing.(*T).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:824 +0x564   testing.runTests.func1()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1063 +0xa4   testing.tRunner()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:777 +0x16d   testing.runTests()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:1061 +0x4e1   testing.(*M).Run()       /usr/local/Cellar/go/1.10.3/libexec/src/testing/testing.go:978 +0x2cd   github.com/hyperledger/fabric/discovery/test.TestMain()       /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/discovery/test/integration_test.go:101 +0x223   main.main()       _testmain.go:46 +0x22a{code}    ></description> </Issue>
