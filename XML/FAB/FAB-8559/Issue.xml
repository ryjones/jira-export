<Issue id="28065" key="FAB-8559" number="8559" project="10002" reporter="tongliofcary" assignee="christopherferris" creator="tongliofcary" type="10004" summary="Peer container does use its own namespace or tag look for ccenv image" priority="3" resolution="10000" status="6" created="2018-02-27 16:26:33.0" updated="2018-07-20 14:15:53.0" resolutiondate="2018-06-18 12:04:58.0" votes="0" watches="4" workflowId="41389"> <environment><! CDATA the steps to reproduce the problem.  1. retrieve peer image from non docker hub repo using a tagged snapshot image 2. try to instantiate a chaincode.  ></environment> <description><! CDATA We recently have to test the latest code for some performance/stress test. We had to use a private docker repo. The private docker repo saves snapshot build peer and chaincode images, however, the images always get labeled with stable and snapshot tag. When use the stable tag to set things up for test, peer image gets pulled successfully, but when it is time to create chaincode containers, peer container looks for the chaincode image with tag hardcoded (snapshot tag), the problem is that peer container has no way to authenticate with the private repo, thus even if the snapshot tagged ccenv container exists in the private repo, peer container just can not get it, thus the chaincode container creation fails. I think peer container really needs to use its own namespace and tag finding ccenv image for chaincode creation, currently it seems it is not doing that. even with core.yaml configuration, this still is an issue since peer does not know how to authenticate with private docker repo. I am changing this to a bug now and higher the priority. Thanks for your attention.   The following were original description of the problem.  See comment thread, below.  Â   peer container image can be retrieved from multiple sources, and it can use any tag, for example, nexus3.hyperledger.org:10001/hyperledger/fabric-peer:latest, when peer try to instantiate chaincode container, it always try to retrieve the chaincode from docker hub since it assume this hyperledger/fabric-ccenv, so there are two problems.  1. peer does not care where it was retrieved 2. peer does not use its own tag to find the ccenv tag, seems that the ccenv tag peer uses is some where hardcoded. for example, when peer image was built, it may carry a tag like this x86_64-1.1.0-beta-snapshot-0a81773, then that image may get tagged as "latest", now when the image is pulled down, it will bear the tag of "latest", one would assume that peer will instantiate the ccenv:latest, but the peer instead simply uses the snapshot tag.  I think these are pretty serious issues. Need to be fixed very soon.  ></description> </Issue>
