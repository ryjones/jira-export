<Issue id="45086" key="FAB-17906" number="17906" project="10002" reporter="manish-sethi" assignee="wenjian" creator="manish-sethi" type="10003" summary="Add functions for snapshots management in kvledger" priority="3" resolution="10000" status="6" created="2020-05-15 18:43:17.0" updated="2020-08-03 12:47:30.0" resolutiondate="2020-08-03 12:47:30.0" votes="0" watches="2" workflowId="58996" archived="N"> <description><! CDATA In the {{kvledger}} add the following APIs as mentioned in the RFC.   Note that in the RFC, the scope of the APIs is mentioned at the higher level and hence only limited functionality would be implemented at the {{kvledger}} level. For instance, authorization checks etc. would be maintain at the peer level in a separate task.  * {{SubmitSnapshotRequest (height uint64, error)}} ** Accept a valid request for snapshot generation and persists the request in a leveldb instance ** Return error if the ledger height specified in the request has already passed * {{PendingSnapshotRequests () (  height, error)}} ** Returns the pending (or under processing) requests for snapshots * {{CancelSnapshotRequest (height uint64) error}} ** Cancels the previously submitted request ** Returns an error if no such pending request * {{ListSnapshots() (  *SnapshotInfo, error)}} ** Define SnapshotInfo proto in fabric-protos repo (details in the RFC) ** Returns the information about available snapshots * {{DeleteSnapshot (height uint64) error}} ** Delete the snapshot files except the metadata file ** Returns an error if no such snapshot  In addition make the following changes in {{kvledger}} * On startup, delete the folder {{snapshots/under_processing}} to discard any incomplete snapshots that may be present due to a possible server crash * Start tracking the next snapshot request to be processed (pending request with the shortest height) * Start tracking the height of the ledger such that upon reaching the ledger height specified in the snapshot request, pause further block commits and invoke the API {{createSnapshot}} on kvledger (FAB-17904)  ></description> </Issue>
