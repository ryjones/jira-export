<Issue id="34149" key="FAB-12200" number="12200" project="10002" reporter="sykesm" assignee="sykesm" creator="sykesm" type="10004" summary="Data races in metrics" priority="3" resolution="10000" status="6" created="2018-09-27 14:10:34.0" updated="2018-11-19 05:08:08.0" resolutiondate="2018-09-28 15:57:51.0" votes="0" watches="1" workflowId="45472"> <description><! CDATA Welcome to the land of fallout from using a global singleton manager for config:  {code} WARNING: DATA RACE Read at 0x00c0000ab330 by goroutine 20: github.com/hyperledger/fabric/vendor/github.com/spf13/viper.(*Viper).find() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/viper/viper.go:634 +0x1d5 github.com/hyperledger/fabric/vendor/github.com/spf13/viper.(*Viper).Get() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/viper/viper.go:404 +0x108 github.com/hyperledger/fabric/vendor/github.com/spf13/viper.(*Viper).GetBool() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/viper/viper.go:457 +0x4c github.com/hyperledger/fabric/vendor/github.com/spf13/viper.GetBool() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/viper/viper.go:455 +0x5e github.com/hyperledger/fabric/common/metrics.NewOpts() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/metrics/server.go:39 +0x96 github.com/hyperledger/fabric/common/metrics.TestNewOptsDefaultVar() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/metrics/server_test.go:219 +0x55 testing.tRunner() /usr/local/Cellar/go/1.11/libexec/src/testing/testing.go:827 +0x162  Previous write at 0x00c0000ab330 by goroutine 19: github.com/hyperledger/fabric/common/metrics.setupTestConfig() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/vendor/github.com/spf13/viper/viper.go:686 +0x1bc github.com/hyperledger/fabric/common/metrics.TestNewOpts() /Users/sykesm/workspace/fabric/src/github.com/hyperledger/fabric/common/metrics/server_test.go:198 +0x78 testing.tRunner() /usr/local/Cellar/go/1.11/libexec/src/testing/testing.go:827 +0x162 {code}  ></description> </Issue>
