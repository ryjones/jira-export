<Action id="22769" issue="15783" author="vpaprots" type="comment" created="2017-04-20 16:19:02.0" updateauthor="vpaprots" updated="2017-04-20 16:19:02.0"> <body><! CDATA Sent to hyperledger-fabric@lists.hyperledger.org  -----------  I have been trying to get PKCS11 support into fabric so that our crypto operations can be backed up by a crypto card. Over the last several days I ran into issues with builds, so I had a lengthy chat with Greg Haskins for what it means to support PKCS11. (At lowest level, PKCS11 is set of headers/function definitions that a DLL/SO is built to be made pluggable)  Our current status: (0) FROM: ubuntu:16.04 + static peer  As much as I try, I cannot get static peer to link with PKCS11 library (crash in glibc). Also, as Greg points out, one pkcs11 dll that works on one release, might not work on another  Alternatives: (1) FROM: scratch + static peer (2) FROM: ubuntu:16.04 + dynamic peer (3) build fabric for various distros  The good and the bad: 1)  FROM: scratch + static peer  No HSM support. As a docker distribution, this is probably the most portable. This executable can be copied out, distro-independent, and the smallest footprint.  2)  FROM: ubuntu:16.04 + dynamic peer  (Some) HSM support. Card vendors must support Ubuntu (i.e. provide deb packages, etc.). Changing base OS or even updating base OS release now becomes something that could break customers.  3)  build fabric for various distros  (Best) HSM support. Customer chose their supported distro. Install their pkcs11 hsm.so (`yum install hsm`, `apt-get install hsm`, etc.), install fabric (`yum install fabric-peer`, `apt-get install fabric-peer`, etc.) and compose their (arbitrary) container as they like. However, this explodes the support configuration requirements.  ----  Two questions: - For v1.0, I would propose (0)->(2). This gets us HSM, but at the price of static builds. (This is https://jira.hyperledger.org/browse/FAB-3196 Has two gerrit patches associated) - For v1.x, we need to reconsider our distribution strategy. There is value in scratch builds. Is locking down to Ubuntu (2) ok? Should we be heading to distro repos?  Greg, is that about what we discussed? What are the thoughts of other maintainers and the community?  ></body> </Action>
<Action id="23543" issue="15783" author="vpaprots" type="comment" body="Won&apos;t fix. Staying at option (0). Closing." created="2017-05-08 16:22:10.0" updateauthor="vpaprots" updated="2017-05-08 16:22:10.0"/>
<Action id="30729" issue="15783" author="divyank" type="comment" body=" ~vpaprots  How was this resolved? Were you able to statically link the libraries that PKCS11 requires?" created="2017-09-11 15:40:02.0" updateauthor="divyank" updated="2017-09-11 15:40:02.0"/>
