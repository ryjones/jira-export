<Issue id="39313" key="FAB-15183" number="15183" project="10002" reporter="sambhavdutt" assignee="c0rwin" creator="sambhavdutt" type="10004" summary="TestMsgStoreExpirationWithMembershipMessages failed in discovery test, ping to localhost failed" priority="3" resolution="10201" status="6" created="2019-04-15 12:15:01.0" updated="2019-04-21 16:32:11.0" resolutiondate="2019-04-21 16:32:11.0" votes="0" watches="3" workflowId="52192"> <description><! CDATA TestMsgStoreExpirationWithMembershipMessages failed in discovery test, ping to localhost failed in discovery test.  *Branch:* release-1.4 *Platform:* x86_64 *Error Snippet:*  {code:java} 21:52:13 2019-04-15 01:50:54.990 UTC  gossip.discovery#localhost:2048  handleMsgFromComm -> WARN 001 Got message with wrong type (expected Alive or MembershipResponse or MembershipRequest message): data_msg:<>  21:52:13 Ping to localhost:7615 failed . . 21:52:13 2019-04-15 01:51:24.244 UTC  gossip.discovery#localhost:4676  expireDeadMembers -> WARN 154 Exiting 21:52:13 Ping to localhost:4676 failed 21:52:13 Ping to localhost:4676 failed 21:52:13 --- FAIL: TestMsgStoreExpirationWithMembershipMessages (75.00s) 21:52:13     discovery_test.go:1296:  21:52:13         	Error Trace:	discovery_test.go:1296 21:52:13         	            				discovery_test.go:1373 21:52:13         	Error:      	Should be empty, but was map localhost:22610:1555293058006658098, 274  21:52:13         	Test:       	TestMsgStoreExpirationWithMembershipMessages 21:52:13         	Messages:   	 Step6 - after lost MembershipResp process  Data from alive msg still exists in aliveLastTS of discovery inst 2 21:52:13     discovery_test.go:1298:  21:52:13         	Error Trace:	discovery_test.go:1298 21:52:13         	            				discovery_test.go:1373 21:52:13         	Error:      	Should be empty, but was map localhost:22610:Endpoint: localhost:22610, InternalEndpoint: localhost:22610, PKI-ID: 6c6f63616c686f73743a3232363130, Metadata:   21:52:13         	Test:       	TestMsgStoreExpirationWithMembershipMessages 21:52:13         	Messages:   	 Step6 - after lost MembershipResp process  id2Member mapping still still contains data related to Alive msg: discovery inst 2 21:52:13     discovery_test.go:1300:  21:52:13         	Error Trace:	discovery_test.go:1300 21:52:13         	            				discovery_test.go:1373 21:52:13         	Error:      	Should be zero, but was 1 21:52:13         	Test:       	TestMsgStoreExpirationWithMembershipMessages 21:52:13         	Messages:   	 Step6 - after lost MembershipResp process  Alive membership list is not empty, discovery instance2 21:52:13 FAIL . 21:52:13 FAIL	github.com/hyperledger/fabric/gossip/discovery	78.048s {code}  *Build Log* https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-unit-test-coverage-daily-release-1.4-x86_64/92/  ></description> </Issue>
