<Issue id="36726" key="FAB-13660" number="13660" project="10002" reporter="scottz" assignee="dongming" creator="scottz" type="10101" summary="restart follower OSNs with multiple-threads sending transactions and multiple TX per block" priority="3" resolution="10000" status="6" created="2019-01-14 02:13:32.0" updated="2019-07-23 20:59:57.0" resolutiondate="2019-07-23 20:59:57.0" votes="0" watches="1" workflowId="48320"> <description><! CDATA +SETUP+: Create network as in FAB-13641: 3 orgs, 1 peers per org, 3 raft orderers, and create 1 application channel.  +INPUTS+ (scenario 1): # Start transactions running in 3 threads with PTE running in "constant mode" which sends the next transaction once the previous transaction is broadcast to an orderer, as in FAB-13641: 1 thread to org1.peer1, 1 thread to org2.peer1, 1 thread to org3.peer1. # The client should be configured to broadcast transactions to different orderers (e.g. the client thread that sends to org1.peer1 could send to orderer1, etc). # Check orderer logs to determine which orderer is the leader (could be any of the three). # While the traffic is running, stop and start a follower orderer of the application channel.  +EXPECTATIONS+: * In the orderers that are not stopped, for the system channel and for each channel shared with the stopped orderer, we can expect to see an error log when their connection drops to the stopped orderer (followed by an info log indicating its recovery, whenever it is started again). Or something like that. The exact number of logs and loglevels to expect for each channel are described in FAB-12687. * Expect something less than the max of 30,002 transactions, delivered in a much smaller number of blocks since batchsize=500. We can expect to see NAK'd transactions reported by the client (e.g. those TXs that are sent blindly to the stopped orderer while it is stopped or not yet rejoined to the consensus group), and possibly lost transactions if the orderer receives and ACKs a TX but is stopped before forwarding it to the leader.  ></description> </Issue>
