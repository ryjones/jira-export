<Issue id="31335" key="FAB-10843" number="10843" project="10002" reporter="denyeart" assignee="yacovm" creator="denyeart" type="10004" summary="Misconfiguration of peer validation plugin causes state fork upon upgrade to v1.2" priority="2" resolution="10000" status="6" created="2018-06-25 02:53:57.0" updated="2018-07-20 14:17:02.0" resolutiondate="2018-06-25 10:25:24.0" votes="0" watches="2" workflowId="42538"> <description><! CDATA Misconfiguration of peer validation plugin will cause a transaction to get invalidated on the peer that has the misconfiguration.  This results in a state fork on the misconfigured peer.  Instead of an invalidation resulting in state fork, misconfigurations should result in a block processing error that would require an administrator to fix the peer configuration.  After the misconfiguration is fixed and peer is restarted, the transaction in question should get processed successfully and validated.  One such instance of this problem is a missing "validators" section in core.yaml.  In v1.1 there was no "validators" section.  Therefore if a peer is upgraded to v1.2 and the peer administrator forgets to add a "validators" section, the next transactions processed after peer restart will get invalidated causing state fork.  This misconfiguration should be detected and cause an error upon peer processing a transaction after upgrade, so that the peer administrator can identify and resolve the misconfiguration without a state fork.  The documentation section "*Validation plugin consistency across peers*" does mention that correct configuration is the responsibility of the peer administrator, but still the peer should protect against state forks in such misconfiguration scenarios and return an error rather than a transaction invalidation. This is especially important given the likelihood of missing "validators" section when upgrading from v1.1 to v1.2 ("validators" section is included in default core.yaml that ships with v1.2, but in some deployments the administrator may not apply the new default core.yaml).  ></description> </Issue>
