<Issue id="43607" key="FAB-17203" number="17203" project="10002" reporter="scottz" assignee="suryalnvs" creator="scottz" type="10004" summary="fabric-test azure pipeline does not reflect test failures or test suite cleanup errors" priority="2" resolution="10000" status="6" created="2019-12-05 15:58:15.0" updated="2020-02-13 15:19:29.0" resolutiondate="2020-02-13 15:19:29.0" votes="0" watches="2" workflowId="57455"> <description><! CDATA To correctly reflect failures in the azp pipeline results, we should return failure codes from "Run Test" scripts when tests fail.  The fabric-test/regression/smoke/runSmokeTestSuite.sh script does not use non-zero exit code if any of the tests fail for the NL+PTE or the operator based tests, which means we always see a green checkmark in the pipeline, for the "Run Smoke Tests" task. The script does not use "-e" option for bash, so we are ignoring test results and not passing them along the pipeline. For exampleÂ  https://dev.azure.com/Hyperledger/Fabric-Test/_build/results?buildId=3141&view=logs&j=1d99425b-0e5e-525f-8602-4964d4d27096   We must run all the tests, and archive logs, so do NOT use bash "-e" option. Instead, just accumulate each test result (which is nonzero if the test command fails) by "OR"ing the result into a local exitcode variable, and then the last line in the script should be "exit $exitcode".  Same fix is needed for the fabric-test/regression/daily/runPteTestSuite.sh.  ></description> </Issue>
