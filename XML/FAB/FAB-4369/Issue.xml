<Issue id="17495" key="FAB-4369" number="4369" project="10002" reporter="hanhzf" assignee="hanhzf" creator="hanhzf" type="10004" summary="orderer failed to start due to sample config was not updated when building orderer docker images" priority="3" resolution="10000" status="6" created="2017-06-05 14:55:33.0" updated="2018-07-20 14:13:08.0" resolutiondate="2017-06-09 20:30:32.0" votes="0" watches="2" timeoriginalestimate="14400" timeestimate="14400" workflowId="38820" security="10001"> <description><! CDATA I have a local dev env, which I use for continuously fetch and build latest fabric code, recently just found end2end test failed with error, and then found orderer container was not started, with following error: {code:java} 2017-06-05T14:45:55.130778062Z 2017-06-05 14:45:55.130 UTC  orderer/localconfig  Load -> CRIT 001 Error unmarshaling config into struct: 1 error(s) decoding: 2017-06-05T14:45:55.130822212Z 2017-06-05T14:45:55.130838907Z * '' has invalid keys: genesis, sbftlocal 2017-06-05T14:45:55.132874783Z panic: Error unmarshaling config into struct:1 error(s) decoding: 2017-06-05T14:45:55.132889338Z 2017-06-05T14:45:55.132893771Z * '' has invalid keys: genesis, sbftlocal 2017-06-05T14:45:55.132898102Z{code} Then check *orderer.yaml* from the orderer docker images, find *orderer.yaml* was not up to date, with following deprecated configuration(*which was not the same as config under fabirc/sampleconfig*/) which caused this problem:    {code:java} SbftLocal:  Address to use for SBFT internal communication PeerCommAddr: ":6101" CertFile: "sbft/testdata/cert1.pem" KeyFile: "sbft/testdata/key.pem" Directory for SBFT data (persistence) DataDir: "/tmp" {code}    check fabric/Makefile:     {code:java} build/sampleconfig.tar.bz2: (cd sampleconfig && tar -jc *) > $@{code}       So once there exist a deprecated file  build/sampleconfig.tar.bz2, Makefile will not try to recreate it even when fabirc/sampleconfig is updated.  ></description> </Issue>
