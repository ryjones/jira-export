<Issue id="40976" key="FAB-15909" number="15909" project="10002" reporter="dereckluo" assignee="sykesm" creator="dereckluo" type="10004" summary="run-unit-test script should not test packages that are not part of TEST_PKGS" priority="3" resolution="10000" status="6" created="2019-07-10 14:14:29.0" updated="2019-08-02 20:21:48.0" resolutiondate="2019-08-02 20:21:48.0" votes="0" watches="3" workflowId="53945"> <description><! CDATA In run-unit-test.sh script, there are some issues between TEST_PKG, pluginsenabled, pkcs11 tags, and conditional packages.   for example:   {{TEST_PKGS=github.com/hyperledger/fabric/core/comm/... ./scripts/run-unit-tests.sh}} ends up running tests in {{core/scc}} and {{fabric/bccsp}} because of the three phases to test.  {code} $ TEST_PKGS=github.com/hyperledger/fabric/core/comm/... ./scripts/run-unit-tests.sh   ok  	github.com/hyperledger/fabric/core/comm	(cached)	coverage: 85.4% of statements ?   	github.com/hyperledger/fabric/core/comm/testpb	 no test files   real	0m0.635s user	0m0.901s sys	0m0.655s pluginsenabled ok  	github.com/hyperledger/fabric/core/scc	(cached)	coverage: 84.1% of statements  real	0m0.853s user	0m1.185s sys	0m1.036s pkcs11 ok  	github.com/hyperledger/fabric/bccsp	(cached)	coverage: 68.2% of statements ok  	github.com/hyperledger/fabric/bccsp/factory	(cached)	coverage: 81.3% of statements ?   	github.com/hyperledger/fabric/bccsp/factory/test-plugin	 no test files  ok  	github.com/hyperledger/fabric/bccsp/idemix	(cached)	coverage: 80.0% of statements ok  	github.com/hyperledger/fabric/bccsp/idemix/bridge	(cached)	coverage: 97.0% of statements ok  	github.com/hyperledger/fabric/bccsp/idemix/handlers	(cached)	coverage: 97.3% of statements ?   	github.com/hyperledger/fabric/bccsp/idemix/handlers/mock	 no test files  ?   	github.com/hyperledger/fabric/bccsp/mocks	 no test files  ok  	github.com/hyperledger/fabric/bccsp/pkcs11	3.551s	coverage: 26.0% of statements ok  	github.com/hyperledger/fabric/bccsp/signer	(cached)	coverage: 100.0% of statements ok  	github.com/hyperledger/fabric/bccsp/sw	14.698s	coverage: 90.1% of statements ?   	github.com/hyperledger/fabric/bccsp/sw/mocks	 no test files  ok  	github.com/hyperledger/fabric/bccsp/utils	(cached)	coverage: 85.5% of statements  real	0m16.053s user	1m13.422s sys	0m2.977s {code}  There may also be interaction issues between {{TEST_PKGS}} and conditional packages (gossip).    ></description> </Issue>
