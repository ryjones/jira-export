<Issue id="40767" key="FAB-15797" number="15797" project="10002" reporter="dongming" assignee="dongming" creator="dongming" type="10101" summary="rollback: verification of commit hash, reset and rollback with private db using manual test" priority="3" resolution="10000" status="6" created="2019-06-24 14:15:09.0" updated="2019-08-01 03:26:19.0" resolutiondate="2019-08-01 03:26:19.0" votes="0" watches="2" workflowId="53722"> <description><! CDATA Purpose: verification of commit hash, reset and rollback using manual test  Network configuration: Orgs: O1, O2 Peers: <O1, P1>, <O2, P2> Peer logging level: info Channels: <P1, C1|C2|C3> <P2, C1|C2|C3>  Transactions: Send all endorsement requests to P1 only  Steps: 1. start the network with fabric 1.4 with capability 1.4.2 enabled 1.2 Submit a few transactions 1.2 Observation: - each block commit, both peer would have commit hash (verify via logs)  2. Stop peers and orderer 2.1 Stop all peers and orderer 2.2 On P1, execute rollback command for channel C1 to block zero 2.3 On P1, execute rollback command for channel C2 to a random block 2.4 On P2, execute reset command 2.5 restart the peers 2.6 Observation: - send endorsements to <P1, C1|C2> and <P2, C1|C2|C3> They shall fail. - send endorsements to <P1, C3> (Q. does peer endorsement works if not connected to orderer?) They shall succeed.  3. Start orderer 3.1 Start the orderer 3.2 Observation: - query block height from all peers to ensure that all peers reach the original height - send endorsement to all peers on all channels to ensure success - query private data on all peers to ensure that they are available in all the peers - <P1, C1> blocks contain commit hash (verify via logs) - <P2, C1|C2|C3> blocks contain commit hash (verify via logs) - Commit Hash For last block in <P1, C1> matches the commit hash for last block in <P2, C2> (verify via logs)    ></description> </Issue>
