<Issue id="15127" key="FAB-2560" number="2560" project="10002" reporter="denyeart" assignee="chris.elder" creator="denyeart" type="10004" summary="GetQueryResult() query re-write is not correct" priority="2" resolution="10000" status="6" created="2017-03-01 06:55:41.0" updated="2018-07-20 14:11:51.0" resolutiondate="2017-03-01 19:08:31.0" votes="0" watches="1" workflowId="37642"> <description><! CDATA From fabric-ledger channel:  Query is getting re-written in fabric with duplicate "data" wrappers.  Query in chaincode:  {"selector":{"docTypeId":3,"oriRe":"SMP","ctB":"CTB","valDt":"1990-12-24","orB":"YYY","tD":"TD","cuVoB":52,"cuIoBu":"AA","cuSt":"NA"}}  Result:  2017-03-01 06:48:14.782 UTC  statecouchdb  ApplyQueryWrapper -> DEBU 441 Rewritten query with data wrapper: {"selector":{"$and": {"chaincodeid":"marbles"},{"data.cuIoBu":"AA","data.cuVoB":52,"data.data.ctB":"CTB","data.data.cuSt":"NA","data.docTypeId":3,"data.orB":"YYY","data.oriRe":"SMP","data.tD":"TD","data.valDt":"1990-12-24"} }}  See the problem in red: { "selector":{ "$and":  { "chaincodeid":"marbles" }, { "data.cuIoBu":"AA", "data.cuVoB":52, {color:red}            "data.data.ctB":"CTB", "data.data.cuSt":"NA",{color} "data.docTypeId":3, "data.orB":"YYY", "data.oriRe":"SMP", "data.tD":"TD", "data.valDt":"1990-12-24" }   } }  ></description> </Issue>
