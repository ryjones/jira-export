<Issue id="30065" key="FAB-9974" number="9974" project="10002" reporter="wlahti" assignee="wlahti" creator="wlahti" type="10004" summary="Configtxgen should recover from &quot;Could not find profile&quot; panic" priority="3" resolution="10000" status="6" created="2018-05-09 14:25:09.0" updated="2018-07-20 14:16:36.0" resolutiondate="2018-05-10 11:50:10.0" votes="0" watches="1" workflowId="42125"> <description><! CDATA configtxgen currently recovers from a panic when the FABRIC_CFG_PATH or default dev config directory are not set ( https://github.com/hyperledger/fabric/blob/master/common/tools/configtxgen/main.go#L240).  Now that the config logic for tests has been modified via  https://gerrit.hyperledger.org/r/c/20651/,  the error handling logic for configtxgen should also be updated to recover from the following error message, which is now the most likely error for a user/developer to hit (since viper is now initialized with the sampleconfig dir when the FABRIC_CFG_PATH is not set, it will always find a configtx.yaml but that yaml won't necessarily contain the requested profile): {code:java} 19:41:28 unit-tests_1 |  e   2018-05-08 19:41:18.329 UTC  common/tools/configtxgen/localconfig  Load -> CRIT 003 Could not find profile: TwoOrgsOrdererGenesis 19:41:28 unit-tests_1 |  e   2018-05-08 19:41:18.330 UTC  common/tools/configtxgen  func1 -> CRIT 004 Could not find profile: TwoOrgsOrdererGenesis 19:41:28 unit-tests_1 |  e   panic: Could not find profile: TwoOrgsOrdererGenesis  recovered  19:41:28 unit-tests_1 |  e   panic: Could not find profile: TwoOrgsOrdererGenesis 19:41:28 unit-tests_1 |  e   19:41:28 unit-tests_1 |  e   goroutine 1  running : 19:41:28 unit-tests_1 |  e   github.com/hyperledger/fabric/vendor/github.com/op/go-logging.(*Logger).Panic(0xc4201a5d10, 0xc420409ec0, 0x1, 0x1) 19:41:28 unit-tests_1 |  e   /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/op/go-logging/logger.go:188 +0xbd 19:41:28 unit-tests_1 |  e   main.main.func1() 19:41:28 unit-tests_1 |  e   /opt/gopath/src/github.com/hyperledger/fabric/common/tools/configtxgen/main.go:248 +0x115 19:41:28 unit-tests_1 |  e   panic(0xc68a20, 0xc420409eb0) 19:41:28 unit-tests_1 |  e   /opt/go/src/runtime/panic.go:505 +0x229 19:41:28 unit-tests_1 |  e   github.com/hyperledger/fabric/vendor/github.com/op/go-logging.(*Logger).Panic(0xc4201a5b60, 0xc420490e00, 0x2, 0x2) 19:41:28 unit-tests_1 |  e   /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/op/go-logging/logger.go:188 +0xbd 19:41:28 unit-tests_1 |  e   github.com/hyperledger/fabric/common/tools/configtxgen/localconfig.Load(0x7ffca10e4b87, 0x15, 0x0, 0x0, 0x0, 0xc42045a3a8) 19:41:28 unit-tests_1 |  e   /opt/gopath/src/github.com/hyperledger/fabric/common/tools/configtxgen/localconfig/config.go:289 +0x82f 19:41:28 unit-tests_1 |  e   main.main() 19:41:28 unit-tests_1 |  e   /opt/gopath/src/github.com/hyperledger/fabric/common/tools/configtxgen/main.go:259 +0xce7{code}  ></description> </Issue>
