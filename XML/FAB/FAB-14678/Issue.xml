<Issue id="38522" key="FAB-14678" number="14678" project="10002" reporter="dongming" creator="dongming" type="10004" summary="RAFT SERVICE UNAVAILABLE with 108 orderers" priority="3" resolution="10000" status="6" created="2019-03-15 15:09:20.0" updated="2019-03-19 17:38:31.0" resolutiondate="2019-03-19 17:38:31.0" votes="0" watches="3" workflowId="50165"> <description><! CDATA orderer: Version: 1.4.1 Commit SHA: bf34e30  When test FAb-14230, with 108 orderers, some orderers show "SERVICE_UNAVAILABLE" during the test.  As a result, there are small number of transactions (2172 or 0.4%) were dropped without noticing client. I ran the test twice, the first time succeeded but the second time failed. The same test was successful with 3, 27, 54 orderers.   When the "SERVICE_UNAVAILABLE" occurs, there is no leader changes.  Here is an snippet log:  Mar 14 14:48:57 orderer7-ordererorg2-6bfdd7b54-6rfxs orderer7-ordererorg2 2019-03-14 18:48:57.000 UTC  comm.grpc.server  1 -> INFO 3ce0 streaming call completed grpc.service=orderer.AtomicBroadcast grpc.method=Broadcast grpc.peer_address=10.191.5.91:49804 grpc.code=OK grpc.call_duration=21.758415ms Mar 14 14:48:57 orderer7-ordererorg2-6bfdd7b54-6rfxs orderer7-ordererorg2 2019-03-14 18:48:57.084 UTC  comm.grpc.server  1 -> INFO 3ce1 streaming call completed grpc.service=orderer.AtomicBroadcast grpc.method=Broadcast grpc.peer_address=10.191.5.91:49804 grpc.code=OK grpc.call_duration=17.936084ms Mar 14 14:49:02 orderer7-ordererorg2-6bfdd7b54-6rfxs orderer7-ordererorg2 2019-03-14 18:49:02.809 UTC  orderer.common.broadcast  ProcessMessage -> WARN 3ce2  channel: testorgschannel1  Rejecting broadcast of normal message from 10.191.5.91:49804 with SERVICE_UNAVAILABLE: rejected by Order: stream aborted Mar 14 14:49:02 orderer7-ordererorg2-6bfdd7b54-6rfxs orderer7-ordererorg2 2019-03-14 18:49:02.809 UTC  comm.grpc.server  1 -> INFO 3ce3 streaming call completed grpc.service=orderer.AtomicBroadcast grpc.method=Broadcast grpc.peer_address=10.191.5.91:49804 grpc.code=OK grpc.call_duration=5.620683066s Mar 14 14:49:02 orderer7-ordererorg2-6bfdd7b54-6rfxs orderer7-ordererorg2 2019-03-14 18:49:02.810 UTC  orderer.common.cluster.step  sendMessage -> WARN 3ce4 Stream 2 to orderer2-ordererorg2.ordererorg2(orderer2-ordererorg2:7050) was forcibly terminated because timeout (7s) expired Mar 14 14:49:02 orderer7-ordererorg2-6bfdd7b54-6rfxs orderer7-ordererorg2 2019-03-14 18:49:02.921 UTC  comm.grpc.server  1 -> INFO 3ce5 streaming call completed grpc.service=orderer.AtomicBroadcast grpc.method=Broadcast grpc.peer_address=10.191.5.91:49804 grpc.code=OK grpc.call_duration=19.256127ms   We also did a test with fixed incoming TPS=100 for 90 min. This test passed.  This may related to FAB-14187.  The log is available on the LogDNA-community-quality-lab. Look for Mar 14 14:48:00. The snippet log for orderer7-ordererorg2 is attached. PTE log is attached.  ></description> </Issue>
