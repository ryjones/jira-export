<Issue id="15065" key="FAB-2498" number="2498" project="10002" reporter="denyeart" assignee="denyeart" creator="denyeart" type="10004" summary="Panic upon peer startup when state db recovery is needed (CouchDB)" priority="3" resolution="10000" status="6" created="2017-02-27 07:25:23.0" updated="2018-07-20 14:11:49.0" resolutiondate="2017-03-01 12:31:10.0" votes="0" watches="1" workflowId="37614"> <description><! CDATA panic: runtime error: invalid memory address or nil pointer dereference  signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x9d89df   goroutine 1  running : panic(0xb49b20, 0xc4200140c0) 	/opt/go/src/runtime/panic.go:500 +0x1a1 github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/statecouchdb.(*VersionedDB).GetLatestSavePoint(0xc4203b28c0, 0xc42021d2b0, 0x9c6041, 0x7f7821f07398) 	/opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go:405 +0x7f github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr.(*LockBasedTxMgr).GetLastSavepoint(0xc420303f90, 0xbb1140, 0xc42036f500, 0x7f7821f07398) 	/opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr/lockbased_txmgr.go:52 +0x33 github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr.(*LockBasedTxMgr).ShouldRecover(0xc420303f90, 0x3, 0xc4203b2900, 0x7f7821f07398, 0xc4203b2900, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr/lockbased_txmgr.go:112 +0x2f github.com/hyperledger/fabric/core/ledger/kvledger.(*kvLedger).recoverDBs(0xc42035c980, 0xc42035c980, 0xc420303f90) 	/opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/kv_ledger.go:83 +0x1ca github.com/hyperledger/fabric/core/ledger/kvledger.newKVLedger(0xc4203a3a28, 0x4, 0x11df180, 0xc4203c48e0, 0x11de980, 0xc4203b28c0, 0x11dc880, 0xc4203b2900, 0xc42021d4f0, 0x748933, ...) 	/opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/kv_ledger.go:62 +0x1b6 github.com/hyperledger/fabric/core/ledger/kvledger.(*Provider).Open(0xc42000cac0, 0xc4203a3a28, 0x4, 0x4, 0x1216320, 0x0, 0x21891f6b00413ae8) 	/opt/gopath/src/github.com/hyperledger/fabric/core/ledger/kvledger/kv_ledger_provider.go:142 +0x294 github.com/hyperledger/fabric/core/ledger/ledgermgmt.OpenLedger(0xc4203a3a28, 0x4, 0x0, 0x0, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/core/ledger/ledgermgmt/ledger_mgmt.go:95 +0x227 github.com/hyperledger/fabric/core/peer.Initialize(0xc9b218) 	/opt/gopath/src/github.com/hyperledger/fabric/core/peer/peer.go:96 +0x171 github.com/hyperledger/fabric/peer/node.serve(0xc420235220, 0x0, 0x1, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/peer/node/start.go:199 +0x84b github.com/hyperledger/fabric/peer/node.glob..func1(0x11c7500, 0xc420235220, 0x0, 0x1, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/peer/node/start.go:75 +0x3f github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).execute(0x11c7500, 0xc4202351f0, 0x1, 0x1, 0x11c7500, 0xc4202351f0) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:599 +0x234 github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).ExecuteC(0x11c7d80, 0xf, 0xc42015ed78, 0x7) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:689 +0x367 github.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).Execute(0x11c7d80, 0x10, 0xc42015ed78) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:648 +0x2b main.main() 	/opt/gopath/src/github.com/hyperledger/fabric/peer/main.go:111 +0x52d  ></description> </Issue>
