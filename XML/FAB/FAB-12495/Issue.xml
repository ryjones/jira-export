<Issue id="34726" key="FAB-12495" number="12495" project="10002" reporter="dhuseby" creator="dhuseby" type="10004" summary="escape from a container with default docker-compose config" priority="3" resolution="10001" status="6" created="2018-10-16 23:12:14.0" updated="2018-11-28 23:27:14.0" resolutiondate="2018-11-28 23:27:14.0" votes="0" watches="2" workflowId="46135" security="10000"> <description><! CDATA This came in from H1: h2. 1. test environment:  fabric/examples/e2e_cli (release-1.2)  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-704b2fcac0346d82.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=de0e9a11b90ec8fcd90544f211eb114bc8eb5da0&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-704b2fcac0346d82.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 ) h2. 2. poc  After starting the network, go in to cli container. Install docker and use /host/var/run/dcoker.sock to contact with Docker daemon of host  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-b8fe34eb66e5b921.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=52c597baa36eb3bffa5ec226007c1ad9e492bddc&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-b8fe34eb66e5b921.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 )  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-b3d45f825cb6c5ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=34ec283b9d0f6c8db602606f59e88474d3194d9f&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-b3d45f825cb6c5ee.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 )  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-b3d45f825cb6c5ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=34ec283b9d0f6c8db602606f59e88474d3194d9f&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-b3d45f825cb6c5ee.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 )  now we use {{/host/var/run/dcoker.sock}} to contact with Docker daemon of host to start another docker container and mount the root director to the docker  {{docker -H unix:///host/var/run/docker.sock run -itd ubuntu14:04 -v /:/aaa /bin/bash}}  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-54e8394378623d14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=a33593600a49792d1b1c9da69bdc4d57a962e3dd&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-54e8394378623d14.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 )  Goto the new contianer again  {{docker -H unix:///host/var/run/docker.sock exec -it d98 bash}}  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-703b440a291718fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=b1983a66925abf5b86847a053a794e53c416c7ab&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-703b440a291718fe.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 )  Write something to {{/tmp}} in host  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-e54fe8887b34af81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=2660e951383e58ef7e33899c78b80744c3af800f&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-e54fe8887b34af81.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 )  In host,we can see the file  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-dfa5de014a0d88ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=b9405c332045356acbed2e186cfe13383df0698b&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-dfa5de014a0d88ad.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 ) h2. 3. reason  ! image.png ( https://upload-images.jianshu.io/upload_images/5443560-10002ee4077c5af8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240|https://hackerone.com/redirect?signature=df33f618f8dafbaa1b8b9820e5358d6379b69aaa&url=https%3A%2F%2Fupload-images.jianshu.io%2Fupload_images%2F5443560-10002ee4077c5af8.png%3FimageMogr2%2Fauto-orient%2Fstrip%257CimageView2%2F2%2Fw%2F1240 ) h2. Impact  scaping from a container--breaking out of the VM.  ></description> </Issue>
