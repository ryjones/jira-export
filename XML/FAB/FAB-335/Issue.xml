<Issue id="12636" key="FAB-335" number="335" project="10002" reporter="scottz" creator="scottz" type="10004" summary="When 3 of 4 peers are stopped, deploy fails when subsequently start 3 peers together" priority="3" resolution="10000" status="6" created="2016-09-09 20:03:18.0" updated="2018-07-20 14:10:09.0" resolutiondate="2017-04-07 20:06:27.0" votes="0" watches="2" workflowId="36193"> <description><! CDATA Problem Summary  Start 4 peers in a secure docker network and deploy and send invoke(s) to each peer and query to confirm operational. Deploy after stopping 3 of 4 peers. Then start the 3 peers again together. All queries subsequently fail.  Note: Instead, if restart just two of the three stopped peers, with ample delays, then the deploy works and the network generally works (although there are minor problems in that scenario too, such as FAB-334). Note: Reproduced with NULLREQUEST=0 and with  NULLREQUEST=1 and batchsize=1.  This issue is a port to Jira from GitHub hyperledger fabric issue #2313 https://github.com/hyperledger-archives/fabric/issues/2313  How to Reproduce  Originally found using testcase CAT_37_S0S1S2_D_I_R0R1R2_IQ.go, using v0.5 IMAGE=3e0e80a. That testcase has been renamed in current test suite to CAT_408_S0S1S2_D_I_R0R1R2_IQ.go, which is attached for reference.  # Start a new pbft batch network. # Stop VP0 VP1 VP2 # Send request for new deployment to VP3, and receive a transaction ID (70dfc8e6...) # Send Invokes. # Restart the 3 peers all at once. # Send Invokes. # Query. All queries to the new deployment hash always fail. The deploy never worked. Here is my testcase error message: Error extracted from json: res.Error.Message Query failure POST /chaincode returned code =-32003 message=Query failure data=Error when querying chaincode: Error:Failed to launch chaincode spec(Could not get deployment transaction for 70dfc8e6... - LedgerError - ResourceNotFound: ledger: resource not found)   ></description> </Issue>
