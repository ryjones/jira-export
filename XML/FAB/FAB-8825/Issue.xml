<Issue id="28456" key="FAB-8825" number="8825" project="10002" reporter="denyeart" assignee="ales" creator="denyeart" type="10002" summary="TEST PLAN: key-level validation" priority="3" resolution="10000" status="6" created="2018-03-12 22:54:23.0" updated="2018-09-12 07:15:53.0" resolutiondate="2018-09-12 07:15:53.0" votes="0" watches="4" workflowId="35609"> <description><! CDATA Before closing this testplan task, coverage must be reviewed and approved (via upvote or comment) by the epic feature owner and the test leads identified below.  +*Location / Description of*+ docs, APIs, config vars, system configuration (fabric, SDKs, fabric-samples) : *  Google Doc|https://docs.google.com/document/d/1RRtjfTSPO8vdfwep-QpfMckSYdnA-k24WmqsgSIEbOA/edit#heading=h.blytbnfrd23h      +*Unit Test (UT) leader*+:  ~ales  /  ~mne  * core/chaincode coverage: 97.4% of statements * core/common/validation/statebased coverage: 83.7% of statements  * core/chaincode/shim/ext/statebased coverage: 74.0% of statements  Automated unit tests are merged in repo, as go tests or otherwise part of build/verify jenkins jobs. Code coverage tracked in Jenkins:  https://jenkins.hyperledger.org/view/Daily/job/fabric-unit-test-coverage-daily-master-x86_64/      +*Function Test (FVT) leader*+:  ~ales  /  ~mne  A.  Expand unit testcases beyond traditional UT coverage, for the following integration scenarios that otherwise might be done using the ginko framework) - we consider the following extended unit tests: * The ledger support for the validation parameter retrieval is mocked for the unit tests. * Policy evaluation for the key-level validation is mocked for the unit tests. Consider using full cauthdsl policies in addition.  B.  E2E testcases scenarios (FAB-11607). The E2E testcases are stacked on top of one another. They use the CLI as there is no specific SDK support for state-based endorsement. The scenario consists of a setup with two orgs A and B and a sample chaincode (FAB-8824) for state-based endorsement. # Setting an endorsement policy: A invokes a chaincode function that ## creates a KVS key "x" and sets an endorsement policy that requires org A. ## creates a KVS key "y" # Reading an endorsement policy: A invokes a chaincode function that ## reads the endorsement policy for "x" ## reads the endorsement policy for "y" (which does not exist) ## reads the endorsement policy for "z" (key does not exist) # Modify a key's value: ## A invokes a chaincode function that modifies the value of "x" and succeeds ## B invokes a chaincode function that tries to modify the value of "x" and fails because the EP is not satisified  C.  Other functional testing required: N/A     +*System Verification Test (SVT) leader*+:  ~AdnanChoudhury  State-based endorsement is a change to fabric that affects validation and chaincode. We suggest to perform SVT tests that involve these components with a chaincode that sets up key-level validation parameters in a network setup with at least two orgs, preferably more.  FAB-11614 FAB-11615 FAB-11616   ></description> </Issue>
