<Issue id="28881" key="FAB-9153" number="9153" project="10002" reporter="sykesm" creator="sykesm" type="10003" summary="Multiple data races when running TestNewChain" priority="4" resolution="10002" status="6" created="2018-03-26 14:57:28.0" updated="2018-07-20 14:17:34.0" resolutiondate="2018-07-20 14:06:24.0" votes="0" watches="1" workflowId="43105"> <description><! CDATA {code:java} unit-tests_1  | ==================  unit-tests_1  | WARNING: DATA RACE  unit-tests_1  | Write at 0x00c4203ca098 by goroutine 33:  unit-tests_1  |   github.com/hyperledger/fabric/common/ledger/blockledger/ram.(*ramLedger).appendBlock()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/common/ledger/blockledger/ram/impl.go:170 +0x30d  unit-tests_1  |   github.com/hyperledger/fabric/common/ledger/blockledger/ram.(*ramLedger).Append()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/common/ledger/blockledger/ram/impl.go:158 +0x193  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*ChainSupport).Append()  unit-tests_1  |       <autogenerated>:1 +0x82  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*BlockWriter).commitBlock()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_obj_test/blockwriter.go:181 +0x132  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*BlockWriter).WriteBlock.func1()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_obj_test/blockwriter.go:166 +0x9e  unit-tests_1  |  unit-tests_1  | Previous read at 0x00c4203ca098 by goroutine 30:  unit-tests_1  |   github.com/hyperledger/fabric/common/ledger/blockledger/ram.(*ramLedger).Iterator()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/common/ledger/blockledger/ram/impl.go:103 +0xe75  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.TestNewChain.func1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar_test.go:206 +0x146  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.TestNewChain()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar_test.go:222 +0x9eb  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |  unit-tests_1  | Goroutine 33 (running) created at:  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*BlockWriter).WriteBlock()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_obj_test/blockwriter.go:163 +0xc7  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*BlockWriter).WriteConfigBlock()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_obj_test/blockwriter.go:155 +0x30d  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*ChainSupport).WriteConfigBlock()  unit-tests_1  |       <autogenerated>:1 +0x83  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*mockChain).Start.func1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/util_test.go:90 +0x4da  unit-tests_1  |  unit-tests_1  | Goroutine 30 (running) created at:  unit-tests_1  |   testing.(*T).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:789 +0x568  unit-tests_1  |   testing.runTests.func1()  unit-tests_1  |       /opt/go/src/testing/testing.go:1004 +0xa7  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |   testing.runTests()  unit-tests_1  |       /opt/go/src/testing/testing.go:1002 +0x521  unit-tests_1  |   testing.(*M).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:921 +0x206  unit-tests_1  |   main.main()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_testmain.go:116 +0x2f0  unit-tests_1  | =================={code} {code:java} unit-tests_1  | ==================  unit-tests_1  | WARNING: DATA RACE  unit-tests_1  | Write at 0x00c4201e71f8 by goroutine 34:  unit-tests_1  |   github.com/hyperledger/fabric/common/ledger/blockledger/ram.(*ramLedger).appendBlock()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/common/ledger/blockledger/ram/impl.go:170 +0x30d  unit-tests_1  |   github.com/hyperledger/fabric/common/ledger/blockledger/ram.(*ramLedger).Append()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/common/ledger/blockledger/ram/impl.go:158 +0x193  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*ChainSupport).Append()  unit-tests_1  |       <autogenerated>:1 +0x82  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*BlockWriter).commitBlock()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_obj_test/blockwriter.go:181 +0x132  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*BlockWriter).WriteBlock.func1()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_obj_test/blockwriter.go:166 +0x9e  unit-tests_1  |  unit-tests_1  | Previous read at 0x00c4201e71f8 by goroutine 30:  unit-tests_1  |    failed to restore the stack   unit-tests_1  |  unit-tests_1  | Goroutine 34 (running) created at:  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*BlockWriter).WriteBlock()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_obj_test/blockwriter.go:163 +0xc7  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*ChainSupport).WriteBlock()  unit-tests_1  |       <autogenerated>:1 +0x83  unit-tests_1  |   github.com/hyperledger/fabric/orderer/common/multichannel.(*mockChain).Start.func1()  unit-tests_1  |       /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/util_test.go:95 +0x87b  unit-tests_1  |  unit-tests_1  | Goroutine 30 (running) created at:  unit-tests_1  |   testing.(*T).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:789 +0x568  unit-tests_1  |   testing.runTests.func1()  unit-tests_1  |       /opt/go/src/testing/testing.go:1004 +0xa7  unit-tests_1  |   testing.tRunner()  unit-tests_1  |       /opt/go/src/testing/testing.go:746 +0x16c  unit-tests_1  |   testing.runTests()  unit-tests_1  |       /opt/go/src/testing/testing.go:1002 +0x521  unit-tests_1  |   testing.(*M).Run()  unit-tests_1  |       /opt/go/src/testing/testing.go:921 +0x206  unit-tests_1  |   main.main()  unit-tests_1  |       github.com/hyperledger/fabric/orderer/common/multichannel/_test/_testmain.go:116 +0x2f0  unit-tests_1  | =================={code}  ></description> </Issue>
