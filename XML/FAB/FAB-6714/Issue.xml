<Issue id="22732" key="FAB-6714" number="6714" project="10002" reporter="nishi" assignee="latitiah" creator="nishi" type="10004" summary="behave tests using enccc_example chaincode to test encryption failing " priority="2" resolution="10000" status="6" created="2017-10-20 19:51:41.0" updated="2019-03-19 11:13:16.0" resolutiondate="2017-11-01 18:00:26.0" votes="0" watches="2" workflowId="40321"> <description><! CDATA On fabric commit level *e4cb863f253d89ec223f5406f2da7126e6a3b63b*  Encryption tests using behave are failing @GET with the following error message: {code:java} Assertion Failed: Expected response was 123-45-6789; received Error occurred  u'docker exec peer0.org1.example.com /bin/bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/configs/5af7ef2eb5c811e78f0854ee7539463f/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp CORE_PEER_LOCALMSPID=org1.example.com CORE_PEER_ID=peer0.org1.example.com CORE_PEER_ADDRESS=peer0.org1.example.com:7051 peer chaincode query --name mycc --ctor '{\"Args\":  \"ENC\",\"GET\", \"Social-Security-Number\" }' --channelID behavesystest --transient \"{\\\"ENCKEY\\\":\\\"i1jrKDxdmxuGNuonaOQmtlDVGAm9DZ5kCQgX7P1/jQQ=\\\"}\" "' : 2017-10-20 18:57:18.430 UTC  gossip/privdata  0 -> WARN 001 Configuration key peer.gossip.pvtData.transientstoreMaxBlockRetention isn't set, defaulting to 1000 2017-10-20 18:57:18.454 UTC  msp  GetLocalMSP -> DEBU 002 Returning existing local MSP 2017-10-20 18:57:18.454 UTC  msp  GetDefaultSigningIdentity -> DEBU 003 Obtaining default signing identity 2017-10-20 18:57:18.454 UTC  chaincodeCmd  checkChaincodeCmdParams -> INFO 004 Using default escc 2017-10-20 18:57:18.454 UTC  chaincodeCmd  checkChaincodeCmdParams -> INFO 005 Using default vscc 2017-10-20 18:57:18.454 UTC  chaincodeCmd  getChaincodeSpec -> DEBU 006 java chaincode enabled 2017-10-20 18:57:18.455 UTC  msp/identity  Sign -> DEBU 007 Sign: plaintext: 0AB4070A6B08031A0C088E8EA9CF0510...50D51809BD0D9E64090817ECFD7F8D04  2017-10-20 18:57:18.455 UTC  msp/identity  Sign -> DEBU 008 Sign: digest: 64CA5B606916DB092A156532A77C48A01ADD9A52C532CD66792CB4AFE2A213A1  Error: Error endorsing query: rpc error: code = Unknown desc = chaincode error (status: 500, message: encshim.GetState failed, err GetState error, stub.GetState returned nil value for key Social-Security-Number) - <nil> Usage: peer chaincode query  flags   Flags: -C, --channelID string The channel on which this command should be executed (default "testchainid") -c, --ctor string Constructor message for the chaincode in JSON format (default "{}") -x, --hex If true, output the query value byte array in hexadecimal. Incompatible with --raw -n, --name string Name of the chaincode -r, --raw If true, output the query value as raw bytes, otherwise format as a printable string -t, --tid string Name of a custom ID generation algorithm (hashing and decoding) e.g. sha256base64  Global Flags: --cafile string Path to file containing PEM-encoded trusted certificate(s) for the ordering endpoint --logging-level string Default logging level and overrides, see core.yaml for full syntax -o, --orderer string Ordering service endpoint --test.coverprofile string Done (default "coverage.cov") --tls Use TLS when communicating with the orderer endpoint --transient string Transient map of arguments in JSON encoding -v, --version Display current version of fabric peer server   {code} Please find encryption-6439.feature attached.  This could be related to commit *f754f40d3165571cecf5fce43c8a034559983311* Merge "-FAB-5080- Chaincode API Support for PrivateData"   As tests failed on commit level:  *f754f40d3165571cecf5fce43c8a034559983311*  And since encryption tests ran successfully in behave on commit level *5ce16659ee78788f0b65536d3bd8f59e036989c3 (one commit before -FAB-5080-)*  ></description> </Issue>
