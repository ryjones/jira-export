<Action id="60573" issue="40264" author="muralisr" type="comment" created="2019-06-01 17:54:09.0" updateauthor="muralisr" updated="2019-06-01 17:54:09.0"> <body><! CDATA This appears to have started from https://jira.hyperledger.org/browse/FAB-15234. Haven't dug in enough but seems that this assumes all installed chaincodes are legacy formatted ?   If the "*Steps to Reproduce:"* is incorrect in some way and needs to be adjusted for new lifecycle, lets make sure its fixed and stops the user from issuing wrong commands.      ~ales   ~denyeart   ~wlahti   ></body> </Action>
<Action id="60574" issue="40264" author="muralisr" type="comment" created="2019-06-02 00:23:34.0" updateauthor="muralisr" updated="2019-06-02 00:23:34.0"> <body><! CDATA NOT-A-FIX but the following works and gives a hint as to direction of a fix    {code:java} git diff diff --git a/core/common/ccprovider/ccprovider.go b/core/common/ccprovider/ccprovider.go index 85be078ad..c8b13f5e1 100644 --- a/core/common/ccprovider/ccprovider.go +++ b/core/common/ccprovider/ccprovider.go @@ -206,7 +206,7 @@ func (cifs *CCInfoFSImpl) ListInstalledChaincodes(dir string, ls DirEnumerator, ccPackage, err := ccFromPath(ccName, ccVersion, dir) if err != nil { ccproviderLogger.Warning("Failed obtaining chaincode information about", ccName, ccVersion, ":", err) -                       return nil, errors.Wrapf(err, "failed obtaining information about %s, version %s", ccName, ccVersion) +                       continue }  chaincodes = append(chaincodes, chaincode.InstalledChaincode{ {code} Perhaps we need a way of introspecting packages and pick only truly legacy (ie, marshalled ChaincodeDeploymentSpec)    ></body> </Action>
<Action id="60601" issue="40264" author="wlahti" type="comment" body="This is an accidental side effect of our switch to separate install directories for _lifecycle and lscc chaincodes. ListInstalledChaincodesLegacy() in the PackageProvider wasn&apos;t updated to account for this, causing this panic at peer start when an _lifecycle chaincode has already been installed.  " created="2019-06-03 14:48:29.0" updateauthor="wlahti" updated="2019-06-03 14:48:29.0"/>
<Action id="60603" issue="40264" author="wlahti" type="comment" body="https://gerrit.hyperledger.org/r/c/fabric/+/31676 . FYI, Ale already had an integration test CR that restarted a peer which also hit this issue after I rebased it on master. I&apos;ve stacked Ale&apos;s test on top of the fix here. " created="2019-06-03 15:29:40.0" updateauthor="wlahti" updated="2019-06-03 16:04:24.0"/>
<Action id="60607" issue="40264" author="muralisr" type="comment" body="OK. I was not aware of the `separate install directories for _lifecycle and lscc chaincodes. ` work. .. even better." created="2019-06-03 16:12:42.0" updateauthor="muralisr" updated="2019-06-03 16:12:42.0"/>
<Action id="60611" issue="40264" author="muralisr" type="comment" body=" ~wlahti  The CR fixed the issue in my env." created="2019-06-03 17:08:45.0" updateauthor="muralisr" updated="2019-06-03 18:24:12.0"/>
