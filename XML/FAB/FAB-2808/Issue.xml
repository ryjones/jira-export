<Issue id="15381" key="FAB-2808" number="2808" project="10002" reporter="nishi" assignee="denyeart" creator="nishi" type="10004" summary="getHistoryForMarble called as &apos;invoke&apos; operation passes the test with incorrect results" priority="3" resolution="10000" status="6" created="2017-03-16 19:25:26.0" updated="2018-07-20 14:12:01.0" resolutiondate="2017-06-07 16:45:28.0" votes="0" watches="2" workflowId="37799"> <description><! CDATA Commit level: *14055d70d9593e99295c7846076fc9dcfb1e052e* In e2e test scenario using chaincodeAPIDriver, chaincode calls executed on marble1 before getHistory: init, delete  call that incorrectly executed in shell script as CLI: peer chaincode invoke -o $ORDERER_IP:7050 -C $CHANNEL_NAME$i -n $CHAINCODE_NAME$ch -c '{"Args": "getHistoryForMarble","marble1" }' *instead of* peer chaincode query -o $ORDERER_IP:7050 -C $CHANNEL_NAME$i -n $CHAINCODE_NAME$ch -c '{"Args": "getHistoryForMarble","marble1" }'  Had the e2e scenario pass, but the results from getHistoryForMarble were incorrect with 2 txID's for (assuming they were for two operations init, delete), txID for was repeated with same exact value in the output.  Sample Output file after "invoke" on "getHistoryForMarble": {code} 2017-03-16 14:05:18.702 UTC  chaincodeCmd  chaincodeInvokeOrQuery -> INFO 008 Invoke result: version:1 response:<status:200 message:"OK" payload:" {\"TxId\":\"a6fab9381bb33c163ec6ba5cecc48a1ca38b139c8f8b008932e48a6a86c7646f\", \"Value\":{\"docType\":\"marble\",\"name\":\"marble3\",\"color\":\"blue\",\"size\":45,\"owner\":\"tom\"}} " > payload:"\n \250\004\316\331\222\307\177x\021\301\034z\242\330\347\0253F^\007\025 \333\203eM\246\323\263\350aU\022\302\001\n\024\001\004lccc\001\005mycc0\004\001\001\001\001\000\000\032\251\001\010\310\001\032\243\001 {\"TxId\":\"a6fab9381bb33c163ec6ba5cecc48a1ca38b139c8f8b008932e48a6a86c7646f\", \"Value\":{\"docType\":\"marble\",\"name\":\"marble3\",\"color\":\"blue\",\"size\":45,\"owner\":\"tom\"}} " endorsement:<endorser:"\n\007Org0MSP\022\210\004-----BEGIN -----\nMIIBYzCCAQmgAwIBAwICA+gwCgYIKoZIzj0EAwIwEzERMA8GA1UEAwwIcGVlck9y\nZzAwHhcNMTcwMjIwMTkwNjExWhcNMTgwMjIwMTkwNjExWjAQMQ4wDAYDVQQDDAVw\nZWVyMTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABI9/7z3nMORUeS3rZ+F93ymD\nR2jiB6Wm+QSoSz/uQuRavnoksgU6peF5rBMfebk/PfNoVjdR4egCqAHBHIpp7Iuj\nUDBOMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFJpxVAXpMAEOHtbNCwvL1m/ku9gt\nMB8GA1UdIwQYMBaAFFQzuQR1RZP/Qn/BNDtGSa8n4eN/MAoGCCqGSM49BAMCA0gA\nMEUCIQDsQ6lmuLdKmMgnN5+9YjlpCRQEJCoaG3uxRHhrAecZngIgQZlwnvwka+TM\ngF/yC3r2MeELK9ocw8c22DAe6x71RT4=\n-----END -----\n" signature:"0E\002!\000\216\2253\330\2370(h\346 e\344;3\010\2235\250\275\367*\001\364\340\nfh\n\3320\252\374\002 (\200\344\203{\002*!\273pD\000\013\323B\302\021\003}\033r\r\316|\234K\\,'(\330\037" >  2017-03-16 14:05:18.703 UTC  main  main -> INFO 009 Exiting..... {code}   ></description> </Issue>
