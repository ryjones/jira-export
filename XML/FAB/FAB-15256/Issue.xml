<Issue id="39451" key="FAB-15256" number="15256" project="10002" reporter="czar0" creator="czar0" type="10004" summary="error trying to connect to local peer: userChaincodeStreamGetter -&gt; ERRO 003 context deadline exceeded" priority="1" resolution="10202" status="6" created="2019-04-23 13:59:20.0" updated="2019-06-05 13:40:17.0" resolutiondate="2019-06-05 13:40:17.0" votes="0" watches="3" workflowId="52330"> <description><! CDATA Environment: * macOS Mojave 10.14.4 * Docker Desktop 2.0.0.3 - Engine 18.09.2 * Kubernetes v1.10.11 using `docker-for-desktop` context ({{kubectl config current-context)}} * Using official stable helm charts configuration with a few changes in order to be able to deploy Fabric v1.4     Hi, I am deploying a Fabric network on Kubernetes (in Docker Desktop) using the official stable helm charts:  hlf-peer|https://github.com/helm/charts/tree/master/stable/hlf-peer   hlf-couchdb|https://github.com/helm/charts/tree/master/stable/hlf-couchdb   hlf-ca|https://github.com/helm/charts/tree/master/stable/hlf-ca   hlf-ord|https://github.com/helm/charts/tree/master/stable/hlf-ord   All the steps including registration/enrollment of users through the CA using the org admin; create/fetch/join channel go perfectly through, but *the instantiation of the chaincode fails with the error reported in the summary*.    Log of the chaincode container attached to the peer:  {{2019-04-23 10:30:16.848 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 052 2019-04-23 10:30:16.847 UTC  shim  setupChaincodeLogging -> INFO 001 Chaincode (build level: 1.4.1) starting up ...}} {{2019-04-23 10:30:16.848 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 053 2019-04-23 10:30:16.847 UTC  shim  userChaincodeStreamGetter -> DEBU 002 Peer address: org1peer1-hlf-peer:7052}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 054 Error starting Sample chaincode: error trying to connect to local peer: context deadline exceeded2019-04-23 10:30:19.848 UTC  shim  userChaincodeStreamGetter -> ERRO 003 context deadline exceeded}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 055 error trying to connect to local peer}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 056 github.com/hyperledger/fabric/core/chaincode/shim.userChaincodeStreamGetter}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 057 /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/shim/chaincode.go:112}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 058 github.com/hyperledger/fabric/core/chaincode/shim.Start}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 059 /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/shim/chaincode.go:151}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 05a main.main}} {{2019-04-23 10:30:19.849 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 05b /chaincode/input/src/chaincode/mychaincode/main.go:399}} {{2019-04-23 10:30:19.850 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 05c runtime.main}} {{2019-04-23 10:30:19.850 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 05d /opt/go/src/runtime/proc.go:201}} {{2019-04-23 10:30:19.850 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 05e runtime.goexit}} {{2019-04-23 10:30:19.850 UTC  peer.chaincode.nid1-org1peer1-mychaincode-1.0  func2 -> INFO 05f /opt/go/src/runtime/asm_amd64.s:1333}} {{2019-04-23 10:30:20.132 UTC  dockercontroller  func2 -> INFO 060 Container nid1-org1peer1-mychaincode-1.0 has closed its IO channel}} {{2019-04-23 10:30:20.277 UTC  endorser  callChaincode -> INFO 061  mychannel  f425dbb8  Exit chaincode: name:"lscc" (54274ms)}} {{2019-04-23 10:30:20.277 UTC  endorser  SimulateProposal -> ERRO 062  mychannel  f425dbb8  failed to invoke chaincode name:"lscc" , error: container exited with 0}} {{github.com/hyperledger/fabric/core/chaincode.(*RuntimeLauncher).Launch.func1}} {  { /opt/gopath/src/github.com/hyperledger/fabric/core/chaincode/runtime_launcher.go:63}  } {{runtime.goexit}} {  { /opt/go/src/runtime/asm_amd64.s:1333}  } {{chaincode registration failed}}     {{+Log on the fabric-tool CLI:+}} {{2019-04-23 10:29:26.070 UTC  msp.identity  Sign -> DEBU 0ac Sign: digest: 9E15E09E02EBED2F9D9DEB1F8F556B46F16D6C3D2D796560A2E9DA6EF746E90E}} {{Error: could not assemble transaction, err proposal response was not successful, error code 500, msg chaincode registration failed: container exited with 0}} {{command terminated with exit code 1}}     The orderer is reachable from the peer (tested using telnet).     I can see the deployed chaincode image has been built. {{nid1-org1peer1-mychaincode-1.0-0495160cf7dc458bb21980ff56b0a3383b4426e923a4180af5b7f746f1bcbc39 latest 32c4b74215ce 29 seconds ago 162MB}}  I am attaching the configtx file and the configmap used to load env variables on the peer.  +Note: I am only using Org1MSP.+  Other (possibly) useful logs  Peer channel list: {{kubectl exec --namespace $namespace $peer_pod – bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/admin_msp peer channel list"}} {{2019-04-23 11:18:21.117 UTC  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initialized}} {{Channels peers has joined:}} {{mychannel}}|     Peer channel info: {{kubectl exec --namespace $namespace $peer_pod – bash -c "CORE_PEER_MSPCONFIGPATH=/var/hyperledger/admin_msp peer channel getinfo -c $channel_name"}} {{2019-04-23 11:14:08.734 UTC  channelCmd  InitCmdFactory -> INFO 001 Endorser and orderer connections initialized}} Blockchain info:  {"height":1,"currentBlockHash":"quqIAAOOkC/BuMeibGNujlq822y08nJ4/HvDtQ0nZq0="}     PS: If it can be any relevant to this issue the peer keeps logging this delivery block error: {{2019-04-23 11:18:21.124 UTC  comm.grpc.server  1 -> INFO 0b2 unary call completed grpc.service=protos.Endorser grpc.method=ProcessProposal grpc.peer_address=10.1.0.1:56708 grpc.code=OK grpc.call_duration=5.0801ms}} {{2019-04-23 11:18:24.085 UTC  ConnProducer  DisableEndpoint -> WARN 0b3 Only 1 endpoint remained, will not black-list it}} 2019-04-23 11:18:24.094 UTC  blocksProvider  DeliverBlocks -> ERRO 0b4  mychannel  Got error &\{FORBIDDEN} {{2019-04-23 11:18:34.096 UTC  ConnProducer  DisableEndpoint -> WARN 0b5 Only 1 endpoint remained, will not black-list it}} 2019-04-23 11:18:34.112 UTC  blocksProvider  DeliverBlocks -> ERRO 0b6  mychannel  Got error &\{FORBIDDEN} {{2019-04-23 11:18:44.079 UTC  ConnProducer  DisableEndpoint -> WARN 0b7 Only 1 endpoint remained, will not black-list it}} 2019-04-23 11:18:44.088 UTC  blocksProvider  DeliverBlocks -> ERRO 0b8  mychannel  Got error &\{FORBIDDEN} {{2019-04-23 11:18:44.088 UTC  blocksProvider  DeliverBlocks -> ERRO 0b9  mychannel  Wrong statuses threshold passed, stopping block provider}}      ></description> </Issue>
