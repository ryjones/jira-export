<Issue id="31889" key="FAB-11155" number="11155" project="10002" reporter="rhegde" creator="rhegde" type="10001" summary="Provisioning Read-Only User for Couch Database" priority="3" resolution="10001" status="6" created="2018-07-13 21:03:13.0" updated="2020-01-22 22:32:44.0" resolutiondate="2020-01-22 22:32:44.0" votes="0" watches="3" workflowId="35952"> <description><! CDATA ***Requirement* Those opting couch database as world state ledger can use the same for running rich queries for production support. This could include Operations or Support user. This avoid user to go through chaincode log which most of the time would be in ERROR mode in Production or Pre-Production.  Server Admin credential cannot be shared for such purpose and should be used exclusively by the respective fabric-peer. This is already implemented as part of -FAB-10048-.  This JIRA is filed to further extended the current functionality to provision Read Only User.     This can be achieved by allowing Server Admin creates a couch database user (_users database) and add following JSON {code:java} {  "name": "readonlyuser_username",  "password": "readonlyuser_password",  "roles":  "channel1_member" ,  "type": "user" }{code}    2.  Same read only user name can be added to \{db}/_security object to the member list  for example - consider the database (channel name) = channel1 {code:java} '{"admins": { "names":   , "roles":    }, "members": { "names":   , "roles":  "channel1_member"  } }'{code}   OR  (haven't tried the below option) {code:java} '{"admins": { "names":   , "roles":    }, "members": { "names":  "readonlyuser_username" , "roles":    } }'{code}      3. Adding a validate function that allows write only to _admin {code:java} "validate_doc_update": "function(newDoc, oldDoc, userCtx, secObj) { if (userCtx.roles.indexOf('_admin') == -1) { throw({forbidden: 'Document can be updated only by server admin user.'});}}" }'{code}    FAB-1308 has a similar Point 3 requirement - this can be further restricted to use userCtx.names as validation logic.  ></description> </Issue>
