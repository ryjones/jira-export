<Action id="51437" issue="34074" author="harsha544" type="comment" created="2018-10-01 15:33:05.0" updateauthor="harsha544" updated="2018-10-01 15:33:05.0"> <body><! CDATA Based on suggestions from Manish, enabled error printing at lines  https://github.com/hyperledger/fabric/blob/master/core/ledger/kvledger/txmgmt/privacyenabledstate/test_exports.go#L51 {color:#444444}Â {color}   https://github.com/hyperledger/fabric/blob/master/core/ledger/kvledger/txmgmt/privacyenabledstate/test_exports.go#L116   Will be updating results here.  ></body> </Action>
<Action id="51466" issue="34074" author="harsha544" type="comment" created="2018-10-01 20:06:58.0" updateauthor="harsha544" updated="2018-10-01 20:06:58.0"> <body><! CDATA +{color:#0747a6}*UT_FAILURE*{color}+  {color:#333333} {{~ ~}}{color}{{~{color:#000080}33munit-tests_1{color}{color:#333333} | {color}{color:#000080}0m{color}{color:#333333} ### Hello from line {color}{color:#008080}53{color}{color:#333333}!!! ###  {color}{color:#000080}33munit-tests_1{color}{color:#333333} | {color}{color:#000080}0m{color}{color:#333333} <nil>  {color}{color:#000080}33munit-tests_1{color}{color:#333333} | {color}{color:#000080}0m{color}{color:#333333}  {color}{color:#000080}33m2018-10-01{color} {color:#008080}18{color}{color:#333333}:58:33.045 UTC  {color}{color:#000080}couchdb{color}{color:#333333}  handleRequest -> WARN {color}{color:#008080}001{color}{color:#333333} {color}{color:#000080}0m{color}{color:#333333} Retrying couchdb request in {color}{color:#008080}125{color}{color:#333333}ms. Attempt:1 Error:Get http://couchdb:5984/: dial tcp {color}{color:#008080}172.17{color}{color:#333333}.0.2:5984: connect: connection refused  {color}{color:#000080}33munit-tests_1{color}{color:#333333} | {color}{color:#000080}0m{color}{color:#333333}  {color}{color:#000080}33m2018-10-01{color} {color:#008080}18{color}{color:#333333}:58:33.171 UTC  {color}{color:#000080}couchdb{color}{color:#333333}  handleRequest -> WARN {color}{color:#008080}002{color}{color:#333333} {color}{color:#000080}0m{color}{color:#333333} Retrying couchdb request in {color}{color:#008080}250{color}{color:#333333}ms. Attempt:2 Error:Get http://couchdb:5984/: dial tcp {color}{color:#008080}172.17{color}{color:#333333}.0.2:5984: connect: connection refused  {color}{color:#000080}33munit-tests_1{color}{color:#333333} | {color}{color:#000080}0m{color}{color:#333333}  {color}{color:#000080}33m2018-10-{color}{color:#333333} {color}{color:#000080}33munit-tests_1{color}{color:#333333} | {color}{color:#000080}0m{color}{color:#333333}  {color}{color:#000080}33m2018-10-01{color} {color:#008080}19{color}{color:#333333}:00:40.929 UTC  {color}{color:#000080}couchdb{color}{color:#333333}  handleRequest -> WARN {color}{color:#008080}00{color}{color:#333333}b {color}{color:#000080}0m{color}{color:#333333} Retrying couchdb request in {color}{color:#008080}2{color}{color:#333333}m8s. Attempt:11 Error:Get http://couchdb:5984/: dial tcp {color}{color:#008080}172.17{color}{color:#333333}.0.2:5984: connect: connection refused  {color}{color:#000080}33munit-tests_1{color}{color:#333333} | {color}{color:#000080}0m{color}{color:#333333} ### Hello from line {color}{color:#008080}120{color}{color:#333333}!!! ###  {color:#0747a6}+*COUCHDB_LOG*+{color}{color}~}}  {{~{color:#333333} {{color:#333333}"log"{color}:{color:#dd1144}"grep: /opt/couchdb/etc/local.d/*.ini: No such file or directory\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.944164608Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}"****************************************************\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.9456589Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}"WARNING: CouchDB is running in Admin Party mode.\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945677881Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" This will allow anyone with access to the\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945685221Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" CouchDB port to access your database. In\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945691694Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" Docker's default configuration, this is\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945697862Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" effectively any other container on the same\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945704083Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" system.\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945710449Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" Use \"-e COUCHDB_USER=admin -e COUCHDB_PASSWORD=password\"\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945716777Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" to set it in \"docker run\".\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.94572358Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}"****************************************************\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:18.945730084Z"{color}} {{color:#333333}"log"{color}:{color:#dd1144}" info  2018-10-01T19:01:20.395789Z nonode@nohost \u003c0.7.0\u003e -------- Application couch_log started on node nonode@nohost\n"{color},{color:#333333}"stream"{color}:{color:#dd1144}"stderr"{color},{color:#333333}"time"{color}:{color:#dd1144}"2018-10-01T19:01:20.396176627Z"{color}}{color}~}}  By the looks  {color:#444444}Multiple retries to connect to couchdb ends atÂ {color}{color:#444444}`{color}{color:#444444}{{19:00:40}}{color}{color:#444444}`{color} {color:#444444}where-as couchdb containers starts logging atÂ {color}{color:#444444}`{color}{color:#444444}{{19:01:18}}{color}  ></body> </Action>
<Action id="51604" issue="34074" author="harsha544" type="comment" created="2018-10-03 02:09:10.0" updateauthor="harsha544" updated="2018-10-03 02:09:10.0"> <body><! CDATA Post working with Chris Elder, and as suspected earlier, here's the conclusion *unittest_unit-tests_1* container cannot reach to *{color:#444444}couchdb{color}* container within given "retries" and thus FAILS for given test packages *privacyenabledstate,* *pvtstatepurgemgmt,* as well as *statecouchdb* . The workaround is to increase given set of retries, thus above mentioned UT passes.  This is also in line withÂ  FAB-12272Â  where-in BYFN test case for couchdb is failing.  Also need to take a look at set of changes that would be required inorder to makeÂ FAB-12272 working.  ></body> </Action>
<Action id="51606" issue="34074" author="harsha544" type="comment" body=" https://gerrit.hyperledger.org/r/26736 " created="2018-10-03 02:17:22.0" updateauthor="harsha544" updated="2018-10-03 02:17:22.0"/>
<Action id="51624" issue="34074" author="harsha544" type="comment" body=" https://gerrit.hyperledger.org/r/#/c/26740/  â€“ release-1.3" created="2018-10-03 14:20:08.0" updateauthor="harsha544" updated="2018-10-03 14:20:08.0"/>
