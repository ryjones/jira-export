<Action id="18717" issue="12548" author="yuki-kon" type="comment" created="2016-08-30 15:11:10.0" updateauthor="yuki-kon" updated="2016-08-30 15:11:10.0"> <body><! CDATA I wrote a sample code for Node.js application to show usage of the hfc API. If anyone familiar with hfc reads this comment, could you check the code? Also, where is the read-me document to commit this sample?  ----------------------------------------------------------------------------------------- var hfc = require('/opt/gopath/src/github.com/hyperledger/fabric/sdk/node'); //var hfc = require('hfc'); // *** NPM package dosen't work well with the least Fabric ? var chain; var chaincodeID; var chainuser;  chain = hfc.newChain("targetChain"); chain.setKeyValStore( hfc.newFileKeyValStore('/tmp/keyValStore') ); chain.setMemberServicesUrl("grpc://localhost:7054"); chain.addPeer("grpc://localhost:7051");  // *** set Registrar *** // enloll "WebAppAdmin" , who is already registered in "membersrvc.yaml" console.log("setting registrar ..."); chain.enroll("WebAppAdmin", "DJY27pEnl16d", function (err, webAppAdmin) { //console.log("Enroll %s",webAppAdmin); if (err) return console.log("ERROR: %s",err); chain.setRegistrar(webAppAdmin);  // *** Register and Enroll User *** // register and enroll a new user "chainuser" console.log("enrolling user ..."); var registrationRequest = { enrollmentID: "chainuser", roles: 1, affiliation: "bank_a", registrar: null };  chain.registerAndEnroll(registrationRequest , function (err, user) { //console.log("RegisterAndEnroll %s", user); if (err) return console.log("ERROR: %s",err); chainuser = user;  // *** Deploy Chaincode *** console.log("deploying chaincode ..."); var deployRequest = { fcn: "init", args:   "a", "100", "b", "200" , chaincodePath: "github.com/chaincode_example02" };  var deployTx = chainuser.deploy(deployRequest);  deployTx.on('submitted', function(results) { console.log("submitted deploy: %j",results); }); deployTx.on('complete', function(results) { console.log("completed deploy: %j",results); chaincodeID = results.chaincodeID; console.log("chaincodeID:" + chaincodeID);  // *** Invoke Chaincode *** console.log("invoke chaincode ..."); var invokeRequest = { chaincodeID: chaincodeID, fcn: "invoke", args:  "a", "b", "10"  }; var invokeTx = chainuser.invoke(invokeRequest);  invokeTx.on('submitted', function(results) { console.log("submitted invoke: %j",results); }); invokeTx.on('complete', function(results) { console.log("completed invoke: %j",results);  // *** Query Chaincode *** console.log("query chaincode ..."); var queryRequest = { chaincodeID: chaincodeID, fcn: "query", args:  "a"  };  var queryTx = chainuser.query(queryRequest);  queryTx.on('submitted', function(results) { console.log("submitted query: %j",results); }); queryTx.on('complete', function(results) { console.log("completed query: %j",results); }); queryTx.on('error', function(err) { console.log("error on query: %j",err); });  });  invokeTx.on('error', function(err) { console.log("error on invoke: %j",err); }); }); deployTx.on('error', function(err) { console.log("error on deploy: %j",err); }); }); });   ></body> </Action>
