<Action id="40474" issue="27884" author="harrisob@us.ibm.com" type="comment" body="Do we have to recreate the configtx artifacts also ?" created="2018-02-21 01:57:27.0" updateauthor="harrisob@us.ibm.com" updated="2018-02-21 01:57:27.0"/>
<Action id="40479" issue="27884" author="ratnakar" type="comment" created="2018-02-21 03:40:26.0" updateauthor="ratnakar" updated="2018-02-21 03:54:20.0"> <body><! CDATA Yes  ~harrisob@us.ibm.com This needs new msps to be generated aswell  channel artifacts  I ran through all the certs and following certs all are expired today. {code} ./test/fixtures/channel/crypto-config/ordererOrganizations/example.com/msp/tlscacerts/example.com-tls-cert.pem ./test/fixtures/channel/crypto-config/ordererOrganizations/example.com/msp/tlscacerts/org1.example.com-tls-cert.pem ./test/fixtures/channel/crypto-config/ordererOrganizations/example.com/msp/tlscacerts/org2.example.com-tls-cert.pem ./test/fixtures/channel/crypto-config/ordererOrganizations/example.com/msp/cacerts/example.com-tls-cert.pem ./test/fixtures/channel/crypto-config/ordererOrganizations/example.com/msp/cacerts/org1.example.com-tls-cert.pem ./test/fixtures/channel/crypto-config/ordererOrganizations/example.com/msp/cacerts/org2.example.com-tls-cert.pem ./test/fixtures/channel/crypto-config/peerOrganizations/org1.example.com/msp/cacerts/org1.example.com-tls-cert.pem ./test/fixtures/channel/crypto-config/peerOrganizations/org1.example.com/msp/cacerts/org2.example.com-tls-cert.pem  Validity Not Before: Feb 20 19:06:10 2017 GMT Not After : Feb 20 19:06:10 2018 GMT {code}  ></body> </Action>
<Action id="40485" issue="27884" author="denyeart" type="comment" created="2018-02-21 11:10:40.0" updateauthor="denyeart" updated="2018-02-21 11:10:40.0"> <body><! CDATA  ~Ratnakar  Did you assign yourself on purpose?  It would be good to use certificates with expiry longer than 1 year.   ~adc  could you help update these like you did for other certs recently?  ></body> </Action>
<Action id="40489" issue="27884" author="ratnakar" type="comment" created="2018-02-21 12:45:37.0" updateauthor="ratnakar" updated="2018-02-21 12:45:37.0"> <body><! CDATA Yes  ~denyeart . I was under impression that the changes would be very minor and re-generating the certs will solve the issue. However the certs structure has changed with recent cryptogen tool, hence several tests were failing. Here are the changes that are in progress https://gerrit.hyperledger.org/r/#/c/18127/ If  ~adc  could generate the certs with the old structure then we don't need to fix any tests and docs.  ></body> </Action>
<Action id="40493" issue="27884" author="angelo.decaro" type="comment" body="So, a way to generate the certificates using the old structure would be to use and old version of cryptogen. I guess, it is better to move to the new version, no?" created="2018-02-21 13:40:05.0" updateauthor="angelo.decaro" updated="2018-02-21 13:40:05.0"/>
<Action id="40495" issue="27884" author="angelo.decaro" type="comment" body="So, it is just the tls certificates that are expired. How are they used? Where are the corresponding secret keys?" created="2018-02-21 13:58:18.0" updateauthor="angelo.decaro" updated="2018-02-21 13:58:18.0"/>
<Action id="40497" issue="27884" author="angelo.decaro" type="comment" body=" ~Ratnakar ,  ~denyeart , the expired certificates are all self-signed certificates. A quick fix is to invoke cryptogen on the same configuration file. Then, replace the expired certificates with freshly generated certificates. This should work. " created="2018-02-21 14:19:59.0" updateauthor="angelo.decaro" updated="2018-02-21 14:19:59.0"/>
<Action id="40498" issue="27884" author="mastersingh24" type="comment" body="this is an easy fix ... we need to do it.  frankly we should probably just regenerate the artifacts for each release" created="2018-02-21 14:38:12.0" updateauthor="mastersingh24" updated="2018-02-21 14:38:12.0"/>
<Action id="40502" issue="27884" author="angelo.decaro" type="comment" body="I would add also the generation of certificates on the fly for the MSP tests as well." created="2018-02-21 14:59:41.0" updateauthor="angelo.decaro" updated="2018-02-21 14:59:41.0"/>
<Action id="40522" issue="27884" author="ratnakar" type="comment" created="2018-02-21 16:48:30.0" updateauthor="ratnakar" updated="2018-02-21 16:48:30.0"> <body><! CDATA As per   ~angelo.decaro  suggestion , I have used the self signed ca tls certs generated from e2e_cli sample and replaced them here. However while generating the channel artifacts like channel transaction. I do see some issues.  {code} $CONFIGTXGEN -profile TwoOrgsChannel -outputCreateChannelTx mychannel.tx -channelID mychannel 2018-02-21 11:45:48.646 EST  common/tools/configtxgen  main -> INFO 001 Loading configuration 2018-02-21 11:45:48.651 EST  common/tools/configtxgen  doOutputChannelCreateTx -> INFO 002 Generating new channel configtx 2018-02-21 11:45:48.669 EST  common/tools/configtxgen  main -> CRIT 003 Error on outputChannelCreateTx: config update generation failure: could not parse application to application group: setting up the MSP manager failed: the supplied identity is not valid: x509: certificate signed by unknown authority {code}  ></body> </Action>
<Action id="40525" issue="27884" author="ratnakar" type="comment" created="2018-02-21 16:59:57.0" updateauthor="ratnakar" updated="2018-02-21 16:59:57.0"> <body><! CDATA Also I see orderer bootstrap failsÂ   {code} 2018-02-21 16:49:41.073 UTC  orderer/commmon/multichannel  newLedgerResources -> CRIT 056 Error creating channelconfig bundle: initializing channelconfig failed: could not create channel Consortiums sub-group config: setting up the MSP manager failed: the supplied identity is not valid: x509: certificate signed by unknown authority panic: Error creating channelconfig bundle: initializing channelconfig failed: could not create channel Consortiums sub-group config: setting up the MSP manager failed: the supplied identity is not valid: x509: certificate signed by unknown authority  goroutine 1  running : github.com/hyperledger/fabric/vendor/github.com/op/go-logging.(*Logger).Panicf(0xc420248570, 0xd1538c, 0x27, 0xc4203579f0, 0x1, 0x1) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/op/go-logging/logger.go:194 +0x134 github.com/hyperledger/fabric/orderer/common/multichannel.(*Registrar).newLedgerResources(0xc420219e30, 0xc42043b470, 0xc42043b470) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar.go:253 +0x391 github.com/hyperledger/fabric/orderer/common/multichannel.NewRegistrar(0x1392280, 0xc42015e000, 0xc42043b0b0, 0x138ed00, 0x13f2da0, 0xc4201388f8, 0x1, 0x1, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar.go:144 +0x352 github.com/hyperledger/fabric/orderer/common/server.initializeMultichannelRegistrar(0xc4202aca00, 0x138ed00, 0x13f2da0, 0xc4201388f8, 0x1, 0x1, 0xc4204210c0) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:262 +0x277 github.com/hyperledger/fabric/orderer/common/server.Start(0xcf98fc, 0x5, 0xc4202aca00) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:103 +0x24c github.com/hyperledger/fabric/orderer/common/server.Main() 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:82 +0x20f main.main() 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/main.go:15 +0x20 {code}   ></body> </Action>
<Action id="40531" issue="27884" author="denyeart" type="comment" body="https://gerrit.hyperledger.org/r/#/c/18165" created="2018-02-21 19:15:30.0" updateauthor="denyeart" updated="2018-02-21 19:15:30.0"/>
<Action id="40532" issue="27884" author="angelo.decaro" type="comment" created="2018-02-21 19:27:06.0" updateauthor="angelo.decaro" updated="2018-02-21 19:27:06.0"> <body><! CDATA The issue was related to the expiration of certain TLS certificates. I have replaced them by fresh certificates generated with cryptogen. I have replaced only the TLS certificates and not the entire MSP folders because they are self-signed. After that I have regenerated the genesis block (recall that it contains a copy of all certificates). And that was it. Tests passed.   Now, because I had the impression that those TLS certificates were useless, I have performed the following sanity check: I have removed the TLS certs, regenerated the genesis block and executed the tests again (restarting docker-compose, as well). The result is that all the tests passed nevertheless :)  ></body> </Action>
<Action id="40545" issue="27884" author="harrisob@us.ibm.com" type="comment" created="2018-02-21 21:58:50.0" updateauthor="harrisob@us.ibm.com" updated="2018-02-21 21:58:50.0"> <body><! CDATA Fixed on 1.0 release also https://gerrit.hyperledger.org/r/#/c/18177/  ></body> </Action>
<Action id="56086" issue="27884" author="knagware9" type="comment" created="2019-01-23 09:39:46.0" updateauthor="knagware9" updated="2019-01-23 09:39:46.0"> <body><! CDATA I am getting similar issue on fabric 1.4 , please check.  019-01-23 09:33:32.479 UTC  orderer.commmon.multichannel  newLedgerResources -> PANI 0fc Error creating channelconfig bundle: initializing channelconfig failed: could not create channel Orderer sub-group config: setting up the MSP manager failed: the supplied identity is not valid: x509: certificate signed by unknown authority (possibly because of "x509: ECDSA verification failure" while trying to verify candidate authority certificate "ca.example.com") panic: Error creating channelconfig bundle: initializing channelconfig failed: could not create channel Orderer sub-group config: setting up the MSP manager failed: the supplied identity is not valid: x509: certificate signed by unknown authority (possibly because of "x509: ECDSA verification failure" while trying to verify candidate authority certificate "ca.example.com")  goroutine 1  running : github.com/hyperledger/fabric/vendor/go.uber.org/zap/zapcore.(*CheckedEntry).Write(0xc000524000, 0x0, 0x0, 0x0) /opt/gopath/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/zapcore/entry.go:229 +0x515 github.com/hyperledger/fabric/vendor/go.uber.org/zap.(*SugaredLogger).log(0xc00000e078, 0x4, 0xf6f983, 0x27, 0xc00033f808, 0x1, 0x1, 0x0, 0x0, 0x0) /opt/gopath/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/sugar.go:234 +0xf6 github.com/hyperledger/fabric/vendor/go.uber.org/zap.(*SugaredLogger).Panicf(0xc00000e078, 0xf6f983, 0x27, 0xc00033f808, 0x1, 0x1) /opt/gopath/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/sugar.go:159 +0x79 github.com/hyperledger/fabric/common/flogging.(*FabricLogger).Panicf(0xc00000e080, 0xf6f983, 0x27, 0xc00033f808, 0x1, 0x1) /opt/gopath/src/github.com/hyperledger/fabric/common/flogging/zap.go:74 +0x60 github.com/hyperledger/fabric/orderer/common/multichannel.(*Registrar).newLedgerResources(0xc0004ea360, 0xc0002c1450, 0xc0002c1450) /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar.go:260 +0x2d7 github.com/hyperledger/fabric/orderer/common/multichannel.(*Registrar).Initialize(0xc0004ea360, 0xc00052af90) /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar.go:147 +0x242 github.com/hyperledger/fabric/orderer/common/server.initializeMultichannelRegistrar(0xc000141880, 0xc0004141f0, 0x0, 0xc0004ea1b0, 0x19b4420, 0xc0004143b0, 0x2, 0x2, 0xc0004143c0, 0x2, ...) /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:414 +0x2ec github.com/hyperledger/fabric/orderer/common/server.Start(0xf4dfc0, 0x5, 0xc000518000) /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:142 +0x52d github.com/hyperledger/fabric/orderer/common/server.Main() /opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:87 +0x1ce main.main() /opt/gopath/src/github.com/hyperledger/fabric/orderer/main.go:15 +0x20  ></body> </Action>
<Action id="59558" issue="27884" author="pankajcheema" type="comment" created="2019-04-29 07:19:39.0" updateauthor="pankajcheema" updated="2019-04-29 07:19:39.0"> <body><! CDATA  ~knagware9  I am facing the same issue in 1.4   ></body> </Action>
<Action id="59559" issue="27884" author="pankajcheema" type="comment" created="2019-04-29 07:24:40.0" updateauthor="pankajcheema" updated="2019-04-29 07:25:19.0"> <body><! CDATA 2019-04-29 07:04:02.904 UTC  localconfig  completeInitialization -> INFO 001 Kafka.Version unset, setting to 0.10.2.0 2019-04-29 07:04:02.916 UTC  orderer.common.server  prettyPrintStruct -> INFO 002 Orderer config values: 	General.LedgerType = "file" 	General.ListenAddress = "0.0.0.0" 	General.ListenPort = 7050 	General.TLS.Enabled = false 	General.TLS.PrivateKey = "/etc/hyperledger/fabric/tls/server.key" 	General.TLS.Certificate = "/etc/hyperledger/fabric/tls/server.crt" 	General.TLS.RootCAs =  /etc/hyperledger/fabric/tls/ca.crt  	General.TLS.ClientAuthRequired = false 	General.TLS.ClientRootCAs =    	General.Cluster.RootCAs =  /etc/hyperledger/fabric/tls/ca.crt  	General.Cluster.ClientCertificate = "" 	General.Cluster.ClientPrivateKey = "" 	General.Cluster.DialTimeout = 5s 	General.Cluster.RPCTimeout = 7s 	General.Cluster.ReplicationBufferSize = 20971520 	General.Cluster.ReplicationPullTimeout = 5s 	General.Cluster.ReplicationRetryTimeout = 5s 	General.Keepalive.ServerMinInterval = 1m0s 	General.Keepalive.ServerInterval = 2h0m0s 	General.Keepalive.ServerTimeout = 20s 	General.GenesisMethod = "file" 	General.GenesisProfile = "SampleInsecureSolo" 	General.SystemChannel = "test-system-channel-name" 	General.GenesisFile = "/hl_config/genesis/genesis.block" 	General.Profile.Enabled = false 	General.Profile.Address = "0.0.0.0:6060" 	General.LocalMSPDir = "/var/hyperledger/msp" 	General.LocalMSPID = "OrdererMSP" 	General.BCCSP.ProviderName = "SW" 	General.BCCSP.SwOpts.SecLevel = 256 	General.BCCSP.SwOpts.HashFamily = "SHA2" 	General.BCCSP.SwOpts.Ephemeral = false 	General.BCCSP.SwOpts.FileKeystore.KeyStorePath = "/var/hyperledger/msp/keystore" 	General.BCCSP.SwOpts.DummyKeystore = 	General.BCCSP.SwOpts.InmemKeystore = 	General.BCCSP.PluginOpts = 	General.Authentication.TimeWindow = 15m0s 	FileLedger.Location = "/var/hyperledger/ledger" 	FileLedger.Prefix = "hyperledger-fabric-ordererledger" 	RAMLedger.HistorySize = 1000 	Kafka.Retry.ShortInterval = 5s 	Kafka.Retry.ShortTotal = 10m0s 	Kafka.Retry.LongInterval = 5m0s 	Kafka.Retry.LongTotal = 12h0m0s 	Kafka.Retry.NetworkTimeouts.DialTimeout = 10s 	Kafka.Retry.NetworkTimeouts.ReadTimeout = 10s 	Kafka.Retry.NetworkTimeouts.WriteTimeout = 10s 	Kafka.Retry.Metadata.RetryMax = 3 	Kafka.Retry.Metadata.RetryBackoff = 250ms 	Kafka.Retry.Producer.RetryMax = 3 	Kafka.Retry.Producer.RetryBackoff = 100ms 	Kafka.Retry.Consumer.RetryBackoff = 2s 	Kafka.Verbose = false 	Kafka.Version = 0.10.2.0 	Kafka.TLS.Enabled = false 	Kafka.TLS.PrivateKey = "" 	Kafka.TLS.Certificate = "" 	Kafka.TLS.RootCAs =    	Kafka.TLS.ClientAuthRequired = false 	Kafka.TLS.ClientRootCAs =    	Kafka.SASLPlain.Enabled = false 	Kafka.SASLPlain.User = "" 	Kafka.SASLPlain.Password = "" 	Kafka.Topic.ReplicationFactor = 3 	Debug.BroadcastTraceDir = "" 	Debug.DeliverTraceDir = "" 	Consensus = map WALDir:/var/hyperledger/production/orderer/etcdraft/wal SnapDir:/var/hyperledger/production/orderer/etcdraft/snapshot  	Operations.ListenAddress = "127.0.0.1:8443" 	Operations.TLS.Enabled = false 	Operations.TLS.PrivateKey = "" 	Operations.TLS.Certificate = "" 	Operations.TLS.RootCAs =    	Operations.TLS.ClientAuthRequired = false 	Operations.TLS.ClientRootCAs =    	Metrics.Provider = "disabled" 	Metrics.Statsd.Network = "udp" 	Metrics.Statsd.Address = "127.0.0.1:8125" 	Metrics.Statsd.WriteInterval = 30s 	Metrics.Statsd.Prefix = "" 2019-04-29 07:04:02.933 UTC  orderer.common.server  initializeMultichannelRegistrar -> INFO 003 Not bootstrapping because of existing chains 2019-04-29 07:04:02.936 UTC  orderer.commmon.multichannel  newLedgerResources -> PANI 004 Error creating channelconfig bundle: initializing channelconfig failed: could not create channel Consortiums sub-group config: setting up the MSP manager failed: the supplied identity is not valid: x509: certificate signed by unknown authority (possibly because of "x509: ECDSA verification failure" while trying to verify candidate authority certificate "ca.org1.example.com") panic: Error creating channelconfig bundle: initializing channelconfig failed: could not create channel Consortiums sub-group config: setting up the MSP manager failed: the supplied identity is not valid: x509: certificate signed by unknown authority (possibly because of "x509: ECDSA verification failure" while trying to verify candidate authority certificate "ca.org1.example.com")  goroutine 1  running : github.com/hyperledger/fabric/vendor/go.uber.org/zap/zapcore.(*CheckedEntry).Write(0xc0000e3ad0, 0x0, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/zapcore/entry.go:229 +0x515 github.com/hyperledger/fabric/vendor/go.uber.org/zap.(*SugaredLogger).log(0xc0000aa350, 0x4, 0xf6f983, 0x27, 0xc00045d808, 0x1, 0x1, 0x0, 0x0, 0x0) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/sugar.go:234 +0xf6 github.com/hyperledger/fabric/vendor/go.uber.org/zap.(*SugaredLogger).Panicf(0xc0000aa350, 0xf6f983, 0x27, 0xc00045d808, 0x1, 0x1) 	/opt/gopath/src/github.com/hyperledger/fabric/vendor/go.uber.org/zap/sugar.go:159 +0x79 github.com/hyperledger/fabric/common/flogging.(*FabricLogger).Panicf(0xc0000aa358, 0xf6f983, 0x27, 0xc00045d808, 0x1, 0x1) 	/opt/gopath/src/github.com/hyperledger/fabric/common/flogging/zap.go:74 +0x60 github.com/hyperledger/fabric/orderer/common/multichannel.(*Registrar).newLedgerResources(0xc0003fa2d0, 0xc000332e10, 0xc000332e10) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar.go:260 +0x2d7 github.com/hyperledger/fabric/orderer/common/multichannel.(*Registrar).Initialize(0xc0003fa2d0, 0xc0001bf890) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/multichannel/registrar.go:147 +0x242 github.com/hyperledger/fabric/orderer/common/server.initializeMultichannelRegistrar(0xc000077800, 0xc0001de440, 0x0, 0xc0003fa240, 0x19b4420, 0xc0001de540, 0x2, 0x2, 0xc0001de550, 0x2, ...) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:414 +0x2ec github.com/hyperledger/fabric/orderer/common/server.Start(0xf4dfc0, 0x5, 0xc00042c000) 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:142 +0x52d github.com/hyperledger/fabric/orderer/common/server.Main() 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/common/server/main.go:87 +0x1ce main.main() 	/opt/gopath/src/github.com/hyperledger/fabric/orderer/main.go:15 +0x20   These are the complete logs .  ></body> </Action>
<Action id="59560" issue="27884" author="pankajcheema" type="comment" created="2019-04-29 07:50:57.0" updateauthor="pankajcheema" updated="2019-04-29 07:50:57.0"> <body><! CDATA Hi All ,  I have regenerated the certificates and it worked fine . But I don't know the cause any idea from anyone ?  ></body> </Action>
<Action id="63131" issue="27884" author="artemskliarov" type="comment" body="Have the same issue" created="2019-08-21 12:15:32.0" updateauthor="artemskliarov" updated="2019-08-21 12:15:45.0"/>
