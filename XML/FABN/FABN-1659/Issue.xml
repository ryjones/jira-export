<Issue id="46239" key="FABN-1659" number="1659" project="10604" reporter="denyeart" creator="denyeart" type="10004" summary="Issues when trying to query another org&apos;s peer" priority="3" resolution="10203" status="6" created="2020-10-23 14:56:47.0" updated="2020-10-23 15:05:19.0" resolutiondate="2020-10-23 15:05:19.0" votes="0" watches="2" workflowId="60150" archived="N"> <description><! CDATA If the client's org does not have a peer, and they try to query another org's peer, there seems to be couple issues.  *Issue1:* Using service discovery with default query handler produces an error with no error message: {code:java} 			await gateway.connect(ccp2, { 				wallet, 				identity: org1UserId, 				discovery: { enabled: true, asLocalhost: true }, // using asLocalhost as this gateway is using a fabric network deployed locally 				eventHandlerOptions: {strategy: DefaultEventHandlerStrategies.PREFER_MSPID_SCOPE_ALLFORTX} 			}); {code} {code:java} let result = await contract.evaluateTransaction('ReadAsset', id); {code} results in: {code:java} 2020-10-23T14:31:30.059Z - error:  SingleQueryHandler : evaluate: message=Query failed. Errors:   , stack=FabricError: Query failed. Errors:    at SingleQueryHandler.evaluate (/Users/denyeart/work/src/github.com/hyperledger/fabric-samples/asset-transfer-basic/application-javascript/node_modules/fabric-network/lib/impl/query/singlequeryhandler.js:46:23) at Transaction.evaluate (/Users/denyeart/work/src/github.com/hyperledger/fabric-samples/asset-transfer-basic/application-javascript/node_modules/fabric-network/lib/transaction.js:275:49) at ContractImpl.evaluateTransaction (/Users/denyeart/work/src/github.com/hyperledger/fabric-samples/asset-transfer-basic/application-javascript/node_modules/fabric-network/lib/contract.js:178:45) at main (/Users/denyeart/work/src/github.com/hyperledger/fabric-samples/asset-transfer-basic/application-javascript/app-client.js:128:32) at processTicksAndRejections (internal/process/task_queues.js:97:5), name=FabricError ******** FAILED to run the application: FabricError: Query failed. Errors:    {code} Â   *Issue2:* Using service discovery with a query handler results in TypeError: queryOptions.strategy is not a function. {code:java} 			await gateway.connect(ccp2, { 				wallet, 				identity: org1UserId, 				discovery: { enabled: true, asLocalhost: true }, // using asLocalhost as this gateway is using a fabric network deployed locally 				eventHandlerOptions: {strategy: DefaultEventHandlerStrategies.PREFER_MSPID_SCOPE_ALLFORTX}, 				queryHandlerOptions: {strategy: DefaultQueryHandlerStrategies.PREFER_MSPID_SCOPE_SINGLE} 			}); {code} {code:java} let result = await contract.evaluateTransaction('ReadAsset', id); {code} results in: {code:java} ******** FAILED to run the application: TypeError: queryOptions.strategy is not a function {code}  ></description> </Issue>
