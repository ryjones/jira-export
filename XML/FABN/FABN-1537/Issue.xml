<Issue id="44747" key="FABN-1537" number="1537" project="10604" reporter="JIRAUSER19991" creator="JIRAUSER19991" type="10004" summary="Default key-value-store saves corrupt data" priority="3" resolution="10001" status="6" created="2020-04-07 18:44:14.0" updated="2020-12-01 15:51:51.0" resolutiondate="2020-12-01 14:59:27.0" votes="0" watches="2" workflowId="58666" archived="N"> <description><! CDATA I am using the 1.4 node client with a common connection profile and the default key-value-store settings. In high load scenarios the *setUserContext* call starts to throw exceptions erratically  with message _"SyntaxError: Unexpected string in JSON at position 1131"_.   Looking at the filesystem, some of the stored user values are indeed corrupt in the way that additional character are appended.  For example a working value ends with   _END CERTIFICATE----\n"}}}_  while a broken value would end with   _END CERTIFICATE----\n"}}}"}}}_  making it an invalid json.     I believe this stems from the fact that the usage of fs.writefile in the default kvs implementation cannot be considered safe when there are writes to the same file.   https://nodejs.org/api/fs.html#fs_fs_writefile_file_data_options_callback   ></description> </Issue>
