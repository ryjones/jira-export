<Issue id="16406" key="FABN-369" number="369" project="10604" reporter="yuki-kon" assignee="yuki-kon" creator="yuki-kon" type="10004" summary="Fix channel creation in test/integration/new-chain.js" priority="3" resolution="10000" status="6" created="2017-05-07 06:40:42.0" updated="2018-07-19 00:53:48.0" resolutiondate="2017-05-30 15:40:45.0" votes="0" watches="2" workflowId="34100"> <environment><! CDATA fabric: commit 58f33ece8cea77c061b516224a7c9646423c748b  fabric-sdk-node: commit f2fdae3fa1e856b1a0b6ec8e118b3279377eabcf  fabri-ca: commit bb17e4e6ac23f9c1d528b85a75e60b28f25fe20e  ></environment> <description><! CDATA Integration test script "test/integration/new-chain.js" is not updated after  FAB-3319  introduced new style protobuf configuration envelope.     "new-chain.js" is a negative test case. SDK requests orderer to create the same channel which has been already created.  The expected outcome is failing to create channel because the same channel exists.  When executing "gulp test", "new-chain.js" passes this test after SDK gets an error message "BAD_REQUEST".     If we execute "new-chain.js" without existing channel, the expected outcome is to create a new channel successfully.  However, this test fails. Orderer produces the unexpected error. The detailed log is attached.     2017-05-06 04:19:01.292 UTC  cauthdsl  func2 -> ERRO 1b2 Principal deserialization failed: (Could not deserialize a SerializedIdentity, err unexpected EOF) for identity  99 101 114 116      Since gulp test passes, it looks like there is no problem. But we don't check the correct test scenario.  We need to fix "new-chain.js" to create channel if the same channel doesn't exist.  ></description> </Issue>
