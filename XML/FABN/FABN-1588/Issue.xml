<Issue id="45528" key="FABN-1588" number="1588" project="10604" reporter="bestbeforetoday" assignee="bestbeforetoday" creator="bestbeforetoday" type="10004" summary="Intermittent scenario test failure in master branch" priority="3" resolution="10000" status="6" created="2020-07-02 10:45:23.0" updated="2020-08-14 10:55:27.0" resolutiondate="2020-08-14 10:55:27.0" votes="0" watches="1" workflowId="59727" archived="N"> <description><! CDATA Builds in Azure pipelines intermittently but fairly frequently fail as follows: {noformat} Scenario: Checkpoint contract event listening # test/ts-scenario/features/events.feature:101 ✔ Given I place a scenario start message EVENTS FEATURE # test/ts-scenario/steps/debug.ts:11 ✔ Given I deploy a tls Fabric network at 2.1 version # test/ts-scenario/steps/docker.ts:23 ✔ And I use the cli to create and join the channel named eventschannel on the deployed network # test/ts-scenario/steps/cli.ts:23 ✔ And I use the cli to update the channel with name eventschannel with config file eventschannel-anchor.tx on the deployed network # test/ts-scenario/steps/cli.ts:55 ✔ And I use the cli to lifecycle deploy a node smart contract named events at version 1.0.0 as events for all organizations on channel eventschannel with default endorsement policy and init-required false # test/ts-scenario/steps/cli.ts:105 ✔ And I have a memory backed gateway named event_gateway with discovery set to true for user User1 using the connection profile named ccp-tls.json # test/ts-scenario/steps/network-model.ts:18 ✔ When I use the gateway named event_gateway to listen for full contract events named create with a new file checkpoint listener named checkpointContractListener for the smart contract named events on channel eventschannel # test/ts-scenario/steps/event-listeners.ts:44 ✔ And I use the gateway named event_gateway to submit a transaction with args  createValue  for contract events instantiated on channel eventschannel # test/ts-scenario/steps/network-model.ts:45 ✖ Then the listener named checkpointContractListener should have contract events with payload containing "createValueTransactionContent" # test/ts-scenario/steps/event-listeners.ts:113 Error: Listener named checkpointContractListener does not have the expected contract event payload  createValueTransactionContent  at Object.logAndThrow (/home/vsts/work/1/s/test/ts-scenario/steps/lib/utility/baseUtils.ts:47:9) at Object.checkContractListenerPayloads (/home/vsts/work/1/s/test/ts-scenario/steps/lib/listeners.ts:258:13) at /home/vsts/work/1/s/test/ts-scenario/steps/event-listeners.ts:114:12 at step (/home/vsts/work/1/s/test/ts-scenario/steps/event-listeners.ts:36:23) at Object.next (/home/vsts/work/1/s/test/ts-scenario/steps/event-listeners.ts:17:53) at /home/vsts/work/1/s/test/ts-scenario/steps/event-listeners.ts:11:71 at new Promise (<anonymous>) at __awaiter (/home/vsts/work/1/s/test/ts-scenario/steps/event-listeners.ts:7:12) at World.<anonymous> (/home/vsts/work/1/s/test/ts-scenario/steps/event-listeners.ts:113:184) {noformat}  ></description> </Issue>
