<Issue id="46204" key="FABN-1653" number="1653" project="10604" reporter="bestbeforetoday" assignee="bestbeforetoday" creator="bestbeforetoday" type="10004" summary="Bad calculation of next snapshot version for npm publish" priority="2" resolution="10000" status="6" created="2020-10-13 14:40:46.0" updated="2020-10-15 13:13:51.0" resolutiondate="2020-10-15 13:13:51.0" votes="0" watches="1" workflowId="60113" archived="N"> <description><! CDATA The publish script calculates the next version to publish by looking at the existing versions, reverse sorting them and taking the first one: {code:java} nextVersion=$(npm view "$1" versions --json | awk -F . "/\"${RELEASE_VERSION}/"'{ ver=$NF sub(/\".*/, "", ver) print ver+1 }' | sort -r | head -1) {code} This is aÂ lexicographic sort so fails when the versions go beyond single digits, and 10 sorts as smaller than 9.  Instead, use the tail element in the order returned by the npm version view, which should go from lowest to highest version anyway.  ></description> </Issue>
