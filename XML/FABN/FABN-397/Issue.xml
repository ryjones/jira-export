<Issue id="15657" key="FABN-397" number="397" project="10604" reporter="geminatea" creator="geminatea" type="10004" summary="e2e.js test failure fabric-sdk-node/test/integration" environment="OSX 10.12.14" priority="3" resolution="10000" status="6" created="2017-04-10 23:24:34.0" updated="2018-07-19 00:53:55.0" resolutiondate="2017-04-14 21:12:17.0" votes="0" watches="1" workflowId="34128"> <description><! CDATA Running on OSX with with the latest docker images: ``` dev-peer0-events_unit_test1491865431130-v1491865431130   latest                          c94a05a30b3a        18 minutes ago      177 MB dev-peer0-events_unit_test1491865217314-v1491865217314   latest                          816cb6013b9a        22 minutes ago      177 MB hyperledger/fabric-couchdb                               latest                          231217971e2a        48 minutes ago      1.51 GB hyperledger/fabric-couchdb                               x86_64-1.0.0-snapshot-a076bba   231217971e2a        48 minutes ago      1.51 GB hyperledger/fabric-kafka                                 latest                          1dfe256e5e0d        54 minutes ago      1.3 GB hyperledger/fabric-kafka                                 x86_64-1.0.0-snapshot-a076bba   1dfe256e5e0d        54 minutes ago      1.3 GB hyperledger/fabric-zookeeper                             latest                          316dc5be7969        56 minutes ago      1.31 GB hyperledger/fabric-zookeeper                             x86_64-1.0.0-snapshot-a076bba   316dc5be7969        56 minutes ago      1.31 GB hyperledger/fabric-testenv                               latest                          a3e8976b76f5        57 minutes ago      1.4 GB hyperledger/fabric-testenv                               x86_64-1.0.0-snapshot-a076bba   a3e8976b76f5        57 minutes ago      1.4 GB hyperledger/fabric-buildenv                              latest                          e3ad35936468        58 minutes ago      1.31 GB hyperledger/fabric-buildenv                              x86_64-1.0.0-snapshot-a076bba   e3ad35936468        58 minutes ago      1.31 GB hyperledger/fabric-orderer                               latest                          8a44dedafe65        58 minutes ago      182 MB hyperledger/fabric-orderer                               x86_64-1.0.0-snapshot-a076bba   8a44dedafe65        58 minutes ago      182 MB hyperledger/fabric-peer                                  latest                          f3f75fc3d66c        59 minutes ago      185 MB hyperledger/fabric-peer                                  x86_64-1.0.0-snapshot-a076bba   f3f75fc3d66c        59 minutes ago      185 MB hyperledger/fabric-javaenv                               latest                          0d304aa50423        59 minutes ago      1.43 GB hyperledger/fabric-javaenv                               x86_64-1.0.0-snapshot-a076bba   0d304aa50423        59 minutes ago      1.43 GB hyperledger/openldap                                     latest                          54480bd341c0        About an hour ago   1.52 GB hyperledger/openldap                                     x86_64-1.0.0-snapshot-ee34334   54480bd341c0        About an hour ago   1.52 GB hyperledger/fabric-ccenv                                 latest                          07dc462377b7        About an hour ago   1.3 GB hyperledger/fabric-ccenv                                 x86_64-1.0.0-snapshot-a076bba   07dc462377b7        About an hour ago   1.3 GB hyperledger/fabric-ca                                    latest                          1be28941621c        About an hour ago   240 MB hyperledger/fabric-ca                                    x86_64-1.0.0-snapshot-ee34334   1be28941621c        About an hour ago   240 MB dev-peer0-events_unit_test1491860866388-v1491860866389   latest                          400665ca4411        About an hour ago   177 MB <none>                                                   <none>                          cc57dba0a2e7        About an hour ago   1.31 GB dev-peer0-events_unit_test1491859755568-v1491859755568   latest                          3857ed8621d7        About an hour ago   177 MB dev-peer0-events_unit_test1491859512396-v1491859512396   latest                          2a42d67974f4        About an hour ago   177 MB dev-peer0-events_unit_test1491858613219-v1491858613219   latest                          539911db22cb        2 hours ago         177 MB dev-peer2-end2end-v1                                     latest                          50b2e2310576        2 hours ago         177 MB dev-peer0-end2end-v1                                     latest                          1bc25da8a8f9        2 hours ago         177 MB dev-peer2-end2end-v0                                     latest                          7f6aa79f2086        2 hours ago         177 MB dev-peer0-end2end-v0                                     latest                          1f18819a0ce4        2 hours ago         177 MB couchdb                                                  latest                          b15a0ea0ffc9        2 weeks ago         225 MB nginx                                                    latest                          6b914bbcb89e        5 weeks ago         182 MB hyperledger/fabric-baseimage                             x86_64-0.3.0                    f4751a503f02        2 months ago        1.27 GB hyperledger/fabric-baseos                                x86_64-0.3.0                    c3a4cf3b3350        2 months ago        161 MB yeasy/hyperledger                                        latest                          f015c74d82a9        5 months ago        837 MB hyperledger/fabric-membersrvc                            latest                          b3654d32e4f9        5 months ago        1.42 GB ```  After removing all docker containers and running `/test/fixtures/docker-compose up --abort-on-container-exit` in different terminal, I get the following test failure from `node test/integration/e2e.js` in the `instantiate chaincode` section:  ``` ...  Peer.js : Peer.sendProposal - Start debug:  Orderer.js : sendDeliver - on error debug:  Orderer.js : sendDeliver - on status:{"code":11,"details":"EOF","metadata":{"_internal_repr":{}}} debug:  Peer.js : Received proposal response from: grpcs://localhost:7051 status: Error: Transaction returned with failure: Failed extracting proposal fields.  Could not extract the channel header from the proposal: UnmarshalChannelHeader failed, err proto: bad wiretype for field common.ChannelHeader.Type: got wiretype 2, want 0  error:  Chain.js : Chain-sendPeersProposal - Promise is rejected: Error: Transaction returned with failure: Failed extracting proposal fields.  Could not extract the channel header from the proposal: UnmarshalChannelHeader failed, err proto: bad wiretype for field common.ChannelHeader.Type: got wiretype 2, want 0  at /Users/drams/go/src/github.com/hyperledger/fabric-sdk-node/node_modules/grpc/src/node/src/client.js:434:17 debug:  Chain.js : Chain-sendPeersProposal - Promise is rejected: Error: Transaction returned with failure: Failed extracting proposal fields.  Could not extract the channel header from the proposal: UnmarshalChannelHeader failed, err proto: bad wiretype for field common.ChannelHeader.Type: got wiretype 2, want 0  error:  E2E testing : instantiate proposal was bad not ok 27 Failed to send instantiate Proposal or receive valid response. Response null or status is not 200. exiting... --- operator: fail at: hfc.newDefaultKeyValueStore.then.then.then.then (/Users/drams/go/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:350:6) ... not ok 28 Error: Failed to send instantiate Proposal or receive valid response. Response null or status is not 200. exiting... at hfc.newDefaultKeyValueStore.then.then.then.then (/Users/drams/go/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:351:10) at process._tickCallback (internal/process/next_tick.js:103:7) --- operator: fail at: hfc.newDefaultKeyValueStore.then.then.then.then.then (/Users/drams/go/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/e2eUtils.js:369:5) ... not ok 29 Failed to instantiate chaincode  --- operator: fail at: e2eUtils.instantiateChaincode.then (/Users/drams/go/src/github.com/hyperledger/fabric-sdk-node/test/integration/e2e/instantiate-chaincode.js:40:6) ... info:  E2E testing : Disconnecting the event hub debug:  EventHub.js : connect - unregister event received```  I have confirmed that Ubuntu 16.0.4 doesn't seem to have this problem.  ></description> </Issue>
