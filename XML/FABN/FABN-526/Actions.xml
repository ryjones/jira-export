<Action id="21537" issue="15364" author="latitiah" type="comment" body="We&apos;re pretty sure this is an environment issue and are trying to figure out what&apos;s causing these failures. Thanks Jim for your help!" created="2017-03-15 20:52:20.0" updateauthor="latitiah" updated="2017-03-15 20:52:20.0"/>
<Action id="21545" issue="15364" author="jimthematrix" type="comment" body="hi  ~latitiah  were you able to find out the cause of the failure?" created="2017-03-16 23:57:00.0" updateauthor="jimthematrix" updated="2017-03-16 23:57:00.0"/>
<Action id="21667" issue="15364" author="jjjjibm" type="comment" created="2017-03-27 22:40:26.0" updateauthor="jjjjibm" updated="2017-03-27 22:40:26.0"> <body><! CDATA FYI Jim.  I am seeing a similar sort of error using today's build:  not ok 13 Failed to enroll 'testUser'. Error: Could not parse enrollment response  {"success":false,"result":null,"errors": {"code":400,"message":"Authorization failure"} ,"messages":  }   as JSON due to error  TypeError: Cannot read property 'errors' of undefined  --- operator: fail at: process._tickCallback (internal/process/next_tick.js:103:7)  fabric-sdk-node: commit be3cf0b35ebfde560a366ed7e3782b7ff5f69db9 fabric: commit 397f5de8a7787b4ce2a52a81448fd35258ab610e commit e724a8951e5260f8129fc9d3ba578cb47dbf812f  It is easy to recreate. 1.Git checkout levels or just get the latest. 2.cd fabric-sdk-node/test/integration 3.node fabric-ca-services-tests.js   ></body> </Action>
<Action id="21735" issue="15364" author="jjjjibm" type="comment" created="2017-03-29 19:13:18.0" updateauthor="jjjjibm" updated="2017-03-29 19:13:18.0"> <body><! CDATA Update:  It's become harder to recreate, but this works:  fabric: commit 561443e60b3331354892e9716cc05eaa6ce1679f fabric-ca: commit c9498646e67355227d46cb7d1b1c0f6c8b35cf02 fabric-sdk-node: commit 567644d5ec027bd639cf8e1f8a8a5fe2ad5bad9c  1.Checkout levels as indicated 2.Build images from scratch before starting local network 3. cd fabric-sdk-node/test/integration 4.node fabric-ca-services-tests.js (works) 5.(again) node fabric-ca-services-tests.js  to see this result: <lines omitted> not ok 13 Failed to enroll 'testUser'. Error: Could not parse enrollment response  {"success":false,"result":null,"errors": {"code":400,"message":"Authorization failure"} ,"messages":  }   as JSON due to error  TypeError: Cannot read property 'errors' of undefined  --- operator: fail at: process._tickCallback (internal/process/next_tick.js:103:7) ...      ></body> </Action>
<Action id="21885" issue="15364" author="vdods" type="comment" created="2017-04-05 21:21:52.0" updateauthor="vdods" updated="2017-04-05 22:01:23.0"> <body><! CDATA I'm still seeing this on the latest;  fabric: cacb292921553900ea808344599b9914632bf1d3 fabric-ca: 77dc0ce08853615e6876db81fb9384c4e9c31209 fabric-sdk-node: 45c2f389ef37f3eab64cfceace46b0157abb9d33  In particular, running the docker-compose in test/fixtures/docker-compose.yaml and then running from the project root `node test/integration/e2e.js` produces 100% failure.  I've determined that the error occurs in the lines (in fabric-ca-client/lib/FabricCAClientImpl.js)  							enrollResponse.enrollmentCert = Buffer.from(res.result.Cert, 'base64').toString(); 							enrollResponse.caCertChain = Buffer.from(res.result.ServerInfo.CAChain, 'base64').toString();  because res.result is just a base64 encoded string, not a JSON object having attributes Cert and ServerInfo.  It looks like res.result is probably the Cert, but then it seems as though ServerInfo is missing.  I tried changing these lines to   							enrollResponse.enrollmentCert = Buffer.from(res.result, 'base64').toString();  And it gets past the current error, but still times out during the "***** U P G R A D E flow: invoke transaction to move money *****" section.  Commenting out `require('./e2e/upgrade.js');` from e2e.js then allows all remaining tests (which would be the full non-upgrade path) to pass.  Note that the suggested change above leaves enrollResponse.caCertChain un-assigned, so it may cause another 'undefined attribute' bug down the line, in particular, in setting the rootCertificate attribute of the response to the FabricCAServices.enroll method.   ></body> </Action>
<Action id="21917" issue="15364" author="jackieliu" type="comment" created="2017-04-06 08:56:22.0" updateauthor="jackieliu" updated="2017-04-06 08:56:22.0"> <body><! CDATA I have the same issue, is there any solution?  LiuXins-MBP:test liuxin$ node query.js info: Returning a new winston logger with default configurations info:  Chain.js : Constructed Chain instance: name - fabric-client1, securityEnabled: true, TCert download batch size: 10, network mode: true info:  Peer.js : Peer.const - url: grpc://localhost:7051 options  grpc.ssl_target_name_override=tlsca, grpc.default_authority=tlsca info:  Peer.js : Peer.const - url: grpc://localhost:8055 options  grpc.ssl_target_name_override=tlsca, grpc.default_authority=tlsca info:  Peer.js : Peer.const - url: grpc://localhost:8056 options  grpc.ssl_target_name_override=tlsca, grpc.default_authority=tlsca info:  Client.js : Failed to load user "admin" from local key value store info:  FabricCAClientImpl.js : Successfully constructed Fabric CA service client: endpoint - {"protocol":"http","hostname":"localhost","port":7054} info:  crypto_ecdsa_aes : This class requires a KeyValueStore to save keys, no store was passed in, using the default store /Users/liuxin/.hfc-key-store  2017-04-06 16:50:07.903   ERROR  Helper - Error: Could not parse enrollment response  {"success":true,"result":{"Cert":"LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUI4akNDQVplZ0F3SUJBZ0lVU1JjODd6eXBERlhhUit6MXR1RFg3NklLUk53d0NnWUlLb1pJemowRUF3SXcKZnpFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RmpBVUJnTlZCQWNURFZOaApiaUJHY21GdVkybHpZMjh4SHpBZEJnTlZCQW9URmtsdWRHVnlibVYwSUZkcFpHZGxkSE1zSUVsdVl5NHhEREFLCkJnTlZCQXNUQTFkWFZ6RVVNQklHQTFVRUF4TUxaWGhoYlhCc1pTNWpiMjB3SGhjTk1UY3dOREEyTURnME5UQXcKV2hjTk1UZ3dNekExTVRZME5UQXdXakFRTVE0d0RBWURWUVFERXdWaFpHMXBiakJaTUJNR0J5cUdTTTQ5QWdFRwpDQ3FHU000OUF3RUhBMElBQkgwb0RZblFRanBpSXIrMHhGSzExa3NFNVBhQUVOdy9TSVg1VjRYMXdRMksvVEJHClVkTENKLzZiU3VHWHdkMWEvMHcyOUZGeGRnbm53ZmlvOXdHcE5lV2pZREJlTUE0R0ExVWREd0VCL3dRRUF3SUMKQkRBTUJnTlZIUk1CQWY4RUFqQUFNQjBHQTFVZERnUVdCQlNGanZtSVBqOFdOdFJIU2VDZTIvVmxJYmRpVXpBZgpCZ05WSFNNRUdEQVdnQlFYWjBJOXFwNkNQOFRGSFo5Ync1blJ0WnhJRURBS0JnZ3Foa2pPUFFRREFnTkpBREJHCkFpRUFoNmNSRWh1VTBoMzN5UDdwblIyRHFCUkQzb2oyaVgwTE9sSGg4V056Wm80Q0lRQzJJMkRsRDlVbkRoQmQKMW1KQVN5cHR3cEt5aGh2em4rNTR6Ly9WdmhvNVlRPT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=","ServerInfo":{"CAName":"","CAChain":"LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNZakNDQWdtZ0F3SUJBZ0lVQjNDVERPVTQ3c1VDNUs0a24vQ2FxbmgxMTRZd0NnWUlLb1pJemowRUF3SXcKZnpFTE1Ba0dBMVVFQmhNQ1ZWTXhFekFSQmdOVkJBZ1RDa05oYkdsbWIzSnVhV0V4RmpBVUJnTlZCQWNURFZOaApiaUJHY21GdVkybHpZMjh4SHpBZEJnTlZCQW9URmtsdWRHVnlibVYwSUZkcFpHZGxkSE1zSUVsdVl5NHhEREFLCkJnTlZCQXNUQTFkWFZ6RVVNQklHQTFVRUF4TUxaWGhoYlhCc1pTNWpiMjB3SGhjTk1UWXhNREV5TVRrek1UQXcKV2hjTk1qRXhNREV4TVRrek1UQXdXakIvTVFzd0NRWURWUVFHRXdKVlV6RVRNQkVHQTFVRUNCTUtRMkZzYVdadgpjbTVwWVRFV01CUUdBMVVFQnhNTlUyRnVJRVp5WVc1amFYTmpiekVmTUIwR0ExVUVDaE1XU1c1MFpYSnVaWFFnClYybGtaMlYwY3l3Z1NXNWpMakVNTUFvR0ExVUVDeE1EVjFkWE1SUXdFZ1lEVlFRREV3dGxlR0Z0Y0d4bExtTnYKYlRCWk1CTUdCeXFHU000OUFnRUdDQ3FHU000OUF3RUhBMElBQktJSDViMkphU21xaVFYSHlxQytjbWtuSUNjRgppNUFkZFZqc1FpekRWNnVaNHY2cytQV2lKeXpmQS9yVHRNdllBUHEveWVFSHBCVUIxajA1M214bnBNdWpZekJoCk1BNEdBMVVkRHdFQi93UUVBd0lCQmpBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUIwR0ExVWREZ1FXQkJRWFowSTkKcXA2Q1A4VEZIWjlidzVuUnRaeElFREFmQmdOVkhTTUVHREFXZ0JRWFowSTlxcDZDUDhURkhaOWJ3NW5SdFp4SQpFREFLQmdncWhrak9QUVFEQWdOSEFEQkVBaUFIcDVSYnA5RW0xRy9VbUtuOFdzQ2JxRGZXZWNWYlpQUWozUks0Cm9HNWtRUUlnUUFlNE9PS1loSmRoM2Y3VVJhS2ZHVGY0OTIvbm1SbXRLK3lTS2pwSFNyVT0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo="}},"errors":  ,"messages":  }   as JSON due to error  TypeError: First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.  at IncomingMessage.<anonymous> (/Users/liuxin/ProjectSource/new/hyperledger/hackfest/node_modules/fabric-ca-client/lib/FabricCAClientImpl.js:394:14) at emitNone (events.js:91:20) at IncomingMessage.emit (events.js:185:7) at endReadableNT (_stream_readable.js:974:12) at _combinedTickCallback (internal/process/next_tick.js:74:11) at process._tickCallback (internal/process/next_tick.js:98:9)  2017-04-06 16:50:07.905   ERROR  QUERY - Error: Failed to obtain an enrolled user at ca_client.enroll.then.then.then.catch (/Users/liuxin/ProjectSource/new/hyperledger/hackfest/helper.js:59:12) at process._tickCallback (internal/process/next_tick.js:103:7)   ></body> </Action>
<Action id="23796" issue="15364" author="pranavkaushik" type="comment" created="2017-05-12 12:57:34.0" updateauthor="pranavkaushik" updated="2017-05-12 12:57:34.0"> <body><! CDATA Hi, I am facing same issue during enroll.  One thing I noticed and may be of help is:  res.result is not a nested object but just contains the enrollmentCert then why is line 550 & 551 of FabricCAClientImpl.js trying to extract res.cert and res.result.ServerInfo.CAChain     When i changed the code from  {code:java} enrollResponse.enrollmentCert = new Buffer.from(res.result.Cert, 'base64').toString(); enrollResponse.caCertChain = new Buffer.from(res.result.ServerInfo.CAChain, 'base64').toString();{code}    to just this  {code:java} enrollResponse.enrollmentCert = new Buffer.from(res.result, 'base64').toString();{code}    the error vanished. However, this might result in other issues due to to not returning caCertChain which I am not sure of.     Please suggest.     ></body> </Action>
<Action id="23857" issue="15364" author="pranavkaushik" type="comment" created="2017-05-15 05:53:59.0" updateauthor="pranavkaushik" updated="2017-05-15 05:53:59.0"> <body><! CDATA Any update on this? Please let me know if this is the right place to ask a question or discuss about this issue?     Thanks,  Pranav  ></body> </Action>
<Action id="23953" issue="15364" author="jimthematrix" type="comment" body=" ~pranavkaushik  what level of SDK and fabric-ca are you using? we run this on every CI build and it has not turned up for a long time. closing the defect for now. if you are still seeing it on the latest, please re-open and let us know the levels." created="2017-05-17 17:01:40.0" updateauthor="jimthematrix" updated="2017-05-17 17:01:40.0"/>
<Action id="29072" issue="15364" author="yogendrasri" type="comment" created="2017-07-27 04:38:57.0" updateauthor="yogendrasri" updated="2017-07-27 04:38:57.0"> <body><! CDATA Is there any solution of above issue, I am still facing this error with "fabric-ca-client": ">=1.0.0-rc1 <1.0.0-rc1.10", "fabric-client": ">=1.0.0-rc1 <1.0.0-rc1.10".  Below is the error:  Caught Error Error: Could not parse enrollment response  404 page not found   as JSON due to error  SyntaxError: Unexpected token p in JSON at position 4      at IncomingMessage.<anonymous> (/Users/yogendra/blockchain-first-example/fabric-samples/ fabcar/node_modules/fabric-ca-client/lib/FabricCAClientImpl.js:704:14)     at emitNone (events.js:91:20)     at IncomingMessage.emit (events.js:185:7)        ></body> </Action>
