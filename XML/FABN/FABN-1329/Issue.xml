<Issue id="41474" key="FABN-1329" number="1329" project="10604" reporter="davidkel" creator="davidkel" type="10004" summary="sendTransactionProposal returns completely different things depending on whether discovery is used or not." priority="2" resolution="10002" status="6" created="2019-07-28 18:17:18.0" updated="2019-08-30 10:29:24.0" resolutiondate="2019-08-30 10:29:24.0" votes="0" watches="1" workflowId="54491"> <description><! CDATA If chaincode returns an error through shim.Error then sendTransactionProposal does completely different things depending on if discovery is used or not. If discovery is not used then it returns an array as follows :- {noformat} res     { Error: I'm a shim error at self._endorserClient.processProposal (/home/dave/Documents/gow/src/testclient/node_modules/fabric-client/lib/Peer.js:140:36) at Object.onReceiveStatus (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:1207:9) at InterceptingListener._callNext (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:568:42) at InterceptingListener.onReceiveStatus (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:618:8) at callback (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:845:24) status: 500, payload: <Buffer >, peer:  Object , isProposalResponse: true }  , { header:  ... payload:  ... extension:  ... }   {noformat}  If however discovery is used, then it doesn't just return, it throws an error as follows {noformat} ERROR { Error: Endorsement has failed at DiscoveryEndorsementHandler._endorse (/home/dave/Documents/gow/src/testclient/node_modules/fabric-client/lib/impl/DiscoveryEndorsementHandler.js:186:19) at <anonymous> endorsements:    { Error: I'm a shim error at self._endorserClient.processProposal (/home/dave/Documents/gow/src/testclient/node_modules/fabric-client/lib/Peer.js:140:36) at Object.onReceiveStatus (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:1207:9) at InterceptingListener._callNext (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:568:42) at InterceptingListener.onReceiveStatus (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:618:8) at callback (/home/dave/Documents/gow/src/testclient/node_modules/grpc/src/client_interceptors.js:845:24) status: 500, payload: <Buffer >, peer:  Object , isProposalResponse: true }   } {noformat} The api should be consistent irrespective of discovery. Unfortunately it can't be changed for V1, but should be made consistent for V2.  ></description> </Issue>
