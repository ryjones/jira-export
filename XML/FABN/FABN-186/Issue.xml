<Issue id="15279" key="FABN-186" number="186" project="10604" reporter="yingshi" assignee="jimthematrix" creator="yingshi" type="10004" summary="ChainCode is packaged with Win-style path and not recognized by Peer side" priority="2" resolution="10000" status="6" created="2017-03-09 02:38:25.0" updated="2018-07-19 00:53:09.0" resolutiondate="2017-05-22 16:21:44.0" votes="0" watches="1" workflowId="33917"> <environment><! CDATA fabric version: latest @ March 6th fabric yaml: \fabric-sdk-node\test\fixtures\docker-compose.yml node sdk version: latest @ March 6th OS: sdk running in win7, peers in linux container  ></environment> <description><! CDATA  Test setting  fabric version: latest @ March 6th fabric yaml: \fabric-sdk-node\test\fixtures\docker-compose.yml node sdk version: latest @ March 6th OS: sdk running in win7, peers in linux container    Debug info  Run fabric-sdk-node\test\integration\e2e\invoke-transaction.js, then get:  34mdebug 39m:  Peer.js : Peer.sendProposal - Start  34mdebug 39m:  Peer.js : Peer.sendProposal - Start  31merror 39m:  Peer.js : GRPC client got an error response from the peer "grpc://localhost:7051". Error: Illegal file detected in payload: "src\github.com\example_cc\example_cc.go" at D:\eclipse-workspace\fabric-sdk-node\node_modules\grpc\src\node\src\client.js:434:17  Add trace to packager/Golang.js and get: info 39m:  packager/Golang.js : packaging GOLANG from github.com/example_cc  34mdebug 39m:  packager/Golang.js : goPath: /eclipse-workspace/fabric-sdk-node/test/fixtures, chaincodePath: github.com/example_cc  34mdebug 39m:  packager/Golang.js : Compose the path to the chaincode project directory: \eclipse-workspace\fabric-sdk-node\test\fixtures\src\github.com\example_cc  34mdebug 39m:  packager/Golang.js : goPath: /eclipse-workspace/fabric-sdk-node/test/fixtures, filePath: \eclipse-workspace\fabric-sdk-node\test\fixtures\src\github.com\example_cc  34mdebug 39m:  packager/Golang.js : adding entry name=src\github.com\example_cc\example_cc.go, fqp=D:\eclipse-workspace\fabric-sdk-node\test\fixtures\src\github.com\example_cc\example_cc.go  34m  No matter the input path style, in Windows the packager converts name and fqp into Win-style by path.join/ relative, which is not recognized in Peers.    To fix temporarily  Modify fabric-client/lib/packager/Golang.js:function findSource(goPath, filePath) line 100-101 as: //- name: path.relative(goPath, entry.path), //- fqp: entry.path name: path.relative(goPath, entry.path).replace(/\\/g,"\/"), fqp: entry.path.replace(/\\/g,"\/")  ></description> </Issue>
