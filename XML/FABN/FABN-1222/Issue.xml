<Issue id="39580" key="FABN-1222" number="1222" project="10604" reporter="jeffywu" assignee="harrisob@us.ibm.com" creator="jeffywu" type="10004" summary="Issue when loading a channel with peers defined in Network Config" priority="3" resolution="10204" status="6" created="2019-05-01 17:53:42.0" updated="2019-05-30 19:38:40.0" resolutiondate="2019-05-30 19:38:40.0" votes="0" watches="1" workflowId="52464"> <description><! CDATA I'm running into an issue where peers are not mapped into a channel even though they are defined in the Network Config:     This is the network config: {code:java} { 	"name": "test-channel", 	"description": "Network on IBP v2", 	"version": "1.0.0", 	"client": { 		"organization": "org" 	}, 	"organizations": { 		"Org0MSP": { 			"mspid": "msp", 			"peers":   				"peer0" 			  		} 	}, 	"orderers": { 		"orderer": { 			"url": "grpcs://orderer:30001", 			"tlsCACerts": { 				"path": "crypto/cert.pem" 			} 		} 	}, 	"peers": { 		"peer0": { 			"url": "grpcs://peer:30003", 			"tlsCACerts": { 				"path": "crypto/cert.pem" 			} 		} 	}, 	"channels": { 		"mychannel": { 			"orderers":  "orderer" , 			"peers":   				"peer0" 			  		} 	} } {code}    When I run the following code, I get the error: {code:javascript} > const hfc = require('fabric-client'); > client = hfc.loadFromConfig(NETWORK_CONFIG) Client { _cryptoSuite: null, _mspid: null, _stateStore: null, _userContext: null, _network_config: NetworkConfig_1_0 { _network_config: { name: 'test-channel', description: 'Network', version: '1.0.0', client:  Object , organizations:  Object , orderers:  Object , peers:  Object , channels:  Object  }, _client_context:  Circular , _peers: Map {}, _channel: Map {}, _orderers: Map {} }, _msps: Map {}, _devMode: false, _adminSigningIdentity: null, _tls_mutual: {}, _organizations: Map {}, _certificateAuthorities: Map {}, _channels: Map {}, _connection_options: {} } > client.getChannel("mychannel") Channel { _name: 'mychannel', _channel_peers: Map {}, _anchor_peers:   , _orderers: Map { 'orderer' => Orderer { _options:  Object , clientCert: undefined, _url: 'grpcs://orderer:30001', _endpoint:  Object , _name: 'orderer', _request_timeout: 45000, _grpc_wait_for_ready_timeout: 3000, _ordererClient:  Object , _sendDeliverConnect: false } }, _kafka_brokers:   , _clientContext: Client { _cryptoSuite: null, _mspid: null, _stateStore: null, _userContext: null, _network_config: NetworkConfig_1_0 { _network_config:  Object , _client_context:  Circular , _peers: Map {}, _channel: Map {}, _orderers: Map {} }, _msps: Map {}, _devMode: false, _adminSigningIdentity: null, _tls_mutual: {}, _organizations: Map {}, _certificateAuthorities: Map {}, _channels: Map { 'mychannel' =>  Circular  }, _connection_options: {} }, _msp_manager: MSPManager { _msps: {} }, _discovery_interests: Map {}, _discovery_results: null, _last_discover_timestamp: null, _discovery_peer: null, _use_discovery: false, _as_localhost: true, _endorsement_handler: null, _commit_handler: null } > client.getChannel("mychannel").newChannelEventHub("peer0") Error: Peer with name "peer0" not assigned to this channel at Channel._getTargets (/usr/src/app/node_modules/fabric-client/lib/Channel.js:3462:13) at Channel.newChannelEventHub (/usr/src/app/node_modules/fabric-client/lib/Channel.js:948:22) {code} However, if I add the peer manually, everything works fine. Wondering if there's an issue with the parsing in the Network Config part? {code:javascript} > client.getChannel("mychannel").addPeer(client.getPeer("peer0")); > client.getChannel("mychannel").newChannelEventHub("peer0"); {code}          ></description> </Issue>
