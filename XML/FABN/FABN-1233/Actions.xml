<Action id="62596" issue="39775" author="vijaypunugubati" type="comment" created="2019-08-05 17:48:02.0" updateauthor="vijaypunugubati" updated="2019-08-05 17:48:02.0"> <body><! CDATA Now, this error hits on 'fabric-merge-end-2-end-x86_64 job" consistently.   and observed on this job from Aug 5, 2019  {color:#172b4d}+* Started from this build|https://jenkins.hyperledger.org/view/fabric/job/fabric-merge-end-2-end-x86_64/6007/console :*+{color}   https://jenkins.hyperledger.org/view/fabric/job/fabric-merge-end-2-end-x86_64/6007/console  {code:java} /00:19:23.103 ok 484 Successfully instantiated chaincode on the channel 00:19:24.016 /tmp/jenkins4014418976961939553.sh: line 112: 22696 Segmentation fault      (core dumped) gulp run-end-to-end 00:19:24.016 --------> ERROR!!! gulp end-2-end tests failed <--------- 00:19:24.038 Build step 'Execute shell' marked build as failure/ code placeholder {code}  ></body> </Action>
<Action id="62646" issue="39775" author="dereckluo" type="comment" created="2019-08-06 15:02:55.0" updateauthor="dereckluo" updated="2019-08-06 15:02:55.0"> <body><! CDATA With changes of FABN-1233 *NodeSDK segment fault* merged in yesterday, the *fabric-merge-end-2-end* job is still failing as observed this morning with the same error.   ~harrisob@us.ibm.com  can you take another look?  {code:java} 07:47:49 ok 481 The chaincode instantiate transaction has been committed on peer localhost:7051 07:47:49 ok 482 The chaincode instantiate transaction was valid. 07:47:49 ok 483 Successfully sent instantiatetransaction to the orderer. 07:47:54 ok 484 Successfully instantiated chaincode on the channel 07:47:55 /tmp/jenkins6708848824831413988.sh: line 112: 22591 Segmentation fault      (core dumped) gulp run-end-to-end 07:47:55 --------> ERROR!!! gulp end-2-end tests failed <--------- 07:47:55 Build step 'Execute shell' marked build as failure {code}  *Build Log*  https://jenkins.hyperledger.org/view/fabric/job/fabric-merge-end-2-end-x86_64/6030/consoleFull   ></body> </Action>
<Action id="62736" issue="39775" author="vijaypunugubati" type="comment" body=" ~harrisob@us.ibm.com  tried to run gulp target `end-2-end` with latest node-version 10.16.2 locally on master and the `Segmentation fault` was not produced, by taking this as an initial step for the fix, requested LF guy to update node-version on jenkins plugin." created="2019-08-08 19:31:46.0" updateauthor="vijaypunugubati" updated="2019-08-08 19:31:46.0"/>
<Action id="62804" issue="39775" author="wlahti" type="comment" body="Also seeing this same failure in fabric-ca-merge-end-2-end job:  https://jenkins.hyperledger.org/job/fabric-ca-merge-end-2-end-x86_64/280/console " created="2019-08-12 15:01:03.0" updateauthor="wlahti" updated="2019-08-12 15:01:03.0"/>
<Action id="62807" issue="39775" author="vijaypunugubati" type="comment" created="2019-08-12 16:01:59.0" updateauthor="vijaypunugubati" updated="2019-08-12 16:02:27.0"> <body><! CDATA  ~harrisob@us.ibm.com I tried with node-version `10.16.2` on the sandbox still the error is observed  https://jenkins.hyperledger.org/sandbox/job/fabric-merge-end-2-end-x86_64/1/console   {code:java} /00:12:38.374 npm version ======> 00:12:38.634 6.9.0 00:12:38.639 node version =======> 00:12:38.643 v10.16.2 {code}  ></body> </Action>
<Action id="62815" issue="39775" author="harrisob@us.ibm.com" type="comment" body="could I get the debug log: /w/workspace/fabric-merge-end-2-end-x86_64/gopath/src/github.com/hyperledger/fabric-sdk-node/test/temp/debug.log" created="2019-08-12 19:03:46.0" updateauthor="harrisob@us.ibm.com" updated="2019-08-12 19:03:46.0"/>
<Action id="62818" issue="39775" author="vijaypunugubati" type="comment" created="2019-08-12 20:25:24.0" updateauthor="vijaypunugubati" updated="2019-08-12 20:25:24.0"> <body><! CDATA In the current build process of end-2-end testing on fabric repo, we are not capturing logs for sdk-node tests while error check, at the same time we do capture on core sdk-node repo builds during error check.    I am testing on sanbox to capture the debug logs.  ></body> </Action>
<Action id="62820" issue="39775" author="vijaypunugubati" type="comment" created="2019-08-12 21:22:47.0" updateauthor="vijaypunugubati" updated="2019-08-13 14:07:45.0"> <body><! CDATA Please check this log, ran on sandbox  https://jenkins.hyperledger.org/sandbox/job/fabric-end-2-end-daily-master-x86_64/4/console  to check debug.log  Fabric-end-2-end-daily-master-x86_64:   https://jenkins.hyperledger.org/sandbox/view/All/job/fabric-end-2-end-daily-master-x86_64/lastFailedBuild/artifact/gopath/src/github.com/hyperledger/fabric-sdk-node/test/temp/debug.log   Fabric-merge-end-2-end-x86_64:   https://jenkins.hyperledger.org/sandbox/view/All/job/fabric-merge-end-2-end-x86_64/5/consoleFull   ></body> </Action>
<Action id="62843" issue="39775" author="harrisob@us.ibm.com" type="comment" created="2019-08-13 15:19:15.0" updateauthor="harrisob@us.ibm.com" updated="2019-08-13 15:19:15.0"> <body><! CDATA Looks like the segfault is in the HSM simulator. Let's create a limited test for merge and daily that runs just runs the end to end without all the functional testing of NodeSDK.  Please point the merge job and daily jobs to run `gulp run-test-merge`.  ></body> </Action>
<Action id="62870" issue="39775" author="vijaypunugubati" type="comment" created="2019-08-14 10:26:55.0" updateauthor="vijaypunugubati" updated="2019-08-14 10:26:55.0"> <body><! CDATA Please refer these CR's for above error fix   https://gerrit.hyperledger.org/r/#/c/fabric-sdk-node/+/32860/    https://gerrit.hyperledger.org/r/#/c/fabric-sdk-node/+/32895/    https://gerrit.hyperledger.org/r/#/c/ci-management/+/32902/   The error is resolved now on merge jobs, waiting for consistency in running the success of the sdk-node tests and close the issue.   ></body> </Action>
<Action id="62908" issue="39775" author="btl5037" type="comment" created="2019-08-15 02:28:08.0" updateauthor="btl5037" updated="2019-08-15 02:30:54.0"> <body><! CDATA The cucumber tests are failing on the Merge E2E job as well. I can replicate this error locally. I can also replicate the segfault locally when running the normal merge suite. As a workaround, disabling HSM tests in that test suite lets us get by, only missing the few tests related to HSM support. Can we just export the variable to disable the tests prior to calling gulp for now until we solve this: {code:java} export PKCS11_TESTS=false {code}  ></body> </Action>
<Action id="62910" issue="39775" author="harrisob@us.ibm.com" type="comment" body="Yes, good idea, disable the HSM test." created="2019-08-15 03:51:40.0" updateauthor="harrisob@us.ibm.com" updated="2019-08-15 03:51:40.0"/>
<Action id="62911" issue="39775" author="harrisob@us.ibm.com" type="comment" body="Yes, good idea, disable the HSM test." created="2019-08-15 03:51:40.0" updateauthor="harrisob@us.ibm.com" updated="2019-08-15 03:51:40.0"/>
<Action id="62947" issue="39775" author="btl5037" type="comment" created="2019-08-15 14:42:01.0" updateauthor="btl5037" updated="2019-08-15 14:42:32.0"> <body><! CDATA  https://jenkins.hyperledger.org/sandbox/view/fabric/job/fabric-merge-end-2-end-x86_64/9/console   Running with PKCS11 tests disabled in sandbox now  ></body> </Action>
<Action id="63405" issue="39775" author="heatherp" type="comment" created="2019-08-29 16:21:04.0" updateauthor="heatherp" updated="2019-08-29 16:21:04.0"> <body><! CDATA  ~vijaypunugubati   ~btl5037  - can this be closed off? I can see the CRs are all merged     ></body> </Action>
<Action id="63630" issue="39775" author="denyeart" type="comment" created="2019-09-09 17:17:59.0" updateauthor="denyeart" updated="2019-09-09 17:21:42.0"> <body><! CDATA  ~vijaypunugubati  Closed, problem is resolved. Please re-open if something remains.   ~andrew-coleman   ~harrisob@us.ibm.com  HSM tests were disabled to get around the problem. How important is it to determine root cause and re-enable the tests?  ></body> </Action>
