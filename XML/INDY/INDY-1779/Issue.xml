<Issue id="34882" key="INDY-1779" number="1779" project="10303" reporter="spivachuk" creator="spivachuk" type="10002" summary="Adjust last_ordered_3pc on non-primary backup replica upon reception of PrePrepare if there are no ordered batches in this view" priority="3" status="10200" created="2018-10-25 11:48:25.0" updated="2019-10-25 12:09:09.0" votes="0" watches="1" workflowId="46299"> <description><! CDATA Adjust {{last_ordered_3pc}} and update the watermarks on a non-primary backup replica upon reception of PrePrepare if the replica has not ordered any 3PC-batches in this view yet. This will be a workaround for a case of faulty restoration of pp_seq_no on the backup's primary when view_no from the persisted triad (inst_id, view_no, pp_seq_no) coincides with view_no of the current pool view but actually the latter is a different view, not the view which the persisted triad relates to. (See comments to INDY-1759 for details.)  Currently we already do a similar adjustment of {{last_ordered_3pc}} on a non-primary backup replica but we do it on gathering a prepared certificate rather than just on reception of a PrePrepare. This was implemented for proceeding ordering on non-primary backup replicas after a catch-up. Loosing the condition for {{last_ordered_3pc}} adjustment will not break ability of a non-primary backup replica to proceed ordering after a catch-up.  ></description> </Issue>
