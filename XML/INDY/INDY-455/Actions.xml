<Action id="29839" issue="19451" author="alexander.shekhovcov" type="comment" created="2017-08-15 10:46:21.0" updateauthor="alexander.shekhovcov" updated="2017-08-15 10:46:36.0"> <body><! CDATA (/) *Case:* The primary replica crashes and completely looses its checkpoint context (array of `checkpoints` and watermark). After the replica is connected back the view is not changed (not enough InstanceChange for consensus or some other reason) so the replica stays the primary. In this case the replica stashes requests because the watermark is reseted.  *The solution:* Set `h` (watermark) on propagate primary done. Unfortunately, it won't recover a backup replica but pool works well with this solution. Backup replica will stash 3pc messages until the next view change. https://github.com/hyperledger/indy-plenum/pull/337  (i) *How to test:* * Have 3 nodes * Stop the Primary * Re-start the Primary. Since we had only 2 active nodes, view is not changed (not enough InstanceChange for consensus) * Start sending txns     ></body> </Action>
<Action id="30032" issue="19451" author="vladimirwork" type="comment" created="2017-08-21 07:54:01.0" updateauthor="vladimirwork" updated="2017-08-21 07:54:01.0"> <body><! CDATA Build Info: indy-node 1.0.112  Steps to Validate: 1. Have 3 nodes. 2. Stop the Primary. 3. Start the Primary. 4. Start sending txns.  Actual Results: View is not changed after Step 3. !2.PNG|thumbnail!  Txn sending works normally after Step 4. !1.PNG|thumbnail!   ></body> </Action>
