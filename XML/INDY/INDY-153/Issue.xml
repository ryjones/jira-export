<Issue id="17503" key="INDY-153" number="153" project="10303" reporter="aleksey-roldugin" assignee="danielhardman" creator="aleksey-roldugin" type="10004" summary="Node cannot start after failure" priority="1" resolution="10000" status="10001" created="2017-06-05 16:40:46.0" updated="2019-03-29 20:35:12.0" resolutiondate="2019-03-29 20:35:12.0" votes="0" watches="4" workflowId="17507"> <description><! CDATA h6. BUILD:  sovrin-node 0.3.17 h6. STEPS TO REPRODUCE: # Make set up with 10 machines (4 nodes for genesis pool, 4 clients, 2 nodes for adding). # Add 2 nodes. # Check that they successfully performed catch up. # Perform some operations for adding NYM on client.  h6. Actual RESULT: - Node disconnects-connects-disconnects. {code:java} sovrin@test> new key with seed 0000000000000000000KellySteward1 Key created in keyring Default-G8VrmL Identifier for key is EHHnpHErJkPqhtJWuKekA4Cn8jLhvnfTsvVVdy53Qarr Current identifier set to EHHnpHErJkPqhtJWuKekA4Cn8jLhvnfTsvVVdy53Qarr sovrin@test> send NODE dest=4Tn3wZMNCvhSTXPcLinQDnHyj56DTLQtL61ki4jo2Loc data={'client_port': 9710, 'client_ip': '10.0.0.105', 'alias': 'Node5', 'node_ip': '10.0.0.105', 'node_port': 9709, ' services':  'VALIDATOR' } Sending node request for node identifier 4Tn3wZMNCvhSTXPcLinQDnHyj56DTLQtL61ki4jo2Loc by EHHnpHErJkPqhtJWuKekA4Cn8jLhvnfTsvVVdy53Qarr (request id: 1496673374998911) BGz5924BWP56KvxgaAbknPhoHTuVjgAbJtAe4NMaAfdp looking for Node5C at 10.0.0.105:9710 Node request completed 4Tn3wZMNCvhSTXPcLinQDnHyj56DTLQtL61ki4jo2Loc BGz5924BWP56KvxgaAbknPhoHTuVjgAbJtAe4NMaAfdp now connected to Node5C sovrin@test> new key with seed 0000000000000000000KellySteward2 Key created in keyring Default-G8VrmL Identifier for key is DqCx7RFEpSUMZbV2mH89XPH6JT3jMvDNU55NTnBHsQCs Current identifier set to DqCx7RFEpSUMZbV2mH89XPH6JT3jMvDNU55NTnBHsQCs sovrin@test> send NODE dest=6G9QhQa3HWjRKeRmEvEkLbWWf2t7cw6KLtafzi494G4G data={'client_port': 9712, 'client_ip': '10.0.0.106', 'alias': 'Node6', 'node_ip': '10.0.0.106', 'node_port': 9711, ' services':  'VALIDATOR' } Sending node request for node identifier 6G9QhQa3HWjRKeRmEvEkLbWWf2t7cw6KLtafzi494G4G by DqCx7RFEpSUMZbV2mH89XPH6JT3jMvDNU55NTnBHsQCs (request id: 1496673453996173) BGz5924BWP56KvxgaAbknPhoHTuVjgAbJtAe4NMaAfdp looking for Node6C at 10.0.0.106:9712 Node request completed 6G9QhQa3HWjRKeRmEvEkLbWWf2t7cw6KLtafzi494G4G BGz5924BWP56KvxgaAbknPhoHTuVjgAbJtAe4NMaAfdp now connected to Node6C sovrin@test> new key with seed 000000000000000000000TestNODETGB Key created in keyring Default-G8VrmL Identifier for key is 7wTXmdcUkkpbEQTbA7E4qLdrAQATq7EkHfKBzNgNbERF Current identifier set to 7wTXmdcUkkpbEQTbA7E4qLdrAQATq7EkHfKBzNgNbERF sovrin@test> new key with seed 0000000000000TestNODETrustAnchor Key created in keyring Default-G8VrmL Identifier for key is FXBEVeDHLLSGdeGj22L9NgiFVrzKj7ocXYfe8RMVFxwQ Current identifier set to FXBEVeDHLLSGdeGj22L9NgiFVrzKj7ocXYfe8RMVFxwQ sovrin@test> new key with seed 00000000000TestNODEIdentityOwner Key created in keyring Default-G8VrmL Identifier for key is FShf9bpKn22ATP8Jd8FkzgeaQuPRHzcJozgFMRw9t3gb Current identifier set to FShf9bpKn22ATP8Jd8FkzgeaQuPRHzcJozgFMRw9t3gb sovrin@test> new key with seed 000000000000000000000000Trustee1 Key created in keyring Default-G8VrmL Identifier for key is GJ1SzoWzavQYfNL9XkaJdrQejfztN4XqdsiV4ct3LXKL Current identifier set to GJ1SzoWzavQYfNL9XkaJdrQejfztN4XqdsiV4ct3LXKL sovrin@test> send NYM dest=7wTXmdcUkkpbEQTbA7E4qLdrAQATq7EkHfKBzNgNbERF role=TGB Adding nym 7wTXmdcUkkpbEQTbA7E4qLdrAQATq7EkHfKBzNgNbERF BGz5924BWP56KvxgaAbknPhoHTuVjgAbJtAe4NMaAfdp disconnected from Node5C Nym 7wTXmdcUkkpbEQTbA7E4qLdrAQATq7EkHfKBzNgNbERF added sovrin@test> send NYM dest=DqCx7RFEpSUMZbV2mH89XPH6JT3jMvDNU55NTnBHsQCs role=TRUST_ANCHOR Adding nym DqCx7RFEpSUMZbV2mH89XPH6JT3jMvDNU55NTnBHsQCs Remote Node5C is not connected - message will not be sent immediately.If this problem does not resolve itself - check your firewall settings Error: client request invalid: UnauthorizedClientRequest('TRUSTEE cannot update role',) BGz5924BWP56KvxgaAbknPhoHTuVjgAbJtAe4NMaAfdp now connected to Node5C BGz5924BWP56KvxgaAbknPhoHTuVjgAbJtAe4NMaAfdp disconnected from Node5C Remote Node5C is not connected - message will not be sent immediately.If this problem does not resolve itself - check your firewall settings Remote Node5C is not connected - message will not be sent immediately.If this problem does not resolve itself - check your firewall settings Remote Node5C is not connected - message will not be sent immediately.If this problem does not resolve itself - check your firewall settings Remote Node5C is not connected - message will not be sent immediately.If this problem does not resolve itself - check your firewall settings Remote Node5C is not connected - message will not be sent immediately.If this problem does not resolve itself - check your firewall settings {code}  - Node failed to start (see attached logs)  {code:java} sovrin-node.service - Sovrin Node Loaded: loaded (/etc/systemd/system/sovrin-node.service; enabled; vendor pres Active: inactive (dead) (Result: exit-code) since Mon 2017-06-05 14:50:45 UTC Process: 13367 ExecStart=/usr/local/bin/start_sovrin_node ${NODE_NAME} ${NODE_ Main PID: 13367 (code=exited, status=1/FAILURE) Jun 05 14:50:34 Node5.evernym.lab systemd 1 : sovrin-node.service: Main process Jun 05 14:50:34 Node5.evernym.lab systemd 1 : sovrin-node.service: Unit entered Jun 05 14:50:34 Node5.evernym.lab systemd 1 : sovrin-node.service: Failed with r Jun 05 14:50:45 Node5.evernym.lab systemd 1 : sovrin-node.service: Service hold- Jun 05 14:50:45 Node5.evernym.lab systemd 1 : Stopped Sovrin Node. Jun 05 14:50:45 Node5.evernym.lab systemd 1 : sovrin-node.service: Start request Jun 05 14:50:45 Node5.evernym.lab systemd 1 : Failed to start Sovrin Node.{code}     ></description> </Issue>
