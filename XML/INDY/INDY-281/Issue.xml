<Issue id="18364" key="INDY-281" number="281" project="10303" reporter="krw910" assignee="krw910" creator="krw910" type="10002" summary="Upgrade: try pool upgrade when system&apos;s clock is tweaked" priority="3" resolution="10000" status="10001" created="2017-06-19 22:25:40.0" updated="2019-03-29 20:32:41.0" resolutiondate="2019-03-29 20:32:41.0" votes="0" watches="2" workflowId="18369"> <description><! CDATA Upgrade: try pool upgrade when system's clock is tweaked  *Things tried:*   +Case 1:+ system's clock is tweaked on the client machine.  1. Set system time to the past.  2. Send POOL_UPGRADE later than new system time, but earlier than current time at the node. Result: Validation of schedule does not depend on system's clock on client machine. Upgrade has failed because of invalid schedule: {code:java} sovrin@sovrin-VirtualBox:~/.sovrin$ sudo date -s "08/2/2017 12:19" sovrin@test> send POOL_UPGRADE name=upgrade-3 version=1.0.72 sha256=f6f2ea8f45d8a057c9566a33f99474da2e5c6a6604d736121650e2730c6fb0a3 ac tion=start schedule={'Gw6pDLhcBcoQesN72qfotTgFa7cbuqZpkX3Xo6pLhPhv': '2017-08-03T08:45:00.000000+00:00', '8ECVSk179mjsjKRLWiQtssMLgp6EPhWXtaYyStWPSGAb': '2017-08-03T08:50:00.000000+00:00', 'DKVxG2fXXTU8yT5N7hGEbXB3dfdAnYv1JczDUHpmDxya': '2017-08-03T08:55:00.000000+00:00', '4PS3EDQ3dW1tci1Bp6543CfuuebjFrg36kLAUcskGfaA': '2017-08-03T09:00:00.000000+00:00'} timeout=10 Sending pool upgrade upgrade-3 for version 1.0.72 Pool upgrade failed: client request invalid: InvalidClientRequest("{'DKVxG2fXXTU8yT5N7hGEbXB3dfdAnYv1JczDUHpmDxya': '2017-08-03T08:55:00.000000+00:00', '8ECVSk179mjsjKRLWiQtssMLgp6EPhWXtaYyStWPSGAb': '2017-08-03T08:50:00.000000+00:00', '4PS3EDQ3dW1tci1Bp6543CfuuebjFrg36kLAUcskGfaA': '2017-08-03T09:00:00.000000+00:00', 'Gw6pDLhcBcoQesN72qfotTgFa7cbuqZpkX3Xo6pLhPhv': '2017-08-03T08:45:00.000000+00:00'} not a valid schedule since 2017-08-03 08:55:00+00:00 is less than current time",){code} +Case 2:+ system's clock is tweaked on one of the nodes.   +Case 3:+ system's clock is tweaked on several nodes.  +Case 4:+ change system date/time when the upgrade is already scheduled.  *Findings:*  Case 2, 3 and 4 don't make sense.  In Case 2 and Case 3 nothing happened after sending of POOL_UPGRADE transaction. But the problem is not in POOL_UPGRADE. Pool breaks after changing of system time on at least one node.  In Case 4 POOL_UPGRADE was send successfully, upgrade was happened in accordance with new system time.  ></description> </Issue>
