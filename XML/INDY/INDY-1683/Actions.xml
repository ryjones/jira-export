<Action id="52618" issue="33506" author="ashcherbakov" type="comment" body="I think we should use `quorum` strategy for degradation and `local` strategy for disconnection" created="2018-10-25 08:17:26.0" updateauthor="ashcherbakov" updated="2018-10-25 08:17:26.0"/>
<Action id="53066" issue="33506" author="toktar" type="comment" created="2018-11-06 09:44:24.0" updateauthor="toktar" updated="2018-11-06 13:13:01.0"> <body><! CDATA If we will remove replicas only with quorum of messages, nodes are not protected from memory leaks.  I think we should switch on quorum strategy for degradation and "local" for disconnected, but change it. In new "quorum" strategy, node send  BackupInstanceFaulty message with every problem detection. Replica will removed if  * node has a quorum of message from different nodes * node has a quorum of own messages  ></body> </Action>
<Action id="53118" issue="33506" author="toktar" type="comment" created="2018-11-07 09:41:41.0" updateauthor="toktar" updated="2018-11-07 14:17:03.0"> <body><! CDATA Problem reason: -  With "local" strategy of replicas removing, different nodes can have different count of nodes.   Changes: - Add a new "quorum" strategy for removing performance degraded replica with quorum(f-1) own messages or quorum of messages from other nodes. - Add tests  PR: *  https://github.com/hyperledger/indy-plenum/pull/954  *  https://github.com/hyperledger/indy-node/pull/1014   Version: * indy-node 1.6.661 -master * indy-plenum 1.6.583  -master  Risk factors: - All replicas will be removed or no one replicas will not be removed and will happen memory leak.  Risk: - Low  Covered with tests: *  test_instance_faulty_processor.py|https://github.com/hyperledger/indy-plenum/pull/954/files#diff-e1a005e8a7b3eef109858ae5550ce196   Recommendations for QA: * Load test with 40 NUM/sec for 4 hours.  ></body> </Action>
<Action id="53254" issue="33506" author="vladimirwork" type="comment" created="2018-11-09 09:46:27.0" updateauthor="vladimirwork" updated="2018-11-09 09:47:38.0"> <body><! CDATA Build Info: indy-node 1.6.669  Steps to Validate: 1. Run 20 nyms/sec for 15 hours. 2. Check metrics and logs for OOM reasons and replicas removal at any node.  Actual Results: Pool works normally. Only 8th node breaks due to OOM and corresponding replica was removed successfully at 03:30 to avoid OOM at all other nodes. !1683_1.png|thumbnail!  !1683_6.png|thumbnail!  !1683_8.png|thumbnail!  !1683_16.png|thumbnail!   ></body> </Action>
