<Action id="64766" issue="42322" author="toktar" type="comment" created="2019-10-17 12:33:00.0" updateauthor="toktar" updated="2019-10-17 12:33:00.0"> <body><! CDATA *PoA:*  Request `NewView` from a Primary if  when node sends Instance change with reason 28 ('View change could not complete in time').  Schedule reasking NewView for every NEW_VIEW_TIMEOUT if waiting_for_new_view==True and NewView  was not received. Process MessageRep only from the future primary and send MessageRep only by the primary node.  Add tests: * simulation test with delaying NewView messages an * unit tests ** for sending MessageReq(NewView) ** for process MessageReq(NewView) and sending MessageRep(NewView) (by primary and non primary) ** for process MessageRep(NewView) (by primary and non primary)  ></body> </Action>
<Action id="64773" issue="42322" author="sergey.khoroshavin" type="comment" body="Regarding simulation tests - I propose instead of adding separate test introduce random &quot;loss&quot; of NewView messages into existing one." created="2019-10-17 15:09:35.0" updateauthor="sergey.khoroshavin" updated="2019-10-17 15:09:35.0"/>
<Action id="64775" issue="42322" author="toktar" type="comment" body=" PR: https://github.com/hyperledger/indy-plenum/pull/1375|https://github.com/hyperledger/indy-plenum/pull/1375 " created="2019-10-17 15:27:37.0" updateauthor="toktar" updated="2019-10-17 15:27:37.0"/>
<Action id="64792" issue="42322" author="toktar" type="comment" created="2019-10-18 15:13:33.0" updateauthor="toktar" updated="2019-10-18 15:13:33.0"> <body><! CDATA *Problem reason:* - If a node lost NewView message, it can't finish a view change.  *Changes:* - Request NewView from a primary if the message wasn't received after NEW_VIEW_TIMEOUT seconds.  *PR:* *  https://github.com/hyperledger/indy-plenum/pull/1375   *Version:* * indy-node 1.11.0.dev1110 -master * indy-plenum 1.11.0.dev935 -master  *Risk factors:* - Problems with re-asking 3pc and view change messages  *Risk:* - Low  *Tests:* *  test_message_req_new_view.py|https://github.com/hyperledger/indy-plenum/pull/1375/files#diff-89de6cfdbee182a531a78bdb43c775f7   *  test_sim_view_change.py|https://github.com/hyperledger/indy-plenum/pull/1375/files#diff-59b79d040115d7127b1ee697def2ed89   *  test_view_change_with_lost_new_view.py|https://github.com/hyperledger/indy-plenum/pull/1375/files#diff-0df670bc5e24bf7848a0c2c8c246d609    *Recommendations for QA:* *  Start a docker pool for 4 nodes * Delay on Node4 messages from Node2 * Start a view change on all nodes. * Reset delays after 2 min * Wait 1 min * Check that all nodes finished view change.  ></body> </Action>
<Action id="64815" issue="42322" author="vladimirwork" type="comment" created="2019-10-21 15:01:12.0" updateauthor="vladimirwork" updated="2019-10-21 15:01:12.0"> <body><! CDATA Build Info: indy-node 1.11.0~dev1110  Steps to Validate: 1. Start a docker pool for 4 nodes. 2. Delay on Node4 messages from Node2. 3. Start a view change on all nodes. 4. Reset delays after 2 min. 5. Wait 1 min. 6. Check that all nodes finished view change.  Actual Results: Pool finished VC successfully.  ></body> </Action>
