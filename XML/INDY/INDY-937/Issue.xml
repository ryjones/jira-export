<Issue id="22938" key="INDY-937" number="937" project="10303" reporter="vladimirwork" assignee="anikitindsr" creator="vladimirwork" type="10004" summary="Inconsistent ledger entries count during the large ledger catch up" priority="4" resolution="10000" status="10001" created="2017-10-30 15:11:30.0" updated="2019-03-29 20:32:50.0" resolutiondate="2019-03-29 20:32:50.0" votes="0" watches="2" workflowId="22939"> <description><! CDATA Build Info: indy-node 1.2.188  Overview: Inconsistent ledger entries count during the large ledger catch up  Steps to Reproduce: 1. Install a pool of 4 nodes. 2. Write more than 50k NYMs via load_test.py script. 3. Stop the 1th node and delete .indy/data/ folder. 4. Start the 1th node. 5. Perform _read_ledger --type=domain --count_ at the 1th node several times during catch up.  Actual Results: There are inconsistent sequence of entries (later requests can return lesser values or even bigger than the ledger pool count) and read_ledger tool freezes due to some requests:  root@28c8b0341b77:/home/indy# read_ledger --type=domain --count 773 root@28c8b0341b77:/home/indy# read_ledger --type=domain --count 28345 root@28c8b0341b77:/home/indy# read_ledger --type=domain --count 19871 root@28c8b0341b77:/home/indy# read_ledger --type=domain --count ^CTraceback (most recent call last): File "/usr/local/lib/python3.5/dist-packages/ledger/ledger.py", line 73, in recoverTree self.recoverTreeFromHashStore() File "/usr/local/lib/python3.5/dist-packages/ledger/ledger.py", line 101, in recoverTreeFromHashStore self.tree.verify_consistency(self._transactionLog.size) File "/usr/local/lib/python3.5/dist-packages/ledger/compact_merkle_tree.py", line 287, in verify_consistency raise ConsistencyVerificationFailed() ledger.util.ConsistencyVerificationFailed  Expected Results: read_ledger tool should return actual values and shouldn't freeze.  ></description> </Issue>
