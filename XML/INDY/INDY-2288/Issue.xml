<Issue id="43233" key="INDY-2288" number="2288" project="10303" reporter="ashcherbakov" creator="ashcherbakov" type="10004" summary="Apply existing PrePrepares for future batches after catchup" priority="3" status="10200" created="2019-11-08 13:29:27.0" updated="2020-01-08 08:09:21.0" votes="0" watches="1" workflowId="56339"> <description><! CDATA *Issue* * A node has all PrePrepares till (3, 230) (for example), but last ordered is (3, 55) * A node starts a catchup (so uncommitted state is reverted) * A node caught up till (3, 202). * A node receives PrePrepare (3, 231) after catchup. It sees that its last PrePrepare is (3, 230), so it starts to apply it.  * But PrePrepares from last ordered (3,202) till (3,230) are not applied (reverted during catchup), so the node will have incorrect state trie  *Fix* * Re-apply all PrePrepares higher that lastCaughtup3PC after catchup * Write an integration test  ></description> </Issue>
