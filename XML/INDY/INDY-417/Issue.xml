<Issue id="19241" key="INDY-417" number="417" project="10303" reporter="krw910" assignee="krw910" creator="krw910" type="10004" summary="Faber and Acme demo agents are unable startup because they cannot authenticate " priority="1" resolution="10200" status="10001" created="2017-07-13 19:15:50.0" updated="2019-03-29 20:33:53.0" resolutiondate="2019-03-29 20:33:53.0" votes="0" watches="2" workflowId="19241"> <description><! CDATA *{color:#14892c}Scroll to the bottom for what I believe the fix is. I tried the fix out manually and it did not seem to work, but I know that section of code will be an issue with DIDs{color}*     When starting the Faber and Acme agents they are not able to authenticate and therefore cannot finish the startup process. I believe this is because we changed from Cryptonyms to DIDs and it does not have the verkey in the wallet where the agent is running from.  *Setup* 4 nodes 4 clients (3 client will act separately as the Faber, Acme, and Thrift agents)  *Steps* *Start the CLI* sovrin  *Register the Faber agent* {code:java} send NYM dest=ULtgFQJe6bjiFbs7ke3NJD role=TRUST_ANCHOR  send ATTRIB dest=ULtgFQJe6bjiFbs7ke3NJD raw={"endpoint": {"ha": "10.0.0.202:5555", "pubkey": "5hmMA64DDQz5NzGJNVtRzNwpkZxktNQds21q3Wxxa62z"}} {code} *Register the Acme agent* {code:java} send NYM dest=CzkavE58zgX7rUMrzSinLr role=TRUST_ANCHOR  send ATTRIB dest=CzkavE58zgX7rUMrzSinLr raw={"endpoint": {"ha": "10.0.0.203:6666", "pubkey": "C5eqjU7NMVMGGfGfx2ubvX5H9X346bQt5qeziVAo3naQ"}} {code} *Register the ThriftBank agent* {code:java} send NYM dest=H2aKRiDeq8aLZSydQMDbtf role=TRUST_ANCHOR  send ATTRIB dest=H2aKRiDeq8aLZSydQMDbtf raw={"endpoint": {"ha": "10.0.0.204:7777", "pubkey": "AGBjYvyM3SFnoiDGAEzkSLHvqyzVkXeMZfKDvdpEsC2x"}} {code} *On Client 2 run* {code:java} python3 /usr/local/lib/python3.5/dist-packages/sovrin_client/test/agent/faber.py  --port 5555 {code} *On Client 3 run* {code:java} python3 /usr/local/lib/python3.5/dist-packages/sovrin_client/test/agent/acme.py  --port 6666 {code} *On Client 4 run* {code:java} python3 /usr/local/lib/python3.5/dist-packages/sovrin_client/test/agent/thrift.py  --port 7777 {code} *{color:#d04437}Error{color}* After starting the agents and doing nothing else you will see the Faber and Acme agent exit with an error about not being able to authenticate.  See Attachment   *{color:#14892c}Fix{color}* The issue is when we used cryptonyms the verkey was the same as the cryptonym. In the agent code you will see the verkey just equals the cryptonym for the seed that was passed. I will provide you with the correct verkey and you should just have to replace it in the code.  You will find the agent code here https://github.com/hyperledger/indy-node/tree/master/sovrin_client/test/agent  *{color:#205081}faber.py{color}* {code} FABER_SEED = b'Faber000000000000000000000000000' FABER_SIGNER = DidSigner(seed=FABER_SEED) FABER_ID = FABER_SIGNER.identifier FABER_VERKEY = FABER_SIGNER.verkey {code} The DID that is produced from the faber seed is *Faber Agent* new key with seed Faber000000000000000000000000000 Identifier for key is ULtgFQJe6bjiFbs7ke3NJD Verification key is ~5kh3FB4H3NKq7tUDqeqHc1  You should be able to just replace  FABER_VERKEY = FABER_SIGNER.verkey with FABER_VERKEY = '~5kh3FB4H3NKq7tUDqeqHc1'  -------------------------------------------------------------------------------------------------------  *{color:#205081}acme.py{color}* {code} ACME_SEED = b'Acme0000000000000000000000000000' ACME_ID = DidSigner(seed=ACME_SEED).identifier ACME_VERKEY = DidSigner(seed=ACME_SEED).verkey ACME_SIGNER = DidSigner(seed=ACME_SEED) {code} The DID that is produced from the faber seed is *Acme Agent* new key with seed Acme0000000000000000000000000000 Identifier for key is CzkavE58zgX7rUMrzSinLr Verification key is ~WjXEvZ9xj4Tz9sLtzf7HVP  You should be able to just replace  ACME_VERKEY = DidSigner(seed=ACME_SEED).verkey with ACME_VERKEY = '~WjXEvZ9xj4Tz9sLtzf7HVP'  -------------------------------------------------------------------------------------------------------  *{color:#205081}thrift.py{color}* {code} THRIFT_SEED = b'Thrift00000000000000000000000000' THRIFT_SIGNER = DidSigner(seed=THRIFT_SEED) THRIFT_ID = THRIFT_SIGNER.identifier THRIFT_VERKEY = THRIFT_SIGNER.verkey {code} The DID that is produced from the faber seed is *Thrift Agent* new key with seed Thrift00000000000000000000000000 Identifier for key is H2aKRiDeq8aLZSydQMDbtf Verification key is ~3sphzTb2itL2mwSeJ1Ji28  You should be able to just replace  THRIFT_VERKEY = THRIFT_SIGNER.verkey with THRIFT_VERKEY = '~3sphzTb2itL2mwSeJ1Ji28'       ></description> </Issue>
