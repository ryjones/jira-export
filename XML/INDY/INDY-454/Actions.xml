<Action id="28892" issue="19443" author="alexander.shekhovcov" type="comment" created="2017-07-24 13:09:29.0" updateauthor="alexander.shekhovcov" updated="2017-07-24 13:09:29.0"> <body><! CDATA (/) *Problem reason:* - a node may get f+1 old LedgerStatus before new ones and stop the catchup procedure  *Changes:* - set LedgerStatus quorum N-f-1  Committed into:  indy-node 0.4.60+ https://github.com/hyperledger/indy-plenum/commit/659d503252136e3a516ad4c85ac3373e5d261742  *Risk factors:* Nothing is expected.  *Risk:* Low  *Covered with tests:* test_ledger_status_quorum  *Recommendations for QA:* Testing the ticket is rather complicated. A pool should be in state when f+2 node have an old state whereas n-f-2 have a new state. But n-f-2 is below required consensus so n-f-2 nodes cannot process requests.  In INDY-246 we got such a state in the result of crashes f+2 nodes between some txns had quorum and were persistent in to a local ledger.  After we get pool in required state some node should get f+1 old LedgerStatus messages from another crashed f+1 before new ones.  Looks like we have to alter f+2 nodes code in a pool in order to crash nodes and then alter node's code which will skip new LedgerStatus and receive only old LedgerStatus and check  if the node does not synced.   Let's think how we can test it simpler.  ></body> </Action>
<Action id="28907" issue="19443" author="krw910" type="comment" body="I have a pool that I think is in that state now. I will upgrade the pool and see what happens." created="2017-07-24 15:44:19.0" updateauthor="krw910" updated="2017-07-24 15:44:19.0"/>
<Action id="29045" issue="19443" author="krw910" type="comment" body="This appears to be working. I ran from the same pool I had before. I had two nodes already working on catch up. During the test I had another two get out of sync. One got back in sync so the pool could keep going and the other started catching up. The first two nodes are far enough behind that they were not able to catch up by the end of the test. We still have issues in this area, but this ticket is fixed." created="2017-07-26 15:32:41.0" updateauthor="krw910" updated="2017-07-26 15:32:41.0"/>
