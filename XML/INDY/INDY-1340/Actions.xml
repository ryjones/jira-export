<Action id="63447" issue="30296" author="sergey.khoroshavin" type="comment" created="2019-08-30 16:27:00.0" updateauthor="sergey.khoroshavin" updated="2019-08-30 16:27:00.0"> <body><! CDATA Some work that was expected to be done in scope of INDY-2177 turned out to be blocked by INDY-1336, so it was decided to move it into scope of this issue. PR is already raised (https://github.com/hyperledger/indy-plenum/pull/1317), but more work is required in order to make all tests pass: * finish INDY-1336 * stop resetting checkpoint after view change * remove as much as possible view_no references from CheckpointService and related tests (I left lots of TODO comments in relevant parts of code, they can be easily found by looking through PRs raised in scope of INDY-2177)  ></body> </Action>
<Action id="63485" issue="30296" author="ashcherbakov" type="comment" created="2019-09-02 13:51:38.0" updateauthor="ashcherbakov" updated="2019-09-13 16:08:23.0"> <body><! CDATA *PoA:* #  DONE  Add `pp_view_no` field to `BatchID` - https://github.com/hyperledger/indy-plenum/pull/1326 ** This is the viewNo where the PrePrepare associated with the BatchID has been applied first time (so persisted in the audit ledger) #  DONE  Support `old_view_preprepares` in Ordering Service - https://github.com/hyperledger/indy-plenum/pull/1326 - ** It needs to take into account (pp_view_no, pp_seq_no, pp_digest) when searching for a PrePrepare in `process_new_view_checkpoints_applied` ** `old_view_preprepares` needs to be correctly GCed- #  DONE  Support requesting old view PrePrepares https://github.com/hyperledger/indy-plenum/pull/1329 ** call it from `process_new_view_checkpoints_applied` ** create a new MessageReq type for this, so that it's sent to all nodes, and reply from any node can be processed (not from a primary only as in a case of common PrePrepare requests) #  DONE  Add more unit tests for `process_new_view_checkpoints_applied` https://github.com/hyperledger/indy-plenum/pull/1329 ** check that `process_new_view_checkpoints_applied` sends a Prepare and adds a PrePrepare if BatchID is already ordered ** check that `process_new_view_checkpoints_applied` applies a PrePrepare (andÂ sends a Prepare if it's not Primary) if BatchID is not already ordered ** check that `process_new_view_checkpoints_applied` requests missing old view PrePrepares from other nodes ** check that `old_view_preprepares` GCed #  DONE  Merge  https://github.com/hyperledger/indy-plenum/pull/1317  #  DONE  Revert unordered batches and set lastPPSeqNo on `ViewChangeStarted` in Ordering Service #  DONE  Changes in View Change Service: ** Move to a new view if there is no NEW VIEW message from a primary for more than X second. Send INSTANCE_CHANGE in this case ** Find out the default value for X    ></body> </Action>
<Action id="63757" issue="30296" author="ashcherbakov" type="comment" created="2019-09-13 16:11:41.0" updateauthor="ashcherbakov" updated="2019-09-13 16:11:41.0"> <body><! CDATA *Changes* - all tasks mentioned in the PoA are done  *PRs*: - https://github.com/hyperledger/indy-plenum/pull/1326 - https://github.com/hyperledger/indy-plenum/pull/1329 - https://github.com/hyperledger/indy-plenum/pull/1330  Implementation and testing will be continued in INDY-2223 and INDY-2146  ></body> </Action>
