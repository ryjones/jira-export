<Issue id="20942" key="INDY-869" number="869" project="10303" reporter="mgbailey" assignee="nage" creator="mgbailey" type="10004" summary="Nodes are reverting to 1.1.33 when doing manual upgrade to 1.1.37" environment="ESN, running 1.1.33" priority="2" resolution="10000" status="10001" created="2017-09-20 23:03:20.0" updated="2019-03-29 20:32:23.0" resolutiondate="2019-03-29 20:32:23.0" votes="0" watches="5" workflowId="20947"> <description><! CDATA Two weeks ago we upgraded the ESN to 1.1.33 using a ledger transaction.  The upgrade was successful, although no entries were seen on the config ledger to reflect this.  Today, I have been upgrading the nodes of the ESN manually (as required) to 1.1.37, one at a time.  I have seen that after doing "sudo apt update", "sudo apt upgrade", and "sudo apt install indy-plenum indy-node", that the correct packages are installed on the node.    However, a few minutes after executing "sudo systemctl start sovrin-node", I notice that the packages have auto-reverted back to 1.1.33 and 1.1.24.  Looking in the logs (attached) I see at 17:17:14, that upgrader.py is running, and I see that there are now transactions in the config ledger (with today's timestamp) indicating that a successful upgrade to 1.1.33 was performed.  My theory is: when we upgraded to 1.1.33 two weeks ago, we had to use the --force flag, and we had the upgrade happen on all nodes at the same time.  This made it so that during the upgrade there was no consensus, and transactions could not be written to the config ledger.  Now, when we restarted the process today after upgrading to 1.1.37, it discovered an "upgrade" transaction pending in the config ledger, and actually downgraded it to 1.1.33.  ></description> </Issue>
