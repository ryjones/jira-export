<Issue id="17359" key="INDY-132" number="132" project="10303" reporter="andrey.goncharov" assignee="danielhardman" creator="andrey.goncharov" type="10001" summary="Improve migration tool" priority="3" resolution="10000" status="10001" created="2017-06-01 08:12:02.0" updated="2019-03-29 20:35:09.0" resolutiondate="2019-03-29 20:35:09.0" votes="0" watches="4" workflowId="17363"> <description><! CDATA As of now migration tool can apply several migrations after an upgrade. Each migration contains only the version you're coming from. This way if you miss several upgrades you willl have several migrations applied (possibly).  From conversation with Daniel: h4. * dhh1128|https://github.com/dhh1128 *  2 days ago |https://github.com/sovrin-foundation/sovrin-node/pull/159#discussion_r119150885  Owner I am feeling concerned about two issues with this approach: # This creates multiple migration scripts per version change. I want one migration script per update. Anything more is unnecessary complexity. Also, it gives multiple points of failure instead of one, and it gives no responsibility to these individual scripts to know about or coordinate with one another. I think it increases the chances of failure. # This mechanism doesn't include in its name the version you are coming from, only the version you are headed to. I think this is problematic because we might have nodes upgrading from more than one starting point.       !https://avatars3.githubusercontent.com/u/2208904?v=3&s=56|width=28,height=28!|https://github.com/dhh1128  h4. * dhh1128|https://github.com/dhh1128 *  2 days ago |https://github.com/sovrin-foundation/sovrin-node/pull/159#discussion_r119151127  Owner Why are versions underscored here, but use dots in .deb? Can we use dots here?       !https://avatars3.githubusercontent.com/u/12794628?v=3&s=56|width=28,height=28!|https://github.com/keenondrums  h4. * keenondrums|https://github.com/keenondrums *  23 hours ago |https://github.com/sovrin-foundation/sovrin-node/pull/159#discussion_r119313532  Member  @dhh1128|https://github.com/dhh1128  # I think we will have a single script almost always. yet I think we need to leave some room for us to wiggle, since it does not cost us anything. # It's actually the version you are coming from. I think it does not really matter what version you're updating to # Versions are underscored because they are python modules and a python module can not be dotted       !https://avatars3.githubusercontent.com/u/2208904?v=3&s=56|width=28,height=28!|https://github.com/dhh1128  h4. * dhh1128|https://github.com/dhh1128 *  17 hours ago |https://github.com/sovrin-foundation/sovrin-node/pull/159#discussion_r119392573  Owner I don't agree with the idea that "it does not cost us anything." Please collapse to 1 script and eliminate the sorting/collection. The cost of more than 1 script is complexity, as I pointed out. It's not just code complexity--it's communication/doc complexity, and complexity in testing/managing the coordination actions across multiple scripts.  Re  #2|https://github.com/sovrin-foundation/sovrin-node/pull/2 : versioning needs to include a src and a target version. Of these two, the _target_ is more important. We can't say, "give me a script that upgrades version X to any version later than that" -- it's just not practical. Instead, we want to say, "give me a script that upgrades X to Y". Then we can play all the migrations in order to get from X to Z.  ></description> </Issue>
