<Issue id="43017" key="INDY-2276" number="2276" project="10303" reporter="ashcherbakov" creator="ashcherbakov" type="10002" summary="A new node joining the pool during the view change may not be able to start ordering immediately" priority="3" status="10200" created="2019-10-28 16:49:31.0" updated="2020-01-08 08:11:55.0" votes="0" watches="1" workflowId="56121"> <description><! CDATA *Issue* If a new NODE txn is sent and a new Node is started immediately after this, then the Node may node join the consensus immediately, but only after 200 batches.   *Workaround* Wait for some time before starting the newly added node. Make sure that view change happened after NODE txn is sent, and the pool started ordering in new View, and only then start a new Node.   *Issue Reason* If a new Node joins the Pool when view change is in progress and don't get enough Instance Changes to start the View Change as well, it will not caught up the new view and new primaries, so it will not be able to order until the quorum of checkpoints (200 batches) from other nodes is received The situation gets worse by the fact that we write new viewNo and update primaries only when we finish re-ordering which may be done not immediately.     *Possible fix* * If a Node didn't start a view change to view X but sees a quorum of COMMIT messages for originalViewNo = X, then it needs to do catcup. * There are chances that the COMMITs are not ordered yet on nodes, so catchup will not move the Node to view X. But then the Node can repeat the procedure until it moves to view X.  ></description> </Issue>
