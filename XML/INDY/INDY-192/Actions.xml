<Action id="25890" issue="17702" author="alexander.shekhovcov" type="comment" created="2017-06-09 17:41:02.0" updateauthor="alexander.shekhovcov" updated="2017-06-09 17:41:57.0"> <body><! CDATA    *Steps:* {code:java} ln -s /proc/self/mem /home/sovrin/.sovrin/data/nodes/Node1/transactions_sandbox/1 {code}       *Result:*  The Node raises the exception during start and does not start after a few tries (in case systemd service):    {code:java} июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : Traceback (most recent call last): июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/bin/start_sovrin_node", line 47, in <module> июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : cliha=cliha) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/sovrin_node/server/node.py", line 81, in __init__ июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : config=self.config) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 149, in __init__ июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self.primaryStorage = storage or self.getPrimaryStorage() июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/sovrin_node/server/node.py", line 123, in getPrimaryStorage июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : defaultFile=defaultTxnFile) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/plenum/common/ledger.py", line 26, in __init__ июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : super().__init__(*args, **kwargs) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/ledger.py", line 61, in __init__ июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self.start() июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/ledger.py", line 210, in start июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self.defaultFile) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/plenum/common/ledger.py", line 23, in _defaultStore июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : defaultFile=defaultFile) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/chunked_file_store.py", line 73, in __init__ июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self._initDB(dbDir, dbName) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/chunked_file_store.py", line 95, in _initDB июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self._useLatestChunk() июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/chunked_file_store.py", line 101, in _useLatestChunk июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self._useChunk(self._findLatestChunk()) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/chunked_file_store.py", line 135, in _useChunk июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self.currentChunk = self._openChunk(index) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/chunked_file_store.py", line 147, in _openChunk июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : return self._chunkCreator(ChunkedFileStore._chunkIndexToFileName(index)) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/chunked_file_store.py", line 71, in <lambda> июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : ensureDurability) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/text_file_store.py", line 22, in __init__ июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self._initDB(dbDir, dbName) июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : File "/usr/local/lib/python3.5/dist-packages/ledger/stores/text_file_store.py", line 27, in _initDB июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : self.dbFile = open(self.dbPath, mode="a+") июн 06 14:47:25 sovrin-node1 start_sovrin_node 18542 : OSError:  Errno 22  Invalid argument {code}  ></body> </Action>
<Action id="64437" issue="17702" author="esplinr" type="comment" created="2019-10-09 09:07:20.0" updateauthor="esplinr" updated="2019-10-09 09:07:20.0"> <body><! CDATA This still applies to the current code base, but it is rare that the ledger file gets corrupted so we don't see it as a priority to fix.  If someone else wants to fix this, they can raise a PR and reopen this issue.  ></body> </Action>
