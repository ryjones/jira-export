<Action id="48394" issue="32418" author="ckochenower" type="comment" created="2018-08-03 17:11:34.0" updateauthor="ckochenower" updated="2018-08-03 17:13:06.0"> <body><! CDATA *Summary*  Demoting a replica (backup primary) does not appear to trigger a reelection/selection of a replacement unless a view change occurs.  *Details*  f = number of nodes that can fail and still reach consensus  n= number of replicas  My 10 node cluster (f = 3, n = 4) has the following configuration according to each node in the pool. The state of replicas (:0 through :3) are highlighted (orange rectangle):  !Screen Shot 2018-08-03 at 10.36.57 AM.png|thumbnail!  The following was observed when demoting the last replica (Node4). Notice that "Replicas 1 through 3" changes to "Replicas 1 through 2"?  "Count_of_replicas" reported by validator-info changes from 4 to 3. Please note that the master is replica ":0".   !Screen Shot 2018-08-03 at 10.19.14 AM.png|thumbnail!  It appears that demoting a replica does not immediately trigger the pool to select/elect a replacement. It also appears that the pool does not select/elect a replacement within a reasonable amount of time (minutes). I did not wait more than 10 minutes.  Promoting the demoted node (Node4) eventually returns the pool to it's original state. Once Node4 is promoted back into the pool, the nodes, immediately begin to report it as replica :3 as if it had never been demoted.  !Screen Shot 2018-08-03 at 10.22.09 AM.png|thumbnail!  Note that "Count_of_replicas" ("Replicas 1 through 2") is still 2 (above) and does not change back to three (below) until the rest of the nodes report Node4 as replica :3.  !Screen Shot 2018-08-03 at 10.36.57 AM.png|thumbnail!     ></body> </Action>
<Action id="48465" issue="32418" author="ckochenower" type="comment" body="Demoting a single replica does not produce a blast radius sufficient to observe anything interesting unless a view change is forced to occur. Closing this issue in favor of INDY-1541." created="2018-08-06 19:53:34.0" updateauthor="ckochenower" updated="2018-08-06 19:53:34.0"/>
<Action id="48498" issue="32418" author="ckochenower" type="comment" created="2018-08-07 15:15:01.0" updateauthor="ckochenower" updated="2018-08-07 15:26:35.0"> <body><! CDATA Simply demoting a replica doesn't result in a new replica being selected/elected. A view change is required to trigger the selection/election of a replacement.  ~krw910  - Is this a problem? Perhaps the real problem is that a node can select itself as one of it's own replicas?  The pool does not fall out of consensus and no negative side-effects are observed when the demoted node is promoted back into the pool. When promoted back into the pool, the node resumes it's role as a replica for other nodes w/o any negative side effects.  ></body> </Action>
<Action id="48569" issue="32418" author="krw910" type="comment" body=" ~ckochenower  I think we are fine with the scenario." created="2018-08-08 14:11:18.0" updateauthor="krw910" updated="2018-08-08 14:11:18.0"/>
