<Action id="41631" issue="28059" author="sergey.khoroshavin" type="comment" created="2018-03-14 16:33:04.0" updateauthor="sergey.khoroshavin" updated="2018-03-14 16:33:04.0"> <body><! CDATA Now there is an integration test for this: https://github.com/hyperledger/indy-plenum/pull/571/files#diff-c3c40a7bce827f52d3bb9eeed77089cf It passes after this fix: https://github.com/hyperledger/indy-plenum/pull/567, although it consistently failed before.  ></body> </Action>
<Action id="41669" issue="28059" author="ashcherbakov" type="comment" body="Indy-node 1.3.338" created="2018-03-15 08:55:16.0" updateauthor="ashcherbakov" updated="2018-03-15 08:55:16.0"/>
<Action id="41739" issue="28059" author="vladimirwork" type="comment" created="2018-03-16 10:02:10.0" updateauthor="vladimirwork" updated="2018-03-16 10:02:10.0"> <body><! CDATA Build Info: indy-node 1.2.188 -> indy-node 1.3.338  Steps to Reproduce: 1. Install 1.2.188 pool. 2. Send POOL_UPGRADE transaction for simultaneous upgrade to version 1.3.338 with force=True without the first node.  Actual Results: Pool stopped writing after this upgrade. NYMs sending forces to nodes' disconnections (see screenshot). !INDY-1198.PNG|thumbnail!  Debug logs from all nodes are in attachment.  ^1198.tar.gz    Expected Result: Pool should work.  ></body> </Action>
<Action id="42126" issue="28059" author="ashcherbakov" type="comment" created="2018-03-26 08:52:17.0" updateauthor="ashcherbakov" updated="2018-03-26 08:52:17.0"> <body><! CDATA Looks like the situation is the following: * A number of txns was ordered (at view=0, Node1 is the Primary) before Upgrade * Upgrade is performed on Nodes2-4 * After initial catch-up, Nodes 2-4 has last ordered  (for master) = (0,0). * They all selected Node1 as a Primary (which wasn't restarted). * Last ordered on Primary (Node1) is (0, 4). * Primary (Node1) sends PRE-PREPARE (0,5) * Nodes2-4 request missing PRE-PREPARES and PREPARES from (0,1) till (0,4). * Only Node1 has them, but this is not enough (moreover, received missing PREPAREs are not processed since they are from the Primary).   Moreover, it looks like there were some crashes, so we need logs from journalctl.     ></body> </Action>
<Action id="42127" issue="28059" author="ashcherbakov" type="comment" created="2018-03-26 08:53:47.0" updateauthor="ashcherbakov" updated="2018-03-26 08:53:47.0"> <body><! CDATA  ~VladimirWork  Can you please provide logs from journalctl?  ></body> </Action>
<Action id="42132" issue="28059" author="vladimirwork" type="comment" created="2018-03-26 10:17:58.0" updateauthor="vladimirwork" updated="2018-03-26 10:17:58.0"> <body><! CDATA We have the same results during the same steps at pool of 12 nodes.  Debug logs:  ^INDY-1198_12_nodes.tar.gz   Journalctl:  ^INDY-1198_journal_from_2_and_10.tar.gz    ></body> </Action>
<Action id="42237" issue="28059" author="sergey-shilov" type="comment" created="2018-03-28 10:06:17.0" updateauthor="sergey-shilov" updated="2018-03-28 10:06:17.0"> <body><! CDATA  ~VladimirWork  Could you please repeat the steps at pool of 12 nodes? Seem like bls storages were broken.  ></body> </Action>
<Action id="42300" issue="28059" author="zhigunenko.dsr" type="comment" created="2018-03-29 09:49:56.0" updateauthor="zhigunenko.dsr" updated="2018-03-29 09:49:56.0"> <body><! CDATA  ~sergey-shilov   Successfully reproduced by these steps: 1. Install 1.2.188 pool (12 nodes) 2. Send POOL_UPGRADE transaction for simultaneous upgrade to version 1.3.338 with force=True without the first node.  ^1198.7z    ></body> </Action>
<Action id="42477" issue="28059" author="sergey-shilov" type="comment" created="2018-04-03 17:39:25.0" updateauthor="sergey-shilov" updated="2018-04-03 17:39:25.0"> <body><! CDATA  ~ozheregelya   ~zhigunenko.dsr   ~VladimirWork   Guys, *1.2.188-master* is not an analogue of *1.2.50-stable*. It points to*1.2.156-master* of indy-plenum, but in *1.2.158-master* of indy-plenum were added changes that make MultiSignatures store non backward compatible. Moreover, there is no migration scripts for that as early implementation of MultiSignatures was not released, so upgrade from *1.2.188* to *1.3.338* fails in any case as *1.3.338* can not work with MultiSignatures storage that *1.2.188* creates.  Much more closer analogue of *1.2.50-stable* is *1.2.223-master*, so the test upgrade should be repeated with this version.  ></body> </Action>
<Action id="42513" issue="28059" author="zhigunenko.dsr" type="comment" created="2018-04-04 13:33:27.0" updateauthor="zhigunenko.dsr" updated="2018-04-04 13:33:27.0"> <body><! CDATA Pool successfully upgraded by these steps: 1. Install pool with 12 nodes * python3-indy-crypto=0.1.6 * indy-anoncreds=1.0.32 * indy-plenum=1.2.180 * indy-node=1.2.223  2. Send POOL_UPGRADE transaction for simultaneous upgrade to version 1.3.338 with force=True without the first node.  *Results:* Node1 stops to write new txns.   Logs|https://drive.google.com/file/d/15Ct0fM7nX0GY9BNo2R8p_E4ap51mPSXK/view?usp=sharing   ></body> </Action>
<Action id="42557" issue="28059" author="sergey-shilov" type="comment" body="This ticket relates to  lower vewno/ppseqno|https://jira.hyperledger.org/browse/INDY-1199  issue, so mark it as duplicate." created="2018-04-05 10:48:19.0" updateauthor="sergey-shilov" updated="2018-04-05 10:48:58.0"/>
