<Action id="65468" issue="43268" author="toktar" type="comment" created="2019-11-12 12:09:49.0" updateauthor="toktar" updated="2019-11-12 13:53:15.0"> <body><! CDATA *PoA:* PoA: 1. Add a new class StateVersionController: self._version - str - version of current restoring process. Shouldn't cleared (This affects the need to logically break for restoring phases or not) set_version(txn) - check txn type and schedule update self._version if this is UPGRADE_POOL (use first, second or medium time) 2. Add to DataBaseManager init() creation of StateVersionController 4. Add to WriteRequestManager method restore_state(txn, request=None, isCommitted=False), which will set version, call update state and commit 5. Call restore_state instead update_state in Node.postTxnFromCatchupAddedToLedger() 6. Call restore_state instead update_state in LedgersBootstrap._init_state_from_ledger() 7. Add to WriteRequestHandler.update_state choose a method to update state ___ 8. Add integration tests to restoring a state without real upgrades.  ></body> </Action>
<Action id="65551" issue="43268" author="esplinr" type="comment" body="It might not be needed at this time to have logic for using historical calculation by ledger plugins, as INDY-2293 would be sufficient to fix Sovrin Staging Net (since we don&apos;t need to preserve the auditability of history on Staging Net)." created="2019-11-14 15:26:19.0" updateauthor="esplinr" updated="2019-11-14 15:27:52.0"/>
<Action id="65651" issue="43268" author="vladimirwork" type="comment" body="Logs for the issue with KeyError:   ^2292.tar.gz  " created="2019-11-20 15:39:02.0" updateauthor="vladimirwork" updated="2019-11-20 15:39:02.0"/>
<Action id="65659" issue="43268" author="ashcherbakov" type="comment" body="The KeyError issue is related to INDY-2262 and fixed in https://github.com/hyperledger/indy-plenum/pull/1410" created="2019-11-20 16:37:04.0" updateauthor="ashcherbakov" updated="2019-11-20 16:37:04.0"/>
<Action id="65687" issue="43268" author="vladimirwork" type="comment" body="Logs for the issue with sovtoken state:   ^2292_token_state.tar.gz  " created="2019-11-21 11:51:34.0" updateauthor="vladimirwork" updated="2019-11-21 11:51:34.0"/>
<Action id="65778" issue="43268" author="toktar" type="comment" created="2019-11-26 07:28:53.0" updateauthor="toktar" updated="2019-11-26 07:28:53.0"> <body><! CDATA *Test1* - for StagingNet # Start pool of 7 nodes # Upgrade to 1.1.24 # Write down set_fees # Upgrade to the last stable version # Upgrade to master # Write new set_fees # Add a new Node # Restart one of the nodes with the state removing. # Check that all nodes can order.   *Test2 -* MainNet # Start pool of 7 nodes # Upgrade to 1.1.52 # Write auth_rule1 (without specifying off_ledger value) and other transactions # Upgrade to the last stable version # Upgrade to master # WriteÂ new auth_rule2 # Add a new Node # Restart one of the nodes with the state removing. # Check that all nodes can order.  ></body> </Action>
