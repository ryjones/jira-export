<Issue id="39476" key="INDY-2073" number="2073" project="10303" reporter="ashcherbakov" creator="ashcherbakov" type="10002" summary="Validate transaction author agreement as part of consensus" priority="3" resolution="10000" status="10001" created="2019-04-24 08:05:17.0" updated="2019-05-22 11:14:15.0" resolutiondate="2019-05-22 09:12:37.0" votes="0" watches="2" workflowId="52356"> <description><! CDATA *Acceptance criteria* * The author agreement is must have for all Domain transactions * Plugins must be able to specify for what ledgers the author agreement is also must have * Enhance dynamic validation as follows: ** If this is DOMAIN txn, or a Plugin txn from a ledger for which TAA is required - process. Otherwise - OK. ** Get the latest TAA (using 'last_taa' key in state) ** If there is no TAA - OK ** If the TAA's text is empty - OK ** Get the latest AML (using 'last_aml' key in state) ** If there is no AML - REJECT ** Get the TAA's hash and compare with the one in the request. If they are not equal - REJECT ** Get the request's timestamp. Make sure that the ts is in the intervalÂ  TAA's ts - 2 mins; current PP time + 2 mins . If not - REJECT ** Get the requests' acceptance mechanism string. Make sure that it's present in the latest AML. If not - REJECT  * Cover by tests  ></description> </Issue>
