<Action id="40693" issue="27974" author="lovesh" type="comment" created="2018-02-23 22:58:39.0" updateauthor="lovesh" updated="2018-02-23 22:58:39.0"> <body><! CDATA Fix resides here  https://github.com/hyperledger/indy-plenum/pull/549 https://github.com/hyperledger/indy-node/commit/83837b4ce0c1e7e0a37c584b164505d5f69f34de  ></body> </Action>
<Action id="40777" issue="27974" author="ashcherbakov" type="comment" created="2018-02-26 09:32:46.0" updateauthor="ashcherbakov" updated="2018-02-26 10:25:35.0"> <body><! CDATA *Problem:*  There is a validation for POOL_UPGRADE txn that checks whether a node in `schedule` is demoted. In order to do this, pool ledger is analysed and `service` field is checked.   There was a bug in this validation assuming that `services` field is always present.  If there is BLS key rotation txn in the pool ledger which doesn't have `services` field (we omit it, and specify `blskey` field only), then the validation failes and upgrade doesn't happen.  *Fix* * Added a check if `service` is present. * Added a test that pool upgrade works after BLS key rotation  *PR:* *  https://github.com/hyperledger/indy-plenum/pull/549  * https://github.com/hyperledger/indy-node/pull/582  *Build*  1.3.319 (master)  1.3.55 (RC)     *Risk*  Low     *Recommendation for QA*  Rotate BLS keys (omit `service` field!) and perform Upgrade        ></body> </Action>
<Action id="40946" issue="27974" author="ozheregelya" type="comment" created="2018-02-27 17:18:11.0" updateauthor="ozheregelya" updated="2018-02-27 17:18:11.0"> <body><! CDATA Environment: indy-node 1.3.55  Steps to Validate: 1. Setup the pool with indy-node 1.2.50. 2. Send NODE transaction with empty 'sevrices' field: {code:java} new key with seed 000000000000000000000000Steward1 send NODE dest=Gw6pDLhcBcoQesN72qfotTgFa7cbuqZpkX3Xo6pLhPhv data={'alias':'Node1','blskey': 'G9CyMZepT2ktvLuXvUDF1trMiUPxiShfEJxQq3bQJwHxCjwFn9bwGfWzQcixAomTm3r6j7UGnwFAA5hb9y2oQEL62id1BiKEUmsr7YFvqG3RmzF53fcDGAy2TYKhS6BQkDSWxNHMU471A11C51PxHbMMkUpHnw7HPUR3pgd43op1N1'} send NODE dest=Gw6pDLhcBcoQesN72qfotTgFa7cbuqZpkX3Xo6pLhPhv data={'alias':'Node1','blskey': 'G9CyMZepT2ktvLuXvUDF1trMiUPxiShfEJxQq3bQJwHxCjwFn9bwGfWzQcixAomTm3r6j7UGnwFAA5hb9y2oQEL62id1BiKEUmsr7YFvqG3RmzF53fcDGAy2TYKhS6BQkDSWxNHMU471A11C51PxHbMMkUpHnw7HPUR3pgd43op1N6'}{code} 3. Send POOL_UPGRADE transaction to 1.3.55 version. => Pool successfully upgraded. 4. Send one more POOL_UPGRADE to the same version with reinstall=True to make sure that transaction will be written.  Actual Result: POOL_UPGRADE is successfully written after upgrade to the latest version.  ></body> </Action>
