<Action id="40149" issue="27528" author="sergey-shilov" type="comment" created="2018-02-14 16:05:23.0" updateauthor="sergey-shilov" updated="2018-02-14 16:05:23.0"> <body><! CDATA *Problem state / reason:*  When returning N-F nodes to a pool, "View change" does not occur if Primary node is stopped. This happens due to the fact that a node currently participating in the pool does not schedule a view change if the pool has come back to quorum when a primary is still down.  *Changes:*  Now a node schedules a view change if it transits its state from _starting_ to _started_hungry_ and a primary is set but it is still down. It means that a pool has come back to quorum while primary is still down, so initiating of view change process makes sense.  *Committed into:*       https://github.com/hyperledger/indy-plenum/pull/531      https://github.com/hyperledger/indy-plenum/pull/533     https://github.com/hyperledger/indy-node/pull/565     indy-node 1.2.308-master  *Risk factors:*      Some cases of view change may be influences by committed changes, but this is not expected.  *Risk:*      Medium  *Recommendations for QA:*  Do full testing of view change. Also the test case mentioned in description of this ticket should be repeated and expected results should be got.  ></body> </Action>
<Action id="40224" issue="27528" author="ozheregelya" type="comment" created="2018-02-14 22:08:58.0" updateauthor="ozheregelya" updated="2018-02-15 11:28:38.0"> <body><! CDATA *Environment:* indy-node 1.3.308 docker pool of 4 and 7 nodes  *Steps to Validate:* 1. Setup the pool of 4 nodes, check the primary, make sure that all nodes working. => primary is node2. 2. Stop Node4, send transaction. => transaction was successfully written. 3. Stop Node2, send transaction. => transaction was not written. 4. Start Node4, check primary, write transaction.  *Actual Results:* Consensus restored after starting Node4.   *Following cases also were verified:* - The same case with 7 nodes. - View change in case of stopping primary. - View change in case of primary performance decreasing (load test). - View change in case of primary demotion. Unclear behavior was noticed after primary demotion: one of nodes stopped writing transactions after primary demotion and re-promotion. Problem was reproduced only once. Logs are collected for this problem and it will be moved to separated ticket after discussion with developers. UPD: ticket number for this problem is INDY-1179.  ></body> </Action>
