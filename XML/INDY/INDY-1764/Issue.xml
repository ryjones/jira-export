<Issue id="34732" key="INDY-1764" number="1764" project="10303" reporter="ashcherbakov" assignee="ozheregelya" creator="ashcherbakov" type="10004" summary="Upgrade to latest Sovrin doesn&apos;t work if it depends on a newer IndyNode" priority="2" resolution="10000" status="10001" created="2018-10-17 06:56:25.0" updated="2019-03-29 20:33:45.0" resolutiondate="2019-03-29 20:33:45.0" votes="0" watches="4" workflowId="46141"> <description><! CDATA If we have installed old Sovrin (not dependent on concrete version of IndyNode) and indy-node version X, and trying to send POOL_UPGRADE to the latest Sovrin depending on indy-node version > X, then upgrade will fail, since sovrin's dependencies are not processed. *Example:* Have Sovrin 1.1.10, and Indy-Node 1.6.77. Trying to Upgrade to sovrin 1.1.30 (depending on 1.6.78)  *Actual behaviour:*  Upgrade fails (see INDY-1748 for details): {code:java} sovrin 1.1.10 indy-node 1.6.77 -> sovrin 1.1.30: Oct 16 15:20:05 a839cb478e79 env 3205 : + deps='libindy-crypto=0.4.5 sovrin=1.1.30' Oct 16 15:20:05 a839cb478e79 env 3205 : + ' ' -z 'libindy-crypto=0.4.5 sovrin=1.1.30' ' ' Oct 16 15:20:05 a839cb478e79 env 3205 : + echo 'Try to donwload indy version libindy-crypto=0.4.5 sovrin=1.1.30' Oct 16 15:20:05 a839cb478e79 env 3205 : Try to donwload indy version libindy-crypto=0.4.5 sovrin=1.1.30 Oct 16 15:20:05 a839cb478e79 env 3205 : + apt-get -y update Oct 16 15:20:06 a839cb478e79 env 3205 : Hit:1 http://archive.ubuntu.com/ubuntu xenial InRelease Oct 16 15:20:06 a839cb478e79 env 3205 : Hit:2 http://archive.ubuntu.com/ubuntu xenial-updates InRelease Oct 16 15:20:06 a839cb478e79 env 3205 : Get:3 http://archive.ubuntu.com/ubuntu xenial-backports InRelease  107 kB  Oct 16 15:20:06 a839cb478e79 env 3205 : Get:4 http://security.ubuntu.com/ubuntu xenial-security InRelease  107 kB  Oct 16 15:20:07 a839cb478e79 env 3205 : Hit:5 https://repo.sovrin.org/deb xenial InRelease Oct 16 15:20:07 a839cb478e79 env 3205 : Fetched 214 kB in 1s (163 kB/s) Oct 16 15:20:08 a839cb478e79 env 3205 : Reading package lists... Oct 16 15:20:08 a839cb478e79 env 3205 : + apt-get --download-only -y --allow-downgrades --allow-change-held-packages install libindy-crypto=0.4.5 sovrin=1.1.30 Oct 16 15:20:09 a839cb478e79 env 3205 : Reading package lists... Oct 16 15:20:09 a839cb478e79 env 3205 : Building dependency tree... Oct 16 15:20:09 a839cb478e79 env 3205 : Reading state information... Oct 16 15:20:09 a839cb478e79 env 3205 : libindy-crypto is already the newest version (0.4.5). Oct 16 15:20:09 a839cb478e79 env 3205 : Some packages could not be installed. This may mean that you have Oct 16 15:20:09 a839cb478e79 env 3205 : requested an impossible situation or if you are using the unstable Oct 16 15:20:09 a839cb478e79 env 3205 : distribution that some required packages have not yet been created Oct 16 15:20:09 a839cb478e79 env 3205 : or been moved out of Incoming. Oct 16 15:20:09 a839cb478e79 env 3205 : The following information may help to resolve the situation: Oct 16 15:20:09 a839cb478e79 env 3205 : The following packages have unmet dependencies: Oct 16 15:20:09 a839cb478e79 env 3205 :  sovrin : Depends: indy-node (= 1.6.78) but 1.6.77 is to be installed Oct 16 15:20:09 a839cb478e79 env 3205 :           Depends: sovtoken (= 0.9.5) but it is not going to be installed Oct 16 15:20:09 a839cb478e79 env 3205 :           Depends: sovtokenfees (= 0.9.5) but it is not going to be installed Oct 16 15:20:09 a839cb478e79 env 3205 : E: Unable to correct problems, you have held broken packages. Oct 16 15:20:09 a839cb478e79 env 3205 : + ret=100 Oct 16 15:20:09 a839cb478e79 env 3205 : + ' ' 100 -ne 0 ' ' Oct 16 15:20:09 a839cb478e79 env 3205 : + echo 'Failed to obtain libindy-crypto=0.4.5 sovrin=1.1.30'  {code} *Expected behaviour*  Upgrade is successful        ></description> </Issue>
