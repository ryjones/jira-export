<Action id="53246" issue="35223" author="dsurnin" type="comment" created="2018-11-09 07:41:36.0" updateauthor="dsurnin" updated="2018-11-09 07:41:36.0"> <body><! CDATA PR https://github.com/hyperledger/indy-node/pull/1024  first Node version with fix if v670  ></body> </Action>
<Action id="53477" issue="35223" author="ozheregelya" type="comment" created="2018-11-15 10:07:37.0" updateauthor="ozheregelya" updated="2018-11-15 10:07:37.0"> <body><! CDATA Environment: indy-node 1.6.675 -> sovrin 1.1.89 -> sovrin 1.1.90 docker pool  Steps to Validate: 1. Setup the pool of 10 nodes with indy-node 1.6.675 and sovrin 1.1.62 (last not pinned version). 2. Send pool upgrade transaction to sovrin 1.1.89 (depending on indy-node 1.6.675). => Upgrade completed successfully, information about upgrade logged to journalctl. 3. Send pool upgrade transaction to sovrin 1.1.90 (depending on indy-node 1.6.678). => Upgrade failed due to INDY-1850, information about problem logged to journalctl.  Actual Results: Information about successful upgrade: {code:java} Nov 14 16:42:05 8fcd6b2e84ed env 4169 : WARNING: apt does not have a stable CLI interface. Use with caution in scripts. Nov 14 16:42:06 8fcd6b2e84ed env 4169 : Hit:1 http://security.ubuntu.com/ubuntu xenial-security InRelease Nov 14 16:42:06 8fcd6b2e84ed env 4169 : Hit:2 http://archive.ubuntu.com/ubuntu xenial InRelease Nov 14 16:42:06 8fcd6b2e84ed env 4169 : Hit:3 http://archive.ubuntu.com/ubuntu xenial-updates InRelease Nov 14 16:42:06 8fcd6b2e84ed env 4169 : Hit:4 http://archive.ubuntu.com/ubuntu xenial-backports InRelease Nov 14 16:42:08 8fcd6b2e84ed env 4169 : Hit:5 https://repo.sovrin.org/deb xenial InRelease Nov 14 16:42:08 8fcd6b2e84ed env 4169 : Hit:6 https://repo.sovrin.org/sdk/deb xenial InRelease Nov 14 16:42:28 8fcd6b2e84ed env 4169 : Reading package lists... Nov 14 16:42:31 8fcd6b2e84ed env 4169 : Building dependency tree... Nov 14 16:42:31 8fcd6b2e84ed env 4169 : Reading state information... Nov 14 16:42:32 8fcd6b2e84ed env 4169 : 30 packages can be upgraded. Run 'apt list --upgradable' to see them. Nov 14 16:43:39 8fcd6b2e84ed env 4169 : at Nov 14 16:43:39 8fcd6b2e84ed env 4169 : indy-anoncreds Nov 14 16:43:39 8fcd6b2e84ed env 4169 : indy-node Nov 14 16:43:39 8fcd6b2e84ed env 4169 : indy-plenum Nov 14 16:43:39 8fcd6b2e84ed env 4169 : iptables Nov 14 16:43:39 8fcd6b2e84ed env 4169 : libindy-crypto Nov 14 16:43:39 8fcd6b2e84ed env 4169 : libsodium18 Nov 14 16:43:39 8fcd6b2e84ed env 4169 : python3-indy-crypto Nov 14 16:43:39 8fcd6b2e84ed env 4169 : sovrin Nov 14 16:43:39 8fcd6b2e84ed env 4169 : + deps=sovrin=1.1.89 Nov 14 16:43:39 8fcd6b2e84ed env 4169 : + ' ' -z sovrin=1.1.89 ' ' Nov 14 16:43:39 8fcd6b2e84ed env 4169 : + echo 'Try to donwload indy version sovrin=1.1.89' Nov 14 16:43:39 8fcd6b2e84ed env 4169 : Try to donwload indy version sovrin=1.1.89 Nov 14 16:43:39 8fcd6b2e84ed env 4169 : + apt-get -y update Nov 14 16:43:40 8fcd6b2e84ed env 4169 : Hit:1 http://security.ubuntu.com/ubuntu xenial-security InRelease Nov 14 16:43:40 8fcd6b2e84ed env 4169 : Hit:2 http://archive.ubuntu.com/ubuntu xenial InRelease Nov 14 16:43:41 8fcd6b2e84ed env 4169 : Hit:3 http://archive.ubuntu.com/ubuntu xenial-updates InRelease Nov 14 16:43:41 8fcd6b2e84ed env 4169 : Hit:4 http://archive.ubuntu.com/ubuntu xenial-backports InRelease Nov 14 16:43:43 8fcd6b2e84ed env 4169 : Hit:5 https://repo.sovrin.org/deb xenial InRelease Nov 14 16:43:43 8fcd6b2e84ed env 4169 : Hit:6 https://repo.sovrin.org/sdk/deb xenial InRelease Nov 14 16:44:00 8fcd6b2e84ed env 4169 : Reading package lists... Nov 14 16:44:01 8fcd6b2e84ed env 4169 : + apt-get --download-only -y --allow-downgrades --allow-change-held-packages install sovrin=1.1.89 Nov 14 16:44:15 8fcd6b2e84ed env 4169 : Reading package lists... Nov 14 16:44:17 8fcd6b2e84ed env 4169 : Building dependency tree... Nov 14 16:44:17 8fcd6b2e84ed env 4169 : Reading state information... Nov 14 16:44:20 8fcd6b2e84ed env 4169 : The following held packages will be changed: Nov 14 16:44:20 8fcd6b2e84ed env 4169 :   sovrin Nov 14 16:44:20 8fcd6b2e84ed env 4169 : The following packages will be upgraded: Nov 14 16:44:20 8fcd6b2e84ed env 4169 :   sovrin Nov 14 16:44:23 8fcd6b2e84ed env 4169 : 1 upgraded, 0 newly installed, 0 to remove and 29 not upgraded. Nov 14 16:44:23 8fcd6b2e84ed env 4169 : Need to get 10.4 kB of archives. Nov 14 16:44:23 8fcd6b2e84ed env 4169 : After this operation, 0 B of additional disk space will be used. Nov 14 16:44:23 8fcd6b2e84ed env 4169 : Get:1 https://repo.sovrin.org/deb xenial/master amd64 sovrin amd64 1.1.89  10.4 kB  Nov 14 16:44:23 8fcd6b2e84ed env 4169 : Fetched 10.4 kB in 2s (4932 B/s) Nov 14 16:44:23 8fcd6b2e84ed env 4169 : Download complete and in download only mode Nov 14 16:44:23 8fcd6b2e84ed env 4169 : + ret=0 Nov 14 16:44:23 8fcd6b2e84ed env 4169 : + ' ' 0 -ne 0 ' ' Nov 14 16:44:23 8fcd6b2e84ed env 4169 : + ' ' '' = '' ' ' Nov 14 16:44:23 8fcd6b2e84ed env 4169 : + echo 'Stop indy-node' Nov 14 16:44:23 8fcd6b2e84ed env 4169 : Stop indy-node Nov 14 16:44:23 8fcd6b2e84ed env 4169 : + systemctl stop indy-node Nov 14 16:44:23 8fcd6b2e84ed systemd 1 : Stopping Indy Node... Nov 14 16:44:24 8fcd6b2e84ed systemd 1 : Stopped Indy Node. Nov 14 16:44:24 8fcd6b2e84ed env 4169 : + echo 'Run indy upgrade to sovrin=1.1.89' Nov 14 16:44:24 8fcd6b2e84ed env 4169 : Run indy upgrade to sovrin=1.1.89 Nov 14 16:44:24 8fcd6b2e84ed env 4169 : + apt-get -y --allow-downgrades --allow-change-held-packages --reinstall install sovrin=1.1.89 Nov 14 16:44:32 8fcd6b2e84ed env 4169 : Reading package lists... Nov 14 16:44:34 8fcd6b2e84ed env 4169 : Building dependency tree... Nov 14 16:44:34 8fcd6b2e84ed env 4169 : Reading state information... Nov 14 16:44:35 8fcd6b2e84ed env 4169 : The following held packages will be changed: Nov 14 16:44:35 8fcd6b2e84ed env 4169 :   sovrin Nov 14 16:44:35 8fcd6b2e84ed env 4169 : The following packages will be upgraded: Nov 14 16:44:35 8fcd6b2e84ed env 4169 :   sovrin Nov 14 16:44:35 8fcd6b2e84ed env 4169 : debconf: delaying package configuration, since apt-utils is not installed Nov 14 16:44:36 8fcd6b2e84ed env 4169 : 1 upgraded, 0 newly installed, 0 to remove and 29 not upgraded. Nov 14 16:44:36 8fcd6b2e84ed env 4169 : Need to get 0 B/10.4 kB of archives. Nov 14 16:44:36 8fcd6b2e84ed env 4169 : After this operation, 0 B of additional disk space will be used. Nov 14 16:44:36 8fcd6b2e84ed env 4169 :  614B blob data  Nov 14 16:44:36 8fcd6b2e84ed env 4169 : Preparing to unpack .../sovrin_1.1.89_amd64.deb ... Nov 14 16:44:36 8fcd6b2e84ed env 4169 : Unpacking sovrin (1.1.89) over (1.1.62) ... Nov 14 16:44:37 8fcd6b2e84ed env 4169 : Setting up sovrin (1.1.89) ... Nov 14 16:44:40 8fcd6b2e84ed env 4169 : + ret=0 Nov 14 16:44:40 8fcd6b2e84ed env 4169 : + ' ' 0 -ne 0 ' ' Nov 14 16:44:42 8fcd6b2e84ed env 4169 : + ' ' '' = '' ' ' Nov 14 16:44:42 8fcd6b2e84ed env 4169 : + systemctl daemon-reload Nov 14 16:44:42 8fcd6b2e84ed systemd 1 : Reloading. Nov 14 16:44:43 8fcd6b2e84ed env 4169 : + systemctl reset-failed Nov 14 16:44:43 8fcd6b2e84ed env 4169 : + echo 'Starting indy-node' Nov 14 16:44:43 8fcd6b2e84ed env 4169 : Starting indy-node Nov 14 16:44:43 8fcd6b2e84ed env 4169 : + systemctl start indy-node Nov 14 16:44:43 8fcd6b2e84ed systemd 1 : Started Indy Node. Nov 14 16:44:43 8fcd6b2e84ed env 4169 : + echo 'Restarting agent' Nov 14 16:44:43 8fcd6b2e84ed env 4169 : Restarting agent Nov 14 16:44:43 8fcd6b2e84ed env 4169 : + systemctl restart indy-node-control Nov 14 16:44:43 8fcd6b2e84ed systemd 1 : Stopping Indy Node... Nov 14 16:44:43 8fcd6b2e84ed systemd 1 : Stopping Service for upgrade of existing Indy Node and other operations... Nov 14 16:44:43 8fcd6b2e84ed systemd 1 : Stopped Service for upgrade of existing Indy Node and other operations. Nov 14 16:44:43 8fcd6b2e84ed systemd 1 : Stopped Indy Node. Nov 14 16:44:43 8fcd6b2e84ed systemd 1 : Started Indy Node. Nov 14 16:44:43 8fcd6b2e84ed systemd 1 : Started Service for upgrade of existing Indy Node and other operations. Nov 14 16:45:16 8fcd6b2e84ed env 5196 : indy-anoncreds was already set on hold. Nov 14 16:45:16 8fcd6b2e84ed env 5196 : indy-plenum was already set on hold. Nov 14 16:45:16 8fcd6b2e84ed env 5196 : indy-node was already set on hold. Nov 14 16:45:16 8fcd6b2e84ed env 5196 : python3-indy-crypto was already set on hold. Nov 14 16:45:16 8fcd6b2e84ed env 5196 : libindy-crypto was already set on hold. Nov 14 16:45:16 8fcd6b2e84ed env 5196 : sovrin set on hold. {code}  Information about failed upgrade: {code:java} Nov 14 16:47:03 8fcd6b2e84ed env 5196 : WARNING: apt does not have a stable CLI interface. Use with caution in scripts. Nov 14 16:47:04 8fcd6b2e84ed env 5196 : Hit:1 http://security.ubuntu.com/ubuntu xenial-security InRelease Nov 14 16:47:04 8fcd6b2e84ed env 5196 : Hit:2 http://archive.ubuntu.com/ubuntu xenial InRelease Nov 14 16:47:04 8fcd6b2e84ed env 5196 : Get:3 http://archive.ubuntu.com/ubuntu xenial-updates InRelease  109 kB  Nov 14 16:47:04 8fcd6b2e84ed env 5196 : Get:4 http://archive.ubuntu.com/ubuntu xenial-backports InRelease  107 kB  Nov 14 16:47:06 8fcd6b2e84ed env 5196 : Hit:5 https://repo.sovrin.org/deb xenial InRelease Nov 14 16:47:06 8fcd6b2e84ed env 5196 : Hit:6 https://repo.sovrin.org/sdk/deb xenial InRelease Nov 14 16:47:12 8fcd6b2e84ed env 5196 : Fetched 216 kB in 8s (25.0 kB/s) Nov 14 16:47:25 8fcd6b2e84ed env 5196 : Reading package lists... Nov 14 16:47:27 8fcd6b2e84ed env 5196 : Building dependency tree... Nov 14 16:47:28 8fcd6b2e84ed env 5196 : Reading state information... Nov 14 16:47:28 8fcd6b2e84ed env 5196 : 30 packages can be upgraded. Run 'apt list --upgradable' to see them. Nov 14 16:48:36 8fcd6b2e84ed env 5196 : at Nov 14 16:48:36 8fcd6b2e84ed env 5196 : indy-anoncreds Nov 14 16:48:36 8fcd6b2e84ed env 5196 : indy-node Nov 14 16:48:36 8fcd6b2e84ed env 5196 : indy-plenum Nov 14 16:48:36 8fcd6b2e84ed env 5196 : iptables Nov 14 16:48:36 8fcd6b2e84ed env 5196 : libindy-crypto Nov 14 16:48:36 8fcd6b2e84ed env 5196 : libsodium18 Nov 14 16:48:36 8fcd6b2e84ed env 5196 : python3-indy-crypto Nov 14 16:48:36 8fcd6b2e84ed env 5196 : sovrin Nov 14 16:48:36 8fcd6b2e84ed env 5196 : + deps=sovrin=1.1.90 Nov 14 16:48:36 8fcd6b2e84ed env 5196 : + ' ' -z sovrin=1.1.90 ' ' Nov 14 16:48:36 8fcd6b2e84ed env 5196 : + echo 'Try to donwload indy version sovrin=1.1.90' Nov 14 16:48:36 8fcd6b2e84ed env 5196 : Try to donwload indy version sovrin=1.1.90 Nov 14 16:48:36 8fcd6b2e84ed env 5196 : + apt-get -y update Nov 14 16:48:37 8fcd6b2e84ed env 5196 : Get:1 http://security.ubuntu.com/ubuntu xenial-security InRelease  107 kB  Nov 14 16:48:37 8fcd6b2e84ed env 5196 : Hit:2 http://archive.ubuntu.com/ubuntu xenial InRelease Nov 14 16:48:37 8fcd6b2e84ed env 5196 : Hit:3 http://archive.ubuntu.com/ubuntu xenial-updates InRelease Nov 14 16:48:37 8fcd6b2e84ed env 5196 : Hit:4 http://archive.ubuntu.com/ubuntu xenial-backports InRelease Nov 14 16:48:39 8fcd6b2e84ed env 5196 : Hit:5 https://repo.sovrin.org/deb xenial InRelease Nov 14 16:48:39 8fcd6b2e84ed env 5196 : Hit:6 https://repo.sovrin.org/sdk/deb xenial InRelease Nov 14 16:48:43 8fcd6b2e84ed env 5196 : Get:7 http://security.ubuntu.com/ubuntu xenial-security/universe Sources  104 kB  Nov 14 16:48:43 8fcd6b2e84ed env 5196 : Get:8 http://security.ubuntu.com/ubuntu xenial-security/universe amd64 Packages  506 kB  Nov 14 16:48:44 8fcd6b2e84ed env 5196 : Get:9 http://security.ubuntu.com/ubuntu xenial-security/multiverse amd64 Packages  4027 B  Nov 14 16:48:46 8fcd6b2e84ed env 5196 : Fetched 721 kB in 9s (73.5 kB/s) Nov 14 16:48:59 8fcd6b2e84ed env 5196 : Reading package lists... Nov 14 16:48:59 8fcd6b2e84ed env 5196 : + apt-get --download-only -y --allow-downgrades --allow-change-held-packages install sovrin=1.1.90 Nov 14 16:49:12 8fcd6b2e84ed env 5196 : Reading package lists... Nov 14 16:49:15 8fcd6b2e84ed env 5196 : Building dependency tree... Nov 14 16:49:15 8fcd6b2e84ed env 5196 : Reading state information... Nov 14 16:49:16 8fcd6b2e84ed env 5196 : Some packages could not be installed. This may mean that you have Nov 14 16:49:16 8fcd6b2e84ed env 5196 : requested an impossible situation or if you are using the unstable Nov 14 16:49:16 8fcd6b2e84ed env 5196 : distribution that some required packages have not yet been created Nov 14 16:49:16 8fcd6b2e84ed env 5196 : or been moved out of Incoming. Nov 14 16:49:16 8fcd6b2e84ed env 5196 : The following information may help to resolve the situation: Nov 14 16:49:16 8fcd6b2e84ed env 5196 : The following packages have unmet dependencies: Nov 14 16:49:17 8fcd6b2e84ed env 5196 : sovrin : Depends: indy-node (= 1.6.678) but 1.6.675 is to be installed Nov 14 16:49:17 8fcd6b2e84ed env 5196 : E: Unable to correct problems, you have held broken packages. Nov 14 16:49:17 8fcd6b2e84ed env 5196 : + ret=100 Nov 14 16:49:17 8fcd6b2e84ed env 5196 : + ' ' 100 -ne 0 ' ' Nov 14 16:49:17 8fcd6b2e84ed env 5196 : + echo 'Failed to obtain sovrin=1.1.90' Nov 14 16:49:17 8fcd6b2e84ed env 5196 : Failed to obtain sovrin=1.1.90 Nov 14 16:49:17 8fcd6b2e84ed env 5196 : + exit 1 Nov 14 16:49:17 8fcd6b2e84ed env 5196 : Upgrade from 1.1.89 to 1.1.90 failed: Command 'upgrade_indy_node "sovrin=1.1.90"' returned non-zero exit status 1 Nov 14 16:49:17 8fcd6b2e84ed env 5196 : Trying to rollback to the previous version Command 'upgrade_indy_node "sovrin=1.1.90"' returned non-zero exit status 1{code}    ></body> </Action>
