<Action id="62049" issue="41371" author="vladimirwork" type="comment" body="Logs are added to the ticket." created="2019-07-23 15:54:11.0" updateauthor="vladimirwork" updated="2019-07-23 15:54:11.0"/>
<Action id="62072" issue="41371" author="ashcherbakov" type="comment" created="2019-07-24 09:32:49.0" updateauthor="ashcherbakov" updated="2019-07-24 09:32:49.0"> <body><! CDATA *Problem reason* * It looks like the reason is a very long GET_VALIDATOR_INFO execution (6 sec) which is done synchronously blocking main execution. * It affects connections, so Nodes started to disconnect from each other after such long delays. * The main reason of long execution GET_VALIDATOR_INFO  is memory profiling.  *Suggested fix:* * Remove memory profiling from GET_VALIDATOR_INFO execution * Do not change output JSON structure, just put N/A into memory-related fields.     ></body> </Action>
<Action id="62073" issue="41371" author="anikitindsr" type="comment" created="2019-07-24 09:55:30.0" updateauthor="anikitindsr" updated="2019-07-24 09:55:30.0"> <body><! CDATA Also, we can reduce frequency of get_validator_info sending for checking primary status in system's tests.     ></body> </Action>
<Action id="62163" issue="41371" author="ashcherbakov" type="comment" created="2019-07-26 12:27:06.0" updateauthor="ashcherbakov" updated="2019-07-26 12:27:06.0"> <body><! CDATA The test still fails intermittently even with the GET_VALIDATOR_INFO fix, but in a different place: https://github.com/hyperledger/indy-test-automation/blob/163a56b21c5df792b26595d00211047b16311baa/system/indy-node-tests/test_vc.py#L49     *Reasons for failing:* * The test doesn't wait for View Change after promotion of Primary (as it does after demotion). So, clients can not send requests (and the test fails) just because view change is in progress. * The view change is so long because of INDY-2023: after promotion, the pool selects the same Primary as was on the previous view, so all nodes are waiting for the new View Change triggered after timeout (7 minutes!)  *Recommendation:* * Fix the test to wait for view change after promotion before sending any new requests * Remove the test from the list of ones running for master * Either skip the test or increase timeout for waiting for view (it needs to be > 420 sec) * Write a new test where the last (7th) node is demoted and promoted. In this test view change after promotion should be fast and INDY-2023 will not be reproduced. Such test can be included into a list of test running on master  ></body> </Action>
<Action id="62540" issue="41371" author="vladimirwork" type="comment" created="2019-08-02 11:56:28.0" updateauthor="vladimirwork" updated="2019-08-02 11:56:28.0"> <body><! CDATA 1. test_vc_by_demotion_primary was fixed and skipped. 2. test_vc_by_demotion_last was implemented and will be sent in the next PR after several local runs.  ></body> </Action>
