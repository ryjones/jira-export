<Issue id="35457" key="INDY-1863" number="1863" project="10303" reporter="sergey.khoroshavin" assignee="vladimirwork" creator="sergey.khoroshavin" type="10002" summary="Limit number of 3PC batches in flight" priority="3" resolution="10000" status="10001" created="2018-11-19 13:25:21.0" updated="2019-04-23 14:47:14.0" resolutiondate="2019-04-23 14:47:14.0" votes="0" watches="3" workflowId="46923"> <description><! CDATA Currently batches are created as soon as there are _Max3PCBatchSize_ requests in queue OR _Max3PCBatchWait_ seconds passed since last batch was created. When under high load it can lead to creation of batches faster than they are ordered leading to uncontrollable growth of node traffic and consensus related data structures. At the same time batch size is not maxed out, which means that nodes are not using resources optimally (actually, the bigger batch the lower overhead of consensus).  *Proposed solution* * Add _Max3PCBatchesInFlight_ parameter * Create batches as soon as there are _Max3PCBatchSize_ requests in queue OR (_Max3PCBatchWait_ seconds passed AND there are less than _Max3PCBatchesInFlight_ batches in flight)  *Expected improvements* Under high load bigger batches will be created, reducing number of consensus messages per request, so throughput and probably latency are improved  ></description> </Issue>
