<Issue id="22401" key="INDY-908" number="908" project="10303" reporter="vladimirwork" creator="vladimirwork" type="10004" summary="Added node loses ledger after the pool upgrade" priority="4" resolution="10001" status="10001" created="2017-10-16 09:39:29.0" updated="2019-03-29 20:35:40.0" resolutiondate="2019-03-29 20:35:40.0" votes="0" watches="2" workflowId="22401"> <description><! CDATA Build Info: See Steps to Reproduce.  Overview: Added node loses ledger after the pool upgrade.  Steps to Reproduce: 1. Install 1.0.28 pool of 4 nodes and send some NYMs. 2. Upgrade it to 1.1.37 with force=True (and the whole pool at the same time) and send some NYMs. 3. Install the 5th node with 1.0.28 version. 4. Reset the 5th node with clear_node.py -- full. 5. Upgrade the 5th node manually to 1.1.37 without applying migration script and without stopping node-control-service (so during upgrade to 1.1.41 there will be not 1 but 2 migration script applyings). 6. Fill the 5th node's ledger with genesis txn (by starting it with 1.1.37 genesis files). 6. Add the 5th node and send some NYMs (5th node shouldn't catch up at this step). 7. Upgrade the whole pool (5 nodes) to 1.1.41 with force=True and send some NYMs.  Actual Results: After the Step 7 pool upgrade the 5th node loses its ledger (but at installation this node has it with genesis txns).  Expected Results: Step 7 migration scripts should be applied without errors and the 5th node should keep its ledger after the pool upgrade to catch up with other nodes after it.  Additional Info: This steps consist special case of single node upgrading and there is a small chance of reproducing it at the live pool.  ></description> </Issue>
