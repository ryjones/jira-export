<Action id="55886" issue="36921" author="ashcherbakov" type="comment" created="2019-01-21 07:00:51.0" updateauthor="ashcherbakov" updated="2019-01-21 07:00:51.0"> <body><! CDATA  ~esplinr   The story is mostly about creation of new transactions (new SCHEMA, NYM, CRED_DEF, etc.). So, if `ANYONE_CAN_WRITE=False`, then a non-trust-anchor can not create new transactions.  What about modifying existing transactions, for example DID key rotation? As of now, only the owner can modify his or her data (SSI principles). So, if a non-trust-anchor user has a DID (created by some Trust Anchor), he or she can send any number of txns to rotate the key. Is it OK and intended?  ></body> </Action>
<Action id="55989" issue="36921" author="ozheregelya" type="comment" created="2019-01-22 13:50:47.0" updateauthor="ozheregelya" updated="2019-01-22 13:50:47.0"> <body><! CDATA  ~esplinr   There is one difference between auth_rules.md and  old spreadsheet|https://docs.google.com/spreadsheets/d/1uSxqZ5tzAiervgrLQn4FGlUhD-5YbxAbZkG4GdzjPtM/edit#gid=0 . In current implementation and in auth_rules.md only Trustee can blacklist Trust Anchor, but in old spreadsheet Steward can do this as well. Long time ago we had several discussions with Kelly, but have not had final answer, if the spreadsheet actual or not. Which requirement is correct?  ></body> </Action>
<Action id="56211" issue="36921" author="andkononykhin" type="comment" created="2019-01-25 14:28:38.0" updateauthor="andkononykhin" updated="2019-01-25 14:28:38.0"> <body><! CDATA PoA: # implement integration tests # fix failed tests that don't need much time for that,  create tasks for other  ></body> </Action>
<Action id="56213" issue="36921" author="esplinr" type="comment" body=" ~ozheregelya  The old spreadsheet should be considered deprecated. We need to maintain auth_rules.md to match the code." created="2019-01-25 14:36:54.0" updateauthor="esplinr" updated="2019-01-25 14:36:54.0"/>
<Action id="56257" issue="36921" author="ozheregelya" type="comment" body=" ~esplinr , It&apos;s clear. I asked because it&apos;s looks a bit strange that STEWARD can create TRUST_ANCHOR, but can&apos;t blacklist it." created="2019-01-28 11:24:06.0" updateauthor="ozheregelya" updated="2019-01-28 11:24:06.0"/>
<Action id="56282" issue="36921" author="ashcherbakov" type="comment" created="2019-01-28 20:15:19.0" updateauthor="ashcherbakov" updated="2019-01-30 12:45:57.0"> <body><! CDATA There are 3 main things we need to take into account when deciding if the current trust anchor's behavior is fine and sufficient for the current use cases: # Although only trust anchor can create new NYMs, SCHEMAs, ATTRIBs and CLAIM_DEFs, the owner of the NYM transaction can edit it (for example rotate the key) without any restrictions. So, at some degree there are write transactions that can be sent by a non-trust-anchor. # As of now, it's not possible to have either Permissions or fees-based authorization policies (that is be either a Trust Anchor OR pay). Tokens always require payment regardless of the role. This will be fixed once the new multi-signature approach is integrated in the scope of INDY-1930. # Revocation transactions can be sent by non-trust-anchors. This will be addressed in the scope of INDY-1554 # As of now, no promotion of roles is possible, that is if a NYM is demoted (trust anchor role is removed), then it's removed forever.  ></body> </Action>
<Action id="56371" issue="36921" author="andkononykhin" type="comment" created="2019-01-30 09:26:03.0" updateauthor="andkononykhin" updated="2019-02-01 08:28:20.0"> <body><! CDATA > Any steward or trustee can create the role.  works  > Any trustee can revoke the role.  woks  > Holders of this role can demote themselves (remove the role).  INDY-1968  > Anyone with the role should be able to write to the ledger without proof of payment.  Doesn't work. Plugins doesn't check any authorization rules for now. (INDY-1930)  > If a ANYONE_CAN_WRITE (INDY-1528) is false, this role is required to write to the ledger.  Doesn't work since: * NYM: by design anyone can modify its verkey if he/she owns the NYM (verkey is not None) * revocation txns: anyone can write (INDY-1554)  > If ANYONE_CAN_WRITE is true, then anyone can write to the ledger with or without this role.  Partly works. INDY-1967  > The plugin interface supports plugins such that if ANYONE_CAN_WRITE is true, writes can be allowed without this role only if payment is attached, and can be allowed without a payment if the author has this role. (Check the Sovrin payment plugins to ensure they work this way. Issues with the plugin implementation should be raised in the Sovrin jira.)  Doesn't work. (INDY-1930)  Additional notes (already mentioned): * there was found that demotion for did with no role (already demoted or never been promoted) is accepted and seems it is not as designed (INDY-1969) * previously demoted DID (or created without any role specified) can't be promoted (INDY-1970) * once INDY-1930 becomes done ANYONE_CAN_WRITE is going to be removed * created a set of tasks to improve test codebase to cover all possible cases related to auth rules: INDY-1974,  INDY-1975,  INDY-1976,  INDY-1977,  INDY-1978,  INDY-1979,  INDY-1980,  INDY-1981,  INDY-1982  ></body> </Action>
<Action id="56372" issue="36921" author="ozheregelya" type="comment" created="2019-01-30 09:33:55.0" updateauthor="ozheregelya" updated="2019-01-30 09:33:55.0"> <body><! CDATA {quote}If ANYONE_CAN_WRITE is true, then anyone can write to the ledger with or without this role. {quote} Please note the that now there is a problem with ANYONE_CAN_WRITE = True - INDY-1967: ANYONE_CAN_WRITE = True breaks roles validation.  So, anyone can write to the ledger with or without any role, but, for example, Identity Owner can create new Trustee or blacklist existing one.  ></body> </Action>
<Action id="56435" issue="36921" author="ozheregelya" type="comment" created="2019-01-31 11:24:13.0" updateauthor="ozheregelya" updated="2019-01-31 11:24:13.0"> <body><! CDATA From QA side, all acceptance scenarios were reviewed and updated. INDY-1963 and INDY-1971 block updating expected results, so expected results will be updated in scope of these tickets. Roles were re-tested and there were no issues besides INDY-1963, INDY-1967 and INDY-1971.  ></body> </Action>
<Action id="56486" issue="36921" author="andkononykhin" type="comment" created="2019-02-01 08:29:55.0" updateauthor="andkononykhin" updated="2019-02-08 13:25:03.0"> <body><! CDATA *Problem reason*: * there is no assurance  that TRUST_ANCHOR permissions are set correctly * there are not enough integration tests to cover more cases (all would be the best)  *Changes*: * added integration tests * created set of tasks to fix encountered issues and improve test codebase (please refer to this comment)  *Committed into*:   https://github.com/hyperledger/indy-plenum/pull/1068    https://github.com/hyperledger/indy-node/pull/1146|https://github.com/hyperledger/indy-node/pull/1029   *Risk factors*:  no  *Risk*:  Low  *Covered with tests*:  yes  *Recommendations for QA*: * no acceptance is expected since changes were made only for test codebase only  ></body> </Action>
