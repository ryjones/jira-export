<Action id="53371" issue="35264" author="esplinr" type="comment" created="2018-11-13 05:54:23.0" updateauthor="esplinr" updated="2018-11-13 05:54:23.0"> <body><! CDATA From Mike: All new nodes coming onto the network show this behavior. In addition, the address they are trying to contact it on is the loopback address (127.0.0.1)  ></body> </Action>
<Action id="53394" issue="35264" author="ashcherbakov" type="comment" created="2018-11-13 16:28:59.0" updateauthor="ashcherbakov" updated="2018-11-13 16:28:59.0"> <body><! CDATA  ~mgbailey  Is `valNode01` part of genesis file?  ></body> </Action>
<Action id="53401" issue="35264" author="mgbailey" type="comment" created="2018-11-13 19:42:57.0" updateauthor="mgbailey" updated="2018-11-13 19:42:57.0"> <body><! CDATA It is not in the genesis. It was added by a node transaction, which was later updated, and then updated again to remove the validator service tag.     ></body> </Action>
<Action id="53471" issue="35264" author="ashcherbakov" type="comment" created="2018-11-15 08:35:08.0" updateauthor="ashcherbakov" updated="2018-11-15 08:35:08.0"> <body><! CDATA  ~mgbailey  1) Do we understand correctly, that the pool stability is not affected by this issue, and all nodes are in consensus?  2) Is the issue still there if a new node is restarted?  ></body> </Action>
<Action id="53502" issue="35264" author="mgbailey" type="comment" created="2018-11-15 17:42:55.0" updateauthor="mgbailey" updated="2018-11-15 17:42:55.0"> <body><! CDATA  ~ashcherbakov  This issue is not preventing consensus, but it still merits looking at since we are experiencing intermittent slowness from clients for unknown reasons. There are 4 of 13 nodes that are currently experiencing this issue. I have asked the stewards of these nodes to restart the indy-node service on them, but due to their time zones, we may not hear back from them today.     ></body> </Action>
<Action id="53538" issue="35264" author="mgbailey" type="comment" created="2018-11-16 18:46:22.0" updateauthor="mgbailey" updated="2018-11-16 18:46:22.0"> <body><! CDATA Update: # Restarting the nodes does appear to make them stop attempting to connect to the phantom node. # All the nodes in the pool started today reporting "sovrin.sicpa.com" as unreachable. Once again, this node's transaction on the pool ledger has been previously disabled with a services=<blank> write to the ledger. Once again, a restart of the nodes makes them stop trying to reach the phantom node. # My concern is rising. Could clients, which share code libraries with indy-node, also be attempting to contact demoted nodes?  ></body> </Action>
<Action id="53552" issue="35264" author="krw910" type="comment" created="2018-11-17 18:04:53.0" updateauthor="krw910" updated="2018-11-17 18:06:33.0"> <body><! CDATA  ~esplinr  ~mgbailey  ~ashcherbakov  I changed this from a task to a bug since it is an issue and not an exploratory type ticket.  I agree with Mike that this is a concern and I would say a big one for me. We cannot keep restarting nodes to fix issues.  I see two possible things here that both are concerning. 1. Nodes are ignoring the demoted state of a node services=   2. The nodes that are trying to contact those in a demoted state do not have the transaction in their ledger showing the node has been demoted.   Both possibilities are concerning.  ></body> </Action>
<Action id="53574" issue="35264" author="ashcherbakov" type="comment" created="2018-11-19 07:14:40.0" updateauthor="ashcherbakov" updated="2018-11-19 07:14:40.0"> <body><! CDATA Agree, it needs to be investigated.   ~mgbailey  {quote}been previously disabled with a services=<blank> {quote}  So, did we use `services=<blank>` or `services=  `? {quote}Could clients, which share code libraries with indy-node, also be attempting to contact demoted nodes? {quote} The only client that shares codebase with indy-node is the old deprecated indy-cli shipped with indy-node. Does anyone still use it?  ></body> </Action>
<Action id="53603" issue="35264" author="mgbailey" type="comment" created="2018-11-19 15:56:25.0" updateauthor="mgbailey" updated="2018-11-19 15:56:25.0"> <body><! CDATA  ~ashcherbakov  The transaction to demote a node in the new indy-cli is: {code:java} ledger node target=7wetNy5AJpHfXvhTx4okZokSw5mcrgWgVZ8jJ3WHgrmd alias=trusted_you services= {code} I assume that libindy and indy-node share some common code. Maybe this is incorrect.  ></body> </Action>
<Action id="53656" issue="35264" author="esplinr" type="comment" created="2018-11-20 17:08:00.0" updateauthor="esplinr" updated="2018-11-20 17:08:00.0"> <body><! CDATA  ~mgbailey  Indy Node and Indy SDK only share the crypto library.  We believe that addressing the concern in IS-1066 and INDY-1816 mitigates most of the symptoms of this ticket. We will continue our investigation to verify that there are no additional changes necessary.  Downstream applications need to ensure that they are refreshing their list of pool nodes on a regular basis to remove stale nodes. cc  ~krw910  and  ~jrayback   ></body> </Action>
<Action id="53717" issue="35264" author="derashe" type="comment" created="2018-11-22 10:07:34.0" updateauthor="derashe" updated="2018-11-22 10:07:34.0"> <body><! CDATA This problem was caused because of double demotion problem (earlier double demotion resulted in connection to node). This was fixed after stable release 1.6.78 was published.  Ticket: https://jira.hyperledger.org/browse/INDY-1506  PR: https://github.com/hyperledger/indy-plenum/pull/922        ></body> </Action>
<Action id="53719" issue="35264" author="dsurnin" type="comment" body="The last demotion of the node valNode01 was made with node ip changed to 127.0.0.1. That is why new nodes tried to connect to localhost." created="2018-11-22 10:11:45.0" updateauthor="dsurnin" updated="2018-11-22 10:11:45.0"/>
<Action id="53758" issue="35264" author="mgbailey" type="comment" body=" ~Derashe   ~ashcherbakov  I am seeing this problem in systems that are running 1.6.78. How can we say that it is fixed?" created="2018-11-23 16:05:39.0" updateauthor="mgbailey" updated="2018-11-23 16:05:39.0"/>
<Action id="53761" issue="35264" author="derashe" type="comment" body=" ~mgbailey  Because this fix was not included in 1.6.78. And was fixed after it has been published." created="2018-11-23 16:36:11.0" updateauthor="derashe" updated="2018-11-23 16:36:11.0"/>
