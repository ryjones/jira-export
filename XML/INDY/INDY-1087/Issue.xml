<Issue id="26736" key="INDY-1087" number="1087" project="10303" reporter="sergey-shilov" assignee="vladimirwork" creator="sergey-shilov" type="10002" summary="Add iptables rules to limit the number of clients connections" priority="2" resolution="10000" status="10001" created="2018-01-11 09:45:43.0" updated="2019-03-29 20:34:21.0" resolutiondate="2019-03-29 20:34:21.0" votes="0" watches="2" workflowId="26736"> <description><! CDATA The investigation done in scope of ticket  INDY-570|https://jira.hyperledger.org/browse/INDY-570  showed that there is no way to limit the number of clients connections using ZMQ API. So we need external firewall (iptables) to do it.  Corresponding iptables rule may be added manually by steward or automatically by install script. The questions here is what max number of sumultaneous connections should be specified? Just to remind: the main problem of non-limited number of clients connections is situation when we can not open some file as the limit of opened file descriptors is reached. The main point here is that we always should have ability to open files that are necessary for node functionality. So I propose the following solution: 1. calculate approximate number of file descriptors needed to open local files, DBs etc. (F) 2. calculate approximate number of file descriptors needed for communication with other nodes (N) 3. define some window, i.e. some number of spare file descriptors as two steps above calculate file descriptors approximately (W) 4. now we can calculate max number of clients connections (X): X = LimitNOFILE - (F + N + W)  ></description> </Issue>
