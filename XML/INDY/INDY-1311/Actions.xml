<Action id="43782" issue="29918" author="ashcherbakov" type="comment" created="2018-05-03 16:04:08.0" updateauthor="ashcherbakov" updated="2018-05-03 16:32:22.0"> <body><! CDATA Some ideas how we can reduce INFO log sizes: * Do not log positive cases (if txn was ordered successfully, then most probably there is no sense to log all details for 3PC) * Extend logging in negative cases: if txn was failed to be ordered (see INDY-1274), then we need to extend logging to provide more info.  We can just dump the current state, or use a circular buffer with more detailed state for this purpose * Use separate log files for detailed logs and for warning/error logs, so that warning/error logs are rotated less often. * Reduce logging on backup instances * Do not log in files, but rather in some indexed DBs   ></body> </Action>
<Action id="43787" issue="29918" author="spivachuk" type="comment" body="It makes sense to write logs to 2 different destinations in parallel with different log levels (for example, WARNING and INFO) and correspondingly with different rotation frequencies. With this approach we would have, for example, a week-long history in the WARNING log that would be sufficient for stewards not to lose sight of errors and warnings and an hour-long history in the INFO log that would give stewards a chance to get also a detailed prehistory of detected warnings and errors in case they occurred not longer than an hour ago." created="2018-05-03 16:42:26.0" updateauthor="spivachuk" updated="2018-05-03 16:42:26.0"/>
<Action id="44265" issue="29918" author="krw910" type="comment" created="2018-05-11 15:33:35.0" updateauthor="krw910" updated="2018-05-11 15:33:35.0"> <body><! CDATA  ~ashcherbakov   ~spivachuk  You need to check in with  ~tharmon  and  ~mgbailey  when considering changes to the logging. They rely heavily on the information provided by the logs. Do we understand why we use so much memory? It seems that there is more to the issue than just the amount being logged at INFO level.   ></body> </Action>
<Action id="44267" issue="29918" author="mgbailey" type="comment" created="2018-05-11 15:53:32.0" updateauthor="mgbailey" updated="2018-05-11 15:53:32.0"> <body><! CDATA I agree with  ~krw910 , it would appear that something beyond the amount written to the log is influencing performance when logging is on at the info level.  I do not believe that the ticket description is accurate for logs at the INFO level, which is much more parsimonious than TRACE.  Nonetheless, some of the suggestions here are valid. For successful posts, the INFO logging can be confined to two events: the transaction received from the client for processing, and the transaction being successfully added to the ledger.  Please do not dump the state in INFO in a form that is not easily consumable by an admin. Unless you convince me otherwise, I still want data in a form like what is described in INDY-1274.  I don't understand the two log suggestion at all. This will not reduce the burden of logging on the system, which I think is the primary goal of this ticket.  ></body> </Action>
<Action id="44272" issue="29918" author="ashcherbakov" type="comment" created="2018-05-11 16:39:27.0" updateauthor="ashcherbakov" updated="2018-05-11 16:39:27.0"> <body><! CDATA  ~mgbailey   ~krw910  The ticket description is accurate. We really have Gigabytes of logs even on INFO level under the high load. And the cause of this is that we log on INFO level every request that comes (there can be even multiple messages for one request). So, even on INFO level we are logging quite a lot, and this is I/O operations, so this affects both Performance and Stability (introducing more random delays in the pool).  One of the ideas is to not log too much in case of positive events (for example, if we successfully ordered 100 txns, then it doesn't make sense to have a line in the log for each request, maybe this is enough to log just once that we ordered 100 txns successfully). It doesn't mean that we should not output data in case on errors or when something goes wrong. So, I believe INDY-1274 is still valid and doesn't contradict with this issue. Moreover, I think we can extend some troubleshooting information even more in some of the cases.   ></body> </Action>
<Action id="46813" issue="29918" author="ashcherbakov" type="comment" body="Duplicates INDY-1416" created="2018-07-02 12:52:28.0" updateauthor="ashcherbakov" updated="2018-07-02 12:52:28.0"/>
<Action id="46924" issue="29918" author="dsurnin" type="comment" created="2018-07-04 15:38:01.0" updateauthor="dsurnin" updated="2018-07-04 15:38:01.0"> <body><! CDATA * time format changed to yymmddHHMMSSFFF * log level is now represented with 1 letter * REPLICA: prefix was removed * file name and function name were removed  in test environment these changes reduced log file size from almost 40M to almost 33M  https://github.com/hyperledger/indy-plenum/pull/794  ></body> </Action>
<Action id="47197" issue="29918" author="ashcherbakov" type="comment" created="2018-07-11 08:40:33.0" updateauthor="ashcherbakov" updated="2018-07-11 08:40:33.0"> <body><! CDATA It was decided that we don't change time format, log level, and keep file name. The only changes that were done is getting rid of REPLICA prefix and function name.  ></body> </Action>
