<Action id="45403" issue="30214" author="sergey-shilov" type="comment" created="2018-06-01 13:17:59.0" updateauthor="sergey-shilov" updated="2018-06-04 06:27:32.0"> <body><! CDATA *Problem state / reason:*  Indy node binds both node and client listeners to 0.0.0.0.  *Changes:* * Made IP to bind to optional in code instead of hard coded "0.0.0.0" or "*". * Now node/client IPs are got from /etc/indy/indy.env. * Changed installation and indy node initialisation scripts. * Implement migration script that adds node/client IPs to /etc/indy/indy.env if they are not present there. Node IP is got from pool ledger, client IP is set as 0.0.0.0. * Fix docs and test network setup scripts.  *Committed into:*  https://github.com/hyperledger/indy-plenum/pull/707 https://github.com/hyperledger/indy-plenum/pull/715 https://github.com/hyperledger/indy-plenum/pull/716     https://github.com/hyperledger/indy-node/pull/732 https://github.com/hyperledger/indy-node/pull/734 https://github.com/hyperledger/indy-node/pull/736 https://github.com/hyperledger/indy-node/pull/738  https://github.com/hyperledger/indy-node/pull/740   indy-node 1.3.438-master  *Risk factors:*      Nothing is expected.  *Risk:*      Low  *Recommendations for QA:*  Set up the pool and check that all nodes connected and can do network exchange with each other.  Check /etc/indy/indy.env after installation, it should contain the following two variables: NODE_IP and NODE_CLIENT_IP. Their values should be set according to initialisation tool (init_indy_node, generate_indy_pool_transactions etc.).  Also check that nodes really listen IPs listed in their /etc/indy/indy.env files using _netstat_ utility: # apt install net-tools # netstat -ln  Example: root@0ffd7dc802b9:/home/indy# netstat -ltn Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address           Foreign Address         State       tcp        0      0 10.0.0.3:9703           0.0.0.0:*               LISTEN      tcp        0      0 0.0.0.0:9704            0.0.0.0:*               LISTEN      tcp        0      0 127.0.0.11:43056        0.0.0.0:*               LISTEN      tcp        0      0 127.0.0.1:30003         0.0.0.0:*               LISTEN       ></body> </Action>
<Action id="45415" issue="30214" author="vladimirwork" type="comment" body="There is an issue with AWS setup (node NICs don&apos;t match IPs in .env file), it is reproduced on QA Live Pool now." created="2018-06-01 16:19:36.0" updateauthor="vladimirwork" updated="2018-06-04 10:23:24.0"/>
<Action id="45448" issue="30214" author="vladimirwork" type="comment" body="We should keep NODE_IP and NODE_CLIENT_IP as *0.0.0.0* during upgrade/migration/installation to let Stewards configure it manually since we can fall into issue with NICs that are set in /etc/indy/indy.env but aren&apos;t listed in node machine NIC list (`ip a`)." created="2018-06-04 10:54:19.0" updateauthor="vladimirwork" updated="2018-06-06 08:32:29.0"/>
<Action id="45450" issue="30214" author="sergey-shilov" type="comment" body="Agreed, seems like it&apos;s the right solution." created="2018-06-04 11:18:33.0" updateauthor="sergey-shilov" updated="2018-06-04 11:18:33.0"/>
<Action id="45658" issue="30214" author="vladimirwork" type="comment" created="2018-06-07 15:11:58.0" updateauthor="vladimirwork" updated="2018-06-07 15:11:58.0"> <body><! CDATA Build Info: indy-node 1.3.447  Actual Results: We keep NODE_IP and NODE_CLIENT_IP as 0.0.0.0 during upgrade(migration)/installation to let Stewards configure it manually. Docker pool works normally with any amount of nodes with fair separate and custom configured NICs for node/client connections. !2NIC_env_config.PNG|thumbnail!  !2NIC_network_config.PNG|thumbnail!  !2NIC_NYMs_adding.PNG|thumbnail!  AWS pool works normally with custom configured NICs only (but not separate).  ></body> </Action>
