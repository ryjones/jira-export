<Issue id="20113" key="INDY-726" number="726" project="10303" reporter="mgbailey" assignee="danielhardman" creator="mgbailey" type="10004" summary="Primary fails to send pre-prepare" environment="This network is running indy-node 1.0.28" priority="2" resolution="10000" status="10001" created="2017-08-10 21:58:47.0" updated="2019-03-29 20:33:04.0" resolutiondate="2019-03-29 20:33:04.0" votes="0" watches="4" workflowId="20113"> <description><! CDATA This error was observed in the ESN.  While running a low-volume load test, one of the nodes, 'metis' lost sync and did not recover.  'play was the primary node at this time.  It occurred at about 16:22:02 in the 'play' log, and the DID of this first NYM transaction was 3SMdqenHLPYz654FAUd5o5.  The issue continued for the next 40 or so transactions until the test script terminated. Later, while attempting to diagnose the issue, another NYM transaction was sent to the pool manually, using the CLI.  The node also failed to post this transaction.  Two other nodes were examined and unlike metis, they were in sync and were accepting new transactions.  In troubleshooting, the metis sovrin-node process was restarted.  metis quickly caught up, but would still not accept new transactions.  As the next troubleshooting step, we stopped the sovrin-node process on the primary, forcing a view change.  At this point, the problem cleared up, and new transactions were posted to all nodes, including metis.  Examining the primary's logs, during the time where the error was occurring we see the transaction propagating to all nodes, but we see PREPREPAREs going to only two of eight nodes.  We speculate that this lack of PREPREPAREs may be a clue.  There were no signs of connectivity issues anywhere.  We later restarted all nodes, and with play once again the primary, there were no further problems observed.  INFO-level logs are attached for play, which is the primary, and for metis.           ></description> </Issue>
