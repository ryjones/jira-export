<Issue id="42115" key="INDY-2221" number="2221" project="10303" reporter="mgbailey" assignee="mgbailey" creator="mgbailey" type="10004" summary="WARNING messages incorrectly logged if tokens are not used" environment="Sovrin Networks, running indy 1.9.1" priority="3" resolution="10000" status="10001" created="2019-08-28 21:37:23.0" updated="2020-01-16 14:08:09.0" resolutiondate="2020-01-16 14:08:09.0" votes="0" watches="2" workflowId="55159"> <description><! CDATA Typically the WARNING log level is used for serious issues, such as those that prevent a transaction from being written to the ledger. Unfortunately, we now see WARNINGS being logged in some cases for valid transactions.  On StagingNet, we have authorization policies set so that a transaction can either be written by any user if paid for by a token, or by user with an appropriate privileged role if no token is paid. The issue described occurs if the second approach is taken. For example, a transaction endorser, which is configured to be authorized to write schemas, writes a schema without paying for it in tokens. This transaction is successful, but misleadingly generates a WARNING message in the node logs:   {code:java} 2019-08-26 14:23:17,693|DEBUG|node.py|australia received propagated request: PROPAGATE{'senderClient': 'mhi exDNsaMDh$yuG$d?Qcg<OJ=x1pdC=)BJ R(k', 'request': {'reqId': 1566829387617365918, 'operation': {'type': '101', 'data': {'version': '180.348.197', 'name': 'account', 'attr_names':  'bsb', 'debit', 'name', 'product name', 'credit', 'account' }}, 'protocolVersion': 2, 'identifier': 'KS34fHidcfwQxvqNCZUpUb', 'signature': 'ZkdWK2u94nw6EUgRrnUxS1mz3bALoky4yezi1h8Z2VjminyjzzD38mEV2dHjL3ZG3yLzVN1uM7rUJpqwCN694Pi'}} 2019-08-26 14:23:17,737|DEBUG|node.py|australia authenticated {'KS34fHidcfwQxvqNCZUpUb'} signature on propagate request 1566829387617365918 ... 2019-08-26 14:23:17,833|DEBUG|auth_cons_strategies.py|Using auth constraint from state 2019-08-26 14:23:17,834|WARNING|fees_authorizer.py|Validation error: Fees are required for this txn type{code} My guess as to what is occurring is that when fees are configured in the auth policies, they are always (appropriately) checked first to see if payment is provided. If no fee is found, a WARNING is generated and then it proceeds on to check if other auth policies are satisfied.  The desired behavior is that no WARNING message is generated until it is determined that *all* auth policies are unsatisfied and so the transaction will fail to be posted to the ledger. This behavior may be happening in more than just schema writes, and the fix should be applied universally.  ></description> </Issue>
