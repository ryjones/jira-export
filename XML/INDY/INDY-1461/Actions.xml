<Action id="47199" issue="31754" author="toktar" type="comment" created="2018-07-11 10:12:44.0" updateauthor="toktar" updated="2018-07-11 10:12:44.0"> <body><! CDATA Nodes receive CATCHUP_REP with inconsistency consProof and blacklisting each other. Example:  {code}Node1 could not verify catchup reply CATCHUP_REP{'ledgerId': 1, 'consProof':  'ap2gZnEvUGQ8XJ3S6jTGAyV3Dkwj7bw4xqbtYKCgKPu', '2qPZqpEuEgXoGm3ibFdh16Xem9PnfS8mn3rLPfJvZ1Dt', '7rdpBLumEwGRhzULJigLrtPA3fpKPHAZTnLfWwTf5Udk', '5XH22xQLuaQF7cMmCJEYQh6KKVGmsGiBQkNTTJJoaTZr', 'FXEahvwDUYNvb2ruTy2UYEp3L3bqDXDNw7xv5F5EUsMd', '2bbkhQs3VHemaehtLrfXCzSWiLCeLzCQbyzrTQEXaQtv', 'APhxKsrqHgv1CLqx3BF5H5pRpqkVbt3yoKjCEuDuoY5w', '9FVGELMH2wg47LnVqvbD5as7BMck4w4uRp2Fag9EjW2t', '7LDys6Y1Ly4GQZ3kXPHoPvJVz4icwrvaAGG72TRHn7Kk', '64nq4vPf1GV3Hdq2xgXn1GjJZktUa5ivTSktTK38VTpW', 'FiDV9ngABcJuP84jcWZUFqnDZmGdEQXPRT4CnxpX3Qxm', 'CYn6G6aDiz5bvinS8kbcsFGWBD27AzDhhE4i5BcP79im', '9isp7TsUEsLeBUG98ZjU3Q7cSjo1h9RDehsz9kVP5Hz6', 'AyoxEVY8ZQRyTBPzrpAjabz9Q722JbbQwxeEeyup62LV', 'AM3HC6SKRPdTUJ7mp6uoFwnbh6mHAyTpVtsKHqaEnpEs', '5onzA2nrxBNGJFCW1sVAFETmh1x9mo6w6b3fs788Eiwf' , 'txns': {'25751': {'ver': '1', 'reqSignature': {'type': 'ED25519', 'values':  {'from': 'V4SGRU86Z58d6TV7PBUe6f', 'value': '5zgcSjZWVhHJkmFXnGgbtCbJs4d4Vg9ee9Hj6UMHx1bSEk7LHCgKXg9CdPXfYKFf2tQtt6RjgLZXFxHK1UpVdSY5'} }, 'txn': {'data': {'dest': 'Tfo7nYvPzFcVLKztDwP3Pz'}, 'protocolVersion': 2, 'metadata': {'reqId': 1531146067433417757, 'digest': '11d98dad0f85022ad60c1a9b7c0787541676878949730604f98156a3f636edab', 'from': 'V4SGRU86Z58d6TV7PBUe6f'}, 'type': '1'}, 'txnMetadata': {'txnId': 'c3c4ce2961681e4f68e77ae295fa4cff9347b894680ee886a8a76b3273c8fe58', 'txnTime': 1531147363, 'seqNo': 25751}}}} since Inconsistency: first root hash does not match. Expected hash: b'2656cb42f43444407ce661db1935a0f76bbda1ac195cbef992f3e5d7f403d391', computed hash: b'198b64ed10faa123b89212a8877435d698eaacf59ff824ae0496ceb7af1bb624' {code}  ></body> </Action>
<Action id="47277" issue="31754" author="toktar" type="comment" created="2018-07-12 14:03:24.0" updateauthor="toktar" updated="2018-07-12 14:03:24.0"> <body><! CDATA During the analysis, was revealed:  7 nodes blacklisting other 18 because _first root hash does not match_ in catchup in 2nd view change. They start 3d  view change but couldn't finish it.  ></body> </Action>
<Action id="47349" issue="31754" author="toktar" type="comment" created="2018-07-16 10:01:06.0" updateauthor="toktar" updated="2018-07-16 10:01:06.0"> <body><! CDATA The problem can be solved using the following methods: 1. To correct the way of obtaining the last prepare certificate. At the moment we take the last value for which there is a quorum of the prepares. This is incorrect, since we do not check for the availability of the pre-prepares in the current node. 2. Make a view change according to PBFT, as in the current protocol this problem does not have a solution.  The first option was chosen. Despite the fact that this does not solve the problem in 100% of cases, this will solve part of the problem. Other bags lead to the problem should be solved in the latest bugfixes, which already in master. Thus, the task will require re-testing after the implementation of the fix on the prepare certificate.  ></body> </Action>
<Action id="47398" issue="31754" author="toktar" type="comment" created="2018-07-17 08:24:13.0" updateauthor="toktar" updated="2018-07-17 08:24:13.0"> <body><! CDATA Problem with incorrect prepare certificate was not found by TDD tests. Added test proves correct work.  The task will be re-tested in  INDY-1343|https://jira.hyperledger.org/browse/INDY-1343      ></body> </Action>
