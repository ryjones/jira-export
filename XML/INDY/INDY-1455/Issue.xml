<Issue id="31668" key="INDY-1455" number="1455" project="10303" reporter="zhigunenko.dsr" assignee="spivachuk" creator="zhigunenko.dsr" type="10004" summary="Pool cannot order transactions because Node set incorrect watermarks after it&apos;s restart" environment="indy-node 1.4.490" priority="2" resolution="10000" status="10001" created="2018-07-05 11:08:25.0" updated="2019-03-29 20:32:28.0" resolutiondate="2019-03-29 20:32:28.0" votes="0" watches="2" workflowId="31682"> <description><! CDATA *Step to reproduce:* 1) setup pool with 25 nodes on AWS 2) set 1,06kk txns to ledger 3) run concurrent load test: {code:java} python3 perf_processes.py -g pool_transactions_genesis -b 10 -r 2 -m t -c 286 -t 57 -n 1 -k "{\"nym\": {\"count\": 4},\"nym\": {\"attrib\": 1},\"nym\": {\"schema\": 1},\"nym\": {\"cred_def\": 1}}" {code} {code:java} python3 perf_processes.py -g pool_transactions_genesis -b 10 -r 2 -m t -c 143 -t 57 -n 1 -k "{\"nym\": {\"count\": 4},\"nym\": {\"attrib\": 1},\"nym\": {\"schema\": 1},\"nym\": {\"cred_def\": 1}}" {code} {code:java} python3 perf_processes.py -g pool_transactions_genesis -b 10 -r 2 -m t -c 143 -t 57 -n 1 -k "{\"nym\": {\"count\": 4},\"nym\": {\"attrib\": 1},\"nym\": {\"schema\": 1},\"nym\": {\"cred_def\": 1}}" {code} {code:java} python3 perf_processes.py -g pool_transactions_genesis -b 10 -r 2 -m t -c 143 -t 4 -n 1 -k "{\"get_schema\": {\"file_name\": \"./load_schema/successful\"}}" {code} {code:java} python3 perf_processes.py -g pool_transactions_genesis -b 10 -r 2 -m t -c 143 -t 4 -n 1 -k "{\"get_attrib\": {\"file_name\": \"./load_attrib/successful\"}}" {code} {code:java} python3 perf_processes.py -g pool_transactions_genesis -b 10 -r 2 -m t -c 143 -t 4 -n 1 -k "{\"get_nym\": {\"file_name\": \"./load_nym/successful\"}}" {code} *Actual results:* {code:java} 2018-07-05 07:16:58,838 | INFO     | replica.py           ( 884) | dispatchThreePhaseMsg | REPLICA:(Node18:5) Node18:5 stashing 3 phase message PREPREPARE{'discarded': 1, 'digest': '28eb27c43db6b7472b72e9fa547f7fc7e7f1eb8e6d4fc521c225a98c5fc3ca91', 'reqIdr':  '2f051e9054ea521e0acce5949839e3a3f174ba6bc063974b6fb796f04564dc34' , 'ppSeqNo': 21116, 'instId': 5, 'ppTime': 1530775018, 'ledgerId': 1, 'txnRootHash': None, 'stateRootHash': None, 'viewNo': 3} since ppSeqNo 21116 is not between 0 and 300) {code} *Workaround:* Restart whole pool via CLI  Logs are available on LogProcessor  ></description> </Issue>
