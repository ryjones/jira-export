<Issue id="31907" key="INDY-1479" number="1479" project="10303" reporter="rajeshkalaria" assignee="rajeshkalaria" creator="rajeshkalaria" type="10004" summary="dev env ledger (from master version) is crashing with add nym and add schema" priority="2" resolution="10000" status="10001" created="2018-07-16 08:35:47.0" updated="2019-03-29 20:34:00.0" resolutiondate="2019-03-29 20:34:00.0" votes="0" watches="2" workflowId="31934"> <description><! CDATA We are seeing some weird issue on our dev env ledger. So we are just trying to do add nym operation, and what it ends up is crashing 3 nodes with given exception. We are pointing to below mentioned master versions of node components:  indy-anoncreds                     1.0.32 indy-node                              1.4.463 indy-plenum                          1.4.406 libindy-crypto                        0.4.0 python3-indy-crypto            0.4.1  FYI: *This was working fine since last few days (at least might be a week as well), somehow today we are seeing this issue.*  {color:#ff0000}When we saw below error, we tried to confirm if all node processes are running or not and we found that only node1 was running, rest 3 nodes were already crashed. {color}  ------------------------------------------------------------  Traceback (most recent call last):   File "/usr/local/bin/start_indy_node", line 19, in <module>     client_ip=sys.argv 4 , client_port=int(sys.argv 5 ))   File "/usr/local/lib/python3.5/dist-packages/indy_node/utils/node_runner.py", line 57, in run_node     looper.run()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 264, in run     return self.loop.run_until_complete(what)   File "/usr/lib/python3.5/asyncio/base_events.py", line 387, in run_until_complete     return future.result()   File "/usr/lib/python3.5/asyncio/futures.py", line 274, in result     raise self._exception   File "/usr/lib/python3.5/asyncio/tasks.py", line 239, in _step     result = coro.send(None)   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 227, in runForever     await self.runOnceNicely()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 210, in runOnceNicely     msgsProcessed = await self.prodAllOnce()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 152, in prodAllOnce     s += await n.prod(limit)   File "/usr/local/lib/python3.5/dist-packages/indy_node/server/node.py", line 298, in prod     c = await super().prod(limit)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1033, in prod     c += await self.serviceNodeMsgs(limit)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1067, in serviceNodeMsgs     await self.processNodeInBox()   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1637, in processNodeInBox     await self.nodeMsgRouter.handle(m)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/router.py", line 81, in handle     res = self.handleSync(msg)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/router.py", line 70, in handleSync     return self.getFunc(msg 0 )(*msg)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_req_processor.py", line 51, in process_message_rep     return handler.process(msg, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_handlers.py", line 63, in process Traceback (most recent call last):   File "/usr/local/bin/start_indy_node", line 19, in <module>     return self.processor(valid_msg, params, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_handlers.py", line 238, in processor     self.node.processPropagate(validated_msg, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 2156, in processPropagate     reqDict = msg.request AttributeError: 'NoneType' object has no attribute 'request'     client_ip=sys.argv 4 , client_port=int(sys.argv 5 ))   File "/usr/local/lib/python3.5/dist-packages/indy_node/utils/node_runner.py", line 57, in run_node     looper.run()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 264, in run     return self.loop.run_until_complete(what)   File "/usr/lib/python3.5/asyncio/base_events.py", line 387, in run_until_complete     return future.result()   File "/usr/lib/python3.5/asyncio/futures.py", line 274, in result     raise self._exception   File "/usr/lib/python3.5/asyncio/tasks.py", line 239, in _step     result = coro.send(None)   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 227, in runForever     await self.runOnceNicely()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 210, in runOnceNicely     msgsProcessed = await self.prodAllOnce()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 152, in prodAllOnce     s += await n.prod(limit)   File "/usr/local/lib/python3.5/dist-packages/indy_node/server/node.py", line 298, in prod     c = await super().prod(limit)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1033, in prod     c += await self.serviceNodeMsgs(limit)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1067, in serviceNodeMsgs     await self.processNodeInBox()   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1637, in processNodeInBox     await self.nodeMsgRouter.handle(m)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/router.py", line 81, in handle     res = self.handleSync(msg)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/router.py", line 70, in handleSync     return self.getFunc(msg 0 )(*msg)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_req_processor.py", line 51, in process_message_rep     return handler.process(msg, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_handlers.py", line 63, in process     return self.processor(valid_msg, params, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_handlers.py", line 238, in processor     self.node.processPropagate(validated_msg, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 2156, in processPropagate     reqDict = msg.request AttributeError: 'NoneType' object has no attribute 'request' Traceback (most recent call last):   File "/usr/local/bin/start_indy_node", line 19, in <module>     client_ip=sys.argv 4 , client_port=int(sys.argv 5 ))   File "/usr/local/lib/python3.5/dist-packages/indy_node/utils/node_runner.py", line 57, in run_node     looper.run()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 264, in run     return self.loop.run_until_complete(what)   File "/usr/lib/python3.5/asyncio/base_events.py", line 387, in run_until_complete     return future.result()   File "/usr/lib/python3.5/asyncio/futures.py", line 274, in result     raise self._exception   File "/usr/lib/python3.5/asyncio/tasks.py", line 239, in _step     result = coro.send(None)   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 227, in runForever     await self.runOnceNicely()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 210, in runOnceNicely     msgsProcessed = await self.prodAllOnce()   File "/usr/local/lib/python3.5/dist-packages/stp_core/loop/looper.py", line 152, in prodAllOnce     s += await n.prod(limit)   File "/usr/local/lib/python3.5/dist-packages/indy_node/server/node.py", line 298, in prod     c = await super().prod(limit)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1033, in prod     c += await self.serviceNodeMsgs(limit)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1067, in serviceNodeMsgs     await self.processNodeInBox()   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1637, in processNodeInBox     await self.nodeMsgRouter.handle(m)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/router.py", line 81, in handle     res = self.handleSync(msg)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/router.py", line 70, in handleSync     return self.getFunc(msg 0 )(*msg)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_req_processor.py", line 51, in process_message_rep     return handler.process(msg, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_handlers.py", line 63, in process     return self.processor(valid_msg, params, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/message_handlers.py", line 238, in processor     self.node.processPropagate(validated_msg, frm)   File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 2156, in processPropagate     reqDict = msg.request AttributeError: 'NoneType' object has no attribute 'request'  ></description> </Issue>
