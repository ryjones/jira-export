<Action id="27360" issue="18672" author="danielhardman" type="comment" body=" ~mgbailey  If you have any further color, please attach to the ticket." created="2017-06-26 15:11:16.0" updateauthor="danielhardman" updated="2017-06-26 15:11:16.0"/>
<Action id="27370" issue="18672" author="mgbailey" type="comment" created="2017-06-26 16:48:35.0" updateauthor="mgbailey" updated="2017-06-26 16:48:35.0"> <body><! CDATA Here is the test that show it.  Metis is disconnecting approximately every 4-5 hours. At about 15:00 6/23 UTC we start up a load generator that is putting a NYM into the ledger every 15 seconds, and leave it running.  At 13:47 6/24, nearly 24 hours later, something goes wrong with one of the nodes in the pool, and the load generator fails.  Soon after another disconnect occurs.  Then there is an 9 hour gap, and then the pattern of disconnecting every 4-5 hours resumes.  Here is grepped data from the logs:  2017-06-22 20:33:39,385 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-23 01:04:48,704 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-23 05:35:53,916 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-23 10:22:57,600 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-23 14:53:50,522 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis _2017-06-23 (load test starts ~15:00)_ _2017-06-24 (load test ends ~13:30)_ 2017-06-24 14:42:09,591 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-24 23:27:54,432 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-25 04:14:54,018 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-25 08:46:03,325 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-25 13:17:12,640 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-25 17:48:21,955 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-25 22:19:47,644 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-26 02:51:13,341 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-26 07:22:06,266 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis 2017-06-26 11:52:59,200 | INFO | keep_in_touch.py ( 92) | _connsChanged | play disconnected from metis  This strongly supports the theory of insufficient keep-alives.  There are 2 things that remain mysteries: 1) Why was there 9 hours with no disconnects from 2017-06-24 14:42:09,591 to 2017-06-24 23:27:54,432? 2) Why did a node in the validator pool lose sync and start spewing messages to the logs and back to the log generator agent?  ></body> </Action>
<Action id="27598" issue="18672" author="lovesh" type="comment" created="2017-06-29 12:45:02.0" updateauthor="lovesh" updated="2017-06-29 17:02:30.0"> <body><! CDATA Changes: STP: https://github.com/evernym/stp/pull/38 Plenum: https://github.com/evernym/plenum/pull/237  ></body> </Action>
<Action id="27713" issue="18672" author="lovesh" type="comment" body=" ~krw910  Test for heartbeats: test_heartbeats.py" created="2017-06-30 16:00:11.0" updateauthor="lovesh" updated="2017-06-30 16:00:11.0"/>
<Action id="27717" issue="18672" author="krw910" type="comment" created="2017-06-30 16:55:17.0" updateauthor="krw910" updated="2017-06-30 16:55:17.0"> <body><! CDATA Notes on overriding the sovrin_config.py file.  Keep Alive (Heartbeat) This is to configure how the nodes will continue to check if the other nodes are able to communicate.  ENABLE_HEARTBEATS=True HEARTBEAT_FREQ= 5 # seconds   We also have a TCP Keep Alive TCP_KEEPALIVE=True KEEPALIVE_INTVL = 1     # seconds KEEPALIVE_IDLE = 20     # seconds KEEPALIVE_CNT = 10   ></body> </Action>
<Action id="28277" issue="18672" author="krw910" type="comment" body="Blocked by INDY-406" created="2017-07-12 20:25:55.0" updateauthor="krw910" updated="2017-07-12 20:25:55.0"/>
<Action id="28604" issue="18672" author="krw910" type="comment" body="The product is good enough to go Stable. I cannot reproduce this issue and we will need to wait until the alpha pool reports back." created="2017-07-18 19:46:08.0" updateauthor="krw910" updated="2017-07-18 19:46:08.0"/>
<Action id="28607" issue="18672" author="danielhardman" type="comment" body=" ~mgbailey  we will have to instruct nodes that are experiencing problems to enable keepalives per the config settings described by Kelly. Otherwise, the fixes will not have any effect." created="2017-07-18 20:14:18.0" updateauthor="danielhardman" updated="2017-07-18 20:14:18.0"/>
<Action id="28627" issue="18672" author="mgbailey" type="comment" body="I am looking forward to trying it out!" created="2017-07-18 23:16:29.0" updateauthor="mgbailey" updated="2017-07-18 23:16:29.0"/>
<Action id="56310" issue="18672" author="liugreatsea" type="comment" body="Sorry for my mis-operation to add some content. Roll back to the original one just now." created="2019-01-29 06:29:00.0" updateauthor="liugreatsea" updated="2019-01-29 06:29:00.0"/>
