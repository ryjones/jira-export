<Action id="48305" issue="32348" author="sergey-shilov" type="comment" created="2018-08-02 16:18:57.0" updateauthor="sergey-shilov" updated="2018-08-02 16:19:25.0"> <body><! CDATA In scope of this ticket we implemented bind-before-connect. But this is not enough as bind() does not control anything about the routing of transmitted packets. The kernel uses routes to choose interface for sending even if packet source address differ from address of interface.  There is a socket option SO_BINDTODEVICE that forces packets on the socket to only egress the bound interface, regardless of what the IP routing table would normally choose.  Seems like ZMQ supports binding to device as a part of connect call:  http://api.zeromq.org/4-1:zmq-tcp  but in my experiments (using python wrapper) ZMQ tried to resolve interface name using DNS queries. Seems like it does not work, at least using python wrapper.  Also ZMQ library supports ZMQ_BINDTODEVICE option, but this option is not available in python wrapper.  But anyway, binding to device is a good solution for machines that are under our control. Much more better (and also native for networking) solution in our case is to recommend stewards to configure their routing tables so that they use dedicated interfaces for node-to-node communication.  BTW, very good doc regarding binding to address and binding to device:  https://codingrelic.geekhold.com/2009/10/code-snippet-sobindtodevice.html   ></body> </Action>
<Action id="48306" issue="32348" author="sergey-shilov" type="comment" created="2018-08-02 16:26:02.0" updateauthor="sergey-shilov" updated="2018-08-02 16:26:02.0"> <body><! CDATA *Problem state / reason:*  See ticket description.  *Changes:*  Added bind-before-connect to NODE_IP.  *Committed into:*  https://github.com/hyperledger/indy-plenum/pull/845 https://github.com/hyperledger/indy-node/pull/852 indy-node 1.5.538-master  *Risk factors:*  Nothing is expected. Complete feature needs manual configuration of routing tables by stewards.  *Risk:*  Low  *NOTE:*  I couldn't implement bind to device using ZMQ (see previous comment).  ></body> </Action>
