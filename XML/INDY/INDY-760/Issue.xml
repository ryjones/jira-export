<Issue id="20381" key="INDY-760" number="760" project="10303" reporter="ozheregelya" assignee="danielhardman" creator="ozheregelya" type="10004" summary="Pool is broken after several running of load_test.py" priority="3" resolution="10000" status="10001" created="2017-08-24 12:21:58.0" updated="2019-03-29 20:32:24.0" resolutiondate="2019-03-29 20:32:24.0" votes="0" watches="3" workflowId="20381"> <environment><! CDATA Build Info:   indy-node 1.0.111   indy-anoncreds 1.0.25   indy-plenum 1.0.97   sovrin 1.0.23 OS/Platform: Ubuntu 16.04.2 LTS Setup: performance pool (7 nodes, 2 clients)  ></environment> <description><! CDATA Steps to Reproduce:  1. Connect to pool. 2. Using two clients, run load script several times: Client 1 (all tests are running one by one): python3 load_test.py --clients-list load_test_clients.list -t NYM -c 10 -r 100 --at-once python3 load_test.py --clients-list load_test_clients.list -t NYM -c 1 -r 500 --at-once python3 load_test.py --clients-list load_test_clients.list -t NYM -c 1 -r 500 --at-once python3 load_test.py --clients-list load_test_clients.list -t NYM -c 10 -r 300 --at-once python3 load_test_inv.py --clients-list load_test_clients.list -t NYM -c 5 -r 100 --at-once  Client 2 in parallel with load_test_inv.py on client 1: python3 load_test.py --clients-list load_test_clients.list -t NYM -c 10 -r 100 --at-once =>test was failed because of InvalidMessageExceedingSizeException)  Invalid test from client 1 and valid test from client 2 are stopped, new test on client 2: python3 load_test.py --clients-list load_test_clients.list -t NYM -c 10 -r 100 --at-once  Actual Results: Pool is broken after these actions. Following messages repeatedly appear in the log: {code:java} 2017-08-24 10:42:37,450 | DEBUG | replica.py ( 311) | last_ordered_3pc | Node1:1 set last ordered as (0, 0) 2017-08-24 10:42:37,450 | DEBUG | replica.py ( 953) | __is_next_pre_prepare | Node1:2 missing PRE-PREPAREs between 10 and 8 2017-08-24 10:42:37,450 | DEBUG | replica.py ( 495) | _setup_for_non_master | Node1:2 Setting last ordered for non-master as (0, 0) 2017-08-24 10:42:37,450 | DEBUG | replica.py ( 311) | last_ordered_3pc | Node1:2 set last ordered as (0, 0) 2017-08-24 10:42:37,463 | DEBUG | replica.py ( 953) | __is_next_pre_prepare | Node1:1 missing PRE-PREPAREs between 6 and 4 2017-08-24 10:42:37,464 | DEBUG | replica.py ( 495) | _setup_for_non_master | Node1:1 Setting last ordered for non-master as (0, 0){code}  Expected Result: Pool should work.  Additional Information: Count of transactions is equal for ledgers on all nodes: {code:java} ubuntu@californiaPerf1:/home/sovrin/.sovrin$ sudo read_ledger --type=domain --count 1406{code}  ></description> </Issue>
