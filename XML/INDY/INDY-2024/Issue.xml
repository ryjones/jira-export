<Issue id="38512" key="INDY-2024" number="2024" project="10303" reporter="vladimirwork" assignee="vladimirwork" creator="vladimirwork" type="10004" summary="Only Trustee or Node owner can be the author of NODE demotion txn regardless of endorsement or auth constraint rules set" priority="3" resolution="10000" status="10001" created="2019-03-15 12:00:50.0" updated="2019-12-11 16:47:18.0" resolutiondate="2019-12-11 16:47:18.0" votes="0" watches="2" workflowId="50155"> <description><! CDATA Build Info: indy-node 1.6.861  Steps to Reproduce: {noformat} pool(docker):wallet(docker):did(V4S...e6f):indy> ledger custom {"reqId":111,"identifier":"V4SGRU86Z58d6TV7PBUe6f","operation":{"type":"120","constraint":{"constraint_id":"OR","auth_constraints": {"constraint_id":"ROLE","role":"101","sig_count":1,"need_to_be_owner":false,"metadata":{}} },"field":"services","auth_type":"0","auth_action":"EDIT","old_value":" 'VALIDATOR' ","new_value":"  "},"protocolVersion":2} sign=true Response:  {"op":"REPLY","result":{"rootHash":"42TDiKJNQiBegte8KMeQaCAMsHk1JjvqCHfgqkHnQUPx","txnMetadata":{"txnTime":1552647677,"seqNo":1},"ver":"1","txn":{"protocolVersion":2,"type":"120","data":{"auth_action":"EDIT","auth_type":"0","constraint":{"auth_constraints": {"metadata":{},"role":"101","need_to_be_owner":false,"constraint_id":"ROLE","sig_count":1} ,"constraint_id":"OR"},"field":"services","old_value":" 'VALIDATOR' ","new_value":"  "},"metadata":{"reqId":111,"from":"V4SGRU86Z58d6TV7PBUe6f","digest":"5d8ec44a9bda929d49ae1200b6a0a110526c6de07ea0259ee50d5c821e11ccb8"}},"auditPath":  ,"reqSignature":{"type":"ED25519","values": {"value":"3mFrSzSnr9ob3jrxsX2etSxpk953EnM629z2W3NeudkM2tdQZoJvWayf5QBTvzYoXfRkomrfDHcnTiVbjLBqXXzv","from":"V4SGRU86Z58d6TV7PBUe6f"} }}} pool(docker):wallet(docker):did(V4S...e6f):indy> ledger custom {"reqId":111,"identifier":"V4SGRU86Z58d6TV7PBUe6f","operation":{"type":"120","constraint":{"constraint_id":"OR","auth_constraints": {"constraint_id":"ROLE","role":"101","sig_count":1,"need_to_be_owner":false,"metadata":{}} },"field":"services","auth_type":"0","auth_action":"EDIT","old_value":"  ","new_value":" 'VALIDATOR' "},"protocolVersion":2} sign=true Response:  {"result":{"auditPath": "42TDiKJNQiBegte8KMeQaCAMsHk1JjvqCHfgqkHnQUPx" ,"txn":{"data":{"constraint":{"auth_constraints": {"metadata":{},"need_to_be_owner":false,"constraint_id":"ROLE","sig_count":1,"role":"101"} ,"constraint_id":"OR"},"old_value":"  ","auth_type":"0","auth_action":"EDIT","field":"services","new_value":" 'VALIDATOR' "},"protocolVersion":2,"metadata":{"reqId":111,"digest":"2c9b6753fed0ab65c6b4868b3cd7b8ab9826f9b65223177723638e8ee3ad7c6c","from":"V4SGRU86Z58d6TV7PBUe6f"},"type":"120"},"reqSignature":{"type":"ED25519","values": {"value":"4oxvQ8m4q8tadAiNkqy42j8tzrTMqSRNeMAKB4He4tyh99yZyJnBmuLKxKo6inABQDJTK4U2AAeBzDzumpWXE5aq","from":"V4SGRU86Z58d6TV7PBUe6f"} },"ver":"1","txnMetadata":{"txnTime":1552647697,"seqNo":2},"rootHash":"GGM8cUuqNnXT7Y6HYdgbMg8N9P592WTWfouAuX8D2EXo"},"op":"REPLY"} pool(docker):wallet(docker):did(V4S...e6f):indy> did use VnxoLY944SQjpctrfzWGaz Did "VnxoLY944SQjpctrfzWGaz" has been set as active pool(docker):wallet(docker):did(Vnx...Gaz):indy> ledger node target=4SWokCJWJc69Tn74VvLS6t2G2ucvXqM9FDMsWJjmsUxe alias=Node5 services= {noformat}   Actual Results: {noformat} Transaction has been rejected: VnxoLY944SQjpctrfzWGaz is not a steward of node 4SWokCJWJc69Tn74VvLS6t2G2ucvXqM9FDMsWJjmsUxe {noformat} Now we have another error here: new TA is not a Steward of Node5 but we have the rule that we should not be the owner to perform node demotion (just TA role is needed).  Expected Results: Node demotion should be successfull in this case.  ></description> </Issue>
