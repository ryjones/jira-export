<Issue id="43489" key="INDY-2308" number="2308" project="10303" reporter="ashcherbakov" assignee="anikitindsr" creator="ashcherbakov" type="10002" summary="A node lagging behind may not be able to finish view change if nodes have been added/demoted" priority="3" resolution="10000" status="10001" created="2019-11-27 19:48:38.0" updated="2020-01-20 10:06:15.0" resolutiondate="2020-01-17 13:11:36.0" votes="0" watches="3" workflowId="56603"> <description><! CDATA *Issue* * A node is lagging behind and doing a view change to viewNo=X. This may happen if a node joins a pool under heavy load. * Other nodes in the pool are already on viewNo=X+Y, and *their node registry is different* (that is new Nodes have been demoted/added). * The node finishes the view change, and stashes all 3PC messages for future view coming from other nodes * The node doesn't unstash the messages until it performs re-ordering till last prepared certificate * The node gets a quorum of instance changes for viewNo=X+1 * The same situation happens for viewNo=X+2, X+3, etc. * At some view lagging Node expects different Primaries than other nodes did since it doesn't have up-to-date node registry * As we don't process any checkopoints and don't start catchup by checkpoints during the view change, the node will be in the view change forever  *Workaround* * Node restart  *Possible fix* * Option 1: Process future checkpoints and allow to start catchup during view change by checkpoints * Option 2: request NEW_VIEW from a quorum of Node and trust who is the Primary based on this NEW_VIEW  ></description> </Issue>
