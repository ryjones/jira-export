<Action id="29436" issue="19540" author="ashcherbakov" type="comment" body="Do not spend much time on this, add a basis reasonable logging." created="2017-08-04 08:44:03.0" updateauthor="ashcherbakov" updated="2017-08-04 08:44:03.0"/>
<Action id="30036" issue="19540" author="alexander.shekhovcov" type="comment" created="2017-08-21 12:42:05.0" updateauthor="alexander.shekhovcov" updated="2017-08-21 12:42:05.0"> <body><! CDATA  ~mgbailey   ~ashcherbakov   Should I add logging on the client side (CLI, ...) or the ticket is about logging on the pool side?  After INDY-484 is closed we will have fairly well logging on the pool side with right log levels and ability to filter logs (see INDY-484).  Anyway let's consider possible cases: # a client sends invalid request ** for now this case has fairly well logging on the client side # pool does not reach consensus ** in this case the pool does not answer anything to the client so we have to add an additional client request like "get request status" which will return some verbose information about request status but it requires significant amount of work   # the pool gets consensus but fails somehow between "ordered" and "replay" phases ** the pool does not answer anything, a new "get request status" will help here as well  So in case of a pool failure a client is not able to get any request status we can solve it adding a new type of request like "get request status" but it assumes some changes in code which are not a simple logging.  ></body> </Action>
<Action id="30037" issue="19540" author="alexander.shekhovcov" type="comment" body=" ~mgbailey  Btw, Nikita has created a document  &quot;Important Node Log Messages&quot;|https://docs.google.com/document/d/1xEHNXn9-PiPP61BccWD0SOSDsw7LYxyOgY2dHXn0X8I/edit#  maybe the document will be helpful for you. The document reflects the latest changes in master branch so it will be actual in the next stable release." created="2017-08-21 12:55:00.0" updateauthor="alexander.shekhovcov" updated="2017-08-21 12:55:00.0"/>
<Action id="30081" issue="19540" author="mgbailey" type="comment" body=" ~alexander.shekhovcov , the ticket is intended for server-side logging.  Currently, we see many cases where attempts to post a transaction fail silently.  The transaction just does not appear in the ledger.  It is possible that a cause could be found if logging is turned on to a very high level, or with a lot of detective work, but this is not how it should be.  This type of event should be made obvious to the average admin, not just to the dedicated developer.  ERROR, or at least WARN, is the appropriate log level for failure to post a transaction, and an explanation of why the failure occurred should be given." created="2017-08-22 19:29:27.0" updateauthor="mgbailey" updated="2017-08-22 19:29:27.0"/>
<Action id="30106" issue="19540" author="alexander.shekhovcov" type="comment" created="2017-08-23 13:04:00.0" updateauthor="alexander.shekhovcov" updated="2017-08-23 13:09:55.0"> <body><! CDATA Agree. I am going to view code to add more verbosity for failures.  Types of failures:  * cannot get consensus * rejecting / reqnacking * suspicions * not enougth connection * node is not participating * missing requests * cachup fails * node crashes * permission errors * election fails  PoA: * check if each of the cases has logging and logging level is >= than INFO    ></body> </Action>
<Action id="30147" issue="19540" author="alexander.shekhovcov" type="comment" created="2017-08-24 10:46:26.0" updateauthor="alexander.shekhovcov" updated="2017-08-24 10:46:49.0"> <body><! CDATA (/) *Resolved*  https://github.com/hyperledger/indy-plenum/pull/355 https://github.com/hyperledger/indy-node/pull/319  I've increased log level for some messages and added messages like: {code} 2017-08-24 13:22:02,801 | WARNING  | monitor.py           ( 302) | warn_has_lot_unordered_requests | It looks like Beta does not participate in processing messages because it has 3 unordered requests in the last 0.25 minutes (assumed that minimum difference between unordered requests is at least 1 seconds) {code}  {code} 2017-08-24 13:22:02,801 | WARNING  | Alpha is getting requests but still does not have a primary so the replica will not process the request until a primary is chosen {code}  It should help to find out that a node is not participating in consensus so exact cause may be found by log messages which are placed above in a log. There is no certain place in the code there we can say "the node cannot process 3pc messages" or "the node cannot choose a primary" and define the cause of that. For example a node may miss a 3pc message because of network problem so a prepare comes before pre-prepare it is not a problem itself but in some cases it may be a sign that the node get out sync.  Let's try to work with the current logging setup and collect cases when the average admin feels uncomfortable with the logs so we will be able to define exact problems and add reasonable logging.  Nothing to test here.  ></body> </Action>
<Action id="30198" issue="19540" author="ashcherbakov" type="comment" body="Node build: 1.1.116" created="2017-08-25 11:32:50.0" updateauthor="ashcherbakov" updated="2017-08-25 11:32:50.0"/>
<Action id="30205" issue="19540" author="vladimirwork" type="comment" created="2017-08-25 15:11:01.0" updateauthor="vladimirwork" updated="2017-08-25 15:11:51.0"> <body><! CDATA Build Info: indy-node 1.1.118  Steps to Validate: 1. Change the log level "echo "logLevel=0" >> /home/sovrin/.sovrin/sovrin_config.py" 2. Restart the node. 3. Check new messages in the log.  Actual Results: New log messages are implemented.  ></body> </Action>
<Action id="40140" issue="19540" author="mgbailey" type="comment" created="2018-02-14 14:57:05.0" updateauthor="mgbailey" updated="2018-02-14 14:57:05.0"> <body><! CDATA The request was for an ERROR, not a DEBUG message when a failure occurs, along with a cause of the failure.  Should be just a couple of lines of logging.  This is not what was provided.     ></body> </Action>
<Action id="40144" issue="19540" author="ashcherbakov" type="comment" created="2018-02-14 15:35:38.0" updateauthor="ashcherbakov" updated="2018-02-14 15:35:38.0"> <body><! CDATA I believe the requirement was got incorrectly.  All issues are logged with ERROR/WARNING level.  What is not logged, is when a request is received, but not enough 3PC. As the system is not deterministic, we can not say that transaction failed in this case, and there is no real ERROR to be shown.  What we can do, is to introduce some kind of a timeout, and check, that if txn is not ordered in, for example, 60 secs, we show a WARNING.  ></body> </Action>
<Action id="40190" issue="19540" author="mgbailey" type="comment" created="2018-02-14 18:33:55.0" updateauthor="mgbailey" updated="2018-02-14 18:33:55.0"> <body><! CDATA Yes.  It would be good to have at the INFO level that a transaction has been received for processing, and then if it is posted to the ledger have a message at the INFO level stating that, and after 60 seconds if it is not posted, have a WARNING and a reason.  This would be a great help, and would require less assistance from engineering for analyzing logs in the future.     ></body> </Action>
<Action id="42304" issue="19540" author="sergey.khoroshavin" type="comment" body="Is it still needed to log this information by node? Now there is a tool which bulk processes logs from nodes (https://github.com/hyperledger/indy-plenum/tree/master/scripts/process_logs), and among other things it can track requests and report how much of them were not ordered at all. It&apos;s not hard to add to this tool reporting which individual requests were not ordered if really needed. Also, while working on https://jira.hyperledger.org/browse/INDY-1177 I plan to implement proof-of-concept integration with Elastic/LogStash/Kibana stack by middle/end of next week, which in the end could turn out to be even better solution." created="2018-03-29 10:48:29.0" updateauthor="sergey.khoroshavin" updated="2018-03-29 10:48:29.0"/>
<Action id="42311" issue="19540" author="ashcherbakov" type="comment" body=" ~mgbailey  ^" created="2018-03-29 13:23:25.0" updateauthor="ashcherbakov" updated="2018-03-29 13:23:25.0"/>
<Action id="42389" issue="19540" author="mgbailey" type="comment" body=" ~sergey.khoroshavin This requirement remains in force.  Failure to post a transaction must be treated as a failure mode, and must be logged in a way that can be understood by operators, not devs." created="2018-03-30 14:55:25.0" updateauthor="mgbailey" updated="2018-03-30 14:56:22.0"/>
<Action id="42739" issue="19540" author="sergey.khoroshavin" type="comment" body="PR: https://github.com/hyperledger/indy-plenum/pull/619" created="2018-04-09 17:13:50.0" updateauthor="sergey.khoroshavin" updated="2018-04-09 17:13:50.0"/>
<Action id="43266" issue="19540" author="ozheregelya" type="comment" created="2018-04-23 10:48:09.0" updateauthor="ozheregelya" updated="2018-04-23 10:48:09.0"> <body><! CDATA *Environment:* indy-node 1.3.382; Docker pool of 6 nodes.  *Case 1:* Steps to Validate: 1. Setup the pool. 2. Check that the pool works by sending any transaction. 3. Stop 2 of 6 nodes. => Consensus is lost. 4. Send transaction and check logs after 1 min.  Actual Results: Warning message appears if the transaction was not ordered in 1 min. {code:java} 2018-04-22 21:30:44,186 | WARNING  | monitor.py           ( 348) | check_unordered | Following requests were not ordered for more than 60 seconds:  ('V4SGRU86Z58d6TV7PBUe6f', 1524432616029524)   {code} *Case 2:* Steps to Validate: 1. Change UnorderedCheckFreq in indy_config.py to 1 sec (default value is 60). 2. Restart the pool after changes in the config. 3. Write several transactions, check logs.  Actual Results: Warning message appears if transaction was not ordered during specified time: {code:java} 2018-04-22 21:40:58,683 | WARNING | monitor.py ( 348) | check_unordered | Following requests were not ordered for more than 1 seconds:  ('V4SGRU86Z58d6TV7PBUe6f', 1524433258386167) {code}  ></body> </Action>
<Action id="43300" issue="19540" author="mgbailey" type="comment" body="Is there information stating +why+ transaction failed to post (i.e. only 4 of 6 nodes, with the following nodes not participating: ...)?  This information is required." created="2018-04-23 17:52:20.0" updateauthor="mgbailey" updated="2018-04-23 17:52:20.0"/>
<Action id="43335" issue="19540" author="ashcherbakov" type="comment" created="2018-04-24 07:54:48.0" updateauthor="ashcherbakov" updated="2018-04-24 07:54:48.0"> <body><! CDATA  ~sergey.khoroshavin   ~ozheregelya   ~mgbailey  Let's create a new ticket if needed to enhance the message of why txn failed to post.  ></body> </Action>
<Action id="43381" issue="19540" author="mgbailey" type="comment" body=" ~ashcherbakov , this ticket is not complete, since the stated requirements have not been completed. The ticket needs to be rejected." created="2018-04-24 21:57:30.0" updateauthor="mgbailey" updated="2018-04-24 21:57:30.0"/>
<Action id="43446" issue="19540" author="esplinr" type="comment" created="2018-04-25 22:25:25.0" updateauthor="esplinr" updated="2018-04-25 22:25:25.0"> <body><! CDATA I reviewed this issue with  ~mgbailey  to understand what specifically is missing. As a result, we clarified INDY-1274 and logged INDY-1300.  We will close this issue, and prioritize those other two into the backlog.  ></body> </Action>
