<Issue id="42716" key="INDY-2247" number="2247" project="10303" reporter="vladimirwork" assignee="toktar" creator="vladimirwork" type="10004" summary="Two View Changes happen during master or backup primary demotion" priority="3" resolution="10000" status="10001" created="2019-10-10 16:01:21.0" updated="2019-10-24 06:56:33.0" resolutiondate="2019-10-24 06:55:32.0" votes="0" watches="3" workflowId="55796"> <description><! CDATA Build Info: indy-node 1.10.0~dev1094  Steps to Reproduce: 1. Stop primary (and ensure that primary has changed). 2. Start ex-primary and demote backup primary (and ensure that primary has changed). 3. Promote demoted node (and ensure that primary has changed).  https://github.com/hyperledger/indy-test-automation/blob/f3c0c75e04f416a81f22025146bc5ca9b1e2f718/system/indy-node-tests/TestAuditSuite.py#L153  Actual Results: Primary didn't change in Step 3 (but before PBFT this test passed) for master and backup primary cases (params 0 and 1). We have View 3 at the end for all 3 cases: master primary, backup primary, non-primary demotion/promotion. Primaries changing during all cases: {noformat} param 0 (master primary): Primary at the beginning is 1 Primary after service stop is 2 Primary after service start is 2 Primary before demotion is 2 Primary after demotion is 4  param 1 (backup primary): Primary at the beginning is 1 Primary after service stop is 2 Primary after service start is 2 Primary before demotion is 2 Primary after demotion is 4  param 5 (non-primary): Primary at the beginning is 1 Primary after service stop is 2 Primary after service start is 2 Primary before demotion is 2 Primary after demotion is 3 Primary after promotion is 4 {noformat} Before PBFT changes all cases passed like the last one now.   ></description> </Issue>
