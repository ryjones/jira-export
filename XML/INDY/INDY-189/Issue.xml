<Issue id="17691" key="INDY-189" number="189" project="10303" reporter="ozheregelya" assignee="stevetolman" creator="ozheregelya" type="10004" summary=" CLI  Trustee can change verkey for CID if it was created without verkey" priority="2" resolution="10200" status="10001" created="2017-06-09 13:37:36.0" updated="2019-03-29 20:33:29.0" resolutiondate="2019-03-29 20:33:29.0" votes="0" watches="3" workflowId="17695"> <environment><! CDATA Build Info: sovrin-client version: 0.3.122 sovrin-node version: 0.3.115   OS/Platform: Ubuntu 16.04.2 LTS  ></environment> <description><! CDATA *Case 1* *Steps to Reproduce:* 1. Create new CID (new key). 2. As trustee, send NYM without verkey (send NYM dest=ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP or send NYM dest=ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP role=STEWARD). => NYM is send, default verkey is set equal to identifier. 3. Send NYM again (as trustee) with verkey.     *Actual Results:* Verkey is successfully changed. {code:java} sovrin@test> new key Key created in keyring oltest Identifier for key is ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP Current identifier set to ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP sovrin@test> new key with seed 000000000000000000000000Trustee1 Key created in keyring oltest Identifier for key is GJ1SzoWzavQYfNL9XkaJdrQejfztN4XqdsiV4ct3LXKL Current identifier set to GJ1SzoWzavQYfNL9XkaJdrQejfztN4XqdsiV4ct3LXKL sovrin@test> send NYM dest=ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP Adding nym ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP Nym ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP added sovrin@test> send GET_NYM dest=ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP Getting nym ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP Current verkey is same as identifier ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP sovrin@test> send NYM dest=ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP verkey=A SxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP Adding nym ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP Nym ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP added {code} *Expected Results:* Verkey should not be changed.   *Case 2* *Steps to Reproduce:* 1. Create new CID (new key). 2. As trustee, send NYM without verkey (send NYM dest=ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP or send NYM dest=ASxpwNExaEjXtuscbVdPSBD8UQ4rw1DaoKVafcdhhmwP role=STEWARD). => NYM is send, default verkey is set equal to identifier. 3. Try to change verkey using newly created identifier. {code:java} sovrin@test> use identifier FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM sovrin@test> send NYM dest=FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM verkey=FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiq1 {code}    *Actual Results:* Error appears: {code:java} sovrin@test> new key Key created in keyring Default-VzUs8R Identifier for key is FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM Current identifier set to FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM sovrin@test> new key with seed 000000000000000000000000Trustee1 Key created in keyring Default-VzUs8R Identifier for key is GJ1SzoWzavQYfNL9XkaJdrQejfztN4XqdsiV4ct3LXKL Current identifier set to GJ1SzoWzavQYfNL9XkaJdrQejfztN4XqdsiV4ct3LXKL J2RSqs5vGxDJ9tykU2z6QkRymDigqaNJbmLf6amTykrh now connected to Node6C sovrin@test> send NYM dest=FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM Adding nym FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM Nym FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM added sovrin@test> use identifier FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM Current identifier set to FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM sovrin@test> send NYM dest=FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM verkey=F vpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiq1 Adding nym FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM Error: client request invalid: InvalidClientRequest('FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM is neither Trustee nor owner of FvpJGZtJ24charRZcx9hpqPziTdDtGy7v4QHHMjjAiqM',) {code} *Expected Results:* Error should not appear, verkey should be changed.   Additional Information: Workaround of Case 2 - do not send NYM without verkey for CID, or send second NYM with verkey equal to identifier as trustee.  ></description> </Issue>
