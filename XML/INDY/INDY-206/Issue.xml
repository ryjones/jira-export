<Issue id="17815" key="INDY-206" number="206" project="10303" reporter="alexander.shekhovcov" assignee="danielhardman" creator="alexander.shekhovcov" type="10004" summary="An ATTRIB transaction with an empty JSON" priority="2" resolution="10000" status="10001" created="2017-06-13 10:20:16.0" updated="2019-03-29 20:32:20.0" resolutiondate="2019-03-29 20:32:20.0" votes="0" watches="4" workflowId="17819"> <description><! CDATA One of the shakedown pools had the following stacktrace {code:java} May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1004, in serviceReplicaInBox May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : msgCount += replica.serviceQueues(limit) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/replica.py", line 522, in serviceQueues May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : self.node.isParticipating) else 0 May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/replica.py", line 438, in send3PCBatch May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : ppReq = self.create3PCBatch(lid) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/replica.py", line 479, in create3PCBatch May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : self.processReqDuringBatch(req, validReqs, inValidReqs, rejects) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/replica.py", line 456, in processReqDuringBatch May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : self.node.applyReq(req) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/sovrin_node/server/node.py", line 393, in applyReq May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : return super().applyReq(request) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1485, in applyReq May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : return self.domainRequestApplication(request) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/node.py", line 1491, in domainRequestApplication May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : return self.reqHandler.apply(request) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/domain_req_handler.py", line 52, in apply May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : self.updateState(txnsWithSeqNo(start, end,  txn )) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/plenum/server/domain_req_handler.py", line 66, in updateState May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : self._updateStateWithSingleTxn(txn, isCommitted=isCommitted) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/sovrin_node/server/domain_req_handler.py", line 56, in _updateStateWithSingleTxn May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : self._addAttr(txn) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/sovrin_node/server/domain_req_handler.py", line 339, in _addAttr May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : attr_key, value = parse(txn) May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : File "/usr/local/lib/python3.5/dist-packages/sovrin_node/server/domain_req_handler.py", line 328, in parse May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : key, _ = data.popitem() May 29 14:06:23 singaporeShakeP2.qatest.evernym.com start_sovrin_node 9347 : KeyError: 'popitem(): dictionary is empty'{code} Lovesh's comment: {quote}The error appears to be due to passing an ATTRIB transaction with an empty JSON {quote} It should be check because if so the an empty JSON in ATTRIB breaks a pool.  Â   ></description> </Issue>
