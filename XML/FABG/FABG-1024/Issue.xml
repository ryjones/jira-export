<Issue id="46446" key="FABG-1024" number="1024" project="10610" reporter="JIRAUSER21226" assignee="JIRAUSER21226" creator="JIRAUSER21226" type="10004" summary="Segfault using TLS 1.3 Client Certificates" priority="3" resolution="10000" status="6" created="2020-12-23 19:50:52.0" updated="2020-12-28 15:29:51.0" resolutiondate="2020-12-28 15:29:51.0" votes="0" watches="1" workflowId="60386" archived="N"> <description><! CDATA Under certain conditions when attempting to perform TLS 1.3 handshake, the Go library's TLS 1.3 code segfaults when trying to access ECDSA public key parameters that since cryptoutils puts an empty public key in the private key.  Â   A stack trace below shows the initial gRPC handshake while trying to create a channel client: {code:java} panic: runtime error: invalid memory address or nil pointer dereference  signal SIGSEGV: segmentation violation code=0x1 addr=0x30 pc=0x435c353 goroutine 78  running : crypto/tls.unsupportedCertificateError(0xc0002c7180, 0xc0002c7180, 0x0) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/auth.go:275 +0x573 crypto/tls.selectSignatureScheme(0xc000c80304, 0xc0002c7180, 0xc0013981a0, 0xc, 0x10, 0xc001383628, 0x4011951, 0x51c95d0) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/auth.go:234 +0x22d crypto/tls.(*CertificateRequestInfo).SupportsCertificate(0xc000c809c0, 0xc0002c7180, 0x0, 0x0) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/common.go:1204 +0xb8 crypto/tls.(*Conn).getClientCertificate(0xc000a78e00, 0xc000c809c0, 0xc001399080, 0x20, 0xc0013837a0) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/handshake_client.go:951 +0x1c9 crypto/tls.(*clientHandshakeStateTLS13).sendClientCertificate(0xc001383d80, 0x0, 0x0) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/handshake_client_tls13.go:548 +0x285 crypto/tls.(*clientHandshakeStateTLS13).handshake(0xc001383d80, 0x8, 0xc000697e9e) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/handshake_client_tls13.go:91 +0x629 crypto/tls.(*Conn).clientHandshake(0xc000a78e00, 0x0, 0x0) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/handshake_client.go:209 +0x837 crypto/tls.(*Conn).Handshake(0xc000a78e00, 0x0, 0x0) /usr/local/Cellar/go/1.15.5/libexec/src/crypto/tls/conn.go:1362 +0x18e google.golang.org/grpc/credentials.(*tlsCreds).ClientHandshake.func1(0xc000d025a0, 0xc000a78e00) /Users/david/go/pkg/mod/google.golang.org/grpc@v1.33.1/credentials/tls.go:87 +0x39 created by google.golang.org/grpc/credentials.(*tlsCreds).ClientHandshake /Users/david/go/pkg/mod/google.golang.org/grpc@v1.33.1/credentials/tls.go:86 +0x12d {code} I've reproduced this in Go 1.14 and Go 1.15.  ></description> </Issue>
