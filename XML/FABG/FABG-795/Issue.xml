<Issue id="35509" key="FABG-795" number="795" project="10610" reporter="jje" creator="jje" type="10004" summary="32 bit operating system, atomic.addUint64() panics if the pointer to its argument is not 64byte aligned" priority="3" resolution="10000" status="6" created="2018-11-21 08:06:02.0" updated="2018-11-21 23:27:22.0" resolutiondate="2018-11-21 23:27:22.0" votes="0" watches="2" workflowId="46975"> <description><! CDATA  When running Fabric Go SDK on a Raspberry Pi I can query the ledger, but if I try to write transactions to the ledger (channel.Execute), a runtime error occurs.  It is an issue with the 32 bit arm operating system, and atomic.addUint64() panics if the pointer to its argument is not 64byte aligned.  Golang bug report:  https://github.com/golang/go/issues/23345  Here is the error message:  {code} panic: runtime error: invalid memory address or nil pointer dereference  signal SIGSEGV: segmentation violation code=0x1 addr=0x4 pc=0x11e08   goroutine 58  running : sync/atomic.loadUint64(0x11cea6c4, 0x11dc0848, 0x37545c) /home/pi/.gvm/gos/go1.10.3/src/sync/atomic/64bit_arm.go:10 +0x3c github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher.(*Dispatcher).updateLastBlockNum(0x11cea680, 0x173, 0x0, 0x11dc0830, 0x1) /home/pi/go/src/github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher/dispatcher.go:157 +0x28 github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher.(*Dispatcher).HandleFilteredBlock(0x11cea680, 0x11eca300, 0x11c9f6b0, 0x10) /home/pi/go/src/github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher/dispatcher.go:451 +0xb8 github.com/hyperledger/fabric-sdk-go/pkg/fab/events/deliverclient/dispatcher.(*Dispatcher).handleEvent(0x1202dc38, 0x5645a0, 0x1202fab0) /home/pi/go/src/github.com/hyperledger/fabric-sdk-go/pkg/fab/events/deliverclient/dispatcher/dispatcher.go:83 +0x1e8 github.com/hyperledger/fabric-sdk-go/pkg/fab/events/deliverclient/dispatcher.(*Dispatcher).(github.com/hyperledger/fabric-sdk-go/pkg/fab/events/deliverclient/dispatcher.handleEvent)-fm(0x5645a0, 0x1202fab0) /home/pi/go/src/github.com/hyperledger/fabric-sdk-go/pkg/fab/events/deliverclient/dispatcher/dispatcher.go:114 +0x2c github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher.(*Dispatcher).Start.func1(0x11cea680) /home/pi/go/src/github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher/dispatcher.go:137 +0x26c created by github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher.(*Dispatcher).Start /home/pi/go/src/github.com/hyperledger/fabric-sdk-go/pkg/fab/events/service/dispatcher/dispatcher.go:121 +0xbc {code} Proper alignment of the structs   {code} type Dispatcher struct { +       lastBlockNum               uint64       // must be 64 bit aligned params -       lastBlockNum               uint64 updateLastBlockInfoOnly    bool state                      int32 eventch                    chan interface{} ... } {code} helps.      ></description> </Issue>
