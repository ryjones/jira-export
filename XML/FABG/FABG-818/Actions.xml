<Action id="56212" issue="37143" author="bstasyszyn" type="comment" body=" ~denniskuhnert  Can you please add steps to reproduce?" created="2019-01-25 14:34:08.0" updateauthor="bstasyszyn" updated="2019-01-25 14:34:08.0"/>
<Action id="57027" issue="37143" author="denniskuhnert" type="comment" created="2019-02-14 11:31:37.0" updateauthor="denniskuhnert" updated="2019-02-14 11:31:37.0"> <body><! CDATA  ~bstasyszyn  One way I found today:  Setup network, connect SDK, make all calls via SDK: * Create channel & join peer * (I also set the channel's anchor peers to this peer) * Stop peer and prune data * Start peer again * Join peer to channel  When I then try to fetch channel data, I get the error that the discovery client has been closed.  Â   PS: This is not the only way this happens, but so far the only way I could reproduce. Not sure if it also happens when a peer gets temporarily unresponsive.  ></body> </Action>
<Action id="57840" issue="37143" author="bstasyszyn" type="comment" created="2019-03-04 16:18:17.0" updateauthor="bstasyszyn" updated="2019-03-04 16:18:17.0"> <body><! CDATA  ~denniskuhnert  The main problem is that the SDK doesn't know whether the 'access denied' error is transient (as in the case of the peer being pruned) or fatal (as in the case of the user being revoked). So I think the decision on what to do in the case of an error should be made by the client (i.e. the user of the SDK). I propose the following: - Add a WithErrorHandler(handler) option to the SDK which would allow the client to be notified of errors - Add a CloseContext(ctxt) function to the SDK which would shut down all resources associated with a given client context  For example: {code:java} errHandler := func(ctxt fab.ClientContext, channelID string, err error) { if err.Error() == "access denied" { sdk.CloseContext(ctxt) // Need to recreate channel/resmgmt clients that were using this context } else { // Probably just a transient error - do nothing } }{code} Please let me know if this would help resolve your problem.  ></body> </Action>
<Action id="57856" issue="37143" author="denniskuhnert" type="comment" created="2019-03-05 06:31:57.0" updateauthor="denniskuhnert" updated="2019-03-05 06:31:57.0"> <body><! CDATA  ~bstasyszyn  I understand that it is difficult to differentiate. Also in my case, I am using different users with the same SDK.  I would be ok with any way to be able to get notified about the SDK close. May it be a function I can call or a handler I can provide. Then, I would be able to close the SDK and open a new one. (I think there is no "reconnect" function, right?)  ></body> </Action>
<Action id="57956" issue="37143" author="denniskuhnert" type="comment" body=" ~bstasyszyn  Thank you for the fast fix =)" created="2019-03-07 08:18:10.0" updateauthor="denniskuhnert" updated="2019-03-07 08:18:10.0"/>
